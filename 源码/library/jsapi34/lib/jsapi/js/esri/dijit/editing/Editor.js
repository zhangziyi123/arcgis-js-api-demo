/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"url:esri/dijit/editing/templates/Editor.html":"<div class=\"esriEditor\">\r\n    <div class=\"esriTemplatePicker\" dojoAttachPoint=\"templatePickerDiv\"></div>\r\n    <div class=\"esriDrawingToolbar\" dojoAttachPoint=\"drawingToolbarDiv\"></div>\r\n    <div class=\"progressBar\" dojoAttachPoint=\"progressBar\" indeterminate=\"true\" dojoType=\"dijit.ProgressBar\" />\r\n</div>"}});define("esri/dijit/editing/Editor",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/kernel","dojo/has","dojo/query","dojo/DeferredList","dojo/dom-class","dojo/dom-construct","dijit/_Widget","dijit/_Templated","esri/domUtils","esri/graphicsUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/graphic","esri/undoManager","esri/tasks/query","esri/layers/FeatureLayer","esri/layers/FeatureTemplate","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/AttributeInspector","esri/dijit/editing/Util","esri/dijit/editing/Add","esri/dijit/editing/Update","esri/dijit/editing/Delete","esri/dijit/editing/toolbars/Drawing","esri/dijit/editing/SelectionHelper","esri/dijit/editing/TemplatePicker","esri/kernel","esri/config","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/Editor.html","dijit/ProgressBar","dojo/NodeList-dom"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,Add,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22){var _23=_1([_b,_c],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:true,templateString:_22,constructor:function(_24,_25){_24=_24||{};if(!_24.settings){console.error("Editor: please provide 'settings' parameter in the constructor");}if(!_24.settings.layerInfos){console.error("Editor: please provide 'layerInfos' parameter in the constructor");}this._settings=_24.settings;this._eConnects=[];},postCreate:function(){this._setDefaultOptions();this._initLayers();this._connectEvents();this._createWidgets();this._reset();this._enableMapClickHandler();},stopEditing:function(_26){this._updateCurrentFeature(_2.hitch(this,function(){this._clearSelection(false);_26&&_26();}));},destroy:function(){if(this.drawingToolbar){this.drawingToolbar.destroy();}if(this.attributeInspector){this.attributeInspector.destroy();}if(this.templatePicker){this.templatePicker.destroy();}if(this._selectionHelper){this._selectionHelper.destroy();}if(this._drawToolbar){this._drawToolbar.deactivate();}this._reset();this._disableMapClickHandler();_3.forEach(this._eConnects,_4.disconnect);_4.disconnect(this._dtConnect);_4.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this._editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;if(this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures){this._settings.map.infoWindow.clearFeatures();}this.inherited(arguments);},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new _16(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this._editToolbar=this._settings.editToolbar||new _17(this._settings.map);this._settings.editToolbar=this._editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||false;this._settings.toolbarOptions=_2.mixin({reshapeVisible:false,cutVisible:false,mergeVisible:false},this._settings.toolbarOptions);this._settings.createOptions=_2.mixin({polylineDrawTools:[_23.CREATE_TOOL_POLYLINE],polygonDrawTools:[_23.CREATE_TOOL_POLYGON],editAttributesImmediately:true},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?true:false;this._datePackage=this._settings.datePackage;var _27=_20.defaults;this._settings.geometryService=this._settings.geometryService||_27.geometryService;_27.geometryService=_27.geometryService||this._settings.geometryService;},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};var _28=this._settings.layerInfos;_3.forEach(_28,function(_29){if(_29.featureLayer&&_29.featureLayer.loaded){this._settings.layers.push(_29.featureLayer);var _2a=_29.featureLayer.id;if(_29.featureLayer.credential){this._settings.userIds[_2a]=_29.featureLayer.credential.userId;}if(_29.userId){this._settings.userIds[_2a]=_29.userId;}var _2b=_29.featureLayer.getEditCapabilities();if(_2b.canCreate&&!_2b.canUpdate){this._settings.createOnlyLayer[_2a]=true;}else{this._settings.createOnlyLayer[_2a]=false;}}},this);},_reset:function(){this._hideAttributeInspector();this._editToolbar.deactivate();this._editVertices=true;this._layer=null;this._currentGraphic=null;this._activeType=null;this._activeTemplate=null;this._drawingTool=null;this._attributeChanged=false;},_saveFeatureOnClient:function(_2c){var _2d=this.templatePicker.getSelected();var _2e;if(_2d.template){_2e=_2d.featureLayer.renderer.getSymbol(_2d.template.prototype);}else{_2e=_2d.symbolInfo.symbol;}var _2f=_2d.featureLayer.fields;var att={};_3.forEach(_2f,function(_30,idx){att[_30.name]=null;});this._tempGraphic=new _11(_2c,_2e,att,null);var map=this._settings.map;map.graphics.add(this._tempGraphic);var _31=this._findCenterPoint(_2c);this._createAttributeInspector(true);map.infoWindow.setTitle(_2d.featureLayer?_2d.featureLayer.name:_21.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,_2d.featureLayer);this._showInfoWindow(_31,map.getInfoWindowAnchor(_31));if(this._settings.createOnlyLayer[_2d.featureLayer.id]){this._infoWindowHideEvent=_4.connect(map.infoWindow,"onHide",this,"_infoWindowHide");}_4.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}this._templatePickerOnSelectionChangeEvent=_4.connect(this.templatePicker,"onSelectionChange",_2.hitch(this,"_onCreateFeature"));},_saveAttributesOnClient:function(_32,_33,_34){this._tempGraphic.attributes[_33]=(typeof (_34)==="number"&&isNaN(_34))?null:_34;},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);_4.disconnect(this._infoWindowHideEvent);},_createFeature:function(_35,_36){this._editClickPoint=this._findCenterPoint(_35);if(!_35.rings){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_35,_36)]}]);return;}this._simplify(_35,_2.hitch(this,function(_37){if(this._drawingTool!==_15.TOOL_AUTO_COMPLETE_POLYGON){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_37,_36)]}]);}else{this._autoComplete(_37,_2.hitch(this,function(_38){if(_38&&_38.length){this._applyEdits([{layer:this._layer,adds:_3.map(_38,_2.hitch(this,function(_39){return this._createGraphic(_39,_36);}))}]);}}));}}));},_updateCurrentFeature:function(_3a){var _3b=this._isModified();if(_3b){this._updateFeature(_3b,_3a);}else{if(_3a){_3a(false);}}},_updateFeature:function(_3c,_3d){var _3e=_3c.geometry;if(!_3e.rings){this._applyEdits([{layer:_3c.getLayer(),updates:[_3c]}],_3d);}else{this._simplify(_3e,_2.hitch(this,function(_3f){this._applyEdits([{layer:_3c.getLayer(),updates:[_2.mixin(_3c,{geometry:_3f})]}],_3d);}));}},_deleteFeature:function(_40,_41){var _42=[];if(!_40){var _43=this._settings.layers;_42=_3.map(_3.filter(_43,function(_44){return _44.getSelectedFeatures().length>0;}),function(_45){return {layer:_45,deletes:_45.getSelectedFeatures()};});if((!_42||!_42.length)&&this._currentGraphic){_42.push({layer:this._layer,deletes:[this._currentGraphic]});}}else{_42.push({layer:_40.getLayer(),deletes:[_40]});}this._applyEdits(_42,(_41));},_stopEditing:function(_46,_47,_48,_49){_d.hide(this.progressBar.domNode);this._undoRedoAdd();var _4a;if(_46._isSelOnly===true){if(_47&&_47.length){this.templatePicker.clearSelection();var _4b=new _13();_4b.objectIds=[_47[0].objectId];if(!this._settings.createOnlyLayer[_46.id]){this._selectFeatures([_46],_4b,_2.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}else{_4a=this._selectionHelper.findMapService(this._settings.map,_46);if(_4a){_4a.refresh();}if(_47&&_47.length){this.templatePicker.clearSelection();if(!this._settings.createOnlyLayer[_46.id]){_19.findFeatures(_47,_46,_2.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}if(_49&&_49.length){this._clearSelection(true);if(this._undoRedo){_4a=this._selectionHelper.findMapService(_46,this._settings.map);if(_4a){_4a.refresh();}}}if(this._undoRedo&&_48&&_48.length){_4a=this._selectionHelper.findMapService(_46,this._settings.map);if(_4a){_4a.refresh();}this.attributeInspector.refresh();this._undoRedo=false;}if(this.drawingToolbar){this.drawingToolbar._updateUI();}this._undoRedo=false;},_undoRedoAdd:function(){this._settings._isApplyEditsCall=false;if(!this._settings.undoManager){return;}if(this._activeTool==="CUT"||this._activeTool==="UNION"){return;}var _4c=(this._edits&&this._edits.length)?this._edits[0]:null;if(!_4c){return;}var _4d=_4c.adds||[];var _4e=_4c.updates||[];var _4f=_4c.deletes||[];var _50={featureLayer:_4c.layer};if(_4d.length){this.undoManager.add(new Add(_2.mixin(_50,{addedGraphics:_4d})));}else{if(_4f.length){this.undoManager.add(new _1b(_2.mixin(_50,{deletedGraphics:_4f})));}else{if(_4e.length){this.undoManager.add(new _1a(_2.mixin(_50,{preUpdatedGraphics:[this._preUpdates],postUpdatedGraphics:_4e})));}}}this._edits=null;this._preUpdates=null;},_activateDrawToolbar:function(_51){this._layer=_51.featureLayer;this._activeType=_51.type;this._activeTemplate=_51.template;this._drawingTool=this._activeTemplate?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,_51.featureLayer);_4.disconnect(this._dtConnect);if(this._settings.createOnlyLayer[_51.featureLayer.id]){this._dtConnect=_4.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient");}else{this._dtConnect=_4.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");}this._editToolbar.deactivate();this._disableMapClickHandler();if(!this.drawingToolbar){this._drawToolbar.activate(this._drawTool);}else{this.drawingToolbar.activateEditing(this._drawTool,this._layer);}},_activateEditToolbar:function(_52,_53){var _54=_52.getLayer();var _55=_54?_54.geometryType:null;var _56=_17.MOVE;if(_55!=="esriGeometryPoint"&&this._isNotesFeature(_52)===true){_56=_56|_17.ROTATE|_17.SCALE;this._editVertices=false;}else{if(_55!=="esriGeometryPoint"&&this._editVertices===true){_56=_56|_17.ROTATE|_17.SCALE;this._editVertices=false;}else{_56=_56|_17.EDIT_VERTICES;this._editVertices=true;}}this._attributeChanged=this._isModified();this._preUpdates=new _11(_2.clone(_52.toJson()));var _57=_54.getEditCapabilities({feature:_52,userId:this._settings.userIds[_54.id]});var _58=_3.filter(this._settings.layerInfos,function(_59){return _59.featureLayer["layerId"]===_54.layerId;})[0];if(_57.canUpdate&&!_58.disableGeometryUpdate&&_54.allowGeometryUpdates){this._editToolbar.activate(_56,_52);}if(!this._settings.map.infoWindow.isShowing){var _5a=(_53&&_53.screenPoint)||this._findCenterPoint(_52);this._showInfoWindow(_5a,this._settings.map.getInfoWindowAnchor(_5a));}},_createGraphic:function(_5b,_5c){var _5d=(this._activeType&&this._activeType.symbol)||this._layer.defaultSymbol;var _5e=new _11(_5b,_5d,_5c);if(this._activeTemplate||_5c){_5e.attributes=_5c||_2.mixin({},this._activeTemplate.prototype.attributes);}else{_5e.attributes=_5e.attributes||[];_3.forEach(this._layer.fields,function(_5f){_5e.attributes[_5f.name]=null;},this);}return _5e;},_connectEvents:function(){var _60=this._settings.layers;_3.forEach(_60,function(_61){this._connect(_61,"onEditsComplete",_2.hitch(this,"_stopEditing",_61));},this);_3.forEach(_60,function(_62){this._connect(_62,"onBeforeApplyEdits",_2.hitch(this,function(){_d.show(this.progressBar.domNode);this._settings._isApplyEditsCall=true;}));},this);this._connect(this._editToolbar,"onGraphicClick",_2.hitch(this,"_activateEditToolbar"));this._connect(this._editToolbar,"onGraphicFirstMove",_2.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onVertexFirstMove",_2.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onScaleStart",_2.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onRotateStart",_2.hitch(this,"_hideAttributeInspector"));},_connect:function(_63,evt,_64){this._eConnects.push(_4.connect(_63,evt,_64));},_createWidgets:function(){this._selectionHelper=new _1d(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager();},_createTemplatePicker:function(){if(!this._settings.templatePicker){var _65=_3.filter(this._settings.layers,function(_66){return _66.getEditCapabilities().canCreate;});this.templatePicker=new _1e({"class":"esriTemplatePicker",featureLayers:_65,showTooltip:true,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker;}else{this.templatePicker=this._settings.templatePicker;_d.hide(this.templatePickerDiv);}this._templatePickerOnSelectionChangeEvent=_4.connect(this.templatePicker,"onSelectionChange",_2.hitch(this,"_onCreateFeature"));},_createAttributeInspector:function(_67){if(!this._settings.attributeInspector){this._customAttributeInspector=false;var map=this._settings.map;this.attributeInspector=new _18({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},_a.create("div"));this.attributeInspector.startup();map.infoWindow.setContent(this.attributeInspector.domNode);map.infoWindow.setTitle(_21.widgets.attributeInspector.NLS_title);map.infoWindow.resize(350,375);_5.query(".esriAttributeInspector .atiLayerName").style({display:"none"});}else{this._customAttributeInspector=true;this.attributeInspector=this._settings.attributeInspector;}this._connect(this.attributeInspector,"onDelete",_2.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",_2.hitch(this,function(_68){this._updateCurrentFeature(_2.hitch(this,function(){this._attributeChanged=false;this._onEditFeature(_68);}));}));if(this._usePopup){this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,_2.hitch(this.attributeInspector,"next"),_2.hitch(this.attributeInspector,"previous"));}if(_67){this._connect(this.attributeInspector,"onAttributeChange",_2.hitch(this,"_saveAttributesOnClient"));}else{this._connect(this.attributeInspector,"onAttributeChange",_2.hitch(this,function(_69,_6a,_6b){this._preUpdates=new _11(_2.clone(_69.toJson()));this._currentGraphic.attributes[_6a]=(typeof (_6b)==="number"&&isNaN(_6b))?null:_6b;this._updateFeature(this._currentGraphic,null);this._attributeChanged=false;}));}},_createDrawingToolbar:function(){if(this._settings.toolbarVisible===true){this.drawingToolbar=new _1c({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this._editToolbar,settings:this._settings,onDelete:_2.hitch(this,"_deleteFeature"),onApplyEdits:_2.hitch(this,"_applyEdits"),onShowAttributeInspector:_2.hitch(this,"_onEditFeature")},this.drawingToolbarDiv);}},_createUndoRedoManager:function(){if(!this._settings.enableUndoRedo&&!this._settings.undoManager){return;}this._settings.enableUndoRedo=true;this.undoManager=this._settings.undoManager;if(!this.undoManager){this.undoManager=this._settings.undoManager=new _12({maxOperations:this._settings.maxUndoRedoOperations});}this._connect(document,"onkeypress",_2.hitch(this,function(evt){if(evt.metaKey||evt.ctrlKey){if(evt.charOrCode==="z"){this._undo();}if(evt.charOrCode==="y"){this._redo();}}}));},_enableMapClickHandler:function(){this._mapClickHandler=_4.connect(this._settings.map,"onClick",_2.hitch(this,function(evt){if(this._drawToolbar._geometryType){return;}if(this._activeTool==="SELECT"){this._activeTool="";return;}this._updateCurrentFeature(_2.hitch(this,function(){this._reset();this._updateSelection(evt);}));}));},_disableMapClickHandler:function(){_4.disconnect(this._mapClickHandler);},_onCreateFeature:function(){var _6c=this.templatePicker.getSelected();if(_6c){this._updateCurrentFeature(_2.hitch(this,function(){if(this._currentGraphic){this._clearSelection(false);}this._reset();this._activateDrawToolbar(_6c);}));}else{this._reset();_4.disconnect(this._dtConnect);this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}}},_onEditFeature:function(_6d,_6e){_6d=(_2.isArray(_6d)?_6d[0]:_6d)||null;if(!_6d){return;}if(!this._customAttributeInspector){_6e=_6e||this._editClickPoint||this._findCenterPoint(_6d);var _6f=_6d.getLayer();this._settings.map.infoWindow.setTitle(_6f?_6f.name:_21.widgets.attributeInspector.NLS_title);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing){this._showInfoWindow(_6e,this._settings.map.getInfoWindowAnchor(_6e));}this._editClickPoint=null;}if(_6d===this._currentGraphic){return;}this._editVertices=true;this._layer=_6d.getLayer();this._currentGraphic=_6d;if(_6d.getDojoShape()){_6d.getDojoShape().moveToFront();}this._activateEditToolbar(_6d);},_applyEdits:function(_70,_71){_70=_70||[];if(_70.length<=0){return;}this._edits=_70;var _72=_3.map(_70,function(_73){return _73.layer.applyEdits(_73.adds,_73.updates,_73.deletes);});this._deferredsList=new _8(_72).addCallback(_2.hitch(this,function(){_d.hide(this.progressBar.domNode);if(_71){_71();}var map=this._settings.map;if(map&&map.infoWindow.reposition&&map.infoWindow.isShowing){map.infoWindow.reposition();}}));},_undo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.undo();}},_redo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.redo();}},_simplify:function(_74,_75){if(_10.prototype.isSelfIntersecting(_74)){this._settings.geometryService.simplify([_74],function(_76){var _77=(_76&&_76.length)?_76[0]:_77;if(_75){_75(_77);}});}else{if(_75){_75(_74);}}},_autoComplete:function(_78,_79){var _7a=this._getLayers("esriGeometryPolygon");var _7b=new _13();_7b.geometry=_78;_7b.returnGeometry=true;this._selectFeatures(_7a,_7b,_2.hitch(this,function(_7c){if(!_7c||_7c.length<=0){if(_79){_79([_78]);}}else{this._settings.geometryService.autoComplete(_e.getGeometries(_7c),this._toPolylines([_7b.geometry]),function(_7d){if(_79){_79(_7d);}});}}));},_getLayers:function(_7e){var _7f=this._settings.layers;return _3.filter(_7f,function(_80){return _80.geometryType===_7e;});},_selectFeatures:function(_81,_82,_83,_84){this._selectionHelper.selectFeatures(_81,_82,_84||_14.SELECTION_NEW,_83);},_updateSelection:function(evt){var _85=evt.mapPoint;var _86=evt.graphic;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,_85,_14.SELECTION_NEW,_2.hitch(this,function(_87){var _88=_3.some(_87,_2.hitch(this,function(_89){return _89==_86;}));if(_86&&!_88){var _8a=_86.getLayer();if(this._isValidLayer(_8a)){var _8b=new _13();_8b.objectIds=[_86.attributes[_8a.objectIdField]];this._selectionHelper.selectFeatures([_8a],_8b,_14.SELECTION_ADD,_2.hitch(this,function(_8c){this._updatePopupButtons(_8c);this._onEditFeature(_8c,_85);}));}else{this._clearSelection();}}else{if(_87&&_87.length){this._updatePopupButtons(_87);this._onEditFeature(_87,_85);}else{this._clearSelection();}}}));},_updatePopupButtons:function(_8d){if(!this._usePopup||!_8d){return;}var _8e=_8d.length;var _8f=[this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton];_3.forEach(_8f,_2.hitch(this,function(_90){(_8e>1)?_9.remove(_90,"hidden"):_9.add(_90,"hidden");}));},_clearSelection:function(_91){this._selectionHelper.clearSelection(_91||false);this._reset();},_findCenterPoint:function(_92){var _93=_92.geometry||_92;var _94;switch(_93.type){case "point":_94=_93;break;case "polyline":var _95=_93.paths[0].length;_94=_93.getPoint(0,Math.ceil(_95/2));break;case "polygon":var _96=_93.rings.length-1;var _97=_93.rings[_96].length-1;_94=_93.getPoint(_96,_97);break;}return this._settings.map.toScreen(_94);},_hideAttributeInspector:function(){if(!this._customAttributeInspector&&this._settings.map.infoWindow){this._settings.map.infoWindow.hide();}},_toPolylines:function(_98){var _99=_3.map(_98,function(_9a){var _9b=new _f(_9a.spatialReference);_3.forEach(_9a.rings,function(_9c){_9b.addPath(_9c);});return _9b;});return _99;},_isNotesFeature:function(_9d){var _9e=_9d.getLayer();var _9f=_9e?_9e.types||null:null;if(!_9f){return false;}var _a0=_9d.attributes[_9e.typeIdField];var _a1;_3.some(_9f,function(_a2){if(_a2.id===_a0){_a1=_a2.templates;return true;}return false;});if(!_a1){return false;}var _a3=_a1[0]||null;if(!_a3){return false;}var _a4=this._isShapeTool(_a3.drawingTool)||null;return _a4?true:false;},_isValidLayer:function(_a5){var i;var _a6=this._settings.layerInfos;for(i=0;i<_a6.length;i++){var _a7=_a6[i];if(_a5.id==_a7.layerId){return true;}}return false;},_isShapeTool:function(_a8){switch(_a8){case _15.TOOL_ARROW:return _16.ARROW;case _15.TOOL_LEFT_ARROW:return _16.LEFT_ARROW;case _15.TOOL_RIGHT_ARROW:return _16.RIGHT_ARROW;case _15.TOOL_UP_ARROW:return _16.UP_ARROW;case _15.TOOL_DOWN_ARROW:return _16.DOWN_ARROW;case _15.TOOL_CIRCLE:return _16.CIRCLE;case _15.TOOL_ELLIPSE:return _16.ELLIPSE;case _15.TOOL_TRIANGLE:return _16.TRIANGLE;case _15.TOOL_RECTANGLE:return _16.RECTANGLE;default:return null;}},_toDrawTool:function(_a9,_aa){var _ab=_aa.geometryType;switch(_a9){case _15.TOOL_POINT:return _16.POINT;case _15.TOOL_ARROW:return _16.ARROW;case _15.TOOL_LEFT_ARROW:return _16.LEFT_ARROW;case _15.TOOL_RIGHT_ARROW:return _16.RIGHT_ARROW;case _15.TOOL_UP_ARROW:return _16.UP_ARROW;case _15.TOOL_DOWN_ARROW:return _16.DOWN_ARROW;case _15.TOOL_CIRCLE:return _16.CIRCLE;case _15.TOOL_ELLIPSE:return _16.ELLIPSE;case _15.TOOL_TRIANGLE:return _16.TRIANGLE;case _15.TOOL_RECTANGLE:return _16.RECTANGLE;case _15.TOOL_LINE:return _16.POLYLINE;case _15.TOOL_POLYGON:return _16.POLYGON;case _15.TOOL_FREEHAND:if(_ab==="esriGeometryPolyline"){return _16.FREEHAND_POLYLINE;}else{return _16.FREEHAND_POLYGON;}break;default:var _ac=_16.POINT;if(_ab==="esriGeometryPolyline"){_ac=_16.POLYLINE;if(this._settings.createOptions.polylineDrawTools[0]===_23.CREATE_TOOL_FREEHAND_POLYLINE){_ac=_16.FREEHAND_POLYLINE;}}else{if(_ab==="esriGeometryPolygon"){_ac=_16.POLYGON;if(this._settings.createOptions.polygonDrawTools[0]===_23.CREATE_TOOL_FREEHAND_POLYGON){_ac=_16.FREEHAND_POLYGON;}}}return _ac;}},_isModified:function(){var _ad=this._editToolbar.getCurrentState();return ((_ad.isModified||this._attributeChanged)&&_ad.graphic)?_ad.graphic:null;},_showInfoWindow:function(_ae,_af){if(!this._customAttributeInspector){this._settings.map.infoWindow.show(_ae,_af);}}});_2.mixin(_23,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});if(_6("extend-esri")){_2.setObject("dijit.editing.Editor",_23,_1f);}return _23;});