/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"esri/layers/FeatureType":function(){define("esri/layers/FeatureType",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/symbols/jsonUtils","esri/layers/RangeDomain","esri/layers/CodedValueDomain","esri/layers/InheritedDomain","esri/layers/FeatureTemplate"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_1(null,{declaredClass:"esri.layers.FeatureType",constructor:function(_d){if(_d&&_2.isObject(_d)){this.id=_d.id;this.name=_d.name;var _e=_d.symbol;if(_e){this.symbol=_7.fromJson(_e);}var _f=_d.domains,_10,i;var _11=this.domains={};for(_10 in _f){if(_f.hasOwnProperty(_10)){var _12=_f[_10];switch(_12.type){case "range":_11[_10]=new _8(_12);break;case "codedValue":_11[_10]=new _9(_12);break;case "inherited":_11[_10]=new _a(_12);break;}}}var _13=_d.templates;if(_13){var _14=this.templates=[];for(i=0;i<_13.length;i++){_14.push(new _b(_13[i]));}}}},toJson:function(){var _15={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _16,_17=this.domains,_18=this.templates,_19=_6.fixJson;if(_17){var _1a=_15.domains={};for(_16 in _17){if(_17.hasOwnProperty(_16)){_1a[_16]=_17[_16]&&_17[_16].toJson();}}_19(_1a);}if(_18){_15.templates=_3.map(_18,function(_1b){return _1b.toJson();});}return _19(_15);}});if(_4("extend-esri")){_2.setObject("layers.FeatureType",_c,_5);}return _c;});},"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n","dijit/form/ComboBoxMixin":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/ComboBoxMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24){return _1c("dijit.form.ComboBoxMixin",[_23,_21],{dropDownClass:_22,hasDownArrow:true,templateString:_24,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(val){this._set("hasDownArrow",val);this._buttonNode.style.display=val?"":"none";},_showResultList:function(){this.displayMessage("");this.inherited(arguments);},_setStoreAttr:function(_25){if(!_25.get){_1f.mixin(_25,{_oldAPI:true,get:function(id){var _26=new _1d();this.fetchItemByIdentity({identity:id,onItem:function(_27){_26.resolve(_27);},onError:function(_28){_26.reject(_28);}});return _26.promise;},query:function(_29,_2a){var _2b=new _1d(function(){_2c.abort&&_2c.abort();});_2b.total=new _1d();var _2c=this.fetch(_1f.mixin({query:_29,onBegin:function(_2d){_2b.total.resolve(_2d);},onComplete:function(_2e){_2b.resolve(_2e);},onError:function(_2f){_2b.reject(_2f);}},_2a));return _20(_2b);}});}this._set("store",_25);},postMixInProperties:function(){var _30=this.params.store||this.store;if(_30){this._setStoreAttr(_30);}this.inherited(arguments);if(!this.params.store&&!this.store._oldAPI){var _31=this.declaredClass;_1f.mixin(this.store,{getValue:function(_32,_33){_1e.deprecated(_31+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return _32[_33];},getLabel:function(_34){_1e.deprecated(_31+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return _34.name;},fetch:function(_35){_1e.deprecated(_31+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");var _36=["dojo/data/ObjectStore"];require(_36,_1f.hitch(this,function(_37){new _37({objectStore:this}).fetch(_35);}));}});}}});});},"dijit/form/RangeBoundTextBox":function(){define("dijit/form/RangeBoundTextBox",["dojo/_base/declare","dojo/i18n","./MappedTextBox"],function(_38,_39,_3a){var _3b=_38("dijit.form.RangeBoundTextBox",_3a,{rangeMessage:"",rangeCheck:function(_3c,_3d){return ("min" in _3d?(this.compare(_3c,_3d.min)>=0):true)&&("max" in _3d?(this.compare(_3c,_3d.max)<=0):true);},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");if(val==null){return false;}var _3e=false;if("min" in this.constraints){var min=this.constraints.min;_3e=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min)<0;}if(!_3e&&("max" in this.constraints)){var max=this.constraints.max;_3e=this.compare(val,((typeof max!="number")||max>0)?max:0)>0;}return _3e;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_3f){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_3f));},getErrorMessage:function(_40){var v=this.get("value");if(v!=null&&v!==""&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_40)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=_39.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},applyTextDir:function(){}});return _3b;});},"esri/dijit/editing/tools/Reshape":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","esri/layers/FeatureLayer","esri/tasks/query","esri/toolbars/draw","esri/dijit/editing/tools/ToggleToolBase","esri/kernel"],function(_41,_42,_43,_44,has,_45,_46,_47,_48,_49){var _4a=_41([_48],{declaredClass:"esri.dijit.editing.tools.Reshape",id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:_47.POLYLINE,_enabled:true,_label:"NLS_reshapeLbl",activate:function(){_44.disconnect(this._rConnect);this._rConnect=_44.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments);},deactivate:function(){this.inherited(arguments);_44.disconnect(this._rConnect);delete this._rConnect;},_onDrawEnd:function(_4b){var _4c=this._settings.layers;var _4d=new _46();_4d.geometry=_4b;var _4e=this._reshapeLayers=_43.filter(_4c,function(_4f){return (_4f.geometryType==="esriGeometryPolygon"||"esriGeometryPolyline");});this._settings.editor._selectionHelper.selectFeatures(_4e,_4d,_45.SELECTION_NEW,_42.hitch(this,"_reshape",_4d));},_reshape:function(_50,_51){var _52=[];var _53=_51;if(_53.length!==1){return;}this._settings.geometryService.reshape(_53[0].geometry,_50.geometry,_42.hitch(this,function(_54){var _55=[_53[0].setGeometry(_54)];this.onApplyEdits([{layer:_53[0].getLayer(),updates:_55}],_42.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}));}});if(has("extend-esri")){_42.setObject("dijit.editing.tools.Reshape",_4a,_49);}return _4a;});},"esri/dijit/editing/tools/Cut":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/DeferredList","esri/graphicsUtils","esri/graphic","esri/tasks/query","esri/layers/FeatureLayer","esri/toolbars/draw","esri/dijit/editing/Cut","esri/dijit/editing/tools/ToggleToolBase","esri/kernel"],function(_56,_57,_58,_59,has,_5a,_5b,_5c,_5d,_5e,_5f,Cut,_60,_61){var _62=_56([_60],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:_5f.POLYLINE,_enabled:true,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(_59.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments);},deactivate:function(){this.inherited(arguments);_58.forEach(this._cutConnects,_59.disconnect);this._cutConnects=[];this._edits=[];},_onDrawEnd:function(_63){var _64=this._settings.layers;var _65=this._cutLayers=_58.filter(_64,function(_66){return ((_66.geometryType==="esriGeometryPolygon")||(_66.geometryType==="esriGeometryPolyline")&&_66.visible&&_66._isMapAtVisibleScale());});this._cutConnects=this._cutConnects.concat(_58.map(_65,_57.hitch(this,function(_67){return _59.connect(_67,"onEditsComplete",_57.hitch(this,function(_68,_69,_6a){if(this._settings.undoRedoManager){var _6b=this._settings.undoRedoManager;_58.forEach(this._edits,_57.hitch(this,function(_6c){_6b.add(new Cut({featureLayer:_6c.layer,addedGraphics:_6c.adds,preUpdatedGraphics:_6c.preUpdates,postUpdatedGraphics:_6c.updates}));}),this);}this.onFinished();}));})));var _6d=new _5d();_6d.geometry=_63;_58.forEach(_65,function(_6e,idx){this._settings.editor._selectionHelper.selectFeatures([_6e],_6d,_5e.SELECTION_NEW,_57.hitch(this,"_cutFeatures",_6e,_6d));},this);},_cutFeatures:function(_6f,_70,_71){if(!_71||!_71.length){return;}this._edits=[];var _72=[];_72.push(this._settings.geometryService.cut(_5b.getGeometries(_71),_70.geometry,_57.hitch(this,"_cutHandler",_6f,_71)));var _73=new _5a(_72).addCallback(_57.hitch(this,function(){this.onApplyEdits(this._edits);}));},_cutHandler:function(_74,_75,_76){var _77=[];var _78=[];var _79=_58.map(_75,function(_7a){return new _5c(_57.clone(_7a.toJson()));});var _7b;var _7c;_58.forEach(_76.cutIndexes,function(_7d,i){if(_7b!=_7d){_7b=_7d;_78.push(_75[_7d].setGeometry(_76.geometries[i]));}else{_7c=new _5c(_76.geometries[i],null,_57.mixin({},_75[_7d].attributes),null);_7c.attributes[_75[0].getLayer().objectIdField]=null;_77.push(_7c);}},this);this._edits.push({layer:_74,adds:_77,updates:_78,preUpdates:_79});}});if(has("extend-esri")){_57.setObject("dijit.editing.tools.Cut",_62,_61);}return _62;});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_7e,_7f){return _7e("dijit._Contained",null,{_getSibling:function(_80){var _81=this.domNode;do{_81=_81[_80+"Sibling"];}while(_81&&_81.nodeType!=1);return _81&&_7f.byNode(_81);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"esri/toolbars/_Box":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/matrix","esri/kernel","esri/lang","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/webMercatorUtils","esri/geometry/jsonUtils","esri/graphic"],function(_82,_83,_84,_85,has,_86,_87,_88,_89,_8a,_8b,_8c,_8d,_8e,_8f){var BOX=_82(null,{declaredClass:"esri.toolbars._Box",constructor:function(_90,map,_91,_92,_93,_94){this._graphic=_90;this._map=map;this._toolbar=_91;this._scale=_92;this._rotate=_93;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_94;var _95=_91._options;this._markerSymbol=_95.boxHandleSymbol;this._lineSymbol=_95.boxLineSymbol;this._moveStartHandler=_83.hitch(this,this._moveStartHandler);this._firstMoveHandler=_83.hitch(this,this._firstMoveHandler);this._moveStopHandler=_83.hitch(this,this._moveStopHandler);this._moveHandler=_83.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){_84.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){_84.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){_84.forEach(this._connects,_85.disconnect);}var _96=this._toolbar._scratchGL;if(this._anchors){_84.forEach(this._anchors,function(_97){_96.remove(_97.graphic);var mov=_97.moveable;if(mov){mov.destroy();}});}if(this._box){_96.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_98=this._toolbar._scratchGL;var _99=this._getBoxCoords();var _9a=new _8c(map.spatialReference);var _9b=_83.clone(_84.filter(_99,function(pt,_9c){return (_9c!==8&&_9c%2===0);}));if(_9b[0]){_9b.push([_9b[0][0],_9b[0][1]]);}_9a.addPath(_9b);if(this._rotate){_9a.addPath([_99[1],_99[8]]);}if(this._box){this._box.setGeometry(_9a);}else{this._box=new _8f(_9a,this._lineSymbol);_98.add(this._box);}if(this._anchors){_84.forEach(this._anchors,function(_9d,_9e){if(!this._scale){_9e=8;}var _9f=new _8b(_99[_9e],map.spatialReference);_9d.graphic.setGeometry(_9f);var mov=_9d.moveable,_a0=_9d.graphic.getDojoShape();if(_a0){if(!mov){_9d.moveable=this._getMoveable(_9d.graphic,_9e);}else{if(_a0!==mov.shape){mov.destroy();_9d.moveable=this._getMoveable(_9d.graphic,_9e);}}}},this);}else{this._anchors=[];this._connects=[];_84.forEach(_99,function(_a1,_a2){if(!this._scale&&_a2<8){return;}_a1=new _8b(_a1,map.spatialReference);var _a3=new _8f(_a1,this._markerSymbol);_98.add(_a3);this._anchors.push({graphic:_a3,moveable:this._getMoveable(_a3,_a2)});},this);}},_getBoxCoords:function(_a4){var _a5=this._graphic,map=this._map,_a6=this._getTransformedBoundingBox(_a5),_a7=[],pt,_a8,_a9;_84.forEach(_a6,function(_aa,_ab,arr){pt=_aa;_a8=arr[_ab+1];if(!_a8){_a8=arr[0];}_a9={x:(pt.x+_a8.x)/2,y:(pt.y+_a8.y)/2};if(!_a4){pt=map.toMap(pt);_a9=map.toMap(_a9);}_a7.push([pt.x,pt.y]);_a7.push([_a9.x,_a9.y]);});if(this._rotate){var _ac=_83.clone(_a7[1]);_ac=_a4?{x:_ac[0],y:_ac[1]}:map.toScreen({x:_ac[0],y:_ac[1],spatialReference:map.spatialReference});_ac.y-=this._toolbar._options.rotateHandleOffset;if(!_a4){_ac=map.toMap(_ac);}_a7.push([_ac.x,_ac.y]);}return _a7;},_getTransformedBoundingBox:function(_ad){var map=this._map,_ae=_ad.geometry.getExtent(),_af=_ad.geometry.spatialReference,_b0=new _8b(_ae.xmin,_ae.ymax,_af),_b1=new _8b(_ae.xmax,_ae.ymin,_af);_b0=map.toScreen(_b0);_b1=map.toScreen(_b1);return [{x:_b0.x,y:_b0.y},{x:_b1.x,y:_b0.y},{x:_b1.x,y:_b1.y},{x:_b0.x,y:_b1.y}];},_getAllGraphics:function(){var _b2=[this._box];if(this._anchors){_84.forEach(this._anchors,function(_b3){_b2.push(_b3.graphic);});}_b2=_84.filter(_b2,_8a.isDefined);return _b2;},_getMoveable:function(_b4,_b5){var _b6=_b4.getDojoShape();if(!_b6){return;}var _b7=new _87(_b6);_b7._index=_b5;this._connects.push(_85.connect(_b7,"onMoveStart",this._moveStartHandler));this._connects.push(_85.connect(_b7,"onFirstMove",this._firstMoveHandler));this._connects.push(_85.connect(_b7,"onMoveStop",this._moveStopHandler));_b7.onMove=this._moveHandler;var _b8=_b6.getEventSource();if(_b8){_86.set(_b8,"cursor",this._toolbar._cursors["box"+_b5]);}return _b7;},_moveStartHandler:function(_b9){this._toolbar["on"+(_b9.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_ba){var _bb=_ba.host._index,_bc=(this._wrapOffset=_ba.host.shape._wrapOffsets[0]||0),_bd=this._graphic.getLayer()._div.getTransform(),mx=_88,_be,_bf,_c0,_c1=_84.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_bc,y:arr[1]};});_c0={x:_c1[1].x,y:_c1[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_bd),_c0);if(_bb===8){_be=mx.multiplyPoint(mx.invert(_bd),_c1[1]);this._startLine=[this._centerCoord,_be];this._moveLine=_83.clone(this._startLine);}else{_be=mx.multiplyPoint(mx.invert(_bd),_c1[_bb]);_bf=mx.multiplyPoint(mx.invert(_bd),_c1[(_bb+4)%8]);this._firstMoverToCenter=Math.sqrt((_be.x-this._centerCoord.x)*(_be.x-this._centerCoord.x)+(_be.y-this._centerCoord.y)*(_be.y-this._centerCoord.y));this._startBox=_bf;this._startBox.width=(_c1[4].x-_c1[0].x);this._startBox.height=(_c1[4].y-_c1[0].y);this._moveBox=_83.clone(this._startBox);this._xfactor=_be.x>_bf.x?1:-1;this._yfactor=_be.y>_bf.y?1:-1;if(_bb===1||_bb===5){this._xfactor=0;}else{if(_bb===3||_bb===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_bb===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_c2,_c3){var _c4=_c2.host._index,_c5=this._defaultEventArgs,_c6,_c7,tx,pt,_c8,_c9,_ca,_cb=0,_cc=0,_cd,_ce,_cf;_c5.angle=0;_c5.scaleX=1;_c5.scaleY=1;if(_c4===8){_c6=this._startLine;_c7=this._moveLine;pt=_c7[1];pt.x+=_c3.dx;pt.y+=_c3.dy;_c8=this._getAngle(_c6,_c7);tx=_88.rotategAt(_c8,_c6[0]);this._graphic.getDojoShape().setTransform(tx);_c5.transform=tx;_c5.angle=_c8;_c5.around=_c6[0];}else{_c6=this._startBox;_c7=this._moveBox;_c7.width+=(_c3.dx*this._xfactor);_c7.height+=(_c3.dy*this._yfactor);if(this._uniformScaling){_cd=_c7.x+this._xfactor*_c7.width;_ce=_c7.y+this._yfactor*_c7.height;_cf=Math.sqrt((_cd-this._centerCoord.x)*(_cd-this._centerCoord.x)+(_ce-this._centerCoord.y)*(_ce-this._centerCoord.y));_c9=_ca=_cf/this._firstMoverToCenter;_cb=this._xfactor*_c6.width/2;_cc=this._yfactor*_c6.height/2;}else{_c9=_c7.width/_c6.width;_ca=_c7.height/_c6.height;}if(isNaN(_c9)||_c9===Infinity||_c9===-Infinity){_c9=1;}if(isNaN(_ca)||_ca===Infinity||_ca===-Infinity){_ca=1;}tx=_88.scaleAt(_c9,_ca,_c6.x+_cb,_c6.y+_cc);this._graphic.getDojoShape().setTransform(tx);_c5.transform=tx;_c5.scaleX=_c9;_c5.scaleY=_ca;_c5.around={x:_c6.x+_cb,y:_c6.y+_cc};}this._toolbar["on"+(_c4===8?this._rotateEvent:this._scaleEvent)](this._graphic,_c5);},_moveStopHandler:function(_d0){var _d1=this._graphic,_d2=this._toolbar,_d3=_d2._geo?_8d.geographicToWebMercator(_d1.geometry):_d1.geometry,_d4=_d3.spatialReference,_d5=_d1.getDojoShape(),_d6=_d5.getTransform(),_d7=_d1.getLayer()._div.getTransform();_d3=_d3.toJson();this._updateSegments(_d3.paths||_d3.rings,_d6,_d7,_d4);_d5.setTransform(null);_d3=_8e.fromJson(_d3);_d1.setGeometry(_d2._geo?_8d.webMercatorToGeographic(_d3,true):_d3);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_d2._endOperation("BOX");this._defaultEventArgs.transform=_d6;_d2["on"+(_d0.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_d8,_d9,_da,_db){var mx=_88,map=this._map,_dc=this._wrapOffset||0;_84.forEach(_d8,function(_dd){_84.forEach(_dd,function(_de){var _df=map.toScreen({x:_de[0],y:_de[1],spatialReference:_db},true);_df.x+=_dc;_df=mx.multiplyPoint([_da,_d9,mx.invert(_da)],_df);_df.x-=_dc;var _e0=map.toMap(_df);_de[0]=_e0.x;_de[1]=_e0.y;});});},_getAngle:function(_e1,_e2){var _e3=Math.atan2(_e1[0].y-_e1[1].y,_e1[0].x-_e1[1].x)*180/Math.PI,_e4=Math.atan2(_e2[0].y-_e2[1].y,_e2[0].x-_e2[1].x)*180/Math.PI;return _e4-_e3;}});if(has("extend-esri")){_83.setObject("toolbars._Box",BOX,_89);}return BOX;});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(_e5,_e6,_e7,_e8,_e9,_ea,_eb,has,_ec,win,_ed,_ee,_ef,_f0,_f1,_f2,_f3,_f4,_f5,_f6){var _f7=function(_f8,_f9){return _f8.style.cssText==undefined?_f8.getAttribute("style"):_f8.style.cssText;};var _fa=_e8("dojox.grid._View",[_ef,_f0],{defaultWidth:"18em",viewWidth:"",templateString:_ed,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_f4._HeaderBuilder,_contentBuilderClass:_f4._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");_f2.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);_f2.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){_f3.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);_f3.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_fb){var vs=(this.structure=_fb);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_fc){if(_fc){_e9.forEach(_ec("[widgetId]",_fc).map(_e6.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_fd,_fe){this._onBeforeRow(_fd,_fe);if(_fd>=0){this._cleanupRowWidgets(this.getRowNode(_fd));}},onAfterRow:function(_ff,_100,_101){this._onAfterRow(_ff,_100,_101);var g=this.grid;_e9.forEach(_ec(".dojoxGridStubNode",_101),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _102=window.parseInt(_f3.attr(n,"cellIdx"),10);var _103=g.getCell(_102);var w=_e6.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}_e5.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _104=this.hasVScrollbar();var _105=_f3.style(this.scrollboxNode,"overflow");if(this.noscroll||!_105||_105=="hidden"){_104=false;}else{if(_105=="scroll"){_104=true;}}return (_104?_f1.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?(h.firstChild.offsetWidth||_f3.style(h.firstChild,"width")):0;},setColumnsWidth:function(_106){this.headerContentNode.firstChild.style.width=_106+"px";if(this.viewWidth){this.viewWidth=_106+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,_f3._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _107=this.grid.layout.cells;var _108=_ea.hitch(this,function(node,_109){!this.grid.isLeftToRight()&&(_109=!_109);var inc=_109?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_107[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_107[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _10a="dojoxGrid_bottomMarker";var _10b="dojoxGrid_topMarker";if(this.bottomMarker){_f3.destroy(this.bottomMarker);}this.bottomMarker=_f3.byId(_10a);if(this.topMarker){_f3.destroy(this.topMarker);}this.topMarker=_f3.byId(_10b);if(!this.bottomMarker){this.bottomMarker=_f3.create("div",{"id":_10a,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=_f3.create("div",{"id":_10b,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=_f3.contentBox(this.bottomMarker);var _10c=_f3.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _ee(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:_ea.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_ee.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:_ea.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_ee.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:_ea.hitch(this,function(_10d){var src=this.source;if(src.current==src.targetAnchor&&src.before==_10d){return;}if(src.targetAnchor&&_108(src.targetAnchor,src.before)){src._removeItemClass(_108(src.targetAnchor,src.before),src.before?"After":"Before");}_ee.prototype._markTargetAnchor.call(src,_10d);var _10e=_10d?src.targetAnchor:_108(src.targetAnchor,src.before);var _10f=0;if(!_10e){_10e=src.targetAnchor;_10f=_f3.contentBox(_10e).w+this.arrowDim.w/2+2;}var pos=_f3.position(_10e,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_10f);_f3.style(this.bottomMarker,"visibility","visible");_f3.style(this.topMarker,"visibility","visible");_f3.style(this.bottomMarker,{"left":left+"px","top":(_10c+pos.y)+"px"});_f3.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_108(src.targetAnchor,src.before)){src._addItemClass(_108(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:_ea.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_108(src.targetAnchor,src.before)){src._removeItemClass(_108(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_ee.prototype._unmarkTargetAnchor.call(src);}),destroy:_ea.hitch(this,function(){_eb.disconnect(this._source_conn);_eb.unsubscribe(this._source_sub);_ee.prototype.destroy.call(this.source);if(this.bottomMarker){_f3.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){_f3.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:_ea.hitch(this,function(){_ee.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_eb.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_eb.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){_f3.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_110,_111,copy){if(_f6.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _112=this.grid.views.views;var _113=_112[_110.viewIndex];var _114=_112[this.index];if(_114!=_113){_113.convertColPctToFixed();_114.convertColPctToFixed();}},_onDndDrop:function(_115,_116,copy){if(_f6.manager().target!==this.source){if(_f6.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _117=function(n){return n?_f3.attr(n,"idx"):null;};var w=_f3.marginBox(_116[0]).w;if(_115.viewIndex!==this.index){var _118=this.grid.views.views;var _119=_118[_115.viewIndex];var _11a=_118[this.index];if(_119.viewWidth&&_119.viewWidth!="auto"){_119.setColumnsWidth(_119.getColumnsWidth()-w);}if(_11a.viewWidth&&_11a.viewWidth!="auto"){_11a.setColumnsWidth(_11a.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _11b=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_11b.moveColumn(_115.viewIndex,idx,_117(_116[0]),_117(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}_f2.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_11c){var n=_11c.name||_11c.grid.getCellName(_11c);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_11c.index!=_11c.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_11c.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_11c.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_11d){var _11e=this._hasHScroll||false;if(this._hasHScroll==undefined||_11d){if(this.noscroll){this._hasHScroll=false;}else{var _11f=_f3.style(this.scrollboxNode,"overflow");if(_11f=="hidden"){this._hasHScroll=false;}else{if(_11f=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_11e!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_120){var _121=this._hasVScroll||false;if(this._hasVScroll==undefined||_120){if(this.noscroll){this._hasVScroll=false;}else{var _122=_f3.style(this.scrollboxNode,"overflow");if(_122=="hidden"){this._hasVScroll=false;}else{if(_122=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_121!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _123=false;this.grid.initialWidth="";var _124=_ec("th",this.headerContentNode);var _125=_e9.map(_124,function(c,vIdx){var w=c.style.width;_f3.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_123=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return _f3.contentBox(c).w;});if(_123){_e9.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _126=cell.view.getHeaderCellNode(cell.index);if(_126&&_f3.hasAttr(_126,"vIdx")){var vIdx=window.parseInt(_f3.attr(_126,"vIdx"));this.setColWidth(idx,_125[vIdx]);_f3.removeAttr(_126,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_127){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _128=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_127||(this.noscroll&&_128())){h-=_f1.getScrollbar().h;}_f2.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_129){var _12a=this.createRowNode(_129);this.buildRow(_129,_12a);return _12a;},createRowNode:function(_12b){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _e7.grid._RowSelector){_f3.attr(node,"role","presentation");}else{_f3.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[_f2.gridViewTag]=this.id;node[_f2.rowIndexTag]=_12b;this.rowNodes[_12b]=node;return node;},buildRow:function(_12c,_12d){this.buildRowContent(_12c,_12d);this.styleRow(_12c,_12d);},buildRowContent:function(_12e,_12f){_12f.innerHTML=this.content.generateHtml(_12e,_12e);if(this.flexCells&&this.contentWidth){_12f.firstChild.style.width=this.contentWidth;}_f2.fire(this,"onAfterRow",[_12e,this.structure.cells,_12f]);},rowRemoved:function(_130){if(_130>=0){this._cleanupRowWidgets(this.getRowNode(_130));}this.grid.edit.save(this,_130);delete this.rowNodes[_130];},getRowNode:function(_131){return this.rowNodes[_131];},getCellNode:function(_132,_133){var row=this.getRowNode(_132);if(row){return this.content.getCellNode(row,_133);}},getHeaderCellNode:function(_134){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_134);}},styleRow:function(_135,_136){_136._style=_f7(_136);this.styleRowNode(_135,_136);},styleRowNode:function(_137,_138){if(_138){this.doStyleRowNode(_137,_138);}},doStyleRowNode:function(_139,_13a){this.grid.styleRowNode(_139,_13a);},updateRow:function(_13b){var _13c=this.getRowNode(_13b);if(_13c){_13c.style.height="";this.buildRow(_13b,_13c);}return _13c;},updateRowStyles:function(_13d){this.styleRowNode(_13d,this.getRowNode(_13d));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_13e){if(has("ff")>=13){this._nativeScroll=true;}var _13f=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_13f&&this.firstScroll==1)||(_13f&&this.firstScroll===0)){var s=_f3.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_13f?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_140){this.lastTop=_140;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_140;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_141,_142){this.grid.setCellWidth(_141,_142+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _143=_e8("dojox.grid._GridAvatar",_f5,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _144=this.manager.source,node;if(_144.creator){node=_144._normalizedCreator(_144.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _145,_146;if(node.tagName.toLowerCase()=="tr"){_145=dd.createElement("table");_146=dd.createElement("tbody");_146.appendChild(node);_145.appendChild(_146);node=_145;}else{if(node.tagName.toLowerCase()=="th"){_145=dd.createElement("table");_146=dd.createElement("tbody");var r=dd.createElement("tr");_145.cellPadding=_145.cellSpacing="0";r.appendChild(node);_146.appendChild(r);_145.appendChild(_146);node=_145;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);_f3.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_f6.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_f6.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _147=_f6.manager().makeAvatar;_f6.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!_f3.hasClass(win.body(),"dijit_a11y")){return new _143(this);}return _147.call(_f6.manager());};return _fa;});},"esri/dijit/editing/TemplatePickerItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/sniff","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojox/gfx","esri/symbols/jsonUtils","esri/kernel"],function(_148,lang,_149,has,_14a,_14b,_14c,_14d,gfx,_14e,_14f){var TPI=_148([_14c,_14d],{declaredClass:"esri.dijit.editing.TemplatePickerItem",templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_150,_151,_152,_153){if(!_150){return;}var _154=gfx.createSurface(node,_151,_152);if(has("ie")<9){var _155=_154.getEventSource();_14b.set(_155,"position","relative");_14b.set(_155.parentNode,"position","relative");}var _156=(!this.legendOverride&&this._getDrawingToolShape(_150,_153))||_14e.getShapeDescriptors(_150);var _157;try{_157=_154.createShape(_156.defaultShape).setFill(_156.fill).setStroke(_156.stroke);}catch(e){_154.clear();_154.destroy();return;}var bbox=_157.getBoundingBox(),_158=bbox.width,_159=bbox.height,_15a=-(bbox.x+(_158/2)),_15b=-(bbox.y+(_159/2)),dim=_154.getDimensions(),_15c={dx:_15a+dim.width/2,dy:_15b+dim.height/2};if(_158>_151||_159>_152){var _15d=_158>_159?_158:_159;var _15e=_151<_152?_151:_152;var _15f=(_15e-5)/_15d;lang.mixin(_15c,{xx:_15f,yy:_15f});}_157.applyTransform(_15c);return _154;},_getDrawingToolShape:function(_160,_161){var _162,_163=_161?_161.drawingTool||null:null;switch(_163){case "esriFeatureEditToolArrow":_162={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_162={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_162={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_162={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_162={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_162={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_162={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_162={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_162={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_160.type==="simplelinesymbol"||_160.type==="cartographiclinesymbol"){_162={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_162={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_162,fill:_160.getFill(),stroke:_160.getStroke()};},_repaint:function(_164){if(!_164){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_164.getStroke&&_164.setStroke){_164.setStroke(_164.getStroke());}if(_164.getFill&&_164.setFill){_164.setFill(_164.getFill());}if(_164.children&&lang.isArray(_164.children)){_149.forEach(_164.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePickerItem",TPI,_14f);}return TPI;});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_165,_166,_167,_168,lang,dom,_169,_16a,_16b,on,_16c,dnd,_16d){var _16e=_166("dojo.dnd.Selector",_16d,{constructor:function(node,_16f){if(!_16f){_16f={};}this.singular=_16f.singular;this.autoSync=_16f.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_16c.press,lang.hitch(this,"onMouseDown")),on(this.node,_16c.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _16b();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_169.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_168.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_16e.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_165.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_170,data,_171,_172){var _173=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_173.call(this,item,hint);if(_170){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_16e.superclass.insertNodes.call(this,data,_171,_172);this._normalizedCreator=_173;return this;},destroy:function(){_16e.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_16a.isLeft(e)){_167.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_167.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_16c.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _16e;});},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(_174){return function(_175,_176){switch(typeof _175){default:throw new Error("Can not query with a "+typeof _175);case "object":case "undefined":var _177=_175;_175=function(_178){for(var key in _177){var _179=_177[key];if(_179&&_179.test){if(!_179.test(_178[key],_178)){return false;}}else{if(_179!=_178[key]){return false;}}}return true;};break;case "string":if(!this[_175]){throw new Error("No filter function "+_175+" was found in store");}_175=this[_175];case "function":}function _17a(_17b){var _17c=_174.filter(_17b,_175);var _17d=_176&&_176.sort;if(_17d){_17c.sort(typeof _17d=="function"?_17d:function(a,b){for(var sort,i=0;sort=_17d[i];i++){var _17e=a[sort.attribute];var _17f=b[sort.attribute];if(_17e!=_17f){return !!sort.descending==(_17e==null||_17e>_17f)?-1:1;}}return 0;});}if(_176&&(_176.start||_176.count)){var _180=_17c.length;_17c=_17c.slice(_176.start||0,(_176.start||0)+(_176.count||Infinity));_17c.total=_180;}return _17c;};_17a.matches=_175;return _17a;};});},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","esri/toolbars/draw","esri/kernel"],function(lang,has,Draw,_181){var _182={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",_drawType:Draw.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:Draw.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:Draw.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:Draw.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:Draw.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:Draw.POLYGON,_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:Draw.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:Draw.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",_drawType:Draw.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:Draw.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:Draw.LEFT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:Draw.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:Draw.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",_drawType:Draw.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:Draw.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:false,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",_enabled:false,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:false,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:false,_label:"NLS_redoLbl"}};if(has("extend-esri")){lang.setObject("dijit.editing.tools.EditingTools",_182,_181);}return _182;});},"dijit/ProgressBar":function(){require({cache:{"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"}});define("dijit/ProgressBar",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/number","./_Widget","./_TemplatedMixin","dojo/text!./templates/ProgressBar.html"],function(_183,_184,_185,lang,_186,_187,_188,_189){return _184("dijit.ProgressBar",[_187,_188],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:_189,_indeterminateHighContrastImagePath:_183.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!(this.params&&"value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_18a){lang.mixin(this,_18a||{});var tip=this.internalProgress,ap=this.domNode;var _18b=1;if(this.indeterminate){ap.removeAttribute("aria-valuenow");}else{if(String(this.progress).indexOf("%")!=-1){_18b=Math.min(parseFloat(this.progress)/100,1);this.progress=_18b*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_18b=this.maximum?this.progress/this.maximum:0;}ap.setAttribute("aria-valuenow",this.progress);}ap.setAttribute("aria-describedby",this.labelNode.id);ap.setAttribute("aria-valuemin",0);ap.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(_18b);_185.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_18b*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_18c){this._set("label",_18c);this.update();},_setIndeterminateAttr:function(_18d){this.indeterminate=_18d;this.update();},report:function(_18e){return this.label?this.label:(this.indeterminate?"&#160;":_186.format(_18e,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});});},"dijit/Toolbar":function(){define("dijit/Toolbar",["require","dojo/_base/declare","dojo/has","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_18f,_190,has,keys,_191,_192,_193,_194){if(has("dijit-legacy-requires")){_191(0,function(){var _195=["dijit/ToolbarSeparator"];_18f(_195);});}return _190("dijit.Toolbar",[_192,_194,_193],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW]:[keys.RIGHT_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW]:[keys.LEFT_ARROW]);}});});},"esri/dijit/editing/toolbars/Drawing":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dijit/_CssStateMixin","esri/dijit/editing/Util","esri/dijit/editing/toolbars/ToolbarBase","esri/dijit/editing/tools/ButtonToolBase","esri/dijit/editing/tools/Cut","esri/dijit/editing/tools/Union","esri/dijit/editing/tools/Reshape","esri/dijit/editing/tools/Editing","esri/dijit/editing/tools/EditingTools","esri/dijit/editing/tools/Selection","esri/dijit/editing/tools/SelectionTools","esri/kernel"],function(_196,lang,_197,_198,has,_199,_19a,_19b,_19c,Cut,_19d,_19e,_19f,_1a0,_1a1,_1a2,_1a3){var _1a4=_196([_19b,_199],{declaredClass:"esri.dijit.editing.toolbars.Drawing",onShowAttributeInspector:function(){},_activateTool:function(tool,_1a5){this._settings.editor._activeTool=tool;if(tool!=="EDITING"){this._settings.templatePicker.clearSelection();}if(tool!=="ATTRIBUTES"){this._settings.editor._hideAttributeInspector();}if(tool==="CLEAR"){return;}this.inherited(arguments);},_initializeToolbar:function(){var _1a6=this._settings.layers;_197.forEach(_1a6,function(_1a7){this._tbConnects.push(_198.connect(_1a7,"onSelectionComplete",this,"_updateUI"));},this);},activateEditing:function(_1a8,_1a9){this._tools.EDITING._activateTool(_1a8,_1a9.geometryType);this._activeTool=this._tools.EDITING;this._activeTool.setChecked(true);},_updateUI:function(){if(this._settings.undoManager){this._tools.UNDO.set("disabled",this._settings.undoManager.canUndo===false);this._tools.REDO.set("disabled",this._settings.undoManager.canRedo===false);}this._selectedFeatures=_19a.getSelection(this._settings.layers);var _1aa=this._selectedFeatures.length;if(this._tools.DELETE){this._tools.DELETE.set("disabled",_1aa<=0);}if(this._tools.CLEAR){this._tools.CLEAR.set("disabled",_1aa<=0);}if(this._tools.ATTRIBUTES){this._tools.ATTRIBUTES.set("disabled",_1aa<=0);}if(this._tools.UNION){this._tools.UNION.set("disabled",_1aa<2);}},_toolFinished:function(tool){if(tool==="ATTRIBUTES"&&(this._selectedFeatures&&this._selectedFeatures.length)){this.onShowAttributeInspector(this._selectedFeatures[0]);}if(tool==="SELECT"||tool==="CUT"||tool==="RESHAPING"||tool==="EDITING"){this._activeTool.deactivate();this._activeTool.setChecked(false);this._activeTool=null;}if(tool==="DELETE"){this.onDelete();}this._updateUI();},_createTools:function(){this._tools.SELECT=new _1a1({settings:this._settings,onClick:lang.hitch(this,"_activateTool","SELECT",true),onFinished:lang.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new _19c(lang.mixin(_1a2.selectClear,{settings:this._settings,onClick:lang.hitch(this._settings.editor,"_clearSelection",false)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new _19c(lang.mixin(_1a0.attributes,{settings:this._settings,onClick:lang.hitch(this,"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);this._createSeparator();this._tools.EDITING=new _19f({settings:this._settings,onClick:lang.hitch(this,"_activateTool","EDITING",true),onApplyEdits:lang.hitch(this,"onApplyEdits"),onFinished:lang.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new _19c(lang.mixin(_1a0.del,{settings:this._settings,onClick:lang.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);if(this._settings.toolbarOptions){if(this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||this._settings.toolbarOptions.reshapeVisible){this._createSeparator();}if(this._settings.toolbarOptions.cutVisible){this._tools.CUT=new Cut({settings:this._settings,onFinished:lang.hitch(this,"_toolFinished","CUT"),onClick:lang.hitch(this,"_activateTool","CUT",true),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.CUT);}if(this._settings.toolbarOptions.mergeVisible){this._tools.UNION=new _19d({settings:this._settings,onFinished:lang.hitch(this,"_toolFinished","UNION"),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.UNION);}if(this._settings.toolbarOptions.reshapeVisible){this._tools.RESHAPING=new _19e({settings:this._settings,onClick:lang.hitch(this,"_activateTool","RESHAPING",true),onFinished:lang.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.RESHAPING);}}if(this._settings.enableUndoRedo){this._createSeparator();this._tools.UNDO=new _19c(lang.mixin(_1a0.undo,{settings:this._settings,onClick:lang.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._undo();})}));this.addChild(this._tools.UNDO);this._tools.REDO=new _19c(lang.mixin(_1a0.redo,{settings:this._settings,onClick:lang.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._redo();})}));this.addChild(this._tools.REDO);}}});if(has("extend-esri")){lang.setObject("dijit.editing.toolbars.Drawing",_1a4,_1a3);}return _1a4;});},"url:esri/dijit/templates/AttributeInspector.html":"<div class=\"esriAttributeInspector\">\r\n    <div class=\"atiLayerName\" dojoAttachPoint=\"layerName\"></div>\r\n    <div class=\"atiAttributes\" dojoAttachPoint=\"attributeTable\"></div>\r\n    <div dojoAttachPoint=\"attachmentEditor\"></div>\r\n    <div class=\"atiEditorTrackingInfo\" dojoAttachPoint=\"editorTrackingInfoDiv\"></div>\r\n    <div class=\"atiButtons\" dojoAttachPoint=\"editButtons\">\r\n        <button  dojoType=\"dijit.form.Button\" class=\"atiButton atiDeleteButton\"  dojoAttachPoint=\"deleteBtn\" dojoAttachEvent=\"onClick: onDeleteBtn\" showLabel=\"true\" type=\"button\">${NLS_deleteFeature}</button>\r\n        <div class=\"atiNavButtons\" dojoAttachPoint=\"navButtons\">\r\n            <div class=\"atiNavMessage\" dojoAttachPoint=\"navMessage\"></div>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiFirstIcon\" dojoAttachPoint=\"firstFeatureButton\" dojoAttachEvent=\"onClick: onFirstFeature\" showLabel=\"false\" type=\"button\">${NLS_first}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiPrevIcon\" dojoAttachPoint=\"prevFeatureButton\" dojoAttachEvent=\"onClick: onPreviousFeature\" showLabel=\"false\" type=\"button\">${NLS_previous}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiNextIcon\" dojoAttachPoint=\"nextFeatureButton\" dojoAttachEvent=\"onClick: onNextFeature\" showLabel=\"false\" type=\"button\">${NLS_next}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiLastIcon\" dojoAttachPoint=\"lastFeatureButton\" dojoAttachEvent=\"onClick: onLastFeature\" showLabel=\"false\" type=\"button\">${NLS_last}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n","dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_1ab,_1ac,_1ad){return _1ab("dojox.grid.DataSelection",_1ad,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _1ac(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_1ad.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_1ae){var _1af=this.grid.getItemIndex(_1ae);var idx=_1ad.prototype.getNextSelected.call(this,_1af);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _1b0=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_1b0.push(this.grid.getItem(i));}}return _1b0;},addToSelection:function(_1b1){if(this.mode=="none"){return;}var idx=null;if(typeof _1b1=="number"||typeof _1b1=="string"){idx=_1b1;}else{idx=this.grid.getItemIndex(_1b1);}_1ad.prototype.addToSelection.call(this,idx);},deselect:function(_1b2){if(this.mode=="none"){return;}var idx=null;if(typeof _1b2=="number"||typeof _1b2=="string"){idx=_1b2;}else{idx=this.grid.getItemIndex(_1b2);}_1ad.prototype.deselect.call(this,idx);},deselectAll:function(_1b3){var idx=null;if(_1b3||typeof _1b3=="number"){if(typeof _1b3=="number"||typeof _1b3=="string"){idx=_1b3;}else{idx=this.grid.getItemIndex(_1b3);}_1ad.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_1b4,_1b5,_1b6,lang,win,_1b7,_1b8,has,keys,on,_1b9,_1ba,dnd,_1bb,_1bc){var _1bd=_1b5("dojo.dnd.Manager",[_1b8],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_1be){if(this.avatar){this.target=(_1be&&_1be.targetState!="Disabled")?_1be:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_1b9.publish("/dnd/source/over",_1be);},outSource:function(_1bf){if(this.avatar){if(this.target==_1bf){this.target=null;this.canDropFlag=false;this.avatar.update();_1b9.publish("/dnd/source/over",null);}}else{_1b9.publish("/dnd/source/over",null);}},startDrag:function(_1c0,_1c1,copy){_1bb.autoScrollStart(win.doc);this.source=_1c0;this.nodes=_1c1;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_1b9.publish("/dnd/start",_1c0,_1c1,this.copy);this.events=[on(win.doc,_1ba.move,lang.hitch(this,"onMouseMove")),on(win.doc,_1ba.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_1b6.stop),on(win.body(),"selectstart",_1b6.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_1b7.add(win.body(),c);},canDrop:function(flag){var _1c2=Boolean(this.target&&flag);if(this.canDropFlag!=_1c2){this.canDropFlag=_1c2;this.avatar.update();}},stopDrag:function(){_1b7.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_1b4.forEach(this.events,function(_1c3){_1c3.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _1bc(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_1bb.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_1b9.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_1b9.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_1b9.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_1b9.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_1b7.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_1bd.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _1bd();}return dnd._manager;};return _1bd;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_1c4,_1c5){return _1c4("dojox.grid._RowSelector",_1c5,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_1c6,_1c7){var w=this.contentWidth||0;_1c7.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_1c8,_1c9){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_1c8)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_1c8)){n.push("dojoxGridRowbarSelected");}_1c9.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_1ca,_1cb,_1cc,lang,_1cd){return _1cb("dojox.grid._Layout",null,{constructor:function(_1ce){this.grid=_1ce;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_1cf,_1d0,_1d1,_1d2,_1d3){var _1d4=this.structure[_1cf].cells[0];var _1d5=this.structure[_1d0].cells[0];var cell=null;var _1d6=0;var _1d7=0;for(var i=0,c;c=_1d4[i];i++){if(c.index==_1d1){_1d6=i;break;}}cell=_1d4.splice(_1d6,1)[0];cell.view=this.grid.views.views[_1d0];for(i=0,c=null;c=_1d5[i];i++){if(c.index==_1d2){_1d7=i;break;}}if(!_1d3){_1d7+=1;}_1d5.splice(_1d7,0,cell);var _1d8=this.grid.getCell(this.grid.getSortIndex());if(_1d8){_1d8._currentlySorted=this.grid.getSortAsc();}this.cells=[];_1d1=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_1d1;this.cells.push(c);if("_currentlySorted" in c){var si=_1d1+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_1d1++;}}}_1cc.forEach(this.cells,function(c){var _1d9=c.markup[2].split(" ");var _1da=parseInt(_1d9[1].substring(5));if(_1da!=c.index){_1d9[1]="idx=\""+c.index+"\"";c.markup[2]=_1d9.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_1db,_1dc){var cell=this.cells[_1db];if(cell.hidden==_1dc){cell.hidden=!_1dc;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_1cd.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_1dd,_1de,_1df){var self=this;var _1e0=function(_1e1){var w=0;if(_1e1.colSpan>1){w=0;}else{w=_1e1.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _1e2={grid:this.grid,subrow:_1dd,layoutIndex:_1de,index:this.cells.length};if(_1df&&_1df instanceof _1ca.grid.cells._Base){var _1e3=lang.clone(_1df);_1e2.unitWidth=_1e0(_1e3._props);_1e3=lang.mixin(_1e3,this._defaultCellProps,_1df._props,_1e2);return _1e3;}var _1e4=_1df.type||_1df.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_1ca.grid.cells.Cell;if(lang.isString(_1e4)){_1e4=lang.getObject(_1e4);}_1e2.unitWidth=_1e0(_1df);return new _1e4(lang.mixin({},this._defaultCellProps,_1df,_1e2));},addRowDef:function(_1e5,_1e6){var _1e7=[];var _1e8=0,_1e9=0,_1ea=true;for(var i=0,def,cell;(def=_1e6[i]);i++){cell=this.addCellDef(_1e5,i,def);_1e7.push(cell);this.cells.push(cell);if(_1ea&&cell.relWidth){_1e8+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_1e9+=window.parseInt(w,10);}else{if(w=="auto"){_1ea=false;}}}}}if(_1e8&&_1ea){_1cc.forEach(_1e7,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_1e8)*(100-_1e9))+"%";}});}return _1e7;},addRowsDef:function(_1eb){var _1ec=[];if(lang.isArray(_1eb)){if(lang.isArray(_1eb[0])){for(var i=0,row;_1eb&&(row=_1eb[i]);i++){_1ec.push(this.addRowDef(i,row));}}else{_1ec.push(this.addRowDef(0,_1eb));}}return _1ec;},addViewDef:function(_1ed){this._defaultCellProps=_1ed.defaultCell||{};if(_1ed.width&&_1ed.width=="auto"){delete _1ed.width;}return lang.mixin({},_1ed,{cells:this.addRowsDef(_1ed.rows||_1ed.cells)});},setStructure:function(_1ee){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_1ca._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _1ef=this.grid.rowSelector;if(_1ef=="false"){sel=null;}else{if(_1ef!="true"){sel["width"]=_1ef;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _1f0=function(def){return ("name" in def||"field" in def||"get" in def);};var _1f1=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_1f0(def[0])){return true;}}return false;};var _1f2=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_1f0(def))));};if(lang.isArray(_1ee)){var _1f3=false;for(var i=0,st;(st=_1ee[i]);i++){if(_1f2(st)){_1f3=true;break;}}if(!_1f3){s.push(this.addViewDef({cells:_1ee}));}else{for(i=0;(st=_1ee[i]);i++){if(_1f1(st)){s.push(this.addViewDef({cells:st}));}else{if(_1f2(st)){s.push(this.addViewDef(st));}}}}}else{if(_1f2(_1ee)){s.push(this.addViewDef(_1ee));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dijit/Editor":function(){define("dijit/Editor",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/i18n","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/string","dojo/topic","dojo/_base/window","./_base/focus","./_Container","./Toolbar","./ToolbarSeparator","./layout/_LayoutWidget","./form/ToggleButton","./_editor/_Plugin","./_editor/plugins/EnterKeyHandling","./_editor/html","./_editor/range","./_editor/RichText","./main","dojo/i18n!./_editor/nls/commands"],function(_1f4,_1f5,_1f6,_1f7,i18n,_1f8,_1f9,_1fa,_1fb,_1fc,keys,lang,has,_1fd,_1fe,win,_1ff,_200,_201,_202,_203,_204,_205,_206,html,_207,_208,_209){var _20a=_1f6("dijit.Editor",_208,{plugins:null,extraPlugins:null,constructor:function(){if(!lang.isArray(this.plugins)){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",_206];}this._plugins=[];this._editInterval=this.editActionInterval*1000;if(has("ie")){this.events.push("onBeforeDeactivate");this.events.push("onBeforeActivate");}},postMixInProperties:function(){this.setValueDeferred=new _1f7();this.inherited(arguments);},postCreate:function(){this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);if(lang.isArray(this.extraPlugins)){this.plugins=this.plugins.concat(this.extraPlugins);}this.inherited(arguments);this.commands=i18n.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar){this.toolbar=new _201({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang});this.header.appendChild(this.toolbar.domNode);}_1f5.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(true);_1f9.add(this.iframe.parentNode,"dijitEditorIFrameContainer");_1f9.add(this.iframe,"dijitEditorIFrame");_1f8.set(this.iframe,"allowTransparency",true);if(has("webkit")){_1fb.set(this.domNode,"KhtmlUserSelect","none");}this.toolbar.startup();this.onNormalizedDisplayChanged();},destroy:function(){_1f5.forEach(this._plugins,function(p){if(p&&p.destroy){p.destroy();}});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments);},addPlugin:function(_20b,_20c){var args=lang.isString(_20b)?{name:_20b}:lang.isFunction(_20b)?{ctor:_20b}:_20b;if(!args.setEditor){var o={"args":args,"plugin":null,"editor":this};if(args.name){if(_205.registry[args.name]){o.plugin=_205.registry[args.name](args);}else{_1fe.publish(_209._scopeName+".Editor.getPlugin",o);}}if(!o.plugin){try{var pc=args.ctor||lang.getObject(args.name)||_1f4(args.name);if(pc){o.plugin=new pc(args);}}catch(e){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}}if(!o.plugin){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}_20b=o.plugin;}if(arguments.length>1){this._plugins[_20c]=_20b;}else{this._plugins.push(_20b);}_20b.setEditor(this);if(lang.isFunction(_20b.setToolbar)){_20b.setToolbar(this.toolbar);}},resize:function(size){if(size){_203.prototype.resize.apply(this,arguments);}},layout:function(){var _20d=(this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+_1fa.getPadBorderExtents(this.iframe.parentNode).h+_1fa.getMarginExtents(this.iframe.parentNode).h));this.editingArea.style.height=_20d+"px";if(this.iframe){this.iframe.style.height="100%";}this._layoutMode=true;},_onIEMouseDown:function(e){var _20e;var b=this.document.body;var _20f=b.clientWidth;var _210=b.clientHeight;var _211=b.clientLeft;var _212=b.offsetWidth;var _213=b.offsetHeight;var _214=b.offsetLeft;if(/^rtl$/i.test(b.dir||"")){if(_20f<_212&&e.x>_20f&&e.x<_212){_20e=true;}}else{if(e.x<_211&&e.x>_214){_20e=true;}}if(!_20e){if(_210<_213&&e.y>_210&&e.y<_213){_20e=true;}}if(!_20e){delete this._cursorToStart;delete this._savedSelection;if(e.target.tagName=="BODY"){this.defer("placeCursorAtEnd");}this.inherited(arguments);}},onBeforeActivate:function(){this._restoreSelection();},onBeforeDeactivate:function(e){if(this.customUndo){this.endEditing(true);}if(e.target.tagName!="BODY"){this._saveSelection();}},customUndo:true,editActionInterval:3,beginEditing:function(cmd){if(!this._inEditing){this._inEditing=true;this._beginEditing(cmd);}if(this.editActionInterval>0){if(this._editTimer){this._editTimer.remove();}this._editTimer=this.defer("endEditing",this._editInterval);}},_steps:[],_undoedSteps:[],execCommand:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return this[cmd]();}else{if(this.customUndo){this.endEditing();this._beginEditing();}var r=this.inherited(arguments);if(this.customUndo){this._endEditing();}return r;}},_pasteImpl:function(){return this._clipboardCommand("paste");},_cutImpl:function(){return this._clipboardCommand("cut");},_copyImpl:function(){return this._clipboardCommand("copy");},_clipboardCommand:function(cmd){var r;try{r=this.document.execCommand(cmd,false,null);if(has("webkit")&&!r){throw {code:1011};}}catch(e){if(e.code==1011||(e.code==9&&has("opera"))){var sub=_1fd.substitute,_215={cut:"X",copy:"C",paste:"V"};alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[has("mac")?"appleKey":"ctrlKey"],[_215[cmd]])]));}r=false;}return r;},queryCommandEnabled:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);}else{return this.inherited(arguments);}},_moveToBookmark:function(b){var _216=b.mark;var mark=b.mark;var col=b.isCollapsed;var r,_217,_218,sel;if(mark){if(has("ie")<9){if(lang.isArray(mark)){_216=[];_1f5.forEach(mark,function(n){_216.push(_207.getNode(n,this.editNode));},this);win.withGlobal(this.window,"moveToBookmark",_1ff,[{mark:_216,isCollapsed:col}]);}else{if(mark.startContainer&&mark.endContainer){sel=_207.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_207.create(this.window);_217=_207.getNode(mark.startContainer,this.editNode);_218=_207.getNode(mark.endContainer,this.editNode);if(_217&&_218){r.setStart(_217,mark.startOffset);r.setEnd(_218,mark.endOffset);sel.addRange(r);}}}}}else{sel=_207.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_207.create(this.window);_217=_207.getNode(mark.startContainer,this.editNode);_218=_207.getNode(mark.endContainer,this.editNode);if(_217&&_218){r.setStart(_217,mark.startOffset);r.setEnd(_218,mark.endOffset);sel.addRange(r);}}}}},_changeToStep:function(from,to){this.setValue(to.text);var b=to.bookmark;if(!b){return;}this._moveToBookmark(b);},undo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._steps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(s,this._steps[this._steps.length-1]);this._undoedSteps.push(s);this.onDisplayChanged();delete this._undoRedoActive;ret=true;}delete this._undoRedoActive;}return ret;},redo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._undoedSteps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(this._steps[this._steps.length-1],s);this._steps.push(s);this.onDisplayChanged();ret=true;}delete this._undoRedoActive;}return ret;},endEditing:function(_219){if(this._editTimer){this._editTimer=this._editTimer.remove();}if(this._inEditing){this._endEditing(_219);this._inEditing=false;}},_getBookmark:function(){var b=win.withGlobal(this.window,_1ff.getBookmark);var tmp=[];if(b&&b.mark){var mark=b.mark;if(has("ie")<9){var sel=_207.getSelection(this.window);if(!lang.isArray(mark)){if(sel){var _21a;if(sel.rangeCount){_21a=sel.getRangeAt(0);}if(_21a){b.mark=_21a.cloneRange();}else{b.mark=win.withGlobal(this.window,_1ff.getBookmark);}}}else{_1f5.forEach(b.mark,function(n){tmp.push(_207.getIndex(n,this.editNode).o);},this);b.mark=tmp;}}try{if(b.mark&&b.mark.startContainer){tmp=_207.getIndex(b.mark.startContainer,this.editNode).o;b.mark={startContainer:tmp,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?tmp:_207.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset};}}catch(e){b.mark=null;}}return b;},_beginEditing:function(){if(this._steps.length===0){this._steps.push({"text":html.getChildrenHtml(this.editNode),"bookmark":this._getBookmark()});}},_endEditing:function(){var v=html.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:v,bookmark:this._getBookmark()});},onKeyDown:function(e){if(!has("ie")&&!this.iframe&&e.keyCode==keys.TAB&&!this.tabIndent){this._saveSelection();}if(!this.customUndo){this.inherited(arguments);return;}var k=e.keyCode;if(e.ctrlKey&&!e.altKey){if(k==90||k==122){_1fc.stop(e);this.undo();return;}else{if(k==89||k==121){_1fc.stop(e);this.redo();return;}}}this.inherited(arguments);switch(k){case keys.ENTER:case keys.BACKSPACE:case keys.DELETE:this.beginEditing();break;case 88:case 86:if(e.ctrlKey&&!e.altKey&&!e.metaKey){this.endEditing();if(e.keyCode==88){this.beginEditing("cut");}else{this.beginEditing("paste");}this.defer("endEditing",1);break;}default:if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<keys.F1||e.keyCode>keys.F15)){this.beginEditing();break;}case keys.ALT:this.endEditing();break;case keys.UP_ARROW:case keys.DOWN_ARROW:case keys.LEFT_ARROW:case keys.RIGHT_ARROW:case keys.HOME:case keys.END:case keys.PAGE_UP:case keys.PAGE_DOWN:this.endEditing(true);break;case keys.CTRL:case keys.SHIFT:case keys.TAB:break;}},_onBlur:function(){this.inherited(arguments);this.endEditing(true);},_saveSelection:function(){try{this._savedSelection=this._getBookmark();}catch(e){}},_restoreSelection:function(){if(this._savedSelection){delete this._cursorToStart;if(win.withGlobal(this.window,"isCollapsed",_1ff)){this._moveToBookmark(this._savedSelection);}delete this._savedSelection;}},onClick:function(){this.endEditing(true);this.inherited(arguments);},replaceValue:function(html){if(!this.customUndo){this.inherited(arguments);}else{if(this.isClosed){this.setValue(html);}else{this.beginEditing();if(!html){html="&#160;";}this.setValue(html);this.endEditing();}}},_setDisabledAttr:function(_21b){this.setValueDeferred.then(lang.hitch(this,function(){if((!this.disabled&&_21b)||(!this._buttonEnabledPlugins&&_21b)){_1f5.forEach(this._plugins,function(p){p.set("disabled",true);});}else{if(this.disabled&&!_21b){_1f5.forEach(this._plugins,function(p){p.set("disabled",false);});}}}));this.inherited(arguments);},_setStateClass:function(){try{this.inherited(arguments);if(this.document&&this.document.body){_1fb.set(this.document.body,"color",_1fb.get(this.iframe,"color"));}}catch(e){}}});function _21c(args){return new _205({command:args.name});};function _21d(args){return new _205({buttonClass:_204,command:args.name});};lang.mixin(_205.registry,{"undo":_21c,"redo":_21c,"cut":_21c,"copy":_21c,"paste":_21c,"insertOrderedList":_21c,"insertUnorderedList":_21c,"indent":_21c,"outdent":_21c,"justifyCenter":_21c,"justifyFull":_21c,"justifyLeft":_21c,"justifyRight":_21c,"delete":_21c,"selectAll":_21c,"removeFormat":_21c,"unlink":_21c,"insertHorizontalRule":_21c,"bold":_21d,"italic":_21d,"underline":_21d,"strikethrough":_21d,"subscript":_21d,"superscript":_21d,"|":function(){return new _205({setEditor:function(_21e){this.editor=_21e;this.button=new _202({ownerDocument:_21e.ownerDocument});}});}});return _20a;});},"dijit/layout/_LayoutWidget":function(){define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","../Viewport","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style"],function(lang,_21f,_220,_221,_222,_223,_224,_225,_226){return _223("dijit.layout._LayoutWidget",[_21f,_220,_221],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);_224.add(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _227=this.getParent&&this.getParent();if(!(_227&&_227.isLayoutContainer)){this.resize();this.own(_222.on("resize",lang.hitch(this,"resize")));}},resize:function(_228,_229){var node=this.domNode;if(_228){_225.setMarginBox(node,_228);}var mb=_229||{};lang.mixin(mb,_228||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_225.getMarginBox(node),mb);}var cs=_226.getComputedStyle(node);var me=_225.getMarginExtents(node,cs);var be=_225.getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=_225.getPadExtents(node,cs);this._contentBox={l:_226.toPixelValue(node,cs.paddingLeft),t:_226.toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_22a){var cls=this.baseClass+"-child "+(_22a.baseClass?this.baseClass+"-"+_22a.baseClass:"");_224.add(_22a.domNode,cls);},addChild:function(_22b,_22c){this.inherited(arguments);if(this._started){this._setupChild(_22b);}},removeChild:function(_22d){var cls=this.baseClass+"-child"+(_22d.baseClass?" "+this.baseClass+"-"+_22d.baseClass:"");_224.remove(_22d.domNode,cls);this.inherited(arguments);}});});},"esri/layers/RenderMode":function(){define("esri/layers/RenderMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/io/script","esri/kernel"],function(_22e,_22f,lang,_230,has,_231,_232){var _233=_22f(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(_22e._scopeName||"dojo")+"IoScript";},initialize:function(map){this.map=map;this._init=true;},startup:function(){},propertyChangeHandler:function(type){},destroy:function(){this._init=false;},drawFeature:function(_234){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _235=this._featureMap[oid];if(_235){_235._count++;}},_decRefCount:function(oid){var _236=this._featureMap[oid];if(_236){_236._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_237){var fmap=this._featureMap,_238=fmap[oid],_239=this.featureLayer;if(!_238){fmap[oid]=_237;_239._add(_237);_237._count=0;}return _238||_237;},_removeFeatureIIf:function(oid){var _23a=this._featureMap[oid],_23b=this.featureLayer;if(_23a){if(_23a._count){return;}delete this._featureMap[oid];_23b._remove(_23a);}return _23a;},_clearIIf:function(){var i,_23c=this.featureLayer,_23d=_23c.graphics,_23e=_23c._selectedFeatures,_23f=_23c.objectIdField;for(i=_23d.length-1;i>=0;i--){var _240=_23d[i];var oid=_240.attributes[_23f];if(oid in _23e){_240._count=1;continue;}_240._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_231[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_231[this._prefix+id];if(dfd){try{dfd.cancel();_231._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_231._validCheck(null);},_toggleVisibility:function(show){var _241=this.featureLayer,_242=_241.graphics,_243=show?"show":"hide",i,len=_242.length;show=show&&_241._ager;for(i=0;i<len;i++){var _244=_242[i];_244[_243]();if(show){_241._repaint(_244);}}},_applyTimeFilter:function(_245){var _246=this.featureLayer;if(!_246.timeInfo||_246.suspended){return;}if(!_245){_246._fireUpdateStart();}var _247=_246._trackManager;if(_247){_247.clearTracks();}var defn=_246.getTimeDefinition(),_248=_246._getOffsettedTE(_246._mapTimeExtent);if(_248){_248=_246._getTimeOverlap(defn,_248);if(_248){var _249=_246._filterByTime(_246.graphics,_248.startTime,_248.endTime);if(_247){_247.addFeatures(_249.match);}_230.forEach(_249.match,function(_24a){var _24b=_24a._shape;if(!_24a.visible){_24a.show();_24b=_24a._shape;_24b&&_24b._moveToFront();}if(_246._ager&&_24b){_246._repaint(_24a);}});_230.forEach(_249.noMatch,function(_24c){if(_24c.visible){_24c.hide();}});}else{this._toggleVisibility(false);}}else{if(_247){_247.addFeatures(_246.graphics);}this._toggleVisibility(true);}if(_247){_247.moveLatestToFront();_247.drawTracks();}if(!_245){_246._fireUpdateEnd();}}});if(has("extend-esri")){lang.setObject("layers._RenderMode",_233,_232);}return _233;});},"dijit/form/_SearchMixin":function(){define("dijit/form/_SearchMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/sniff","dojo/string","dojo/when","../registry"],function(_24d,_24e,_24f,keys,lang,_250,has,_251,when,_252){return _24e("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:true,_abortQuery:function(){if(this.searchTimer){this.searchTimer=this.searchTimer.remove();}if(this._queryDeferHandle){this._queryDeferHandle=this._queryDeferHandle.remove();}if(this._fetchHandle){if(this._fetchHandle.abort){this._cancelingQuery=true;this._fetchHandle.abort();this._cancelingQuery=false;}if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_processInput:function(evt){if(this.disabled||this.readOnly){return;}var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==keys.SHIFT){return;}var _253=false;this._prev_key_backspace=false;switch(key){case keys.DELETE:case keys.BACKSPACE:this._prev_key_backspace=true;this._maskValidSubsetError=true;_253=true;break;default:_253=typeof key=="string"||key==229;}if(_253){if(!this.store){this.onSearch();}else{this.searchTimer=this.defer("_startSearchFromInput",1);}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_startSearch:function(text){this._abortQuery();var _254=this,_250=lang.clone(this.query),_255={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}},qs=_251.substitute(this.queryExpr,[text]),q,_256=function(){var _257=_254._fetchHandle=_254.store.query(_250,_255);if(_254.disabled||_254.readOnly||(q!==_254._lastQuery)){return;}when(_257,function(res){_254._fetchHandle=null;if(!_254.disabled&&!_254.readOnly&&(q===_254._lastQuery)){when(_257.total,function(_258){res.total=_258;var _259=_254.pageSize;if(isNaN(_259)||_259>res.total){_259=res.total;}res.nextPage=function(_25a){_255.direction=_25a=_25a!==false;_255.count=_259;if(_25a){_255.start+=res.length;if(_255.start>=res.total){_255.count=0;}}else{_255.start-=_259;if(_255.start<0){_255.count=Math.max(_259+_255.start,0);_255.start=0;}}if(_255.count<=0){res.length=0;_254.onSearch(res,_250,_255);}else{_256();}};_254.onSearch(res,_250,_255);});}},function(err){_254._fetchHandle=null;if(!_254._cancelingQuery){console.error(_254.declaredClass+" "+err.toString());}});};lang.mixin(_255,this.fetchProperties);if(this.store._oldAPI){q=qs;}else{q=_24d.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_250[this.searchAttr]=q;this._queryDeferHandle=this.defer(_256,this.searchDelay);},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var list=this.list;if(list){this.store=_252.byId(list);}}this.inherited(arguments);}});});},"esri/dijit/editing/Cut":function(){define("esri/dijit/editing/Cut",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/OperationBase"],function(_25b,lang,has,_25c,_25d,_25e){var Cut=_25b(_25e,{declaredClass:"esri.dijit.editing.Cut",type:"edit",label:"Cut Features",constructor:function(_25f){var i;_25f=_25f||{};if(!_25f.featureLayer){console.error("In constructor of 'esri.dijit.editing.Cut', featureLayer not provided");return;}this._featureLayer=_25f.featureLayer;if(!_25f.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', addedGraphics for cut not provided");return;}this._addedGraphics=_25f.addedGraphics;if(!_25f.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(i=0;i<_25f.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_25f.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_25f.preUpdatedGraphics[i].attributes);}if(!_25f.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_25f.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_25f.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_25f.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(lang.clone(_25f.postUpdatedGraphics[i].attributes));}},performUndo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_25d.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics);},performRedo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_25d.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Cut",Cut,_25c);}return Cut;});},"dijit/form/DateTextBox":function(){define("dijit/form/DateTextBox",["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(_260,_261,_262){return _260("dijit.form.DateTextBox",_262,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:_261,_selector:"date",value:new Date("")});});},"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n","dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_263,_264,_265,_266,_267,_268,_269,_26a,_26b,_26c,_26d,_26e,util,_26f,_270,_271,_272,_273,_274,lang,has,_275,html,_276){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _277=_264("dojox.grid._Grid",[_26f,_270,_265],{templateString:_272,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_267,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_275.initOnFontResize();this.connect(_275,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}if(this.rowHeight>0){html.addClass(this.viewsNode,this.classTag+"FixedRowHeight");}},postMixInProperties:function(){this.inherited(arguments);var _278=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_273.substitute(this.loadingMessage,_278);this.errorMessage=_273.substitute(this.errorMessage,_278);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_274.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_279){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_279){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _26a(this);this.focus=new _26b(this);this.edit=new _26c(this);},createSelection:function(){this.selection=new _26d(this);},createScroller:function(){this.scroller=new _266();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_27a){},createViews:function(){this.views=new _269(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_27b,idx){var c=lang.getObject(_27b);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_263._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_27c){var s=_27c;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_27d){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_27d);},getColumnTogglingItems:function(){var _27e,_27f=[];_27e=_274.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _271({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_280){if(self.layout.setColumnVisibility(this._gridCell.index,_280)){var _281=this._gridCell.menuItems;if(_281.length>1){_274.forEach(_281,function(item){if(item!==this){item.setAttribute("checked",_280);}},this);}_280=_274.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_274.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_280.length==1){_274.forEach(_280[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _282=_274.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_282,1);delete this._gridCell;_271.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_27f.push(item);}return item;},this);if(_27f.length==1){_27f[0].set("disabled",true);}return _27e;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_274.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_274.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_283){this.setScrollTop(0);},getItem:function(_284){return null;},showMessage:function(_285){if(_285){this.messagesNode.innerHTML=_285;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_286,_287){this._pendingChangeSize=_286;this._pendingResultSize=_287;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_288,_289){_288=_288||this._pendingChangeSize;_289=_289||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _28a=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_28a.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_289){_288=_289;}if(!this._autoHeight&&_288){html.marginBox(this.domNode,_288);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=(this._parentContentBoxHeight>0?this._parentContentBoxHeight:html._getContentBox(pn).h);this.domNode.style.height=Math.max(0,h)+"px";}}var _28b=_274.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_28b&&hh===undefined){hh=this._getHeaderHeight();}}if(_28b){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _28c=(!this.initialWidth&&this.autoWidth);var w=_28c?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_28c){this.domNode.style.width=vw+"px";}},adaptHeight:function(_28d){var t=_28d===undefined?this._getHeaderHeight():_28d;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _28e=0,_28f=0;var _290=_274.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_28e++;}else{_28f++;}return (!has);});if(_28e>0&&_28f>0){_274.forEach(_290,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_291,_292){this.views.renderRow(_291,_292,this._skipRowRenormalize);},rowRemoved:function(_293){this.views.rowRemoved(_293);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_294){_294=Number(_294);if(this.updating){this.invalidated[_294]=true;}else{this.views.updateRow(_294);this.scroller.rowHeightChanged(_294);}},updateRows:function(_295,_296){_295=Number(_295);_296=Number(_296);var i;if(this.updating){for(i=0;i<_296;i++){this.invalidated[i+_295]=true;}}else{for(i=0;i<_296;i++){this.views.updateRow(i+_295,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_295);}},updateRowCount:function(_297){if(this.updating){this.invalidated.rowCount=_297;}else{this.rowCount=_297;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_297);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_298){this.views.updateRowStyles(_298);},getRowNode:function(_299){if(this.focus.focusView&&!(this.focus.focusView instanceof _26e)){return this.focus.focusView.rowNodes[_299];}else{for(var i=0,_29a;(_29a=this.views.views[i]);i++){if(!(_29a instanceof _26e)){return _29a.rowNodes[_299];}}}return null;},rowHeightChanged:function(_29b){this.views.renormalizeRow(_29b);this.scroller.rowHeightChanged(_29b);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_29c){if(!this.fastScroll){this.setScrollTop(_29c);return;}var _29d=Math.abs(this.lastScrollTop-_29c);this.lastScrollTop=_29c;if(_29d>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_29c;this.views.setScrollTop(_29c);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _29e=this;this._pendingScroll=window.setTimeout(function(){delete _29e._pendingScroll;_29e.finishScrollJob();},200);}else{this.setScrollTop(_29c);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_29f){this.scroller.scroll(this.views.setScrollTop(_29f));},scrollToRow:function(_2a0){this.setScrollTop(this.scroller.findScrollTop(_2a0)+1);},styleRowNode:function(_2a1,_2a2){if(_2a2){this.rows.styleRowNode(_2a1,_2a2);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_2a3){return this.layout.cells[_2a3];},setCellWidth:function(_2a4,_2a5){this.getCell(_2a4).unitWidth=_2a5;},getCellName:function(_2a6){return "Cell "+_2a6.index;},canSort:function(_2a7){},sort:function(){},getSortAsc:function(_2a8){_2a8=_2a8==undefined?this.sortInfo:_2a8;return Boolean(_2a8>0);},getSortIndex:function(_2a9){_2a9=_2a9==undefined?this.sortInfo:_2a9;return Math.abs(_2a9)-1;},setSortIndex:function(_2aa,_2ab){var si=_2aa+1;if(_2ab!=undefined){si*=(_2ab?1:-1);}else{if(this.getSortIndex()==_2aa){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_2ac){if(this.canSort(_2ac)){this.sortInfo=_2ac;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_2ad,_2ae){this.onStartEdit(_2ad,_2ae);},doApplyCellEdit:function(_2af,_2b0,_2b1){this.onApplyCellEdit(_2af,_2b0,_2b1);},doCancelEdit:function(_2b2){this.onCancelEdit(_2b2);},doApplyEdit:function(_2b3){this.onApplyEdit(_2b3);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_277.markupFactory=function(_2b4,node,ctor,_2b5){var _2b6=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_2b4.structure&&node.nodeName.toLowerCase()=="table"){_2b4.structure=_276("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_2b6(cg);}return v;});if(!_2b4.structure.length){_2b4.structure.push({__span:Infinity,cells:[]});}_276("thead > tr",node).forEach(function(tr,_2b7){var _2b8=0;var _2b9=0;var _2ba;var _2bb=null;_276("> th",tr).map(function(th){if(!_2bb){_2ba=0;_2bb=_2b4.structure[0];}else{if(_2b8>=(_2ba+_2bb.__span)){_2b9++;_2ba+=_2bb.__span;var _2bc=_2bb;_2bb=_2b4.structure[_2b9];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_2b8+=cell.colSpan;var _2bd=html.attr(th,"rowspan");if(_2bd){cell.rowSpan=_2bd;}if(html.hasAttr(th,"width")){cell.width=_2b6(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_2b5){_2b5(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_263.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_2bb.cells[_2b7]){_2bb.cells[_2b7]=[];}_2bb.cells[_2b7].push(cell);});});}return new ctor(_2b4,node);};return _277;});},"dojo/_base/query":function(){define(["../query","./NodeList"],function(_2be){return _2be;});},"esri/dijit/editing/Editor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/kernel","dojo/has","dojo/query","dojo/DeferredList","dojo/dom-class","dojo/dom-construct","dijit/_Widget","dijit/_Templated","esri/domUtils","esri/graphicsUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/graphic","esri/undoManager","esri/tasks/query","esri/layers/FeatureLayer","esri/layers/FeatureTemplate","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/AttributeInspector","esri/dijit/editing/Util","esri/dijit/editing/Add","esri/dijit/editing/Update","esri/dijit/editing/Delete","esri/dijit/editing/toolbars/Drawing","esri/dijit/editing/SelectionHelper","esri/dijit/editing/TemplatePicker","esri/kernel","esri/config","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/Editor.html","dijit/ProgressBar","dojo/NodeList-dom"],function(_2bf,lang,_2c0,_2c1,_2c2,has,_2c3,_2c4,_2c5,_2c6,_2c7,_2c8,_2c9,_2ca,_2cb,_2cc,_2cd,_2ce,_2cf,_2d0,_2d1,Draw,_2d2,_2d3,_2d4,Add,_2d5,_2d6,_2d7,_2d8,_2d9,_2da,_2db,_2dc,_2dd){var _2de=_2bf([_2c7,_2c8],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:true,templateString:_2dd,constructor:function(_2df,_2e0){_2df=_2df||{};if(!_2df.settings){console.error("Editor: please provide 'settings' parameter in the constructor");}if(!_2df.settings.layerInfos){console.error("Editor: please provide 'layerInfos' parameter in the constructor");}this._settings=_2df.settings;this._eConnects=[];},postCreate:function(){this._setDefaultOptions();this._initLayers();this._connectEvents();this._createWidgets();this._reset();this._enableMapClickHandler();},stopEditing:function(_2e1){this._updateCurrentFeature(lang.hitch(this,function(){this._clearSelection(false);_2e1&&_2e1();}));},destroy:function(){if(this.drawingToolbar){this.drawingToolbar.destroy();}if(this.attributeInspector){this.attributeInspector.destroy();}if(this.templatePicker){this.templatePicker.destroy();}if(this._selectionHelper){this._selectionHelper.destroy();}if(this._drawToolbar){this._drawToolbar.deactivate();}this._reset();this._disableMapClickHandler();_2c0.forEach(this._eConnects,_2c1.disconnect);_2c1.disconnect(this._dtConnect);_2c1.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this._editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;if(this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures){this._settings.map.infoWindow.clearFeatures();}this.inherited(arguments);},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new Draw(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this._editToolbar=this._settings.editToolbar||new _2d2(this._settings.map);this._settings.editToolbar=this._editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||false;this._settings.toolbarOptions=lang.mixin({reshapeVisible:false,cutVisible:false,mergeVisible:false},this._settings.toolbarOptions);this._settings.createOptions=lang.mixin({polylineDrawTools:[_2de.CREATE_TOOL_POLYLINE],polygonDrawTools:[_2de.CREATE_TOOL_POLYGON],editAttributesImmediately:true},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?true:false;this._datePackage=this._settings.datePackage;var _2e2=_2db.defaults;this._settings.geometryService=this._settings.geometryService||_2e2.geometryService;_2e2.geometryService=_2e2.geometryService||this._settings.geometryService;},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};var _2e3=this._settings.layerInfos;_2c0.forEach(_2e3,function(_2e4){if(_2e4.featureLayer&&_2e4.featureLayer.loaded){this._settings.layers.push(_2e4.featureLayer);var _2e5=_2e4.featureLayer.id;if(_2e4.featureLayer.credential){this._settings.userIds[_2e5]=_2e4.featureLayer.credential.userId;}if(_2e4.userId){this._settings.userIds[_2e5]=_2e4.userId;}var _2e6=_2e4.featureLayer.getEditCapabilities();if(_2e6.canCreate&&!_2e6.canUpdate){this._settings.createOnlyLayer[_2e5]=true;}else{this._settings.createOnlyLayer[_2e5]=false;}}},this);},_reset:function(){this._hideAttributeInspector();this._editToolbar.deactivate();this._editVertices=true;this._layer=null;this._currentGraphic=null;this._activeType=null;this._activeTemplate=null;this._drawingTool=null;this._attributeChanged=false;},_saveFeatureOnClient:function(_2e7){var _2e8=this.templatePicker.getSelected();var _2e9;if(_2e8.template){_2e9=_2e8.featureLayer.renderer.getSymbol(_2e8.template.prototype);}else{_2e9=_2e8.symbolInfo.symbol;}var _2ea=_2e8.featureLayer.fields;var att={};_2c0.forEach(_2ea,function(_2eb,idx){att[_2eb.name]=null;});this._tempGraphic=new _2cd(_2e7,_2e9,att,null);var map=this._settings.map;map.graphics.add(this._tempGraphic);var _2ec=this._findCenterPoint(_2e7);this._createAttributeInspector(true);map.infoWindow.setTitle(_2e8.featureLayer?_2e8.featureLayer.name:_2dc.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,_2e8.featureLayer);this._showInfoWindow(_2ec,map.getInfoWindowAnchor(_2ec));if(this._settings.createOnlyLayer[_2e8.featureLayer.id]){this._infoWindowHideEvent=_2c1.connect(map.infoWindow,"onHide",this,"_infoWindowHide");}_2c1.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}this._templatePickerOnSelectionChangeEvent=_2c1.connect(this.templatePicker,"onSelectionChange",lang.hitch(this,"_onCreateFeature"));},_saveAttributesOnClient:function(_2ed,_2ee,_2ef){this._tempGraphic.attributes[_2ee]=(typeof (_2ef)==="number"&&isNaN(_2ef))?null:_2ef;},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);_2c1.disconnect(this._infoWindowHideEvent);},_createFeature:function(_2f0,_2f1){this._editClickPoint=this._findCenterPoint(_2f0);if(!_2f0.rings){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_2f0,_2f1)]}]);return;}this._simplify(_2f0,lang.hitch(this,function(_2f2){if(this._drawingTool!==_2d1.TOOL_AUTO_COMPLETE_POLYGON){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_2f2,_2f1)]}]);}else{this._autoComplete(_2f2,lang.hitch(this,function(_2f3){if(_2f3&&_2f3.length){this._applyEdits([{layer:this._layer,adds:_2c0.map(_2f3,lang.hitch(this,function(_2f4){return this._createGraphic(_2f4,_2f1);}))}]);}}));}}));},_updateCurrentFeature:function(_2f5){var _2f6=this._isModified();if(_2f6){this._updateFeature(_2f6,_2f5);}else{if(_2f5){_2f5(false);}}},_updateFeature:function(_2f7,_2f8){var geom=_2f7.geometry;if(!geom.rings){this._applyEdits([{layer:_2f7.getLayer(),updates:[_2f7]}],_2f8);}else{this._simplify(geom,lang.hitch(this,function(_2f9){this._applyEdits([{layer:_2f7.getLayer(),updates:[lang.mixin(_2f7,{geometry:_2f9})]}],_2f8);}));}},_deleteFeature:function(_2fa,_2fb){var _2fc=[];if(!_2fa){var _2fd=this._settings.layers;_2fc=_2c0.map(_2c0.filter(_2fd,function(_2fe){return _2fe.getSelectedFeatures().length>0;}),function(item){return {layer:item,deletes:item.getSelectedFeatures()};});if((!_2fc||!_2fc.length)&&this._currentGraphic){_2fc.push({layer:this._layer,deletes:[this._currentGraphic]});}}else{_2fc.push({layer:_2fa.getLayer(),deletes:[_2fa]});}this._applyEdits(_2fc,(_2fb));},_stopEditing:function(_2ff,adds,_300,_301){_2c9.hide(this.progressBar.domNode);this._undoRedoAdd();var _302;if(_2ff._isSelOnly===true){if(adds&&adds.length){this.templatePicker.clearSelection();var _303=new _2cf();_303.objectIds=[adds[0].objectId];if(!this._settings.createOnlyLayer[_2ff.id]){this._selectFeatures([_2ff],_303,lang.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}else{_302=this._selectionHelper.findMapService(this._settings.map,_2ff);if(_302){_302.refresh();}if(adds&&adds.length){this.templatePicker.clearSelection();if(!this._settings.createOnlyLayer[_2ff.id]){_2d4.findFeatures(adds,_2ff,lang.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}if(_301&&_301.length){this._clearSelection(true);if(this._undoRedo){_302=this._selectionHelper.findMapService(_2ff,this._settings.map);if(_302){_302.refresh();}}}if(this._undoRedo&&_300&&_300.length){_302=this._selectionHelper.findMapService(_2ff,this._settings.map);if(_302){_302.refresh();}this.attributeInspector.refresh();this._undoRedo=false;}if(this.drawingToolbar){this.drawingToolbar._updateUI();}this._undoRedo=false;},_undoRedoAdd:function(){this._settings._isApplyEditsCall=false;if(!this._settings.undoManager){return;}if(this._activeTool==="CUT"||this._activeTool==="UNION"){return;}var edit=(this._edits&&this._edits.length)?this._edits[0]:null;if(!edit){return;}var adds=edit.adds||[];var _304=edit.updates||[];var _305=edit.deletes||[];var _306={featureLayer:edit.layer};if(adds.length){this.undoManager.add(new Add(lang.mixin(_306,{addedGraphics:adds})));}else{if(_305.length){this.undoManager.add(new _2d6(lang.mixin(_306,{deletedGraphics:_305})));}else{if(_304.length){this.undoManager.add(new _2d5(lang.mixin(_306,{preUpdatedGraphics:[this._preUpdates],postUpdatedGraphics:_304})));}}}this._edits=null;this._preUpdates=null;},_activateDrawToolbar:function(_307){this._layer=_307.featureLayer;this._activeType=_307.type;this._activeTemplate=_307.template;this._drawingTool=this._activeTemplate?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,_307.featureLayer);_2c1.disconnect(this._dtConnect);if(this._settings.createOnlyLayer[_307.featureLayer.id]){this._dtConnect=_2c1.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient");}else{this._dtConnect=_2c1.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");}this._editToolbar.deactivate();this._disableMapClickHandler();if(!this.drawingToolbar){this._drawToolbar.activate(this._drawTool);}else{this.drawingToolbar.activateEditing(this._drawTool,this._layer);}},_activateEditToolbar:function(_308,info){var _309=_308.getLayer();var _30a=_309?_309.geometryType:null;var _30b=_2d2.MOVE;if(_30a!=="esriGeometryPoint"&&this._isNotesFeature(_308)===true){_30b=_30b|_2d2.ROTATE|_2d2.SCALE;this._editVertices=false;}else{if(_30a!=="esriGeometryPoint"&&this._editVertices===true){_30b=_30b|_2d2.ROTATE|_2d2.SCALE;this._editVertices=false;}else{_30b=_30b|_2d2.EDIT_VERTICES;this._editVertices=true;}}this._attributeChanged=this._isModified();this._preUpdates=new _2cd(lang.clone(_308.toJson()));var _30c=_309.getEditCapabilities({feature:_308,userId:this._settings.userIds[_309.id]});var _30d=_2c0.filter(this._settings.layerInfos,function(item){return item.featureLayer["layerId"]===_309.layerId;})[0];if(_30c.canUpdate&&!_30d.disableGeometryUpdate&&_309.allowGeometryUpdates){this._editToolbar.activate(_30b,_308);}if(!this._settings.map.infoWindow.isShowing){var _30e=(info&&info.screenPoint)||this._findCenterPoint(_308);this._showInfoWindow(_30e,this._settings.map.getInfoWindowAnchor(_30e));}},_createGraphic:function(_30f,_310){var _311=(this._activeType&&this._activeType.symbol)||this._layer.defaultSymbol;var _312=new _2cd(_30f,_311,_310);if(this._activeTemplate||_310){_312.attributes=_310||lang.mixin({},this._activeTemplate.prototype.attributes);}else{_312.attributes=_312.attributes||[];_2c0.forEach(this._layer.fields,function(_313){_312.attributes[_313.name]=null;},this);}return _312;},_connectEvents:function(){var _314=this._settings.layers;_2c0.forEach(_314,function(item){this._connect(item,"onEditsComplete",lang.hitch(this,"_stopEditing",item));},this);_2c0.forEach(_314,function(item){this._connect(item,"onBeforeApplyEdits",lang.hitch(this,function(){_2c9.show(this.progressBar.domNode);this._settings._isApplyEditsCall=true;}));},this);this._connect(this._editToolbar,"onGraphicClick",lang.hitch(this,"_activateEditToolbar"));this._connect(this._editToolbar,"onGraphicFirstMove",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onVertexFirstMove",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onScaleStart",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onRotateStart",lang.hitch(this,"_hideAttributeInspector"));},_connect:function(node,evt,func){this._eConnects.push(_2c1.connect(node,evt,func));},_createWidgets:function(){this._selectionHelper=new _2d8(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager();},_createTemplatePicker:function(){if(!this._settings.templatePicker){var _315=_2c0.filter(this._settings.layers,function(item){return item.getEditCapabilities().canCreate;});this.templatePicker=new _2d9({"class":"esriTemplatePicker",featureLayers:_315,showTooltip:true,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker;}else{this.templatePicker=this._settings.templatePicker;_2c9.hide(this.templatePickerDiv);}this._templatePickerOnSelectionChangeEvent=_2c1.connect(this.templatePicker,"onSelectionChange",lang.hitch(this,"_onCreateFeature"));},_createAttributeInspector:function(_316){if(!this._settings.attributeInspector){this._customAttributeInspector=false;var map=this._settings.map;this.attributeInspector=new _2d3({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},_2c6.create("div"));this.attributeInspector.startup();map.infoWindow.setContent(this.attributeInspector.domNode);map.infoWindow.setTitle(_2dc.widgets.attributeInspector.NLS_title);map.infoWindow.resize(350,375);_2c2.query(".esriAttributeInspector .atiLayerName").style({display:"none"});}else{this._customAttributeInspector=true;this.attributeInspector=this._settings.attributeInspector;}this._connect(this.attributeInspector,"onDelete",lang.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",lang.hitch(this,function(_317){this._updateCurrentFeature(lang.hitch(this,function(){this._attributeChanged=false;this._onEditFeature(_317);}));}));if(this._usePopup){this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,lang.hitch(this.attributeInspector,"next"),lang.hitch(this.attributeInspector,"previous"));}if(_316){this._connect(this.attributeInspector,"onAttributeChange",lang.hitch(this,"_saveAttributesOnClient"));}else{this._connect(this.attributeInspector,"onAttributeChange",lang.hitch(this,function(_318,_319,_31a){this._preUpdates=new _2cd(lang.clone(_318.toJson()));this._currentGraphic.attributes[_319]=(typeof (_31a)==="number"&&isNaN(_31a))?null:_31a;this._updateFeature(this._currentGraphic,null);this._attributeChanged=false;}));}},_createDrawingToolbar:function(){if(this._settings.toolbarVisible===true){this.drawingToolbar=new _2d7({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this._editToolbar,settings:this._settings,onDelete:lang.hitch(this,"_deleteFeature"),onApplyEdits:lang.hitch(this,"_applyEdits"),onShowAttributeInspector:lang.hitch(this,"_onEditFeature")},this.drawingToolbarDiv);}},_createUndoRedoManager:function(){if(!this._settings.enableUndoRedo&&!this._settings.undoManager){return;}this._settings.enableUndoRedo=true;this.undoManager=this._settings.undoManager;if(!this.undoManager){this.undoManager=this._settings.undoManager=new _2ce({maxOperations:this._settings.maxUndoRedoOperations});}this._connect(document,"onkeypress",lang.hitch(this,function(evt){if(evt.metaKey||evt.ctrlKey){if(evt.charOrCode==="z"){this._undo();}if(evt.charOrCode==="y"){this._redo();}}}));},_enableMapClickHandler:function(){this._mapClickHandler=_2c1.connect(this._settings.map,"onClick",lang.hitch(this,function(evt){if(this._drawToolbar._geometryType){return;}if(this._activeTool==="SELECT"){this._activeTool="";return;}this._updateCurrentFeature(lang.hitch(this,function(){this._reset();this._updateSelection(evt);}));}));},_disableMapClickHandler:function(){_2c1.disconnect(this._mapClickHandler);},_onCreateFeature:function(){var _31b=this.templatePicker.getSelected();if(_31b){this._updateCurrentFeature(lang.hitch(this,function(){if(this._currentGraphic){this._clearSelection(false);}this._reset();this._activateDrawToolbar(_31b);}));}else{this._reset();_2c1.disconnect(this._dtConnect);this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}}},_onEditFeature:function(_31c,_31d){_31c=(lang.isArray(_31c)?_31c[0]:_31c)||null;if(!_31c){return;}if(!this._customAttributeInspector){_31d=_31d||this._editClickPoint||this._findCenterPoint(_31c);var _31e=_31c.getLayer();this._settings.map.infoWindow.setTitle(_31e?_31e.name:_2dc.widgets.attributeInspector.NLS_title);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing){this._showInfoWindow(_31d,this._settings.map.getInfoWindowAnchor(_31d));}this._editClickPoint=null;}if(_31c===this._currentGraphic){return;}this._editVertices=true;this._layer=_31c.getLayer();this._currentGraphic=_31c;if(_31c.getDojoShape()){_31c.getDojoShape().moveToFront();}this._activateEditToolbar(_31c);},_applyEdits:function(_31f,_320){_31f=_31f||[];if(_31f.length<=0){return;}this._edits=_31f;var _321=_2c0.map(_31f,function(edit){return edit.layer.applyEdits(edit.adds,edit.updates,edit.deletes);});this._deferredsList=new _2c4(_321).addCallback(lang.hitch(this,function(){_2c9.hide(this.progressBar.domNode);if(_320){_320();}var map=this._settings.map;if(map&&map.infoWindow.reposition&&map.infoWindow.isShowing){map.infoWindow.reposition();}}));},_undo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.undo();}},_redo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.redo();}},_simplify:function(_322,_323){if(_2cc.prototype.isSelfIntersecting(_322)){this._settings.geometryService.simplify([_322],function(_324){var _325=(_324&&_324.length)?_324[0]:_325;if(_323){_323(_325);}});}else{if(_323){_323(_322);}}},_autoComplete:function(_326,_327){var _328=this._getLayers("esriGeometryPolygon");var _329=new _2cf();_329.geometry=_326;_329.returnGeometry=true;this._selectFeatures(_328,_329,lang.hitch(this,function(_32a){if(!_32a||_32a.length<=0){if(_327){_327([_326]);}}else{this._settings.geometryService.autoComplete(_2ca.getGeometries(_32a),this._toPolylines([_329.geometry]),function(_32b){if(_327){_327(_32b);}});}}));},_getLayers:function(_32c){var _32d=this._settings.layers;return _2c0.filter(_32d,function(_32e){return _32e.geometryType===_32c;});},_selectFeatures:function(_32f,_330,_331,mode){this._selectionHelper.selectFeatures(_32f,_330,mode||_2d0.SELECTION_NEW,_331);},_updateSelection:function(evt){var _332=evt.mapPoint;var _333=evt.graphic;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,_332,_2d0.SELECTION_NEW,lang.hitch(this,function(_334){var _335=_2c0.some(_334,lang.hitch(this,function(item){return item==_333;}));if(_333&&!_335){var _336=_333.getLayer();if(this._isValidLayer(_336)){var _337=new _2cf();_337.objectIds=[_333.attributes[_336.objectIdField]];this._selectionHelper.selectFeatures([_336],_337,_2d0.SELECTION_ADD,lang.hitch(this,function(_338){this._updatePopupButtons(_338);this._onEditFeature(_338,_332);}));}else{this._clearSelection();}}else{if(_334&&_334.length){this._updatePopupButtons(_334);this._onEditFeature(_334,_332);}else{this._clearSelection();}}}));},_updatePopupButtons:function(_339){if(!this._usePopup||!_339){return;}var _33a=_339.length;var _33b=[this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton];_2c0.forEach(_33b,lang.hitch(this,function(item){(_33a>1)?_2c5.remove(item,"hidden"):_2c5.add(item,"hidden");}));},_clearSelection:function(_33c){this._selectionHelper.clearSelection(_33c||false);this._reset();},_findCenterPoint:function(_33d){var _33e=_33d.geometry||_33d;var _33f;switch(_33e.type){case "point":_33f=_33e;break;case "polyline":var _340=_33e.paths[0].length;_33f=_33e.getPoint(0,Math.ceil(_340/2));break;case "polygon":var _341=_33e.rings.length-1;var _342=_33e.rings[_341].length-1;_33f=_33e.getPoint(_341,_342);break;}return this._settings.map.toScreen(_33f);},_hideAttributeInspector:function(){if(!this._customAttributeInspector&&this._settings.map.infoWindow){this._settings.map.infoWindow.hide();}},_toPolylines:function(_343){var _344=_2c0.map(_343,function(_345){var _346=new _2cb(_345.spatialReference);_2c0.forEach(_345.rings,function(ring){_346.addPath(ring);});return _346;});return _344;},_isNotesFeature:function(_347){var _348=_347.getLayer();var _349=_348?_348.types||null:null;if(!_349){return false;}var _34a=_347.attributes[_348.typeIdField];var _34b;_2c0.some(_349,function(type){if(type.id===_34a){_34b=type.templates;return true;}return false;});if(!_34b){return false;}var _34c=_34b[0]||null;if(!_34c){return false;}var _34d=this._isShapeTool(_34c.drawingTool)||null;return _34d?true:false;},_isValidLayer:function(_34e){var i;var _34f=this._settings.layerInfos;for(i=0;i<_34f.length;i++){var _350=_34f[i];if(_34e.id==_350.layerId){return true;}}return false;},_isShapeTool:function(_351){switch(_351){case _2d1.TOOL_ARROW:return Draw.ARROW;case _2d1.TOOL_LEFT_ARROW:return Draw.LEFT_ARROW;case _2d1.TOOL_RIGHT_ARROW:return Draw.RIGHT_ARROW;case _2d1.TOOL_UP_ARROW:return Draw.UP_ARROW;case _2d1.TOOL_DOWN_ARROW:return Draw.DOWN_ARROW;case _2d1.TOOL_CIRCLE:return Draw.CIRCLE;case _2d1.TOOL_ELLIPSE:return Draw.ELLIPSE;case _2d1.TOOL_TRIANGLE:return Draw.TRIANGLE;case _2d1.TOOL_RECTANGLE:return Draw.RECTANGLE;default:return null;}},_toDrawTool:function(_352,_353){var _354=_353.geometryType;switch(_352){case _2d1.TOOL_POINT:return Draw.POINT;case _2d1.TOOL_ARROW:return Draw.ARROW;case _2d1.TOOL_LEFT_ARROW:return Draw.LEFT_ARROW;case _2d1.TOOL_RIGHT_ARROW:return Draw.RIGHT_ARROW;case _2d1.TOOL_UP_ARROW:return Draw.UP_ARROW;case _2d1.TOOL_DOWN_ARROW:return Draw.DOWN_ARROW;case _2d1.TOOL_CIRCLE:return Draw.CIRCLE;case _2d1.TOOL_ELLIPSE:return Draw.ELLIPSE;case _2d1.TOOL_TRIANGLE:return Draw.TRIANGLE;case _2d1.TOOL_RECTANGLE:return Draw.RECTANGLE;case _2d1.TOOL_LINE:return Draw.POLYLINE;case _2d1.TOOL_POLYGON:return Draw.POLYGON;case _2d1.TOOL_FREEHAND:if(_354==="esriGeometryPolyline"){return Draw.FREEHAND_POLYLINE;}else{return Draw.FREEHAND_POLYGON;}break;default:var _355=Draw.POINT;if(_354==="esriGeometryPolyline"){_355=Draw.POLYLINE;if(this._settings.createOptions.polylineDrawTools[0]===_2de.CREATE_TOOL_FREEHAND_POLYLINE){_355=Draw.FREEHAND_POLYLINE;}}else{if(_354==="esriGeometryPolygon"){_355=Draw.POLYGON;if(this._settings.createOptions.polygonDrawTools[0]===_2de.CREATE_TOOL_FREEHAND_POLYGON){_355=Draw.FREEHAND_POLYGON;}}}return _355;}},_isModified:function(){var _356=this._editToolbar.getCurrentState();return ((_356.isModified||this._attributeChanged)&&_356.graphic)?_356.graphic:null;},_showInfoWindow:function(_357,_358){if(!this._customAttributeInspector){this._settings.map.infoWindow.show(_357,_358);}}});lang.mixin(_2de,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});if(has("extend-esri")){lang.setObject("dijit.editing.Editor",_2de,_2da);}return _2de;});},"esri/dijit/editing/toolbars/ToolbarBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dijit/Toolbar","dijit/ToolbarSeparator","esri/kernel","esri/lang"],function(_359,lang,_35a,_35b,has,_35c,_35d,_35e,_35f){var TBB=_359([_35c],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:true,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(_360,_361){if(!_360||!_360.settings){return;}this._tools=[];this._tbConnects=[];this._initialize(_360.settings);},postCreate:function(){this._createTools();this.deactivate();},destroy:function(){var tool;var _362=this._tools;for(tool in _362){if(_362.hasOwnProperty(tool)&&_35f.isDefined(this._tools[tool])){this._tools[tool].destroy();}}_35a.forEach(this._tbConnects,_35b.disconnect);this.inherited(arguments);},activate:function(_363){this._enabled=true;},deactivate:function(){var tool;this._enabled=false;this._layer=null;this._geometryType=null;var _364=this._tools;for(tool in _364){if(_364.hasOwnProperty(tool)){this._tools[tool].deactivate();this._tools[tool].setChecked(false);}}},isEnabled:function(){return this._enabled;},setActiveSymbol:function(_365){this._activeSymbol=_365;},_getSymbol:function(){},_createTools:function(){},_initialize:function(_366){this._settings=_366;this._toolbar=_366.drawToolbar;this._editToolbar=_366.editToolbar;this._initializeToolbar();},_activateTool:function(tool,_367){if(this._activeTool){this._activeTool.deactivate();}if(_367===true&&this._activeTool==this._tools[tool]){this._activeTool.setChecked(false);this._activeTool=null;}else{this._activeTool=this._tools[tool];this._activeTool.setChecked(true);this._activeTool.activate(null);}},_createSeparator:function(){this.addChild(new _35d());}});if(has("extend-esri")){lang.setObject("dijit.editing.toolbars.ToolbarBase",TBB,_35e);}return TBB;});},"esri/dijit/editing/Add":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase"],function(_368,lang,has,_369,_36a){var Add=_368(_36a,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(_36b){_36b=_36b||{};if(!_36b.featureLayer){console.error("In constructor of 'esri.dijit.editing.Add', featureLayer is not provided");return;}this._featureLayer=_36b.featureLayer;if(!_36b.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Add', no graphics provided");return;}this._addedGraphics=_36b.addedGraphics;},performUndo:function(){this._featureLayer.applyEdits(null,null,this._addedGraphics);},performRedo:function(){this._featureLayer.applyEdits(this._addedGraphics,null,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Add",Add,_369);}return Add;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"esri/dijit/editing/Update":function(){define("esri/dijit/editing/Update",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/OperationBase"],function(_36c,lang,has,_36d,_36e,_36f){var _370=_36c(_36f,{declaredClass:"esri.dijit.editing.Update",type:"edit",label:"Update Features",constructor:function(_371){var i;_371=_371||{};if(!_371.featureLayer){console.error("In constructor of 'esri.dijit.editing.Update', featureLayer not provided");return;}this._featureLayer=_371.featureLayer;if(!_371.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(i=0;i<_371.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_371.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_371.preUpdatedGraphics[i].attributes);}if(!_371.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_371.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_371.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_371.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(lang.clone(_371.postUpdatedGraphics[i].attributes));}},performUndo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_36e.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);},performRedo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_36e.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Update",_370,_36d);}return _370;});},"dijit/form/_DateTimeTextBox":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/_DateTimeTextBox",["dojo/date","dojo/date/locale","dojo/date/stamp","dojo/_base/declare","dojo/_base/lang","./RangeBoundTextBox","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(date,_372,_373,_374,lang,_375,_376,_377){new Date("X");var _378=_374("dijit.form._DateTimeTextBox",[_375,_376],{templateString:_377,hasDownArrow:true,cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},pattern:_372.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},compare:function(val1,val2){var _379=this._isInvalidDate(val1);var _37a=this._isInvalidDate(val2);return _379?(_37a?0:-1):(_37a?1:date.compare(val1,val2,this._selector));},forceWidth:true,format:function(_37b,_37c){if(!_37b){return "";}return this.dateLocaleModule.format(_37b,_37c);},"parse":function(_37d,_37e){return this.dateLocaleModule.parse(_37d,_37e)||(this._isEmpty(_37d)?null:undefined);},serialize:function(val,_37f){if(val.toGregorian){val=val.toGregorian();}return _373.toISOString(val,_37f);},dropDownDefaultValue:new Date(),value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(_380){this.dateModule=_380.datePackage?lang.getObject(_380.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_380.datePackage?lang.getObject(_380.datePackage+".locale",false):_372;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString();},buildRendering:function(){this.inherited(arguments);if(!this.hasDownArrow){this._buttonNode.style.display="none";}if(!this.hasDownArrow){this._buttonNode=this.domNode;this.baseClass+=" dijitComboBoxOpenOnClick";}},_setConstraintsAttr:function(_381){_381.selector=this._selector;_381.fullYear=true;var _382=_373.fromISOString;if(typeof _381.min=="string"){_381.min=_382(_381.min);}if(typeof _381.max=="string"){_381.max=_382(_381.max);}this.inherited(arguments);},_isInvalidDate:function(_383){return !_383||isNaN(_383)||typeof _383!="object"||_383.toString()==this._invalidDate;},_setValueAttr:function(_384,_385,_386){if(_384!==undefined){if(typeof _384=="string"){_384=_373.fromISOString(_384);}if(this._isInvalidDate(_384)){_384=null;}if(_384 instanceof Date&&!(this.dateClassObj instanceof Date)){_384=new this.dateClassObj(_384);}}this.inherited(arguments);if(this.value instanceof Date){this.filterString="";}if(this.dropDown){this.dropDown.set("value",_384,false);}},_set:function(attr,_387){if(attr=="value"&&this.value instanceof Date&&this.compare(_387,this.value)==0){return;}this.inherited(arguments);},_setDropDownDefaultValueAttr:function(val){if(this._isInvalidDate(val)){val=new this.dateClassObj();}this.dropDownDefaultValue=val;},openDropDown:function(_388){if(this.dropDown){this.dropDown.destroy();}var _389=lang.isString(this.popupClass)?lang.getObject(this.popupClass,false):this.popupClass,_38a=this,_38b=this.get("value");this.dropDown=new _389({onChange:function(_38c){_38a.set("value",_38c,true);},id:this.id+"_popup",dir:_38a.dir,lang:_38a.lang,value:_38b,currentFocus:!this._isInvalidDate(_38b)?_38b:this.dropDownDefaultValue,constraints:_38a.constraints,filterString:_38a.filterString,datePackage:_38a.params.datePackage,isDisabledDate:function(date){return !_38a.rangeCheck(date,_38a.constraints);}});this.inherited(arguments);},_getDisplayedValueAttr:function(){return this.textbox.value;},_setDisplayedValueAttr:function(_38d,_38e){this._setValueAttr(this.parse(_38d,this.constraints),_38e,_38d);}});return _378;});},"esri/layers/FeatureTemplate":function(){define("esri/layers/FeatureTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/lang","esri/graphic"],function(_38f,lang,has,_390,_391,_392){var _393=_38f(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(json){if(json&&lang.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _394=json.prototype;this.prototype=new _392(_394.geometry,null,_394.attributes);}},toJson:function(){return _391.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});lang.mixin(_393,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});if(has("extend-esri")){lang.setObject("layers.FeatureTemplate",_393,_390);}return _393;});},"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n","dijit/_editor/_Plugin":function(){define("dijit/_editor/_Plugin",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../form/Button"],function(_395,_396,lang,_397){var _398=_396("dijit._editor._Plugin",null,{constructor:function(args){this.params=args||{};lang.mixin(this,this.params);this._connects=[];this._attrPairNames={};},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:true,buttonClass:_397,disabled:false,getLabel:function(key){return this.editor.commands[key];},_initButton:function(){if(this.command.length){var _399=this.getLabel(this.command),_39a=this.editor,_39b=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);if(!this.button){var _39c=lang.mixin({label:_399,ownerDocument:_39a.ownerDocument,dir:_39a.dir,lang:_39a.lang,showLabel:false,iconClass:_39b,dropDown:this.dropDown,tabIndex:"-1"},this.params||{});this.button=new this.buttonClass(_39c);}}if(this.get("disabled")&&this.button){this.button.set("disabled",this.get("disabled"));}},destroy:function(){var h;while(h=this._connects.pop()){h.remove();}if(this.dropDown){this.dropDown.destroyRecursive();}},connect:function(o,f,tf){this._connects.push(_395.connect(o,f,this,tf));},updateState:function(){var e=this.editor,c=this.command,_39d,_39e;if(!e||!e.isLoaded||!c.length){return;}var _39f=this.get("disabled");if(this.button){try{_39e=!_39f&&e.queryCommandEnabled(c);if(this.enabled!==_39e){this.enabled=_39e;this.button.set("disabled",!_39e);}if(_39e){if(typeof this.button.checked=="boolean"){_39d=e.queryCommandState(c);if(this.checked!==_39d){this.checked=_39d;this.button.set("checked",e.queryCommandState(c));}}}}catch(e){console.log(e);}}},setEditor:function(_3a0){this.editor=_3a0;this._initButton();if(this.button&&this.useDefaultCommand){if(this.editor.queryCommandAvailable(this.command)){this.connect(this.button,"onClick",lang.hitch(this.editor,"execCommand",this.command,this.commandArg));}else{this.button.domNode.style.display="none";}}this.connect(this.editor,"onNormalizedDisplayChanged","updateState");},setToolbar:function(_3a1){if(this.button){_3a1.addChild(this.button);}},set:function(name,_3a2){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _3a3=this._getAttrNames(name);if(this[_3a3.s]){var _3a4=this[_3a3.s].apply(this,Array.prototype.slice.call(arguments,1));}else{this._set(name,_3a2);}return _3a4||this;},get:function(name){var _3a5=this._getAttrNames(name);return this[_3a5.g]?this[_3a5.g]():this[name];},_setDisabledAttr:function(_3a6){this.disabled=_3a6;this.updateState();},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(name,_3a7){this[name]=_3a7;}});_398.registry={};return _398;});},"esri/layers/FeatureEditResult":function(){define("esri/layers/FeatureEditResult",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_3a8,lang,has,_3a9){var _3aa=_3a8(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(json){if(json&&lang.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});if(has("extend-esri")){lang.setObject("layers.FeatureEditResult",_3aa,_3a9);}return _3aa;});},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../_base/Deferred"],function(_3ab,lang,_3ac){var _3ad=function(_3ae){if(!_3ae){return _3ae;}if(_3ae.then){_3ae=lang.delegate(_3ae);}function _3af(_3b0){if(!_3ae[_3b0]){_3ae[_3b0]=function(){var args=arguments;return _3ac.when(_3ae,function(_3b1){Array.prototype.unshift.call(args,_3b1);return _3ad(_3ab[_3b0].apply(_3ab,args));});};}};_3af("forEach");_3af("filter");_3af("map");if(!_3ae.total){_3ae.total=_3ac.when(_3ae,function(_3b2){return _3b2.length;});}return _3ae;};lang.setObject("dojo.store.util.QueryResults",_3ad);return _3ad;});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _3b3={};lang.setObject("dojo.data.util.sorter",_3b3);_3b3.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_3b3.createSortFunction=function(_3b4,_3b5){var _3b6=[];function _3b7(attr,dir,comp,s){return function(_3b8,_3b9){var a=s.getValue(_3b8,attr);var b=s.getValue(_3b9,attr);return dir*comp(a,b);};};var _3ba;var map=_3b5.comparatorMap;var bc=_3b3.basicComparator;for(var i=0;i<_3b4.length;i++){_3ba=_3b4[i];var attr=_3ba.attribute;if(attr){var dir=(_3ba.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_3b6.push(_3b7(attr,dir,comp,_3b5));}}return function(rowA,rowB){var i=0;while(i<_3b6.length){var ret=_3b6[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _3b3;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_3bb,on,_3bc,_3bd){return _3bb("dojox.gfx.Mover",null,{constructor:function(_3be,e,host){this.shape=_3be;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_3bf=on(d,_3bc.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_3bc.move,lang.hitch(this,"onMouseMove")),on(d,_3bc.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_3bd,"stop")),on(d,"selectstart",lang.hitch(_3bd,"stop")),_3bf];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_3bd.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_3c0){_3c0.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_3c1,_3c2,lang,_3c3){return _3c1("dojox.grid.Selection",null,{constructor:function(_3c4){this.grid=_3c4;this.selected=[];this.setMode(_3c4.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_3c5){return this.grid.onCanSelect(_3c5);},onCanDeselect:function(_3c6){return this.grid.onCanDeselect(_3c6);},onSelected:function(_3c7){},onDeselected:function(_3c8){},onChanging:function(){},onChanged:function(){},isSelected:function(_3c9){if(this.mode=="none"){return false;}return this.selected[_3c9];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_3ca){if(this.mode=="none"){return -1;}for(var i=_3ca+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _3cb=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_3cb.push(i);}}return _3cb;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_3cc){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_3cc);this.addToSelection(_3cc);}else{this.toggleSelect(_3cc);}},addToSelection:function(_3cd){if(this.mode=="none"){return;}if(lang.isArray(_3cd)){_3c2.forEach(_3cd,this.addToSelection,this);return;}_3cd=Number(_3cd);if(this.selected[_3cd]){this.selectedIndex=_3cd;}else{if(this.onCanSelect(_3cd)!==false){this.selectedIndex=_3cd;var _3ce=this.grid.getRowNode(_3cd);if(_3ce){_3c3.set(_3ce,"aria-selected","true");}this._beginUpdate();this.selected[_3cd]=true;this.onSelected(_3cd);this._endUpdate();}}},deselect:function(_3cf){if(this.mode=="none"){return;}if(lang.isArray(_3cf)){_3c2.forEach(_3cf,this.deselect,this);return;}_3cf=Number(_3cf);if(this.selectedIndex==_3cf){this.selectedIndex=-1;}if(this.selected[_3cf]){if(this.onCanDeselect(_3cf)===false){return;}var _3d0=this.grid.getRowNode(_3cf);if(_3d0){_3c3.set(_3d0,"aria-selected","false");}this._beginUpdate();delete this.selected[_3cf];this.onDeselected(_3cf);this._endUpdate();}},setSelected:function(_3d1,_3d2){this[(_3d2?"addToSelection":"deselect")](_3d1);},toggleSelect:function(_3d3){if(lang.isArray(_3d3)){_3c2.forEach(_3d3,this.toggleSelect,this);return;}this.setSelected(_3d3,!this.selected[_3d3]);},_range:function(_3d4,inTo,func){var s=(_3d4>=0?_3d4:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_3d5,inTo){this._range(_3d5,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_3d6,inTo){this._range(_3d6,inTo,lang.hitch(this,"deselect"));},insert:function(_3d7){this.selected.splice(_3d7,0,false);if(this.selectedIndex>=_3d7){this.selectedIndex++;}},remove:function(_3d8){this.selected.splice(_3d8,1);if(this.selectedIndex>=_3d8){this.selectedIndex--;}},deselectAll:function(_3d9){for(var i in this.selected){if((i!=_3d9)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_3da,_3db,_3dc){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_3da);}else{if(!_3dc||this.rangeStartIndex<0){this.rangeStartIndex=_3da;}if(!_3db){this.deselectAll(_3da);}if(_3dc){this.selectRange(this.rangeStartIndex,_3da);}else{if(_3db){this.toggleSelect(_3da);}else{this.addToSelection(_3da);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_3dd,lang,_3de){var _3df=function(_3e0,_3e1){if(_3e0.style.cssText==undefined){_3e0.setAttribute("style",_3e1);}else{_3e0.style.cssText=_3e1;}};return _3dd("dojox.grid._RowManager",null,{constructor:function(_3e2){this.grid=_3e2;},linesToEms:2,overRow:-2,prepareStylingRow:function(_3e3,_3e4){return {index:_3e3,node:_3e4,odd:Boolean(_3e3&1),selected:!!this.grid.selection.isSelected(_3e3),over:this.isOver(_3e3),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_3e5,_3e6){var row=this.prepareStylingRow(_3e5,_3e6);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_3e7){var i=_3e7;i.node.className=i.customClasses;var h=i.node.style.height;_3df(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_3e8){this.grid.updateRowStyles(_3e8);},setOverRow:function(_3e9){var last=this.overRow;this.overRow=_3e9;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_3ea){return (this.overRow==_3ea&&!_3de.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"esri/dijit/editing/tools/DropDownToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dojo/dom-style","dijit/registry","dijit/Menu","dijit/form/ComboButton","esri/dijit/editing/tools/ToolBase","esri/kernel","esri/lang"],function(_3eb,lang,has,_3ec,_3ed,Menu,_3ee,_3ef,_3f0,_3f1){var DDTB=_3eb([_3ee,_3ef],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:false,_checked:false,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){var tool;var _3f2=this._tools;for(tool in _3f2){if(_3f2.hasOwnProperty(tool)&&_3f1.isDefined(_3f2[tool])){_3f2[tool].destroy();}}this.inherited(arguments);},_createTools:function(){var i;var mnu=new Menu();this.dropDown=mnu;for(i in this._tools){if(this._tools.hasOwnProperty(i)){mnu.addChild(this._tools[i]);}}this._activeTool=mnu.getChildren()[0];this._updateUI();},activate:function(_3f3){this.inherited(arguments);if(!this._activeTool){this._activateDefaultTool();}else{this._activeTool.activate();}},deactivate:function(){this.inherited(arguments);if(this._activeTool){this._activeTool.deactivate();}},enable:function(_3f4){var tool;for(tool in this._tools){if(this._tools.hasOwnProperty(tool)){this._tools[tool].enable(_3f4);}}this.setEnabled(true);this.inherited(arguments);},setChecked:function(_3f5){this._checked=_3f5;this._updateUI();},_onDrawEnd:function(_3f6){},onLayerChange:function(_3f7,type,_3f8){this._activeTool=null;this._activeType=type;this._activeTemplate=_3f8;this._activeLayer=_3f7;},onItemClicked:function(_3f9,evt){if(this._activeTool){this._activeTool.deactivate();}this._activeTool=_3ed.byId(_3f9);if(this._checked===false){this._onClick();}else{this._updateUI();if(this._activeTool){this._activeTool.activate();this._activeTool.setChecked(true);}}},_onClick:function(evt){if(this._enabled===false){return;}this._checked=!this._checked;this.inherited(arguments);},_updateUI:function(){this.attr("disabled",!this._enabled);_3ec.set(this.focusNode,{outline:"none"});_3ec.set(this.titleNode,{padding:"0px",border:"none"});if(this._checked){_3ec.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"});}else{_3ec.set(this.titleNode,{backgroundColor:"",border:""});}if(this._activeTool){this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon);this.attr("label",this._activeTool.label);}}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.DropDownToolBase",DDTB,_3f0);}return DDTB;});},"esri/dijit/editing/AttachmentEditor":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/kernel","dojo/has","dojo/query","dojo/io-query","dojo/dom-attr","dijit/_Widget","dijit/_Templated","esri/kernel","esri/lang","esri/domUtils","dojo/text!esri/dijit/editing/templates/AttachmentEditor.html","dojo/i18n!esri/nls/jsapi","dojo/NodeList-dom"],function(_3fa,_3fb,lang,_3fc,_3fd,_3fe,has,_3ff,_400,_401,_402,_403,_404,_405,_406,_407,_408){var AE=_3fb([_402,_403],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:true,templateString:_407,basePath:_3fa.toUrl("esri/dijit/editing")+"/",_listHtml:"<span id='node_${oid}_${attid}'><a href='${href}' target='_blank'>${name}</a>",_deleteBtnHtml:"(<span style='cursor:pointer;color:red;font-weight:bold;' class='deleteAttachment' id='${attid}');'>X</span>)",_endHtml:"<br/></span>",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(_409,_40a){lang.mixin(this,_408.widgets.attachmentEditor);},startup:function(){this.inherited(arguments);this._uploadField_connect=_3fc.connect(this._uploadField,"onchange",this,"_addAttachment");this._uploadFieldFocus_connect=_3fc.connect(this._uploadField,"onfocus",lang.hitch(this,function(e){_406.hide(this._attachmentError);}));},destroy:function(){_3fd.forEach(this._aeConnects,_3fc.disconnect);_3fc.disconnect(this._uploadField_connect);_3fc.disconnect(this._uploadFieldFocus_connect);this.inherited(arguments);},showAttachments:function(_40b,_40c){var list=this._attachmentList;list.innerHTML=this.NLS_none;this._uploadField.value="";_3fd.forEach(this.domNode.children,function(_40d,idx){_406.show(_40d);});_406.hide(this._attachmentError);if(!_40b){return;}this._featureLayer=_40b.getLayer()||_40c;if(!this._featureLayer){return;}if(this._featureLayer.declaredClass!=="esri.layers.FeatureLayer"||!this._featureLayer.getEditCapabilities){_406.hide(this._uploadForm);_3fd.forEach(this.domNode.children,function(_40e,idx){_406.hide(_40e);});return;}this._currentLayerId=this._featureLayer.id;if(!this._layerEditingCapChecked[this._currentLayerId]){this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities();this._layerEditingCapChecked[this._currentLayerId]=true;}this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:_40b}).canUpdate;this._oid=_40b.attributes[this._featureLayer.objectIdField];this._getAttachments(_40b);},_getAttachments:function(_40f){if(!this._featureLayer||!this._featureLayer.queryAttachmentInfos){return;}this._featureLayer.queryAttachmentInfos(this._oid,lang.hitch(this,"_onQueryAttachmentInfosComplete"));},_addAttachment:function(){_406.hide(this._attachmentError);if(!this._featureLayer||!this._featureLayer.addAttachment){return;}this._featureLayer.addAttachment(this._oid,this._uploadForm,lang.hitch(this,"_onAddAttachmentComplete"),lang.hitch(this,"_onAddAttachmentError"));},_deleteAttachment:function(oid,_410){this._featureLayer.deleteAttachments(oid,[_410],lang.hitch(this,"_onDeleteAttachmentComplete"));},_onQueryAttachmentInfosComplete:function(_411){var _412=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";if((!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate)||(!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate)){_412=this._listHtml+this._endHtml;this._uploadForm.style.display="none";}else{if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_412=this._listHtml+this._endHtml;}}var list=this._attachmentList,_413=_3fd.map(_411,lang.hitch(this,function(info){return _405.substitute({href:info.url,name:info.name,oid:info.objectId,attid:info.id},_412);}));list.innerHTML=_413.join("")||this.NLS_none;this._updateConnects();},_onAddAttachmentComplete:function(_414){var _415=this._uploadField;var _416=_415.value;var pos=_416.lastIndexOf("\\");if(pos>-1){_416=_416.substring(pos+1,_416.length);}_416=_416.replace(/\ /g,"_");var list=this._attachmentList,_417=_400.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var _418=this._listHtml+this._deleteBtnHtml+this._endHtml;if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_418=this._listHtml+this._endHtml;}var link=_405.substitute({href:this._featureLayer._url.path+"/"+_414.objectId+"/attachments/"+_414.attachmentId+(_417?("?"+_417):""),name:_416,oid:_414.objectId,attid:_414.attachmentId},_418);list.innerHTML=list.innerHTML==this.NLS_none?link:(list.innerHTML+link);this._updateConnects();_415.value="";},_onAddAttachmentError:function(_419){if(_419&&_405.isDefined(_419.code)){var _41a,_41b=this._attachmentError;if(_419.code===400){_41a=this.NLS_fileNotSupported;}else{_41a=_419.message||(_419.details&&_419.details.length&&_419.details[0]);}_401.set(_41b,"innerHTML",(_41a||this.NLS_error));_406.show(_41b);}},_onDeleteAttachmentComplete:function(_41c){var _41d=_3fd.every(_41c,function(_41e){return _41e.success;}),list=this._attachmentList;if(_41d){_3fe.query("#node_"+_41c[0].objectId+"_"+_41c[0].attachmentId).orphan();if(!list.children||!list.children.length){list.innerHTML=this.NLS_none;}}},_updateConnects:function(){_3fd.forEach(this._aeConnects,_3fc.disconnect);_3fe.query(".deleteAttachment").forEach(function(item){this._aeConnects.push(_3fc.connect(item,"onclick",lang.hitch(this,"_deleteAttachment",this._oid,item.id)));},this);}});if(has("extend-esri")){lang.setObject("dijit.editing.AttachmentEditor",AE,_404);}return AE;});},"esri/dijit/editing/tools/Union":function(){define("esri/dijit/editing/tools/Union",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/graphicsUtils","esri/graphic","esri/toolbars/draw","esri/dijit/editing/Union","esri/dijit/editing/tools/ButtonToolBase","esri/kernel"],function(_41f,lang,_420,has,_421,_422,Draw,_423,_424,_425){var _426=_41f([_424],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:Draw.POLYLINE,_enabled:true,_label:"NLS_unionLbl",_onClick:function(evt){this._settings.editor._activeTool="UNION";var _427=this._settings.layers;var _428=_420.filter(_427,function(item){return (item.geometryType==="esriGeometryPolygon")&&(item.visible&&item._isMapAtVisibleScale());});var _429=[];var _42a=0;_420.forEach(_428,function(_42b,idx){var _42c=_42b.getSelectedFeatures();if(_42c.length>=2){_42a++;var _42d=_420.map(_42c,function(item){return new _422(lang.clone(item.toJson()));});this._settings.geometryService.union(_421.getGeometries(_42c),lang.hitch(this,function(_42e){var _42f=[_42c.pop().setGeometry(_42e)];_429.push({layer:_42b,updates:_42f,deletes:_42c,preUpdates:_42d});_42a--;if(_42a<=0){this.onApplyEdits(_429,lang.hitch(this,function(){if(this._settings.undoRedoManager){var _430=this._settings.undoRedoManager;_420.forEach(this._edits,lang.hitch(this,function(edit){_430.add(new _423({featureLayer:edit.layer,addedGraphics:edit.deletes,preUpdatedGraphics:edit.preUpdates,postUpdatedGraphics:edit.updates}));}),this);}this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}}));}},this);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Union",_426,_425);}return _426;});},"dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_431,win,dom,_432,_433,_434,has,_435){return _431("dojo.dnd.Avatar",null,{constructor:function(_436){this.manager=_436;this.construct();},construct:function(){var a=_434.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_437=this.manager.source,node,b=_434.create("tbody",null,a),tr=_434.create("tr",null,b),td=_434.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_434.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_434.create("span",{innerHTML:_437.generateText?this._generateText():""},td);_432.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_437.creator){node=_437._normalizedCreator(_437.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _438=_434.create("table"),_439=_434.create("tbody",null,_438);_439.appendChild(node);node=_438;}}node.id="";tr=_434.create("tr",null,b);td=_434.create("td",null,tr);td.appendChild(node);_432.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_434.destroy(this.node);this.node=false;},update:function(){_433.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_435(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/dijit/editing/tools/MenuItemBase","esri/kernel"],function(_43a,lang,has,_43b,_43c){var Edit=_43a([_43b],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(_43d){this._enabled=_43d===this._geomType;this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Edit",Edit,_43c);}return Edit;});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_43e,_43f,lang,util,html){var _440=function(_441){var i=0,n,p=_441.parentNode;while((n=p.childNodes[i++])){if(n==_441){return i-1;}}return -1;};var _442=function(_443){if(!_443){return;}dojo.forEach(_43e.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_443,true)){w.destroy();}});};var _444=function(_445){var node=html.byId(_445);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _446=function(_447,_448){var _449=[];var i=0,n;while((n=_447.childNodes[i])){i++;if(_444(n)==_448){_449.push(n);}}return _449;};var _44a=function(_44b){return _446(_44b,"div");};return _43f("dojox.grid._Scroller",null,{constructor:function(_44c){this.setContentNodes(_44c);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_44d,_44e,_44f){switch(arguments.length){case 3:this.rowsPerPage=_44f;case 2:this.keepRows=_44e;case 1:this.rowCount=_44d;default:break;}this.defaultPageHeight=(this.grid.rowHeight>0?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_450,_451){return _450?(Math.ceil(_450/_451)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_452){this.keepRows=_452;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_453){this.contentNodes=_453;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_454){this.invalidateNodes();this.rowCount=_454;var _455=this.pageCount;if(_455===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_455){for(var i=_455-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_455){this.height+=this.defaultPageHeight*(this.pageCount-_455-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_456){return Boolean(this.getDefaultPageNode(_456));},measurePage:function(_457){if(this.grid.rowHeight){return ((_457+1)*this.rowsPerPage>this.rowCount?this.rowCount-_457*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight;}var n=this.getDefaultPageNode(_457);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_458,_459){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_458].style.top=_459+"px";}},repositionPages:function(_45a){var _45b=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_45b[_45a];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_45a):0);for(var p=_45a+1;p<=last;p++){n=_45b[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_45c){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_45c]);}},preparePage:function(_45d,_45e){var p=(_45e?this.popPage():null);for(var i=0;i<this.colCount;i++){var _45f=this.pageNodes[i];var _460=(p===null?this.createPageNode():this.invalidatePageNode(p,_45f));_460.pageIndex=_45d;_45f[_45d]=_460;}},renderPage:function(_461){var _462=[];var i,j;for(i=0;i<this.colCount;i++){_462[i]=this.pageNodes[i][_461];}for(i=0,j=_461*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_462);}},removePage:function(_463){for(var i=0,j=_463*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_464){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_464,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_465){},pacifying:false,pacifyTicks:200,setPacifying:function(_466){if(this.pacifying!=_466){this.pacifying=_466;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _467=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _467;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _468=(!this._invalidating);if(!_468){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_468=true;}}if(_468){this.needPage(this.page,this.pageTop);}var _469=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _46a=this.getPageHeight(this.page);this.averageRowHeight=(_46a>0&&_469>0)?(_46a/_469):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _46b=this.pageCount-1;var _46c=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_46b]=_46c;return _46c;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_46d,_46e,_46f){if(this.pageExists(_46d)){var oh=this.getPageHeight(_46d);var h=(this.measurePage(_46d));if(h===undefined){h=oh;}this.pageHeights[_46d]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_46e)){if(!_46f){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_46d);}}else{this.repositionPages(_46d);}}return h;}return 0;},rowHeightChanged:function(_470,_471){this.updatePageHeight(Math.floor(_470/this.rowsPerPage),false,_471);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_472){var ph=this.pageHeights[_472];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_473){return this.stack.push(_473);},popPage:function(){return this.stack.shift();},findPage:function(_474){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_474){break;}}this.page=i;this.pageTop=h;},buildPage:function(_475,_476,_477){this.preparePage(_475,_476);this.positionPage(_475,_477);this.installPage(_475);this.renderPage(_475);this.pushPage(_475);},needPage:function(_478,_479){var h=this.getPageHeight(_478),oh=h;if(!this.pageExists(_478)){this.buildPage(_478,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_479);h=this.updatePageHeight(_478,true);}else{this.positionPage(_478,_479);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_47a){this.grid.scrollTop=_47a;if(this.colCount){this.startPacify();this.findPage(_47a);var h=this.height;var b=this.getScrollBottom(_47a);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_47a);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_47b){return (this.windowHeight>=0?_47b+this.windowHeight:-1);},processNodeEvent:function(e,_47c){var t=e.target;while(t&&(t!=_47c)&&t.parentNode&&(t.parentNode.parentNode!=_47c)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_47c)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_440(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_47d,_47e){},removeRow:function(_47f){},getDefaultPageNode:function(_480){return this.getDefaultNodes()[_480];},positionPageNode:function(_481,_482){},getPageNodePosition:function(_483){return _483.offsetTop;},invalidatePageNode:function(_484,_485){var p=_485[_484];if(p){delete _485[_484];this.removePage(_484,p);_442(p);p.innerHTML="";}return p;},getPageRow:function(_486){return _486*this.rowsPerPage;},getLastPageRow:function(_487){return Math.min(this.rowCount,this.getPageRow(_487+1))-1;},getFirstVisibleRow:function(_488,_489,_48a){if(!this.pageExists(_488)){return 0;}var row=this.getPageRow(_488);var _48b=this.getDefaultNodes();var rows=_44a(_48b[_488]);for(var i=0,l=rows.length;i<l&&_489<_48a;i++,row++){_489+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_48c,_48d,_48e){if(!this.pageExists(_48c)){return 0;}var _48f=this.getDefaultNodes();var row=this.getLastPageRow(_48c);var rows=_44a(_48f[_48c]);for(var i=rows.length-1;i>=0&&_48d>_48e;i--,row--){_48d-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_490){var _491=this.getDefaultNodes();var rows=_44a(_491[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_490){this.offset=h-(t-_490);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_492){var _493=Math.floor(_492/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_493;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_493;this.needPage(_493,this.pageTop);var _494=this.getDefaultNodes();var rows=_44a(_494[_493]);var r=_492-this.rowsPerPage*_493;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dijit/ToolbarSeparator":function(){define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_495,dom,_496,_497){return _495("dijit.ToolbarSeparator",[_496,_497],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _498={};lang.setObject("dojo.data.util.filter",_498);_498.patternToRegExp=function(_499,_49a){var rxp="^";var c=null;for(var i=0;i<_499.length;i++){c=_499.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_499.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_49a){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _498;});},"url:esri/dijit/editing/templates/TemplatePicker.html":"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>","esri/toolbars/_GraphicMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/Mover","dojox/gfx/matrix","esri/kernel","esri/geometry/webMercatorUtils","esri/geometry/ScreenPoint"],function(_49b,lang,_49c,_49d,has,_49e,_49f,_4a0,_4a1,_4a2,_4a3,_4a4){var GM=_49b(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(_4a5,map,_4a6){this.graphic=_4a5;this.map=map;this.toolbar=_4a6;this._enableGraphicMover();this._moved=false;},refresh:function(_4a7){var _4a8=this.graphic.getDojoShape();if(_4a8&&(_4a7||!_4a8._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _4a9=this.graphic,_4aa=_4a9.getDojoShape();if(_4aa){_4aa._hostGraphic=_4a9;this._moveable=new _49f(_4aa,{mover:GM.Mover});this._moveStartHandle=_49c.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=_49c.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_49c.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=_49c.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_4aa.getEventSource();if(node){_49e.set(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _4ab=this._moveable;if(_4ab){_49c.disconnect(this._moveStartHandle);_49c.disconnect(this._firstMoveHandle);_49c.disconnect(this._movingHandle);_49c.disconnect(this._moveStopHandle);var _4ac=_4ab.shape;if(_4ac){_4ac._hostGraphic=null;var node=_4ac.getEventSource();if(node){_49e.set(node,"cursor",null);}}_4ab.destroy();}this._moveable=null;},_moveStartHandler:function(){var _4ad=this.graphic,map=this.map;this._startTx=_4ad.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_4ad);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_4ae){this.toolbar.onGraphicMove(this.graphic,_4ae.shape.getTransform());},_moveStopHandler:function(_4af){var _4b0=this.graphic,_4b1=this.toolbar,map=this.map,mx=_4a1,_4b2=_4b1._geo?_4a3.geographicToWebMercator(_4b0.geometry):_4b0.geometry,type=_4b2.type,_4b3=_4b0.getDojoShape(),tx=_4b3.getTransform();if(_49d.toJson(tx)!==_49d.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _4b4=[tx,mx.invert(this._startTx)],_4b5;if(map.snappingManager){_4b5=map.snappingManager._snappingPoint;}_4b2=_4b5||map.toMap(mx.multiplyPoint(_4b4,map.toScreen(_4b2,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_4b2=this._updatePolyGeometry(_4b2,_4b2.paths,tx);break;case "polygon":_4b2=this._updatePolyGeometry(_4b2,_4b2.rings,tx);break;}_4b3.setTransform(null);_4b0.setGeometry(_4b1._geo?_4a3.webMercatorToGeographic(_4b2,true):_4b2);}else{this._moved=false;}_4b1._endOperation("MOVE");_4b1.onGraphicMoveStop(_4b0,tx);if(!this._moved){var e=_4af.__e,_4b6=this.map.position,pt=new _4a4(e.pageX-_4b6.x,e.pageY-_4b6.y);_4b1.onGraphicClick(_4b0,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_4b7,_4b8,_4b9){var map=this.map,_4ba=_4b7.getPoint(0,0),_4bb=map.toMap(map.toScreen(_4ba).offset(_4b9.dx,_4b9.dy)),_4bc=_4bb.x-_4ba.x,_4bd=_4bb.y-_4ba.y,i,j,seg,_4be;for(i=0;i<_4b8.length;i++){seg=_4b8[i];for(j=0;j<seg.length;j++){_4be=_4b7.getPoint(i,j);_4b7.setPoint(i,j,_4be.offset(_4bc,_4bd));}}return _4b7;}});GM.Mover=_49b(_4a0,{declaredClass:"esri.toolbars._Mover",constructor:function(_4bf,e,host){this.__e=e;}});if(has("extend-esri")){lang.setObject("toolbars._GraphicMover",GM,_4a2);lang.setObject("toolbars._Mover",GM.Mover,_4a2);}return GM;});},"dijit/_editor/html":function(){define("dijit/_editor/html",["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(_4c0,lang,has){var _4c1={};lang.setObject("dijit._editor.html",_4c1);var _4c2=_4c1.escapeXml=function(str,_4c3){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_4c3){str=str.replace(/'/gm,"&#39;");}return str;};_4c1.getNodeHtml=function(node){var _4c4=[];_4c1.getNodeHtmlHelper(node,_4c4);return _4c4.join("");};_4c1.getNodeHtmlHelper=function(node,_4c5){switch(node.nodeType){case 1:var _4c6=node.nodeName.toLowerCase();if(!_4c6||_4c6.charAt(0)=="/"){return "";}_4c5.push("<",_4c6);var _4c7=[],_4c8={};var attr;if(has("dom-attributes-explicit")||has("dom-attributes-specified-flag")){var i=0;while((attr=node.attributes[i++])){var n=attr.name;if(n.substr(0,3)!=="_dj"&&(!has("dom-attributes-specified-flag")||attr.specified)&&!(n in _4c8)){var v=attr.value;if(n=="src"||n=="href"){if(node.getAttribute("_djrealurl")){v=node.getAttribute("_djrealurl");}}if(has("ie")===8&&n==="style"){v=v.replace("HEIGHT:","height:").replace("WIDTH:","width:");}_4c7.push([n,v]);_4c8[n]=v;}}}else{var _4c9=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false);var s=_4c9.outerHTML;var _4ca=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;var _4cb=s.match(_4ca);s=s.substr(0,s.indexOf(">"));_4c0.forEach(_4cb,function(attr){if(attr){var idx=attr.indexOf("=");if(idx>0){var key=attr.substring(0,idx);if(key.substr(0,3)!="_dj"){if(key=="src"||key=="href"){if(node.getAttribute("_djrealurl")){_4c7.push([key,node.getAttribute("_djrealurl")]);return;}}var val,_4cc;switch(key){case "style":val=node.style.cssText.toLowerCase();break;case "class":val=node.className;break;case "width":if(_4c6==="img"){_4cc=/width=(\S+)/i.exec(s);if(_4cc){val=_4cc[1];}break;}case "height":if(_4c6==="img"){_4cc=/height=(\S+)/i.exec(s);if(_4cc){val=_4cc[1];}break;}default:val=node.getAttribute(key);}if(val!=null){_4c7.push([key,val.toString()]);}}}}},this);}_4c7.sort(function(a,b){return a[0]<b[0]?-1:(a[0]==b[0]?0:1);});var j=0;while((attr=_4c7[j++])){_4c5.push(" ",attr[0],"=\"",(typeof attr[1]==="string"?_4c2(attr[1],true):attr[1]),"\"");}switch(_4c6){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":_4c5.push(" />");break;case "script":_4c5.push(">",node.innerHTML,"</",_4c6,">");break;default:_4c5.push(">");if(node.hasChildNodes()){_4c1.getChildrenHtmlHelper(node,_4c5);}_4c5.push("</",_4c6,">");}break;case 4:case 3:_4c5.push(_4c2(node.nodeValue,true));break;case 8:_4c5.push("<!--",_4c2(node.nodeValue,true),"-->");break;default:_4c5.push("<!-- Element not recognized - Type: ",node.nodeType," Name: ",node.nodeName,"-->");}};_4c1.getChildrenHtml=function(node){var _4cd=[];_4c1.getChildrenHtmlHelper(node,_4cd);return _4cd.join("");};_4c1.getChildrenHtmlHelper=function(dom,_4ce){if(!dom){return;}var _4cf=dom["childNodes"]||dom;var _4d0=!has("ie")||_4cf!==dom;var node,i=0;while((node=_4cf[i++])){if(!_4d0||node.parentNode==dom){_4c1.getNodeHtmlHelper(node,_4ce);}}};return _4c1;});},"url:esri/dijit/editing/templates/AttachmentEditor.html":"<div class=\"attachmentEditor\">\r\n    <br />\r\n    <div>\r\n        <b>${NLS_attachments}</b>\r\n        <hr />\r\n        <div dojoAttachPoint=\"_attachmentError\" style='color:red;display:none'></div>\r\n        <br />\r\n        <span dojoAttachPoint='_attachmentList' style='word-wrap: break-word;'></span>\r\n        <br><br>\r\n        <form dojoAttachPoint='_uploadForm'> ${NLS_add}:&nbsp;&nbsp;<input type='file' name='attachment' dojoAttachPoint='_uploadField' /> </form>\r\n    </div>\r\n</div>","dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_4d1,_4d2,_4d3,has){return _4d2("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_4d4){var i=_4d4;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_4d4);this.edit.styleRow(_4d4);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _4d5;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_4d5=this.focus.getHeaderIndex();if(_4d5>=0){this.setSortIndex(_4d5);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_4d3.stop(e);}if(!e.shiftKey){var _4d6=this.edit.isEditing();this.edit.apply();if(!_4d6){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _4d7=this.focus.focusView||this.views.views[0];_4d7.content.decorateEvent(e);this.onRowClick(e);_4d3.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_4d5=this.focus.getHeaderIndex();if(_4d5>=0){this.setSortIndex(_4d5);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_4d3.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _4d8=e.keyCode;_4d3.stop(e);_4d5=this.focus.getHeaderIndex();if(_4d5>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_4d5,(_4d8==keys.LEFT_ARROW?-1:1)*5);}else{var _4d9=(_4d8==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_4d9*=-1;}this.focus.move(0,_4d9);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_4d3.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_4d3.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_4d3.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_4d3.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_4d1.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_4d1.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _4da;if(this._click.length>1&&has("ie")){_4da=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_4da=this._click[0];}else{_4da=e;}}this.focus.setFocusCell(_4da.cell,_4da.rowIndex);this.onRowClick(_4da);this.edit.setEditCell(_4da.cell,_4da.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_4db,_4dc){this.edit.cellFocus(_4db,_4dc);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_4d3.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_4d1.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_4d1.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_4d3.stop(e);}},onStartEdit:function(_4dd,_4de){},onApplyCellEdit:function(_4df,_4e0,_4e1){},onCancelEdit:function(_4e2){},onApplyEdit:function(_4e3){},onCanSelect:function(_4e4){return true;},onCanDeselect:function(_4e5){return true;},onSelected:function(_4e6){this.updateRowStyles(_4e6);},onDeselected:function(_4e7){this.updateRowStyles(_4e7);},onSelectionChanged:function(){}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_4e8,_4e9,_4ea,_4eb,keys,_4ec,_4ed,_4ee,lang){return _4ec("dijit._KeyNavContainer",[_4ea,_4e9],{tabIndex:"0",connectKeyNavHandlers:function(_4ef,_4f0){var _4f1=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_4eb.forEach(_4ef,function(code){_4f1[code]=prev;});_4eb.forEach(_4f0,function(code){_4f1[code]=next;});_4f1[keys.HOME]=lang.hitch(this,"focusFirstChild");_4f1[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_4e8.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_4eb.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_4f2,_4f3){this.inherited(arguments);this._startupChild(_4f2);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_4f4,last){if(!_4f4){return;}if(this.focusedChild&&_4f4!==this.focusedChild){this._onChildBlur(this.focusedChild);}_4f4.set("tabIndex",this.tabIndex);_4f4.focus(last?"end":"start");this._set("focusedChild",_4f4);},_startupChild:function(_4f5){_4f5.set("tabIndex","-1");this.connect(_4f5,"_onFocus",function(){_4f5.set("tabIndex",this.tabIndex);});this.connect(_4f5,"_onBlur",function(){_4f5.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_4ee.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_4ee.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_4ed.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_4f6,dir){if(_4f6){_4f6=this._getSiblingOfChild(_4f6,dir);}var _4f7=this.getChildren();for(var i=0;i<_4f7.length;i++){if(!_4f6){_4f6=_4f7[(dir>0)?0:(_4f7.length-1)];}if(_4f6.isFocusable()){return _4f6;}_4f6=this._getSiblingOfChild(_4f6,dir);}return null;}});});},"esri/dijit/AttributeInspector":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/sniff","dojo/_base/kernel","dojo/has","dojo/dom-style","dojo/dom-construct","esri/kernel","esri/lang","esri/domUtils","esri/layers/InheritedDomain","esri/layers/FeatureLayer","dojo/i18n!esri/nls/jsapi","dojo/fx","dojox/gfx","dijit/_Widget","dijit/_Templated","dijit/Editor","dijit/_editor/plugins/LinkDialog","dijit/_editor/plugins/TextColor","esri/dijit/editing/AttachmentEditor","esri/dijit/editing/Util","esri/tasks/query","dijit/form/DateTextBox","dijit/form/TextBox","dijit/form/NumberTextBox","dijit/form/FilteringSelect","dijit/form/NumberSpinner","dijit/form/Button","dijit/form/SimpleTextarea","dijit/Tooltip","dojo/data/ItemFileReadStore","dojox/date/islamic","dojox/date/islamic/Date","dojox/date/islamic/locale","dojo/text!esri/dijit/templates/AttributeInspector.html"],function(_4f8,lang,_4f9,_4fa,_4fb,_4fc,has,_4fd,_4fe,_4ff,_500,_501,_502,_503,_504,fx,gfx,_505,_506,_507,_508,_509,_50a,Util,_50b,_50c,_50d,_50e,_50f,_510,_511,_512,_513,_514,_515,_516,_517,_518){var ATI=_4f8([_505,_506],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:true,templateString:_518,_navMessage:"( ${idx} ${of} ${numFeatures} )",onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},constructor:function(_519,_51a){lang.mixin(this,_504.widgets.attributeInspector);_519=_519||{};if(!_519.featureLayer&&!_519.layerInfos){console.error("esri.AttributeInspector: please provide correct parameter in the constructor");}this._userIds={};if(_519.featureLayer&&_519.featureLayer.credential){var _51b=_519.featureLayer.id;this._userIds[_51b]=_519.featureLayer.credential.userId;}else{if(_519.layerInfos){var _51c=_519.layerInfos;_4f9.forEach(_51c,function(_51d){if(_51d.featureLayer){var _51e=_51d.featureLayer.id;if(_51d.featureLayer.credential){this._userIds[_51e]=_51d.featureLayer.credential.userId;}if(_51d.userId){this._userIds[_51e]=_51d.userId;}}},this);}}this._datePackage=this._getDatePackage(_519);this._layerInfos=_519.layerInfos||[{featureLayer:_519.featureLayer,options:_519.options||[]}];this._aiConnects=[];this._selection=[];this._toolTips=[];this._numFeatures=0;this._featureIdx=0;this._currentLInfo=null;this._currentFeature=null;this._hideNavButtons=_519.hideNavButtons||false;},postCreate:function(){this._initLayerInfos();this._createAttachmentEditor();this.onFirstFeature();},destroy:function(){this._destroyAttributeTable();_4f9.forEach(this._aiConnects,_4fa.disconnect);delete this._aiConnects;if(this._attachmentEditor){this._attachmentEditor.destroy();delete this._attachmentEditor;}delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments);},refresh:function(){this._updateSelection();},first:function(){this.onFirstFeature();},last:function(){this.onLastFeature();},next:function(){this.onNextFeature();},previous:function(){this.onPreviousFeature();},showFeature:function(_51f,_520){if(_520){this._createOnlyFirstTime=true;}this._updateSelection([_51f],_520);this._updateUI();},onLayerSelectionChange:function(_521,_522,_523){this._createOnlyFirstTime=false;this._featureIdx=(_523===_503.SELECTION_NEW)?0:this._featureIdx;this._updateSelection();this._updateUI();},onLayerSelectionClear:function(){if(!this._selection||this._selection.length<=0){return;}this._numFeatures=0;this._featureIdx=0;this._selection=[];this._currentFeature=null;this._currentLInfo=null;this._updateUI();},onLayerEditsComplete:function(_524,adds,_525,_526){_526=_526||[];if(_526.length){var _527=this._selection;var _528=_524.featureLayer.objectIdField;_4f9.forEach(_526,lang.hitch(this,function(del){_4f9.some(_527,lang.hitch(this,function(item,idx){if(item.attributes[_528]!==del.objectId){return false;}this._selection.splice(idx,1);return true;}));}));}adds=adds||[];if(adds.length){this._selection=Util.findFeatures(adds,_524.featureLayer);this._featureIdx=0;}var _529=this._numFeatures=this._selection?this._selection.length:0;if(adds.length){var _52a=_529?this._selection[this._featureIdx]:null;if(_52a){var _52b=_52a.getLayer();var _52c=_52b.getEditCapabilities();if(!(_52c.canCreate&&!_52c.canUpdate)){this._showFeature(_52a);}}}this._updateUI();},onFieldValueChange:function(_52d,_52e){_52e=(typeof _52e==="undefined")?null:_52e;var _52f=_52d.field;if(_52f.type==="esriFieldTypeDate"){_52e=(_52e&&_52e.getTime)?_52e.getTime():(_52e&&_52e.toGregorian?_52e.toGregorian().getTime():_52e);}if(this._currentFeature.attributes[_52f.name]===_52e){return;}var _530=this._currentLInfo;var _531=this._currentFeature;var _532=_52f.name;if(_532===_530.typeIdField){var type=this._findFirst(_530.types,"id",_52e);var _533=_530.fieldInfos;_4f9.forEach(_533,function(_534){_52f=_534.field;if(!_52f||_52f.name===_530.typeIdField){return;}var node=_534.dijit;var _535=this._setFieldDomain(node,type,_52f);if(_535&&node){this._setValue(node,_531.attributes[_52f.name]+"");if(node.isValid()===false){this._setValue(node,null);}}},this);}this.onAttributeChange(_531,_532,_52e);},onDeleteBtn:function(evt){this._deleteFeature();},onNextFeature:function(evt){this._onNextFeature(1);},onPreviousFeature:function(evt){this._onNextFeature(-1);},onFirstFeature:function(evt){this._onNextFeature(this._featureIdx*-1);},onLastFeature:function(evt){this._onNextFeature((this._numFeatures-1)-this._featureIdx);},_initLayerInfos:function(){var _536=this._layerInfos;this._editorTrackingInfos={};_4f9.forEach(_536,this._initLayerInfo,this);},_initLayerInfo:function(_537){var _538=_537.featureLayer;this._connect(_538,"onSelectionComplete",lang.hitch(this,"onLayerSelectionChange",_537));this._connect(_538,"onSelectionClear",lang.hitch(this,"onLayerSelectionClear",_537));this._connect(_538,"onEditsComplete",lang.hitch(this,"onLayerEditsComplete",_537));_537.showAttachments=_538.hasAttachments?(_500.isDefined(_537.showAttachments)?_537.showAttachments:true):false;_537.hideFields=_537.hideFields||[];_537.htmlFields=_537.htmlFields||[];_537.isEditable=_538.isEditable()?(_500.isDefined(_537.isEditable)?_537.isEditable:true):false;_537.typeIdField=_538.typeIdField;_537.layerId=_538.id;_537.types=_538.types;if(!_537.showGlobalID&&_538.globalIdField){_537.hideFields.push(_538.globalIdField);}if(!_537.showObjectID){_537.hideFields.push(_538.objectIdField);}var _539=this._getFields(_537.featureLayer);if(!_539){return;}var _53a=_537.fieldInfos||[];_53a=_4f9.map(_53a,function(_53b){return lang.mixin({},_53b);});if(!_53a.length){_539=_4f9.filter(_539,lang.hitch(this,function(_53c){return !this._isInFields(_53c.name,_537.hideFields);}));_537.fieldInfos=_4f9.map(_539,lang.hitch(this,function(_53d){var _53e=(this._isInFields(_53d.name,_537.htmlFields)?ATI.STRING_FIELD_OPTION_RICHTEXT:ATI.STRING_FIELD_OPTION_TEXTBOX);return {"fieldName":_53d.name,"field":_53d,"stringFieldOption":_53e};}));}else{_537.fieldInfos=_4f9.filter(_4f9.map(_53a,lang.hitch(this,function(_53f){var _540=_53f.stringFieldOption||(this._isInFields(_53f.fieldName,_537.htmlFields)?ATI.STRING_FIELD_OPTION_RICHTEXT:ATI.STRING_FIELD_OPTION_TEXTBOX);return lang.mixin(_53f,{"field":this._findFirst(_539,"name",_53f.fieldName),"stringFieldOption":_540});})),"return item.field;");}var _541=[];if(_538.editFieldsInfo){if(_538.editFieldsInfo.creatorField){_541.push(_538.editFieldsInfo.creatorField);}if(_538.editFieldsInfo.creationDateField){_541.push(_538.editFieldsInfo.creationDateField);}if(_538.editFieldsInfo.editorField){_541.push(_538.editFieldsInfo.editorField);}if(_538.editFieldsInfo.editDateField){_541.push(_538.editFieldsInfo.editDateField);}}this._editorTrackingInfos[_538.id]=_541;},_createAttachmentEditor:function(){this._attachmentEditor=null;var _542=this._layerInfos;var _543=_4f9.filter(_542,function(item){return item.showAttachments;});if(!_543||!_543.length){return;}this._attachmentEditor=new _50a({"class":"atiAttachmentEditor"},this.attachmentEditor);this._attachmentEditor.startup();},_setCurrentLInfo:function(_544){var _545=this._currentLInfo?this._currentLInfo.featureLayer:null;var _546=_544.featureLayer;if(_545&&_545.id===_546.id&&!_545.ownershipBasedAccessControlForFeatures){var _547=_546.getEditCapabilities();if(!(_547.canCreate&&!_547.canUpdate)){return;}}this._currentLInfo=_544;this._createTable();},_updateSelection:function(_548,_549){this._selection=_548||[];var _54a=this._layerInfos;_4f9.forEach(_54a,this._getSelection,this);var _54b=this._numFeatures=this._selection.length;var _54c=_54b?this._selection[this._featureIdx]:null;this._showFeature(_54c,_549);},_getSelection:function(_54d){var _54e=_54d.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(_54e);},_updateUI:function(){var _54f=this._numFeatures;var _550=this._currentLInfo;this.layerName.innerHTML=(!_550||_54f===0)?this.NLS_noFeaturesSelected:(_550.featureLayer?_550.featureLayer.name:"");_4fd.set(this.attributeTable,"display",_54f?"":"none");_4fd.set(this.editButtons,"display",_54f?"":"none");_4fd.set(this.navButtons,"display",(!this._hideNavButtons&&(_54f>1)?"":"none"));this.navMessage.innerHTML=_500.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);if(this._attachmentEditor){_4fd.set(this._attachmentEditor.domNode,"display",((_550&&_550.showAttachments)&&_54f)?"":"none");}var _551=((_550&&_550.showDeleteButton===false)||!this._canDelete)?false:true;_4fd.set(this.deleteBtn.domNode,"display",_551?"":"none");if(this.domNode.parentNode&&this.domNode.parentNode.scrollTop>0){this.domNode.parentNode.scrollTop=0;}},_onNextFeature:function(_552){this._featureIdx+=_552;if(this._featureIdx<0){this._featureIdx=this._numFeatures-1;}else{if(this._featureIdx>=this._numFeatures){this._featureIdx=0;}}var _553=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(_553);this._updateUI();this.onNext(_553);},_deleteFeature:function(){this.onDelete(this._currentFeature);},_showFeature:function(_554,_555){if(!_554){return;}this._currentFeature=_554;var _556=_555?_555:_554.getLayer();var _557=_556.getEditCapabilities({feature:_554,userId:this._userIds[_556.id]});this._canUpdate=_557.canUpdate;this._canDelete=_557.canDelete;var _558=this._getLInfoFromFeatureLayer(_556);if(!_558){return;}this._setCurrentLInfo(_558);var _559=_554.attributes;var type=this._findFirst(_558.types,"id",_559[_558.typeIdField]);var node,_55a=null;var _55b=_558.fieldInfos;_4f9.forEach(_55b,function(_55c){_55a=_55c.field;node=_55c.dijit||null;if(!node){return;}var _55d=this._setFieldDomain(node,type,_55a);var _55e=_559[_55a.name];_55e=(_55e&&_55d&&_55d.codedValues&&_55d.codedValues.length)?(_55d.codedValues[_55e]?_55d.codedValues[_55e].name:_55e):_55e;if(!_500.isDefined(_55e)){_55e="";}if(node.declaredClass==="dijit.form.DateTextBox"){_55e=(_55e==="")?null:new Date(_55e);}else{if(node.declaredClass==="dijit.form.FilteringSelect"){node._lastValueReported=null;_55e=_559[_55a.name]+"";}}try{this._setValue(node,_55e);if(node.declaredClass==="dijit.form.FilteringSelect"&&node.isValid()===false){this._setValue(node,null);}}catch(error){node.set("displayedValue",this.NLS_errorInvalid,false);}},this);if(this._attachmentEditor&&_558.showAttachments){this._attachmentEditor.showAttachments(this._currentFeature);}var _55f=_556.getEditSummary(_554);if(_55f){this.editorTrackingInfoDiv.innerHTML=_55f;_501.show(this.editorTrackingInfoDiv);}else{_501.hide(this.editorTrackingInfoDiv);}},_setFieldDomain:function(node,type,_560){if(!node){return null;}var _561=_560.domain;if(type&&type.domains){if(type.domains[_560.name]&&type.domains[_560.name] instanceof _502===false){_561=type.domains[_560.name];}}if(!_561){return null;}if(_561.codedValues&&_561.codedValues.length>0){node.set("store",this._toStore(_4f9.map(_561.codedValues,function(item){return {id:item.code+="",name:item.name};})));this._setValue(node,_561.codedValues[0].code);}else{node.constraints={min:_500.isDefined(_561.minValue)?_561.minValue:Number.MIN_VALUE,max:_500.isDefined(_561.maxValue)?_561.maxValue:Number.MAX_VALUE};this._setValue(node,node.constraints.min);}return _561;},_setValue:function(node,_562){if(!node.set){return;}node._onChangeActive=false;node.set("value",_562,true);node._onChangeActive=true;},_getFields:function(_563){var _564=_563._getOutFields();if(!_564){return null;}var _565=_563.fields;return (_564=="*")?_565:_4f9.filter(_4f9.map(_564,lang.hitch(this,"_findFirst",_565,"name")),_500.isDefined);},_isInFields:function(_566,_567){if(!_566||!_567&&!_567.length){return false;}return _4f9.some(_567,function(name){return name.toLowerCase()===_566.toLowerCase();});},_findFirst:function(_568,_569,_56a){var _56b=_4f9.filter(_568,function(item){return item.hasOwnProperty(_569)&&item[_569]===_56a;});return (_56b&&_56b.length)?_56b[0]:null;},_getLInfoFromFeatureLayer:function(_56c){var _56d=_56c?_56c.id:null;return this._findFirst(this._layerInfos,"layerId",_56d);},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=_4fe.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var _56e=_4fe.create("tbody",null,this._attributes);var _56f=this._currentFeature;var _570=this._currentLInfo;var type=this._findFirst(_570.types,"id",_56f.attributes[_570.typeIdField]);var _571=_570.fieldInfos;_4f9.forEach(_571,lang.hitch(this,"_createField",type,_56e),this);this._createOnlyFirstTime=false;},_createField:function(type,_572,_573){var _574=this._currentLInfo;var _575=_573.field;if(this._isInFields(_575.name,_574.hideFields)){return;}if(this._isInFields(_575.name,this._editorTrackingInfos[_574.featureLayer.id])){return;}var node=_4fe.create("tr",null,_572);var td=_4fe.create("td",{innerHTML:_573.label||_575.alias||_575.name,"class":"atiLabel"},node);td=_4fe.create("td",null,node);var _576=null;var _577=false;if(_573.customField){_4fe.place(_573.customField.domNode||_573.customField,_4fe.create("div",null,td),"first");_576=_573.customField;}else{if(_574.isEditable===false||_575.editable===false||_573.isEditable===false||_575.type==="esriFieldTypeOID"||_575.type==="esriFieldTypeGlobalID"||(!this._canUpdate&&!this._createOnlyFirstTime)){_577=true;}}if(!_576&&(_574.typeIdField&&_575.name.toLowerCase()==_574.typeIdField.toLowerCase())){_576=this._createTypeField(_575,_573,td);}else{if(!_576){_576=this._createDomainField(_575,_573,type,td);}}if(!_576){switch(_575.type){case "esriFieldTypeString":_576=this._createStringField(_575,_573,td);break;case "esriFieldTypeDate":_576=this._createDateField(_575,_573,td);break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":_576=this._createIntField(_575,_573,td);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":_576=this._createFltField(_575,_573,td);break;default:_576=this._createStringField(_575,_573,td);break;}}if(_573.tooltip&&_573.tooltip.length){this._toolTips.push(new _513({connectId:[_576.id],label:_573.tooltip}));}_576.onChange=lang.hitch(this,"onFieldValueChange",_573);_576.set("disabled",_577);_573.dijit=_576;},_createTypeField:function(_578,_579,node){return new _50f({"class":"atiField",name:_578.alias||_578.name,store:this._toStore(_4f9.map(this._currentLInfo.types,function(item){return {id:item.id,name:item.name};})),searchAttr:"name"},_4fe.create("div",null,node));},_createDomainField:function(_57a,_57b,type,node){var _57c=_57a.domain;if(type&&type.domains){if(type.domains[_57a.name]&&type.domains[_57a.name] instanceof _502===false){_57c=type.domains[_57a.name];}}if(!_57c){return null;}if(_57c.codedValues){return new _50f({"class":"atiField",name:_57a.alias||_57a.name,searchAttr:"name",required:_57a.nullable||false},_4fe.create("div",null,node));}else{return new _510({"class":"atiField"},_4fe.create("div",null,node));}},_createStringField:function(_57d,_57e,node){var _57f={"class":"atiField",trim:true,maxLength:_57d.length};if(_57e.stringFieldOption===ATI.STRING_FIELD_OPTION_TEXTAREA){_57f["class"]+=" atiTextAreaField";return new _512(_57f,_4fe.create("div",null,node));}else{if(_57e.stringFieldOption===ATI.STRING_FIELD_OPTION_RICHTEXT){_57f["class"]+=" atiRichTextField";_57f.height="100%";_57f.width="100%";_57f.plugins=_57e.richTextPlugins||["bold","italic","underline","foreColor","hiliteColor","|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createLink"];return new _507(_57f,_4fe.create("div",null,node));}else{return new _50d(_57f,_4fe.create("div",null,node));}}},_createDateField:function(_580,_581,node){var _582={"class":"atiField","trim":true};if(this._datePackage){_582.datePackage=this._datePackage;}return new _50c(_582,_4fe.create("div",null,node));},_createIntField:function(_583,_584,node){return new _50e({"class":"atiField",constraints:{places:0},invalidMessage:this.NLS_validationInt,trim:true},_4fe.create("div",null,node));},_createFltField:function(_585,_586,node){return new _50e({"class":"atiField",trim:true,invalidMessage:this.NLS_validationFlt},_4fe.create("div",null,node));},_toStore:function(_587){return new _514({data:{identifier:"id",label:"name",items:_587}});},_connect:function(node,evt,func){this._aiConnects.push(_4fa.connect(node,evt,func));},_getDatePackage:function(_588){if(_588.datePackage===null){return null;}else{if(_588.datePackage){return _588.datePackage;}else{if(_4fc.locale==="ar"){return "dojox.date.islamic";}}}return null;},_destroyAttributeTable:function(){var _589=this._layerInfos;_4f9.forEach(_589,function(_58a){var _58b=_58a.fieldInfos;_4f9.forEach(_58b,function(_58c){var _58d=_58c.dijit;if(_58d){_58d._onChangeHandle=null;if(_58c.customField){return;}if(_58d.destroyRecursive){_58d.destroyRecursive();}else{if(_58d.destroy){_58d.destroy();}}}_58c.dijit=null;},this);},this);var _58e=this._toolTips;_4f9.forEach(_58e,function(item){item.destroy();delete item;});this._toolTips=[];if(this._attributes){_4fe.destroy(this._attributes);}}});lang.mixin(ATI,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});if(has("extend-esri")){lang.setObject("dijit.AttributeInspector",ATI,_4ff);}return ATI;});},"dojox/date/islamic/locale":function(){define("dojox/date/islamic/locale",["../..","dojo/_base/lang","dojo/_base/array","dojo/date","dojo/i18n","dojo/regexp","dojo/string","./Date","dojo/i18n!dojo/cldr/nls/islamic"],function(_58f,lang,arr,dd,i18n,_590,_591,_592,_593){var _594=lang.getObject("date.islamic.locale",true,_58f);function _595(_596,_597,_598,_599,_59a){return _59a.replace(/([a-z])\1*/ig,function(_59b){var s,pad;var c=_59b.charAt(0);var l=_59b.length;var _59c=["abbr","wide","narrow"];switch(c){case "G":s=_597["eraAbbr"][0];break;case "y":s=String(_596.getFullYear());break;case "M":var m=_596.getMonth();if(l<3){s=m+1;pad=true;}else{var _59d=["months","format",_59c[l-3]].join("-");s=_597[_59d][m];}break;case "d":s=_596.getDate(true);pad=true;break;case "E":var d=_596.getDay();if(l<3){s=d+1;pad=true;}else{var _59e=["days","format",_59c[l-3]].join("-");s=_597[_59e][d];}break;case "a":var _59f=(_596.getHours()<12)?"am":"pm";s=_597["dayPeriods-format-wide-"+_59f];break;case "h":case "H":case "K":case "k":var h=_596.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_596.getMinutes();pad=true;break;case "s":s=_596.getSeconds();pad=true;break;case "S":s=Math.round(_596.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "z":s=dd.getTimezoneName(_596.toGregorian());if(s){break;}l=4;case "Z":var _5a0=_596.toGregorian().getTimezoneOffset();var tz=[(_5a0<=0?"+":"-"),_591.pad(Math.floor(Math.abs(_5a0)/60),2),_591.pad(Math.abs(_5a0)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+_59a);}if(pad){s=_591.pad(s,l);}return s;});};_594.format=function(_5a1,_5a2){_5a2=_5a2||{};var _5a3=i18n.normalizeLocale(_5a2.locale);var _5a4=_5a2.formatLength||"short";var _5a5=_594._getIslamicBundle(_5a3);var str=[];var _5a6=lang.hitch(this,_595,_5a1,_5a5,_5a3,_5a2.fullYear);if(_5a2.selector=="year"){var year=_5a1.getFullYear();return year;}if(_5a2.selector!="time"){var _5a7=_5a2.datePattern||_5a5["dateFormat-"+_5a4];if(_5a7){str.push(_5a8(_5a7,_5a6));}}if(_5a2.selector!="date"){var _5a9=_5a2.timePattern||_5a5["timeFormat-"+_5a4];if(_5a9){str.push(_5a8(_5a9,_5a6));}}var _5aa=str.join(" ");return _5aa;};_594.regexp=function(_5ab){return _594._parseInfo(_5ab).regexp;};_594._parseInfo=function(_5ac){_5ac=_5ac||{};var _5ad=i18n.normalizeLocale(_5ac.locale);var _5ae=_594._getIslamicBundle(_5ad);var _5af=_5ac.formatLength||"short";var _5b0=_5ac.datePattern||_5ae["dateFormat-"+_5af];var _5b1=_5ac.timePattern||_5ae["timeFormat-"+_5af];var _5b2;if(_5ac.selector=="date"){_5b2=_5b0;}else{if(_5ac.selector=="time"){_5b2=_5b1;}else{_5b2=(typeof (_5b1)=="undefined")?_5b0:_5b0+" "+_5b1;}}var _5b3=[];var re=_5a8(_5b2,lang.hitch(this,_5b4,_5b3,_5ae,_5ac));return {regexp:re,tokens:_5b3,bundle:_5ae};};_594.parse=function(_5b5,_5b6){_5b5=_5b5.replace(/[\u200E\u200F\u202A\u202E]/g,"");if(!_5b6){_5b6={};}var info=_594._parseInfo(_5b6);var _5b7=info.tokens,_593=info.bundle;var _5b8=info.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");var re=new RegExp("^"+_5b8+"$");var _5b9=re.exec(_5b5);var _5ba=i18n.normalizeLocale(_5b6.locale);if(!_5b9){return null;}var date,_5bb;var _5bc=[1389,0,1,0,0,0,0];var amPm="";var _5bd=0;var _5be=["abbr","wide","narrow"];var _5bf=arr.every(_5b9,function(v,i){if(!i){return true;}var _5c0=_5b7[i-1];var l=_5c0.length;switch(_5c0.charAt(0)){case "y":_5bc[0]=Number(v);break;case "M":if(l>2){var _5c1=_593["months-format-"+_5be[l-3]].concat();if(!_5b6.strict){v=v.replace(".","").toLowerCase();_5c1=arr.map(_5c1,function(s){return s?s.replace(".","").toLowerCase():s;});}v=arr.indexOf(_5c1,v);if(v==-1){return false;}_5bd=l;}else{v--;}_5bc[1]=Number(v);break;case "D":_5bc[1]=0;case "d":_5bc[2]=Number(v);break;case "a":var am=_5b6.am||_593["dayPeriods-format-wide-am"],pm=_5b6.pm||_593["dayPeriods-format-wide-pm"];if(!_5b6.strict){var _5c2=/\./g;v=v.replace(_5c2,"").toLowerCase();am=am.replace(_5c2,"").toLowerCase();pm=pm.replace(_5c2,"").toLowerCase();}if(_5b6.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":_5bc[3]=Number(v);break;case "m":_5bc[4]=Number(v);break;case "s":_5bc[5]=Number(v);break;case "S":_5bc[6]=Number(v);}return true;});var _5c3=+_5bc[3];if(amPm==="p"&&_5c3<12){_5bc[3]=_5c3+12;}else{if(amPm==="a"&&_5c3==12){_5bc[3]=0;}}var _5c4=new _592(_5bc[0],_5bc[1],_5bc[2],_5bc[3],_5bc[4],_5bc[5],_5bc[6]);return _5c4;};function _5a8(_5c5,_5c6,_5c7,_5c8){var _5c9=function(x){return x;};_5c6=_5c6||_5c9;_5c7=_5c7||_5c9;_5c8=_5c8||_5c9;var _5ca=_5c5.match(/(''|[^'])+/g);var _5cb=_5c5.charAt(0)=="'";arr.forEach(_5ca,function(_5cc,i){if(!_5cc){_5ca[i]="";}else{_5ca[i]=(_5cb?_5c7:_5c6)(_5cc);_5cb=!_5cb;}});return _5c8(_5ca.join(""));};function _5b4(_5cd,_5ce,_5cf,_5d0){_5d0=_590.escapeString(_5d0);var _5d1=i18n.normalizeLocale(_5cf.locale);return _5d0.replace(/([a-z])\1*/ig,function(_5d2){var s;var c=_5d2.charAt(0);var l=_5d2.length;var p2="",p3="";if(_5cf.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d+";break;case "M":s=(l>2)?"\\S+ ?\\S+":p2+"[1-9]|1[0-2]";break;case "d":s="[12]\\d|"+p2+"[1-9]|3[01]";break;case "E":s="\\S+";break;case "h":s=p2+"[1-9]|1[0-2]";break;case "k":s=p2+"\\d|1[01]";break;case "H":s=p2+"\\d|1\\d|2[0-3]";break;case "K":s=p2+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":s=p2+"\\d|[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_5cf.am||_5ce["dayPeriods-format-wide-am"],pm=_5cf.pm||_5ce["dayPeriods-format-wide-pm"];if(_5cf.strict){s=am+"|"+pm;}else{s=am+"|"+pm;if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}}break;default:s=".*";}if(_5cd){_5cd.push(_5d2);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};var _5d3=[];_594.addCustomFormats=function(_5d4,_5d5){_5d3.push({pkg:_5d4,name:_5d5});};_594._getIslamicBundle=function(_5d6){var _5d7={};arr.forEach(_5d3,function(desc){var _5d8=i18n.getLocalization(desc.pkg,desc.name,_5d6);_5d7=lang.mixin(_5d7,_5d8);},this);return _5d7;};_594.addCustomFormats("dojo.cldr","islamic");_594.getNames=function(item,type,_5d9,_5da,date){var _5db;var _5dc=_594._getIslamicBundle(_5da);var _5dd=[item,_5d9,type];if(_5d9=="standAlone"){var key=_5dd.join("-");_5db=_5dc[key];if(_5db[0]==1){_5db=undefined;}}_5dd[1]="format";return (_5db||_5dc[_5dd.join("-")]).concat();};_594.weekDays=_594.getNames("days","wide","format");_594.months=_594.getNames("months","wide","format");return _594;});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/date/locale","dojo/sniff","dojo/io-query","dojo/dom-construct","dojo/i18n","esri/kernel","esri/lang","esri/request","esri/deferredUtils","esri/SpatialReference","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/jsonUtils","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/jsonUtils","esri/tasks/QueryTask","esri/tasks/query","esri/tasks/FeatureSet","esri/geometry/Extent","esri/geometry/jsonUtils","esri/geometry/normalizeUtils","esri/layers/GraphicsLayer","esri/layers/Field","esri/layers/TimeInfo","esri/layers/FeatureType","esri/layers/FeatureTemplate","esri/layers/FeatureEditResult","esri/layers/SnapshotMode","esri/layers/OnDemandMode","esri/layers/SelectionMode","esri/layers/TrackManager","dojo/i18n!esri/nls/jsapi","dojo/has!extend-esri?esri/layers/agscommon"],function(_5de,_5df,lang,_5e0,_5e1,_5e2,_5e3,has,ioq,_5e4,i18n,_5e5,_5e6,_5e7,_5e8,_5e9,_5ea,_5eb,_5ec,_5ed,_5ee,_5ef,_5f0,_5f1,_5f2,_5f3,_5f4,_5f5,_5f6,_5f7,_5f8,_5f9,_5fa,_5fb,_5fc,_5fd,_5fe,_5ff,_600){var _601=_5de(_5f7,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",constructor:function(url,_602){this.i18n=i18n.getLocalization("esri","jsapi");this._outFields=_602&&_602.outFields;this._loadCallback=_602&&_602.loadCallback;var _603=_602&&_602._usePatch;this._usePatch=(_603===null||_603===undefined)?true:_603;this._trackIdField=_602&&_602.trackIdField;this.objectIdField=_602&&_602.objectIdField;this._maxOffset=_602&&_602.maxAllowableOffset;this._optEditable=_602&&_602.editable;this._optAutoGen=_602&&_602.autoGeneralize;this.editSummaryCallback=_602&&_602.editSummaryCallback;this.userId=_602&&_602.userId;this.userIsAdmin=_602&&_602.userIsAdmin;this.useMapTime=(_602&&_602.hasOwnProperty("useMapTime"))?(!!_602.useMapTime):true;this.source=_602&&_602.source;this.gdbVersion=_602&&_602.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(_5e6.isDefined(_602&&_602.mode)?_602.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new _5fd(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_602&&_602.tileWidth)||512;this._tileHeight=(_602&&_602.tileHeight)||512;this._mode=new _5fe(this);var _604=_602&&_602.latticeTiling;this.latticeTiling=_604;break;case ctor.MODE_SELECTION:this._mode=new _5ff(this);this._isSelOnly=true;break;}this._initLayer=lang.hitch(this,this._initLayer);this._selectHandler=lang.hitch(this,this._selectHandler);this._editable=false;if(lang.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new _5f1(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _605=this._url.path;this._fserver=false;if(_605.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _606=_602&&_602.resourceInfo;if(_606){this._initLayer(_606);}else{if(this.source){var _607={source:this.source.toJson()};this._url.query=lang.mixin(this._url.query,{layer:_5e1.toJson(_607)});}if(this.gdbVersion){this._url.query=lang.mixin(this._url.query,{gdbVersion:this.gdbVersion});}_5e7({url:_605,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_608,io){if(_608||io){this._json=_608;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_608&&_608._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new _5fd(this);this._isSnapshot=true;this._featureSet=_608.featureSet;this._nextId=_608.nextObjectId;_608=_608.layerDefinition;}if(_608.hasOwnProperty("capabilities")){var _609=(this.capabilities=_608.capabilities);if(_609&&_609.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(_5e6.isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_5e1.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_608.geometryType==="esriGeometryPolyline")||(_608.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_5e6.isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _60a=_608.effectiveMinScale||_608.minScale,_60b=_608.effectiveMaxScale||_608.maxScale;if(!this._hasMin&&_60a){this.setMinScale(_60a);}if(!this._hasMax&&_60b){this.setMaxScale(_60b);}this.layerId=_608.id;this.name=_608.name;this.description=_608.description;this.copyright=_608.copyrightText;this.type=_608.type;this.geometryType=_608.geometryType;this.displayField=_608.displayField;this.defaultDefinitionExpression=_608.definitionExpression;this.fullExtent=new _5f4(_608.extent);this.initialExtent=new _5f4(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new _5e9(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_608.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_608.indexedFields;this.maxRecordCount=_608.maxRecordCount;this.canModifyLayer=_608.canModifyLayer;this.supportsStatistics=_608.supportsStatistics;this.supportsAdvancedQueries=_608.supportsAdvancedQueries;this.hasLabels=_608.hasLabels;this.canScaleSymbols=_608.canScaleSymbols;this.supportsRollbackOnFailure=_608.supportsRollbackOnFailure;this.syncCanReturnChanges=_608.syncCanReturnChanges;this.isDataVersioned=_608.isDataVersioned;this.editFieldsInfo=_608.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_608.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_608.relationships;this.allowGeometryUpdates=_5e6.isDefined(_608.allowGeometryUpdates)?_608.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _60c=(this.fields=[]),_60d=_608.fields,i;for(i=0;i<_60d.length;i++){_60c.push(new _5f8(_60d[i]));}if(!this.objectIdField){this.objectIdField=_608.objectIdField;if(!this.objectIdField){_60d=_608.fields;for(i=0;i<_60d.length;i++){var _60e=_60d[i];if(_60e.type==="esriFieldTypeOID"){this.objectIdField=_60e.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+_5e6.substitute({url:this.url},"objectIdField is not set [url: ${url}]"));}}if(!_5e6.isDefined(this._nextId)){var _60f=this.objectIdField,_610=-1;if(this._collection&&_60f){var fset=this._featureSet,_611=fset&&fset.features,il=_611?_611.length:0,oid,attr;for(i=0;i<il;i++){attr=_611[i].attributes;oid=attr&&attr[_60f];if(oid>_610){_610=oid;}}}this._nextId=(_610+1);}this.globalIdField=_608.globalIdField;var _612=(this.typeIdField=_608.typeIdField),_613;if(_612){_613=!this._getField(_612)&&this._getField(_612,true);if(_613){this.typeIdField=_613.name;}}this.visibilityField=_608.visibilityField;var _614=_608.defaultSymbol;if(_614){this.defaultSymbol=_5ed.fromJson(_614);}var _615=this.types=[],_616=_608.types,_617,_618,_619,_61a=this.editFieldsInfo,_61b=_61a&&_61a.creatorField,_61c=_61a&&_61a.editorField,fix=(_61b||_61c),_61d=[];if(_616){for(i=0;i<_616.length;i++){_617=new _5fa(_616[i]);_618=_617.templates;if(fix&&_618&&_618.length){_61d=_61d.concat(_618);}_615.push(_617);}}var _61e=_608.templates,_61f,_620=this.templates=[];if(_61e){for(i=0;i<_61e.length;i++){_61f=new _5fb(_61e[i]);if(fix){_61d.push(_61f);}_620.push(_61f);}}for(i=0;i<_61d.length;i++){_619=lang.getObject("prototype.attributes",false,_61d[i]);if(_619){if(_61b){delete _619[_61b];}if(_61c){delete _619[_61c];}}}var _621=_608.timeInfo;if(_621){this.timeInfo=new _5f9(_621);this._startTimeField=_621.startTimeField;this._endTimeField=_621.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_621.trackIdField=this._trackIdField;}else{this._trackIdField=_621.trackIdField;}}this.hasAttachments=(!this._collection&&_608.hasAttachments)?true:false;this.htmlPopupType=_608.htmlPopupType;var _622=_608.drawingInfo,_623;if(!this.renderer){if(_622&&_622.renderer){_623=_622.renderer;this.setRenderer(_5f0.fromJson(_623));if(_623.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _624=_623.type,_625=[];_623=this.renderer;switch(_624){case "simple":_625.push(_623.symbol);break;case "uniqueValue":case "classBreaks":_625.push(_623.defaultSymbol);_625=_625.concat(_5e0.map(_623.infos,function(info){return info.symbol;}));break;}_625=_5e0.filter(_625,_5e6.isDefined);var _626=this._url.path+"/images/",_627=this._getToken();_5e0.forEach(_625,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_626+url;}if(_627&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_627);}}});}}else{if(_614){_616=this.types;if(_616.length>0){_623=new _5ef(this.defaultSymbol,this.typeIdField);_5e0.forEach(_616,function(type){_623.addValue(type.id,type.symbol);});}else{_623=new _5ee(this.defaultSymbol);}this.setRenderer(_623);}else{if(!this._isTable){var _628;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_628=new _5ea();break;case "esriGeometryPolyline":_628=new _5eb();break;case "esriGeometryPolygon":_628=new _5ec();break;}this.setRenderer(_628?new _5ee(_628):null);}}}}var _629=(_622&&_622.transparency)||0;if(!_5e6.isDefined(this.opacity)&&_629>0){this.opacity=1-(_629/100);}this.version=_608.currentVersion;if(!this.version){var ver;if("capabilities" in _608||"drawingInfo" in _608||"hasAttachments" in _608||"htmlPopupType" in _608||"relationships" in _608||"timeInfo" in _608||"typeIdField" in _608||"types" in _608){ver=10;}else{ver=9.3;}this.version=ver;}if((has("ie")||has("safari"))&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _62a=function(){this.onLoad(this);var _62b=this._loadCallback;if(_62b){delete this._loadCallback;_62b(this);}};if(this._collection){this._fireUpdateStart();var _62c=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new _5f3(_62c));this._fcAdded=true;_62a.call(this);}else{this._forceIdentity(_62a);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _62d=this.renderer;if(_62d){this._ager=(_62d.declaredClass.indexOf("TemporalRenderer")!==-1&&_62d.observationAger&&_62d.observationRenderer);var _62e=_5e0.filter([_62d,_62d.observationRenderer,_62d.latestObservationRenderer,_62d.trackRenderer],_5e6.isDefined);var _62f=[];_5e0.forEach(_62e,function(rnd){if(!lang.isFunction(rnd.attributeField)){_62f.push(rnd.attributeField);}_62f.push(rnd.attributeField2);_62f.push(rnd.attributeField3);},this);this._rendererFields=_5e0.filter(_62f,_5e6.isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map){var div=this.inherited(arguments),mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_5df.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_630){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_630;return this;}var _631=this._editable;this._editable=_630;this._updateCaps();if(_631!==_630){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_632){var _633={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _633;}var _634=_632&&_632.feature,_635=_632&&_632.userId,caps=_5e0.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),lang.trim),_636=_5e0.indexOf(caps,"editing")>-1,_637=_636&&(_5e0.indexOf(caps,"create")>-1),_638=_636&&(_5e0.indexOf(caps,"update")>-1),_639=_636&&(_5e0.indexOf(caps,"delete")>-1),_63a=this.ownershipBasedAccessControlForFeatures,_63b=this.editFieldsInfo,_63c=_63b&&_63b.creatorField,_63d=_63b&&_63b.realm,_63e=_634&&_634.attributes,_63f=(_63e&&_63c)?_63e[_63c]:undefined,_640,_641=!!this.userIsAdmin,_642=!_63a||_641||!!(_63a.allowOthersToUpdate||_63a.allowUpdateToOthers),_643=!_63a||_641||!!(_63a.allowOthersToDelete||_63a.allowDeleteToOthers);if(_641||(_636&&!(_637||_638||_639))){_637=_638=_639=true;}_640={"canCreate":_637,"canUpdate":_638,"canDelete":_639};if(_63f===null){_640.canUpdate=_638&&_642;_640.canDelete=_639&&_643;}else{if(_63f===""){return _640;}else{if(_63f){_635=_635||this.getUserId();if(_635&&_63d){_635=_635+"@"+_63d;}if(_635.toLowerCase()===_63f.toLowerCase()){return _640;}else{_640.canUpdate=_638&&_642;_640.canDelete=_639&&_643;}}}}return _640;},getUserId:function(){var _644;if(this.loaded){_644=(this.credential&&this.credential.userId)||this.userId||"";}return _644;},setUserIsAdmin:function(_645){this.userIsAdmin=_645;},setEditSummaryCallback:function(_646){this.editSummaryCallback=_646;},getEditSummary:function(_647,_648,_649){_649=_5e6.isDefined(_649)?_649:(new Date()).getTime();var _64a="",info=this.getEditInfo(_647,_648,_649),_64b=(_648&&_648.callback)||this.editSummaryCallback;if(_64b){info=_64b(_647,info)||"";}if(lang.isString(info)){_64a=info;}else{if(info){var _64c=info.action,_64d=info.userId,_64e=info.timeValue,_64f=0;if(_64c){_64f++;}if(_64d){_64f++;}if(_5e6.isDefined(_64e)){_64f++;}if(_64f>1){_64a=(_64c==="edit"?"edit":"create")+(_64d?"User":"")+(_5e6.isDefined(_64e)?info.displayPattern:"");}}_64a=_64a&&_5e6.substitute(info,this.i18n.layers.FeatureLayer[_64a]);}return _64a;},getEditInfo:function(_650,_651,_652){if(!this.loaded){return;}_652=_5e6.isDefined(_652)?_652:(new Date()).getTime();var _653=(_651&&_651.action)||"last",_654=this.editFieldsInfo,_655=_654&&_654.creatorField,_656=_654&&_654.creationDateField,_657=_654&&_654.editorField,_658=_654&&_654.editDateField,_659=_654&&_654.realm,_65a=_650&&_650.attributes,_65b=(_65a&&_655)?_65a[_655]:undefined,_65c=(_65a&&_656)?_65a[_656]:null,_65d=(_65a&&_657)?_65a[_657]:undefined,_65e=(_65a&&_658)?_65a[_658]:null,_65f=this._getEditData(_65b,_65c,_652),_660=this._getEditData(_65d,_65e,_652),_661;switch(_653){case "creation":_661=_65f;break;case "edit":_661=_660;break;case "last":_661=_660||_65f;break;}if(_661){_661.action=(_661===_660)?"edit":"creation";}return _661;},_getEditData:function(_662,_663,_664){var data,_665,_666,_667=60000,_668=3600000,_669=2*_668,_66a=24*_668,_66b=7*_66a;if(_5e6.isDefined(_663)){_665=_664-_663;if(_665<0){_666="Full";}else{if(_665<_667){_666="Seconds";}else{if(_665<(2*_667)){_666="Minute";}else{if(_665<_668){_666="Minutes";}else{if(_665<_669){_666="Hour";}else{if(_665<_66a){_666="Hours";}else{if(_665<_66b){_666="WeekDay";}else{_666="Full";}}}}}}}}if((_662!==undefined)||_666){data=data||{};data.userId=_662;if(_666){var _66c=_5e3.format,_66d=new Date(_663);data.minutes=Math.floor(_665/_667);data.hours=Math.floor(_665/_668);data.weekDay=_66c(_66d,{datePattern:"EEEE",selector:"date"});data.formattedDate=_66c(_66d,{selector:"date"});data.formattedTime=_66c(_66d,{selector:"time"});data.displayPattern=_666;data.timeValue=_663;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_66e){if(!this.isEditable()){this._maxOffset=_66e;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_66f){if(!this.loaded){this._optAutoGen=_66f;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_66f;if(_66f){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_670){if(!this._collection&&(_670!==this.gdbVersion)&&(_670||this.gdbVersion)){this.gdbVersion=_670;this._task.gdbVersion=_670;this._url.query=lang.mixin(this._url.query,{gdbVersion:_670});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_671){if(this._isSnapshot){this._timeDefn=_671;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_672,_673){this._timeOffset=_672;this._timeOffsetUnits=_673;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_674,_675,_676,_677){_675=_675||this.constructor.SELECTION_NEW;var _678=this._getShallowClone(_674),map=this._map,_679,dfd=_5e8._fixDfd(new _5e2(_5e8._dfdCanceller));_678.outFields=this._getOutFields();_678.returnGeometry=true;if(map){_678.outSpatialReference=new _5e9(map.spatialReference.toJson());}if(!this._applyQueryFilters(_678)){_679={features:[]};this._selectHandler(_679,_675,_676,_677,dfd);return dfd;}var _67a=this._canDoClientSideQuery(_678);if(_67a){_679={features:this._doQuery(_678,_67a)};this._selectHandler(_679,_675,_676,_677,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+this.invalidParams);this._resolve([err],null,_677,dfd,true);return dfd;}var self=this;if(this._ts){_678._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_678);temp.addCallbacks(function(_67b){self._selectHandler(_67b,_675,_676,_677,dfd);},function(err){self._resolve([err],null,_677,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _67c=this._selectedFeatures,_67d=[],item;for(item in _67c){if(_67c.hasOwnProperty(item)){_67d.push(_67c[item]);}}return _67d;},clearSelection:function(_67e){var _67f=this._selectedFeatures,mode=this._mode,item;for(item in _67f){if(_67f.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_67e){this.onSelectionClear();}return this;},setSelectionSymbol:function(_680){this._selectionSymbol=_680;if(_680){var _681=this._selectedFeatures,item;for(item in _681){if(_681.hasOwnProperty(item)){_681[item].setSymbol(_680);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_682,_683,_684,_685,_686){var _687=_686.assembly,dfd=_686.dfd;this._applyNormalized(adds,_687&&_687[0]);this._applyNormalized(_682,_687&&_687[1]);this.onBeforeApplyEdits(adds,_682,_683);var i,_688={},_689=this.objectIdField,_68a={f:"json"},_68b=false;if(this._collection){var _68c={};_68c.addResults=adds?_5e0.map(adds,function(){_68b=true;return {objectId:this._nextId++,success:true};},this):null;_68c.updateResults=_682?_5e0.map(_682,function(_68d){_68b=true;var oid=_68d.attributes[_689];_688[oid]=_68d;return {objectId:oid,success:true};},this):null;_68c.deleteResults=_683?_5e0.map(_683,function(_68e){_68b=true;return {objectId:_68e.attributes[_689],success:true};},this):null;if(_68b){this._editHandler(_68c,adds,_688,_684,_685,dfd);}return;}if(adds&&adds.length>0){_68a.adds=this._convertFeaturesToJson(adds,0,1);_68b=true;}if(_682&&_682.length>0){for(i=0;i<_682.length;i++){var _68f=_682[i];_688[_68f.attributes[_689]]=_68f;}_68a.updates=this._convertFeaturesToJson(_682,0,0,1);_68b=true;}if(_683&&_683.length>0){var ids=[];for(i=0;i<_683.length;i++){ids.push(_683[i].attributes[_689]);}_68a.deletes=ids.join(",");_68b=true;}if(_68b){var self=this;return _5e7({url:this._url.path+"/applyEdits",content:lang.mixin(_68a,this._url.query),callbackParamName:"callback",load:function(_690){self._editHandler(_690,adds,_688,_684,_685,dfd);},error:function(err){self._resolve([err],null,_685,dfd,true);}},{usePost:true});}},queryFeatures:function(_691,_692,_693){return this._query("execute","onQueryFeaturesComplete",_691,_692,_693);},queryRelatedFeatures:function(_694,_695,_696){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_694,_695,_696);},queryIds:function(_697,_698,_699){return this._query("executeForIds","onQueryIdsComplete",_697,_698,_699);},queryCount:function(_69a,_69b,_69c){return this._query("executeForCount","onQueryCountComplete",_69a,_69b,_69c);},queryAttachmentInfos:function(_69d,_69e,_69f){var url=this._url.path+"/"+_69d+"/attachments",dfd=new _5e2(_5e8._dfdCanceller),self=this;dfd._pendingDfd=_5e7({url:url,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_6a0){var _6a1=_6a0.attachmentInfos,_6a2;_5e0.forEach(_6a1,function(info){_6a2=ioq.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_6a2?("?"+_6a2):"");info.objectId=_69d;});self._resolve([_6a1],"onQueryAttachmentInfosComplete",_69e,dfd);},error:function(err){self._resolve([err],null,_69f,dfd,true);}});return dfd;},addAttachment:function(_6a3,_6a4,_6a5,_6a6){return this._sendAttachment("add",_6a3,_6a4,_6a5,_6a6);},updateAttachment:function(_6a7,_6a8,_6a9,_6aa,_6ab){_6a9.appendChild(_5e4.create("input",{type:"hidden",name:"attachmentId",value:_6a8}));return this._sendAttachment("update",_6a7,_6a9,_6aa,_6ab);},deleteAttachments:function(_6ac,_6ad,_6ae,_6af){var url=this._url.path+"/"+_6ac+"/deleteAttachments",dfd=new _5e2(_5e8._dfdCanceller),self=this,_6b0={f:"json",attachmentIds:_6ad.join(",")};dfd._pendingDfd=_5e7({url:url,content:lang.mixin(_6b0,this._url.query),callbackParamName:"callback",load:lang.hitch(this,function(_6b1){var _6b2=_6b1.deleteAttachmentResults;_6b2=_5e0.map(_6b2,function(_6b3){var res=new _5fc(_6b3);res.attachmentId=res.objectId;res.objectId=_6ac;return res;});self._resolve([_6b2],"onDeleteAttachmentsComplete",_6ae,dfd);}),error:function(err){self._resolve([err],null,_6af,dfd,true);}},{usePost:true});return dfd;},addType:function(_6b4){var _6b5=this.types;if(_6b5){var _6b6=_5e0.some(_6b5,function(type){if(type.id==_6b4.id){return true;}return false;});if(_6b6){return false;}else{_6b5.push(_6b4);}}else{this.types=[_6b4];}this._typesDirty=true;return true;},deleteType:function(_6b7){if(!this._collection){return;}var _6b8=this.types;if(_6b8){var _6b9=-1;_5e0.some(_6b8,function(type,_6ba){if(type.id==_6b7){_6b9=_6ba;return true;}return false;});if(_6b9>-1){this._typesDirty=true;return _6b8.splice(_6b9,1)[0];}}},toJson:function(){var _6bb=this._json,json=lang.isString(_6bb)?_5e1.fromJson(_6bb):lang.clone(_6bb);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _6bc=json.layerDefinition,_6bd=this._collection;if(_6bd&&this._typesDirty){_6bc.types=_5e0.map(this.types||[],function(type){return type.toJson();});var _6be=this.renderer,_6bf=_6bc.drawingInfo;if(_6bf&&_6be&&_6be.declaredClass.indexOf("TemporalRenderer")===-1){_6bf.renderer=_6be.toJson();}}var _6c0=null;if(!(_6bd&&!this._fcAdded)){_6c0={geometryType:_6bc.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=lang.mixin({},json.featureSet||{},_6c0);if(_6bd){json.nextObjectId=this._nextId;_6bc.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_6c1){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&_5e5.id&&_5e5.id._hasPortalSession()&&_5e5.id._doPortalSignIn(path)){_5e5.id.getCredential(path).then(function(){self._findCredential();_6c1.call(self);},function(){_6c1.call(self);});}else{_6c1.call(this);}},_updateCaps:function(){var _6c2=this._editable,_6c3=lang.trim(this.capabilities||""),_6c4=_5e0.map((_6c3?_6c3.split(","):[]),lang.trim),caps=_5e0.map((_6c3?_6c3.toLowerCase().split(","):[]),lang.trim),_6c5=_5e0.indexOf(caps,"editing"),cap,i,_6c6,_6c7={"Create":_5e0.indexOf(caps,"create"),"Update":_5e0.indexOf(caps,"update"),"Delete":_5e0.indexOf(caps,"delete")};if(_6c2&&_6c5===-1){_6c4.push("Editing");}else{if(!_6c2&&_6c5>-1){_6c6=[_6c5];for(cap in _6c7){if(_6c7[cap]>-1){_6c6.push(_6c7[cap]);}}_6c6.sort();for(i=_6c6.length-1;i>=0;i--){_6c4.splice(_6c6[i],1);}}}this.capabilities=_6c4.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_6c8=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_6c8&&(_6c8.latestObservationRenderer||_6c8.trackRenderer))){this._trackManager=new _600(this);this._trackManager.initialize(map);}}this._zoomConnect=_5df.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.startup():mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_6c9){var map=this._map;if(_6c9&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_5df.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_5df.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_6ca){this._mapTimeExtent=_6ca;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_6cb){var _6cc=this._timeOffset,_6cd=this._timeOffsetUnits;return (_6cb&&_6cc&&_6cd)?_6cb.offset(-1*_6cc,_6cd):_6cb;},_getTimeOverlap:function(_6ce,_6cf){if(_6ce&&_6cf){return _6ce.intersection(_6cf);}else{return _6ce||_6cf;}},_getTimeFilter:function(_6d0){var _6d1=this.getTimeDefinition(),_6d2=null,_6d3;if(_6d1||_6d2){_6d3=this._getTimeOverlap(_6d1,_6d2);if(!_6d3){return [false];}}if(_6d0){_6d0=_6d3?this._getTimeOverlap(_6d0,_6d3):_6d0;if(!_6d0){return [false];}}else{_6d0=_6d3;}return [true,_6d0];},_getAttributeFilter:function(_6d4){var _6d5=this.getDefinitionExpression();if(_6d4){_6d4=_6d5?"("+_6d5+") AND ("+_6d4+")":_6d4;}else{_6d4=_6d5;}return _6d4;},_applyQueryFilters:function(_6d6){_6d6.where=this._getAttributeFilter(_6d6.where);_6d6.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _6d7=this._getTimeFilter(_6d6.timeExtent);if(!_6d7[0]){return false;}else{_6d6.timeExtent=_6d7[1];}}return true;},_add:function(_6d8){var _6d9=this._selectionSymbol,attr=_6d8.attributes,_6da=this.visibilityField;if(_6d9&&this._isSelOnly){_6d8.setSymbol(_6d9);}if(_6da&&attr&&attr.hasOwnProperty(_6da)){_6d8[attr[_6da]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_6db){var _6dc=[],map=this._map;if(this._isTable||!map){return;}if(_6db.text||(_6db.where&&_6db.where!==this.getDefinitionExpression())){return;}var _6dd=this._isSnapshot,_6de=this._isSelOnly;var _6df=_6db.geometry;if(_6df){if(!_6de&&_6db.spatialRelationship===_5f2.SPATIAL_REL_INTERSECTS&&(_6df.type==="extent"&&(_6dd||map.extent.contains(_6df)))){_6dc.push(1);}else{return;}}var ids=_6db.objectIds;if(ids){if(_6dd){_6dc.push(2);}else{var len=ids.length,mode=this._mode,_6e0=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_6e0++;}}if(_6e0===len){_6dc.push(2);}else{return;}}}if(this.timeInfo){var _6e1=_6db.timeExtent,_6e2=this._mapTimeExtent;if(_6dd){if(_6e1){_6dc.push(3);}}else{if(_6de){if(_6e1){return;}}else{if(_6e2){if(_5e0.indexOf(_6dc,2)!==-1){if(_6e1){_6dc.push(3);}}else{return;}}else{if(_6dc.length>0){if(_6e1){_6dc.push(3);}}else{if(_6e1){return;}}}}}}return _6dc.length>0?_6dc:null;},_doQuery:function(_6e3,_6e4,_6e5){var _6e6=[],mode=this._mode,_6e7=this.objectIdField,i,len,_6e8;if(_5e0.indexOf(_6e4,2)!==-1){_6e6=[];var ids=_6e3.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_6e6.push(obj);}}if(_6e6.length===0){return [];}}if(_5e0.indexOf(_6e4,1)!==-1){_6e8=_6e6.length>0?_6e6:this.graphics;len=_6e8.length;var _6e9=_6e3.geometry._normalize(null,true);_6e6=[];for(i=0;i<len;i++){var _6ea=_6e8[i],_6eb=_6ea.geometry;if(_6eb){if(this.normalization&&_6e9.length){if(_6e9[0].intersects(_6eb)||_6e9[1].intersects(_6eb)){_6e6.push(_6ea);}}else{if(_6e9.intersects(_6eb)){_6e6.push(_6ea);}}}}if(_6e6.length===0){return [];}}if(_5e0.indexOf(_6e4,3)!==-1){if(this.timeInfo){_6e8=_6e6.length>0?_6e6:this.graphics;var time=_6e3.timeExtent,_6ec=this._filterByTime(_6e8,time.startTime,time.endTime);_6e6=_6ec.match;}}if(_6e5){return _5e0.map(_6e6,function(obj){return obj.attributes[_6e7];},this);}else{return _6e6;}},_filterByTime:function(_6ed,_6ee,_6ef){var _6f0=this._startTimeField,_6f1=this._endTimeField,_6f2;if(!this._twoTimeFields){_6f2=_6f0||_6f1;}var _6f3=_5e6.isDefined,yea=[],nay=[],i,len=_6ed.length,_6f4,_6f5;_6ee=_6ee?_6ee.getTime():-Infinity;_6ef=_6ef?_6ef.getTime():Infinity;if(_6f2){for(i=0;i<len;i++){_6f4=_6ed[i];_6f5=_6f4.attributes;var time=_6f5[_6f2];if(time>=_6ee&&time<=_6ef){yea.push(_6f4);}else{nay.push(_6f4);}}}else{for(i=0;i<len;i++){_6f4=_6ed[i];_6f5=_6f4.attributes;var _6f6=_6f5[_6f0],end=_6f5[_6f1];_6f6=_6f3(_6f6)?_6f6:-Infinity;end=_6f3(end)?end:Infinity;if((_6f6>=_6ee&&_6f6<=_6ef)||(end>=_6ee&&end<=_6ef)||(_6ee>=_6f6&&_6ef<=end)){yea.push(_6f4);}else{nay.push(_6f4);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_6f7,_6f8,dfd,_6f9){if(_6f7){this[_6f7].apply(this,args);}if(_6f8){_6f8.apply(null,args);}if(dfd){_5e8._resDfd(dfd,args,_6f9);}},_getShallowClone:function(_6fa){var _6fb=new _5f2(),prop;for(prop in _6fa){if(_6fa.hasOwnProperty(prop)){_6fb[prop]=_6fa[prop];}}return _6fb;},_query:function(type,_6fc,_6fd,_6fe,_6ff){var that=this,map=this._map,dfd=new _5e2(_5e8._dfdCanceller),_700=_6fd;var _701=function(_702,_703){if(!_703&&type==="execute"&&!that._isTable){var _704=_702.features,mode=that._mode,_705=that.objectIdField,il=_704.length,i;for(i=il-1;i>=0;i--){var oid=_704[i].attributes[_705];var _706=mode._getFeature(oid);if(_706){_704.splice(i,1,_706);}}}that._resolve([_702],_6fc,_6fe,dfd);};if(type!=="executeRelationshipQuery"){_700=this._getShallowClone(_6fd);_700.outFields=this._getOutFields();_700.returnGeometry=(!map&&_6fd.hasOwnProperty("returnGeometry"))?_6fd.returnGeometry:true;var _707;if(map){_700.outSpatialReference=new _5e9(map.spatialReference.toJson());}if(!this._applyQueryFilters(_700)){switch(type){case "execute":_707=new _5f3({features:[]});break;case "executeForIds":_707=[];break;case "executeForCount":_707=0;break;}_701(_707,true);return dfd;}var _708=this._canDoClientSideQuery(_700);if(_708){var _709=this._doQuery(_700,_708,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_707=new _5f3();_707.features=_709;break;case "executeForIds":_707=_709;break;case "executeForCount":_707=_709.length;break;}_701(_707,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+this.invalidParams);this._resolve([err],null,_6ff,dfd,true);return dfd;}if(this._ts){_700._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_700);temp.addCallbacks(_701,function(err){that._resolve([err],null,_6ff,dfd,true);});return dfd;},_convertFeaturesToJson:function(_70a,_70b,_70c,_70d){var json=[],_70e=this._selectionSymbol,_70f=this.visibilityField,i,_710,_711=this.objectIdField;if(this.loaded&&(_70c||_70d)){_710=_5e0.filter(this.fields,function(_712){return (_712.editable===false)&&(!_70d||(_712.name!==_711));});}for(i=0;i<_70a.length;i++){var _713=_70a[i],_714={},_715=_713.geometry,attr=_713.attributes,_716=_713.symbol;if(_715&&(!_70d||!this.loaded||this.allowGeometryUpdates)){_714.geometry=_715.toJson();}if(_70f){_714.attributes=attr=lang.mixin({},attr);attr[_70f]=_713.visible?1:0;}else{if(attr){_714.attributes=lang.mixin({},attr);}}if(_714.attributes&&_710&&_710.length){_5e0.forEach(_710,function(_717){delete _714.attributes[_717.name];});}if(_716&&(_716!==_70e)){_714.symbol=_716.toJson();}json.push(_714);}return _70b?json:_5e1.toJson(json);},_selectHandler:function(_718,_719,_71a,_71b,dfd){var _71c,ctor=this.constructor;switch(_719){case ctor.SELECTION_NEW:this.clearSelection(true);_71c=true;break;case ctor.SELECTION_ADD:_71c=true;break;case ctor.SELECTION_SUBTRACT:_71c=false;break;}var i,_71d=_718.features,mode=this._mode,_71e=[],_71f=this.objectIdField,_720,oid;if(_71c){for(i=0;i<_71d.length;i++){_720=_71d[i];oid=_720.attributes[_71f];var _721=mode._addFeatureIIf(oid,_720);_71e.push(_721);this._selectFeatureIIf(oid,_721,mode);}}else{for(i=0;i<_71d.length;i++){_720=_71d[i];oid=_720.attributes[_71f];this._unSelectFeatureIIf(oid,mode);var _722=mode._removeFeatureIIf(oid);_71e.push(_722||_720);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_71e,_719,_718.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_71a,dfd);if(_718.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_723,mode){var _724=this._selectedFeatures,_725=_724[oid];if(!_725){mode._incRefCount(oid);_724[oid]=_723;if(!this._isTable){this._setSelectSymbol(_723);}}return _725||_723;},_unSelectFeatureIIf:function(oid,mode){var _726=this._selectedFeatures[oid];if(_726){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_726);}}return _726;},_isSelected:function(_727){},_setSelectSymbol:function(_728){var _729=this._selectionSymbol;if(_729&&!this._isSelOnly){_728.setSymbol(_729);}},_setUnSelectSymbol:function(_72a){var _72b=this._selectionSymbol;if(_72b&&!this._isSelOnly){if(_72b===_72a.symbol){_72a.setSymbol(null,true);}}},_getOutFields:function(){var _72c=_5e0.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_72d,_72e,arr){return !!_72d&&(_5e0.indexOf(arr,_72d)===_72e);});var _72f=lang.clone(this._outFields);if(_72f){if(_5e0.indexOf(_72f,"*")!==-1){return _72f;}_5e0.forEach(_72c,function(_730){if(_5e0.indexOf(_72f,_730)===-1){_72f.push(_730);}});return _72f;}else{return _72c;}},_checkFields:function(_731){var _732=_731||this._getOutFields();_5e0.forEach(_732,function(_733){if(_733==="*"){return;}if(!this._getField(_733)){console.debug("esri.layers.FeatureLayer: "+_5e6.substitute({url:this.url,field:_733},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]"));}},this);if(!_731&&!this._isTable&&!this._fserver&&!this._collection){var _734=_5e0.some(this.fields,function(_735){return (_735&&_735.type==="esriFieldTypeGeometry")?true:false;});if(!_734){console.debug("esri.layers.FeatureLayer: "+_5e6.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"));}}},_fixRendererFields:function(){var _736=this.renderer;if(_736&&this.fields.length>0){var _737=_5e0.filter([_736,_736.observationRenderer,_736.latestObservationRenderer,_736.trackRenderer],_5e6.isDefined);var _738=[];_5e0.forEach(_737,function(rnd){var _739,_73a;_73a=rnd.attributeField;if(_73a&&!lang.isFunction(_73a)){_739=!this._getField(_73a)&&this._getField(_73a,true);if(_739){rnd.attributeField=_739.name;}}_73a=rnd.attributeField2;if(_73a){_739=!this._getField(_73a)&&this._getField(_73a,true);if(_739){rnd.attributeField2=_739.name;}}_73a=rnd.attributeField3;if(_73a){_739=!this._getField(_73a)&&this._getField(_73a,true);if(_739){rnd.attributeField3=_739.name;}}if(!lang.isFunction(rnd.attributeField)){_738.push(rnd.attributeField);}_738.push(rnd.attributeField2);_738.push(rnd.attributeField3);},this);this._rendererFields=_5e0.filter(_738,_5e6.isDefined);}},_getField:function(_73b,_73c){var _73d=this.fields;if(_73d.length===0){return null;}var _73e;if(_73c){_73b=_73b.toLowerCase();}_5e0.some(_73d,function(_73f){var _740=false;if(_73c){_740=(_73f&&_73f.name.toLowerCase()===_73b)?true:false;}else{_740=(_73f&&_73f.name===_73b)?true:false;}if(_740){_73e=_73f;}return _740;});return _73e;},_getDateOpts:function(){if(!this._dtOpts){var _741=_5e0.map(_5e0.filter(this.fields,function(_742){return !!(_742&&_742.type==="esriFieldTypeDate");}),function(_743){return _743.name;});this._dtOpts={properties:_741};}return this._dtOpts;},_applyNormalized:function(_744,_745){if(_744&&_745){_5e0.forEach(_744,function(_746,_747){if(_746&&_745[_747]){_746.setGeometry(_745[_747]);}});}},_editHandler:function(_748,adds,_749,_74a,_74b,dfd){var _74c=_748.addResults,_74d=_748.updateResults,_74e=_748.deleteResults,i,_74f,oid,_750,attr,_751=this.objectIdField,mode=this._mode,_752=this._isTable;var _753=this.editFieldsInfo,_754=this._getOutFields()||[],_755=_753&&_753.creatorField,_756=_753&&_753.creationDateField,_757=_753&&_753.editorField,_758=_753&&_753.editDateField,_759=_753&&_753.realm;if(_5e0.indexOf(_754,"*")===-1){if(_755&&_5e0.indexOf(_754,_755)===-1){_755=null;}if(_756&&_5e0.indexOf(_754,_756)===-1){_756=null;}if(_757&&_5e0.indexOf(_754,_757)===-1){_757=null;}if(_758&&_5e0.indexOf(_754,_758)===-1){_758=null;}}var _75a=(_756||_758)?(new Date()).getTime():null,_75b=(_755||_757)?this.getUserId():undefined;if(_75b&&_759){_75b=_75b+"@"+_759;}if(_74c){for(i=0;i<_74c.length;i++){_74c[i]=new _5fc(_74c[i]);if(_752){continue;}_74f=_74c[i];if(_74f.success){oid=_74f.objectId;_750=adds[i];var gl=_750._graphicsLayer;if(gl&&gl!==this){gl.remove(_750);}attr=_750.attributes||{};attr[_751]=oid;if(_755){attr[_755]=_75b;}if(_757){attr[_757]=_75b;}if(_756){attr[_756]=_75a;}if(_758){attr[_758]=_75a;}_750.setAttributes(attr);if(mode._init){mode.drawFeature(_750);}}}}if(_74d){for(i=0;i<_74d.length;i++){_74d[i]=new _5fc(_74d[i]);if(_752){continue;}_74f=_74d[i];if(_74f.success){oid=_74f.objectId;_750=_749[oid];var _75c=mode._getFeature(oid);if(_75c){if(_75c.geometry!==_750.geometry){_75c.setGeometry(_5f5.fromJson(_750.geometry.toJson()));}this._repaint(_75c,oid);}_750=_75c||_750;attr=_750.attributes||{};if(_757){attr[_757]=_75b;}if(_758){attr[_758]=_75a;}_750.setAttributes(attr);}}}if(_74e){var _75d=[];for(i=0;i<_74e.length;i++){_74e[i]=new _5fc(_74e[i]);if(_752){continue;}_74f=_74e[i];if(_74f.success){oid=_74f.objectId;_750=mode._getFeature(oid);if(_750){if(this._unSelectFeatureIIf(oid,mode)){_75d.push(_750);}_750._count=0;mode._removeFeatureIIf(oid);}}}if(_75d.length>0){this.onSelectionComplete(_75d,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_74c,_74d,_74e],"onEditsComplete",_74a,dfd);},_sendAttachment:function(type,_75e,_75f,_760,_761){var _762=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_75e+"/"+_762,self=this;var dfd=_5e7({url:url,form:_75f,content:lang.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_763){var _764=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_765=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_766=new _5fc(_763[_764]);_766.attachmentId=_766.objectId;_766.objectId=_75e;self._resolve([_766],_765,_760);return _766;}).addErrback(function(_767){self._resolve([_767],null,_761,null,true);});return dfd;},_repaint:function(_768,oid,_769){oid=_5e6.isDefined(oid)?oid:_768.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_768.setSymbol(_768.symbol,_769);}},_getKind:function(_76a){var _76b=this._trackManager;if(_76b){return _76b.isLatestObservation(_76a)?1:0;}return 0;}});lang.mixin(_601,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});_5f6._createWrappers(_601);if(has("extend-esri")){lang.setObject("layers.FeatureLayer",_601,_5e5);}return _601;});},"dijit/form/_ListMouseMixin":function(){define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/mouse","dojo/on","dojo/touch","./_ListBase"],function(_76c,_76d,on,_76e,_76f){return _76c("dijit.form._ListMouseMixin",_76f,{postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,_76e.press,function(evt){evt.preventDefault();}));this._listConnect(_76e.press,"_onMouseDown");this._listConnect(_76e.release,"_onMouseUp");this._listConnect(_76d.enter,"_onMouseOver");this._listConnect(_76d.leave,"_onMouseOut");},_onMouseDown:function(evt,_770){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(_770);},_onMouseUp:function(evt,_771){this._isDragging=false;var _772=this.selected;var _773=this._hoveredNode;if(_772&&_771==_772){this.onClick(_772);}else{if(_773&&_771==_773){this._setSelectedAttr(_773);this.onClick(_773);}}},_onMouseOut:function(evt,_774){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt,_775){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}this._hoveredNode=_775;this.onHover(_775);if(this._isDragging){this._setSelectedAttr(_775);}}});});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_776,arr,_777,_778,_779,_77a,win,_77b,_77c){return _776("dojox.gfx.Moveable",null,{constructor:function(_77d,_77e){this.shape=_77d;this.delay=(_77e&&_77e.delay>0)?_77e.delay:0;this.mover=(_77e&&_77e.mover)?_77e.mover:_77b;this.leftButtonOnly=_77e&&_77e.leftButtonOnly;this.events=[this.shape.connect(_779.press,lang.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_77f){_77f.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_779.move,lang.hitch(this,"onMouseMove")),this.shape.connect(_779.release,lang.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_77c.isLeft(e)){new this.mover(this.shape,e,this);}}_777.stop(e);},onMouseMove:function(e){var _780=e.clientX,_781=e.clientY;if(Math.abs(_780-this._lastX)>this.delay||Math.abs(_781-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_777.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_782){_778.publish("/gfx/move/start",_782);_77a.add(win.body(),"dojoMove");},onMoveStop:function(_783){_778.publish("/gfx/move/stop",_783);_77a.remove(win.body(),"dojoMove");},onFirstMove:function(_784){},onMove:function(_785,_786){this.onMoving(_785,_786);this.shape.applyLeftTransform(_786);this.onMoved(_785,_786);},onMoving:function(_787,_788){},onMoved:function(_789,_78a){}});});},"dijit/_editor/RichText":function(){define("dijit/_editor/RichText",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/query","dojo/ready","dojo/sniff","dojo/topic","dojo/_base/unload","dojo/_base/url","dojo/_base/window","../_Widget","../_CssStateMixin","./selection","./range","./html","../focus","../main"],function(_78b,_78c,_78d,_78e,dom,_78f,_790,_791,_792,_793,_794,_795,keys,lang,on,_796,_797,has,_798,_799,_79a,win,_79b,_79c,_79d,_79e,_79f,_7a0,_7a1){var _7a2=_78d("dijit._editor.RichText",[_79b,_79c],{constructor:function(_7a3){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};if(_7a3&&lang.isString(_7a3.value)){this.value=_7a3.value;}this.onLoadDeferred=new _78e();},baseClass:"dijitEditor",inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"===this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}this.contentPreFilters=[lang.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);if(has("mozilla")){this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters);this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters);}if(has("webkit")){this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters);this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters);}if(has("ie")){this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters);this.contentDomPostFilters=[lang.hitch(this,this._stripBreakerNodes)].concat(this.contentDomPostFilters);}this.inherited(arguments);_798.publish(_7a1._scopeName+"._editor.RichText::init",this);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var exec=lang.hitch(this,function(cmd,arg){return function(){return !this.execCommand(cmd,arg);};});var _7a4={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};if(!has("ie")){_7a4.Z=exec("redo");}var key;for(key in _7a4){this.addKeyHandler(key,true,false,_7a4[key]);}},events:["onKeyPress","onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(_7a2._editorCommandsLocalized){this._local2NativeFormatNames=_7a2._local2NativeFormatNames;this._native2LocalFormatNames=_7a2._native2LocalFormatNames;return;}_7a2._editorCommandsLocalized=true;_7a2._local2NativeFormatNames={};_7a2._native2LocalFormatNames={};this._local2NativeFormatNames=_7a2._local2NativeFormatNames;this._native2LocalFormatNames=_7a2._native2LocalFormatNames;var _7a5=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _7a6="",_7a7,i=0;while((_7a7=_7a5[i++])){if(_7a7.charAt(1)!=="l"){_7a6+="<"+_7a7+"><span>content</span></"+_7a7+"><br/>";}else{_7a6+="<"+_7a7+"><li>content</li></"+_7a7+"><br/>";}}var _7a8={position:"absolute",top:"0px",zIndex:10,opacity:0.01};var div=_791.create("div",{style:_7a8,innerHTML:_7a6});this.ownerDocumentBody.appendChild(div);var _7a9=lang.hitch(this,function(){var node=div.firstChild;while(node){try{this._sCall("selectElement",[node.firstChild]);var _7aa=node.tagName.toLowerCase();this._local2NativeFormatNames[_7aa]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_7aa]]=_7aa;node=node.nextSibling.nextSibling;}catch(e){}}_791.destroy(div);});this.defer(_7a9);},open:function(_7ab){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new _78e();}if(!this.isClosed){this.close();}_798.publish(_7a1._scopeName+"._editor.RichText::open",this);if(arguments.length===1&&_7ab.nodeName){this.domNode=_7ab;}var dn=this.domNode;var html;if(lang.isString(this.value)){html=this.value;delete this.value;dn.innerHTML="";}else{if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;html=ta.value;dn=this.domNode=this.ownerDocument.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;_791.place(dn,ta,"before");var _7ac=lang.hitch(this,function(){_793.set(ta,{display:"block",position:"absolute",top:"-1000px"});if(has("ie")){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(has("ie")){this.defer(_7ac,10);}else{_7ac();}if(ta.form){var _7ad=ta.value;this.reset=function(){var _7ae=this.getValue();if(_7ae!==_7ad){this.replaceValue(_7ad);}};on(ta.form,"submit",lang.hitch(this,function(){_78f.set(ta,"disabled",this.disabled);ta.value=this.getValue();}));}}else{html=_79f.getChildrenHtml(dn);dn.innerHTML="";}}this.value=html;if(dn.nodeName&&dn.nodeName==="LI"){dn.innerHTML=" <br>";}this.header=dn.ownerDocument.createElement("div");dn.appendChild(this.header);this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);this.footer=dn.ownerDocument.createElement("div");dn.appendChild(this.footer);if(!this.name){this.name=this.id+"_AUTOGEN";}if(this.name!==""&&(!_78c["useXDomain"]||_78c["allowXdRichTextSave"])){var _7af=dom.byId(_7a1._scopeName+"._editor.RichText.value");if(_7af&&_7af.value!==""){var _7b0=_7af.value.split(this._SEPARATOR),i=0,dat;while((dat=_7b0[i++])){var data=dat.split(this._NAME_CONTENT_SEP);if(data[0]===this.name){html=data[1];_7b0=_7b0.splice(i,1);_7af.value=_7b0.join(this._SEPARATOR);break;}}}if(!_7a2._globalSaveHandler){_7a2._globalSaveHandler={};_799.addOnUnload(function(){var id;for(id in _7a2._globalSaveHandler){var f=_7a2._globalSaveHandler[id];if(lang.isFunction(f)){f();}}});}_7a2._globalSaveHandler[this.id]=lang.hitch(this,"_saveContent");}this.isClosed=false;var ifr=(this.editorObject=this.iframe=this.ownerDocument.createElement("iframe"));ifr.id=this.id+"_iframe";ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(has("ie")>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=lang.hitch(this,function(w){this.window=w;this.document=this.window.document;if(has("ie")){this._localizeEditorCommands();}this.onLoad(html);});var src=this._getIframeDocTxt(),s="javascript: '"+src.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(has("safari")<=4){src=ifr.getAttribute("src");if(!src||src.indexOf("javascript")===-1){this.defer(function(){ifr.setAttribute("src",s);});}}if(dn.nodeName==="LI"){dn.lastChild.style.marginTop="-1.2em";}_790.add(this.domNode,this.baseClass);},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var _7b1=_793.getComputedStyle(this.domNode);var html="";var _7b2=true;if(has("ie")||has("webkit")||(!this.height&&!has("mozilla"))){html="<div id='dijitEditorBody'></div>";_7b2=false;}else{if(has("mozilla")){this._cursorToStart=true;html="&#160;";}}var font=[_7b1.fontWeight,_7b1.fontSize,_7b1.fontFamily].join(" ");var _7b3=_7b1.lineHeight;if(_7b3.indexOf("px")>=0){_7b3=parseFloat(_7b3)/parseFloat(_7b1.fontSize);}else{if(_7b3.indexOf("em")>=0){_7b3=parseFloat(_7b3);}else{_7b3="normal";}}var _7b4="";var self=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(_7b5){_7b5=_7b5.replace(/^;/ig,"")+";";var s=_7b5.split(":")[0];if(s){s=lang.trim(s);s=s.toLowerCase();var i;var sC="";for(i=0;i<s.length;i++){var c=s.charAt(i);switch(c){case "-":i++;c=s.charAt(i).toUpperCase();default:sC+=c;}}_793.set(self.domNode,sC,"");}_7b4+=_7b5+";";});var _7b6=_796("label[for=\""+this.id+"\"]");return [this.isLeftToRight()?"<html>\n<head>\n":"<html dir='rtl'>\n<head>\n",(has("mozilla")&&_7b6.length?"<title>"+_7b6[0].innerHTML+"</title>\n":""),"<meta http-equiv='Content-Type' content='text/html'>\n","<style>\n","\tbody,html {\n","\t\tbackground:transparent;\n","\t\tpadding: 1px 0 0 0;\n","\t\tmargin: -1px 0 0 0;\n",((has("webkit"))?"\t\twidth: 100%;\n":""),((has("webkit"))?"\t\theight: 100%;\n":""),"\t}\n","\tbody{\n","\t\ttop:0px;\n","\t\tleft:0px;\n","\t\tright:0px;\n","\t\tfont:",font,";\n",((this.height||has("opera"))?"":"\t\tposition: fixed;\n"),"\t\tmin-height:",this.minHeight,";\n","\t\tline-height:",_7b3,";\n","\t}\n","\tp{ margin: 1em 0; }\n",(!_7b2&&!this.height?"\tbody,html {overflow-y: hidden;}\n":""),"\t#dijitEditorBody{overflow-x: auto; overflow-y:"+(this.height?"auto;":"hidden;")+" outline: 0px;}\n","\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\n",(!has("ie")?"\tli{ min-height:1.2em; }\n":""),"</style>\n",this._applyEditingAreaStyleSheets(),"\n","</head>\n<body ",(_7b2?"id='dijitEditorBody' ":""),"onload='frameElement && frameElement._loadFunc(window,document)' ","style='"+_7b4+"'>",html,"</body>\n</html>"].join("");},_applyEditingAreaStyleSheets:function(){var _7b7=[];if(this.styleSheets){_7b7=this.styleSheets.split(";");this.styleSheets="";}_7b7=_7b7.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var text="",i=0,url;while((url=_7b7[i++])){var _7b8=(new _79a(win.global.location,url)).toString();this.editingAreaStyleSheets.push(_7b8);text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_7b8+"\"/>";}return text;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _79a(win.global.location,url)).toString();}if(_78b.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);this.onLoadDeferred.then(lang.hitch(this,function(){if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var head=this.document.getElementsByTagName("head")[0];var _7b9=this.document.createElement("link");_7b9.rel="stylesheet";_7b9.type="text/css";_7b9.href=url;head.appendChild(_7b9);}}));},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _79a(win.global.location,url)).toString();}var _7ba=_78b.indexOf(this.editingAreaStyleSheets,url);if(_7ba===-1){return;}delete this.editingAreaStyleSheets[_7ba];_796("link:[href=\""+url+"\"]",this.window.document).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_7bb){_7bb=!!_7bb;this._set("disabled",_7bb);if(!this.isLoaded){return;}if(has("ie")||has("webkit")||has("opera")){var _7bc=has("ie")&&(this.isLoaded||!this.focusOnLoad);if(_7bc){this.editNode.unselectable="on";}this.editNode.contentEditable=!_7bb;if(_7bc){this.defer(function(){if(this.editNode){this.editNode.unselectable="off";}});}}else{try{this.document.designMode=(_7bb?"off":"on");}catch(e){return;}if(!_7bb&&this._mozSettingProps){var ps=this._mozSettingProps;var n;for(n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e2){}}}}}this._disabledOK=true;},onLoad:function(html){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;this._iframeRegHandle=_7a0.registerIframe(this.iframe);}if(!has("ie")&&!has("webkit")&&(this.height||has("mozilla"))){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _7bd=this;if(has("ie")){this.tabStop=_791.create("div",{tabIndex:-1},this.editingArea);this.iframe.onfocus=function(){_7bd.editNode.setActive();};}}this.focusNode=this.editNode;var _7be=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;_78b.forEach(_7be,function(item){this.connect(ap,item.toLowerCase(),item);},this);this.connect(ap,"onmouseup","onClick");if(has("ie")){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}else{this.connect(this.document,"onmousedown",function(){delete this._cursorToStart;});}if(has("webkit")){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");this.connect(this.document,"onmousedown",function(e){var t=e.target;if(t&&(t===this.document.body||t===this.document)){this.defer("placeCursorAtEnd");}});}if(has("ie")){try{this.document.execCommand("RespectVisibilityInDesign",true,null);}catch(e){}}this.isLoaded=true;this.set("disabled",this.disabled);var _7bf=lang.hitch(this,function(){this.setValue(html);if(this.onLoadDeferred){this.onLoadDeferred.resolve(true);}this.onDisplayChanged();if(this.focusOnLoad){_797(lang.hitch(this,"defer","focus",this.updateInterval));}this.value=this.getValue(true);});if(this.setValueDeferred){this.setValueDeferred.then(_7bf);}else{_7bf();}},onKeyDown:function(e){if(e.keyCode===keys.TAB&&this.isTabIndent){_794.stop(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(has("ie")){if(e.keyCode==keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===keys.BACKSPACE&&this.document.selection.type==="Control"){_794.stop(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}if(has("ff")){if(e.keyCode===keys.PAGE_UP||e.keyCode===keys.PAGE_DOWN){if(this.editNode.clientHeight>=this.editNode.scrollHeight){e.preventDefault();}}}return true;},onKeyUp:function(){},setDisabled:function(_7c0){_795.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.set("disabled",_7c0);},_setValueAttr:function(_7c1){this.setValue(_7c1);},_setDisableSpellCheckAttr:function(_7c2){if(this.document){_78f.set(this.document.body,"spellcheck",!_7c2);}else{this.onLoadDeferred.then(lang.hitch(this,function(){_78f.set(this.document.body,"spellcheck",!_7c2);}));}this._set("disableSpellCheck",_7c2);},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode,_7c3=this._keyHandlers[c],args=arguments;if(_7c3&&!e.altKey){_78b.some(_7c3,function(h){if(!(h.shift^e.shiftKey)&&!(h.ctrl^(e.ctrlKey||e.metaKey))){if(!h.handler.apply(this,args)){e.preventDefault();}return true;}},this);}if(!this._onKeyHitch){this._onKeyHitch=lang.hitch(this,"onKeyPressed");}this.defer("_onKeyHitch",1);return true;},addKeyHandler:function(key,ctrl,_7c4,_7c5){if(!lang.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_7c4||false,ctrl:ctrl||false,handler:_7c5});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(){if(!this.focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _7c6=this.getValue(true);if(_7c6!==this.value){this.onChange(_7c6);}this._set("value",_7c6);},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.set("disabled",false);}this.inherited(arguments);}},blur:function(){if(!has("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(this.ownerDocumentBody.focus){this.ownerDocumentBody.focus();}}},focus:function(){if(!this.isLoaded){this.focusOnLoad=true;return;}if(this._cursorToStart){delete this._cursorToStart;if(this.editNode.childNodes){this.placeCursorAtStart();return;}}if(!has("ie")){_7a0.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(){if(this._updateTimer){this._updateTimer.remove();}this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(){},_normalizeCommand:function(cmd,_7c7){var _7c8=cmd.toLowerCase();if(_7c8==="formatblock"){if(has("safari")&&_7c7===undefined){_7c8="heading";}}else{if(_7c8==="hilitecolor"&&!has("mozilla")){_7c8="backcolor";}}return _7c8;},_qcaCache:{},queryCommandAvailable:function(_7c9){var ca=this._qcaCache[_7c9];if(ca!==undefined){return ca;}return (this._qcaCache[_7c9]=this._queryCommandAvailable(_7c9));},_queryCommandAvailable:function(_7ca){var ie=1;var _7cb=1<<1;var _7cc=1<<2;var _7cd=1<<3;function _7ce(_7cf){return {ie:Boolean(_7cf&ie),mozilla:Boolean(_7cf&_7cb),webkit:Boolean(_7cf&_7cc),opera:Boolean(_7cf&_7cd)};};var _7d0=null;switch(_7ca.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_7d0=_7ce(_7cb|ie|_7cc|_7cd);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_7d0=_7ce(_7cb|ie|_7cd|_7cc);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_7d0=_7ce(ie);break;case "cut":case "copy":case "paste":_7d0=_7ce(ie|_7cb|_7cc|_7cd);break;case "inserttable":_7d0=_7ce(_7cb|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_7d0=_7ce(ie|_7cb);break;default:return false;}return (has("ie")&&_7d0.ie)||(has("mozilla")&&_7d0.mozilla)||(has("webkit")&&_7d0.webkit)||(has("opera")&&_7d0.opera);},execCommand:function(_7d1,_7d2){var _7d3;this.focus();_7d1=this._normalizeCommand(_7d1,_7d2);if(_7d2!==undefined){if(_7d1==="heading"){throw new Error("unimplemented");}else{if((_7d1==="formatblock")&&has("ie")){_7d2="<"+_7d2+">";}}}var _7d4="_"+_7d1+"Impl";if(this[_7d4]){_7d3=this[_7d4](_7d2);}else{_7d2=arguments.length>1?_7d2:null;if(_7d2||_7d1!=="createlink"){_7d3=this.document.execCommand(_7d1,false,_7d2);}}this.onDisplayChanged();return _7d3;},queryCommandEnabled:function(_7d5){if(this.disabled||!this._disabledOK){return false;}_7d5=this._normalizeCommand(_7d5);var _7d6="_"+_7d5+"EnabledImpl";if(this[_7d6]){return this[_7d6](_7d5);}else{return this._browserQueryCommandEnabled(_7d5);}},queryCommandState:function(_7d7){if(this.disabled||!this._disabledOK){return false;}_7d7=this._normalizeCommand(_7d7);try{return this.document.queryCommandState(_7d7);}catch(e){return false;}},queryCommandValue:function(_7d8){if(this.disabled||!this._disabledOK){return false;}var r;_7d8=this._normalizeCommand(_7d8);if(has("ie")&&_7d8==="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_7d8)];}else{if(has("mozilla")&&_7d8==="hilitecolor"){var _7d9;try{_7d9=this.document.queryCommandValue("styleWithCSS");}catch(e){_7d9=false;}this.document.execCommand("styleWithCSS",false,true);r=this.document.queryCommandValue(_7d8);this.document.execCommand("styleWithCSS",false,_7d9);}else{r=this.document.queryCommandValue(_7d8);}}return r;},_sCall:function(name,args){return win.withGlobal(this.window,name,_79d,args);},placeCursorAtStart:function(){this.focus();var _7da=false;if(has("mozilla")){var _7db=this.editNode.firstChild;while(_7db){if(_7db.nodeType===3){if(_7db.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_7da=true;this._sCall("selectElement",[_7db]);break;}}else{if(_7db.nodeType===1){_7da=true;var tg=_7db.tagName?_7db.tagName.toLowerCase():"";if(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){this._sCall("selectElement",[_7db]);}else{this._sCall("selectElementChildren",[_7db]);}break;}}_7db=_7db.nextSibling;}}else{_7da=true;this._sCall("selectElementChildren",[this.editNode]);}if(_7da){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _7dc=false;if(has("mozilla")){var last=this.editNode.lastChild;while(last){if(last.nodeType===3){if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_7dc=true;this._sCall("selectElement",[last]);break;}}else{if(last.nodeType===1){_7dc=true;this._sCall("selectElement",[last.lastChild||last]);break;}}last=last.previousSibling;}}else{_7dc=true;this._sCall("selectElementChildren",[this.editNode]);}if(_7dc){this._sCall("collapse",[false]);}},getValue:function(_7dd){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_7dd);},_getValueAttr:function(){return this.getValue(true);},setValue:function(html){if(!this.isLoaded){this.onLoadDeferred.then(lang.hitch(this,function(){this.setValue(html);}));return;}this._cursorToStart=true;if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=html;}else{html=this._preFilterContent(html);var node=this.isClosed?this.domNode:this.editNode;if(html&&has("mozilla")&&html.toLowerCase()==="<p></p>"){html="<p>&#160;</p>";}if(!html&&has("webkit")){html="&#160;";}node.innerHTML=html;this._preDomFilterContent(node);}this.onDisplayChanged();this._set("value",this.getValue(true));},replaceValue:function(html){if(this.isClosed){this.setValue(html);}else{if(this.window&&this.window.getSelection&&!has("mozilla")){this.setValue(html);}else{if(this.window&&this.window.getSelection){html=this._preFilterContent(html);this.execCommand("selectall");if(!html){this._cursorToStart=true;html="&#160;";}this.execCommand("inserthtml",html);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(html);}}}}this._set("value",this.getValue(true));},_preFilterContent:function(html){var ec=html;_78b.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;_78b.forEach(this.contentDomPreFilters,function(ef){if(ef&&lang.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_7de){var ec;if(!lang.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_7de){dom=lang.clone(dom);}_78b.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=_79f.getChildrenHtml(dom);}else{ec=dom;}if(!lang.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}_78b.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(){var _7df=dom.byId(_7a1._scopeName+"._editor.RichText.value");if(_7df){if(_7df.value){_7df.value+=this._SEPARATOR;}_7df.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(true);}},escapeXml:function(str,_7e0){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_7e0){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(node){_795.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);return _79f.getNodeHtml(node);},getNodeChildrenHtml:function(dom){_795.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return _79f.getChildrenHtml(dom);},close:function(save){if(this.isClosed){return;}if(!arguments.length){save=true;}if(save){this._set("value",this.getValue(true));}if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(has("ie")){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this._iframeRegHandle){this._iframeRegHandle.remove();delete this._iframeRegHandle;}if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(has("ie")){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=this.value;_791.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=this.value;}delete this.iframe;_790.remove(this.domNode,this.baseClass);this.isClosed=true;this.isLoaded=false;delete this.editNode;delete this.focusNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;},destroy:function(){if(!this.isClosed){this.close(false);}if(this._updateTimer){this._updateTimer.remove();}this.inherited(arguments);if(_7a2._globalSaveHandler){delete _7a2._globalSaveHandler[this.id];}},_removeMozBogus:function(html){return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"");},_removeWebkitBogus:function(html){html=html.replace(/\sclass="webkit-block-placeholder"/gi,"");html=html.replace(/\sclass="apple-style-span"/gi,"");html=html.replace(/<meta charset=\"utf-8\" \/>/gi,"");return html;},_normalizeFontStyle:function(html){return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(html){return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");},_browserQueryCommandEnabled:function(_7e1){if(!_7e1){return false;}var elem=has("ie")?this.document.selection.createRange():this.document;try{return elem.queryCommandEnabled(_7e1);}catch(e){return false;}},_createlinkEnabledImpl:function(){var _7e2=true;if(has("opera")){var sel=this.window.getSelection();if(sel.isCollapsed){_7e2=true;}else{_7e2=this.document.queryCommandEnabled("createlink");}}else{_7e2=this._browserQueryCommandEnabled("createlink");}return _7e2;},_unlinkEnabledImpl:function(){var _7e3=true;if(has("mozilla")||has("webkit")){_7e3=this._sCall("hasAncestorElement",["a"]);}else{_7e3=this._browserQueryCommandEnabled("unlink");}return _7e3;},_inserttableEnabledImpl:function(){var _7e4=true;if(has("mozilla")||has("webkit")){_7e4=true;}else{_7e4=this._browserQueryCommandEnabled("inserttable");}return _7e4;},_cutEnabledImpl:function(){var _7e5=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_7e5=!!sel;}else{_7e5=this._browserQueryCommandEnabled("cut");}return _7e5;},_copyEnabledImpl:function(){var _7e6=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_7e6=!!sel;}else{_7e6=this._browserQueryCommandEnabled("copy");}return _7e6;},_pasteEnabledImpl:function(){var _7e7=true;if(has("webkit")){return true;}else{_7e7=this._browserQueryCommandEnabled("paste");}return _7e7;},_inserthorizontalruleImpl:function(_7e8){if(has("ie")){return this._inserthtmlImpl("<hr>");}return this.document.execCommand("inserthorizontalrule",false,_7e8);},_unlinkImpl:function(_7e9){if((this.queryCommandEnabled("unlink"))&&(has("mozilla")||has("webkit"))){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);return this.document.execCommand("unlink",false,null);}return this.document.execCommand("unlink",false,_7e9);},_hilitecolorImpl:function(_7ea){var _7eb;var _7ec=this._handleTextColorOrProperties("hilitecolor",_7ea);if(!_7ec){if(has("mozilla")){this.document.execCommand("styleWithCSS",false,true);console.log("Executing color command.");_7eb=this.document.execCommand("hilitecolor",false,_7ea);this.document.execCommand("styleWithCSS",false,false);}else{_7eb=this.document.execCommand("hilitecolor",false,_7ea);}}return _7eb;},_backcolorImpl:function(_7ed){if(has("ie")){_7ed=_7ed?_7ed:null;}var _7ee=this._handleTextColorOrProperties("backcolor",_7ed);if(!_7ee){_7ee=this.document.execCommand("backcolor",false,_7ed);}return _7ee;},_forecolorImpl:function(_7ef){if(has("ie")){_7ef=_7ef?_7ef:null;}var _7f0=false;_7f0=this._handleTextColorOrProperties("forecolor",_7ef);if(!_7f0){_7f0=this.document.execCommand("forecolor",false,_7ef);}return _7f0;},_inserthtmlImpl:function(_7f1){_7f1=this._preFilterContent(_7f1);var rv=true;if(has("ie")){var _7f2=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()==="CONTROL"){var n=_7f2.item(0);while(_7f2.length){_7f2.remove(_7f2.item(0));}n.outerHTML=_7f1;}else{_7f2.pasteHTML(_7f1);}_7f2.select();}else{if(has("mozilla")&&!_7f1.length){this._sCall("remove");}else{rv=this.document.execCommand("inserthtml",false,_7f1);}}return rv;},_boldImpl:function(_7f3){var _7f4=false;if(has("ie")){this._adaptIESelection();_7f4=this._adaptIEFormatAreaAndExec("bold");}if(!_7f4){_7f4=this.document.execCommand("bold",false,_7f3);}return _7f4;},_italicImpl:function(_7f5){var _7f6=false;if(has("ie")){this._adaptIESelection();_7f6=this._adaptIEFormatAreaAndExec("italic");}if(!_7f6){_7f6=this.document.execCommand("italic",false,_7f5);}return _7f6;},_underlineImpl:function(_7f7){var _7f8=false;if(has("ie")){this._adaptIESelection();_7f8=this._adaptIEFormatAreaAndExec("underline");}if(!_7f8){_7f8=this.document.execCommand("underline",false,_7f7);}return _7f8;},_strikethroughImpl:function(_7f9){var _7fa=false;if(has("ie")){this._adaptIESelection();_7fa=this._adaptIEFormatAreaAndExec("strikethrough");}if(!_7fa){_7fa=this.document.execCommand("strikethrough",false,_7f9);}return _7fa;},_superscriptImpl:function(_7fb){var _7fc=false;if(has("ie")){this._adaptIESelection();_7fc=this._adaptIEFormatAreaAndExec("superscript");}if(!_7fc){_7fc=this.document.execCommand("superscript",false,_7fb);}return _7fc;},_subscriptImpl:function(_7fd){var _7fe=false;if(has("ie")){this._adaptIESelection();_7fe=this._adaptIEFormatAreaAndExec("subscript");}if(!_7fe){_7fe=this.document.execCommand("subscript",false,_7fd);}return _7fe;},_fontnameImpl:function(_7ff){var _800;if(has("ie")){_800=this._handleTextColorOrProperties("fontname",_7ff);}if(!_800){_800=this.document.execCommand("fontname",false,_7ff);}return _800;},_fontsizeImpl:function(_801){var _802;if(has("ie")){_802=this._handleTextColorOrProperties("fontsize",_801);}if(!_802){_802=this.document.execCommand("fontsize",false,_801);}return _802;},_insertorderedlistImpl:function(_803){var _804=false;if(has("ie")){_804=this._adaptIEList("insertorderedlist",_803);}if(!_804){_804=this.document.execCommand("insertorderedlist",false,_803);}return _804;},_insertunorderedlistImpl:function(_805){var _806=false;if(has("ie")){_806=this._adaptIEList("insertunorderedlist",_805);}if(!_806){_806=this.document.execCommand("insertunorderedlist",false,_805);}return _806;},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header);},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer);},_getNodeChildrenHeight:function(node){var h=0;if(node&&node.childNodes){var i;for(i=0;i<node.childNodes.length;i++){var size=_792.position(node.childNodes[i]);h+=size.h;}}return h;},_isNodeEmpty:function(node,_807){if(node.nodeType===1){if(node.childNodes.length>0){return this._isNodeEmpty(node.childNodes[0],_807);}return true;}else{if(node.nodeType===3){return (node.nodeValue.substring(_807)==="");}}return false;},_removeStartingRangeFromRange:function(node,_808){if(node.nextSibling){_808.setStart(node.nextSibling,0);}else{var _809=node.parentNode;while(_809&&_809.nextSibling==null){_809=_809.parentNode;}if(_809){_808.setStart(_809.nextSibling,0);}}return _808;},_adaptIESelection:function(){var _80a=_79e.getSelection(this.window);if(_80a&&_80a.rangeCount&&!_80a.isCollapsed){var _80b=_80a.getRangeAt(0);var _80c=_80b.startContainer;var _80d=_80b.startOffset;while(_80c.nodeType===3&&_80d>=_80c.length&&_80c.nextSibling){_80d=_80d-_80c.length;_80c=_80c.nextSibling;}var _80e=null;while(this._isNodeEmpty(_80c,_80d)&&_80c!==_80e){_80e=_80c;_80b=this._removeStartingRangeFromRange(_80c,_80b);_80c=_80b.startContainer;_80d=0;}_80a.removeAllRanges();_80a.addRange(_80b);}},_adaptIEFormatAreaAndExec:function(_80f){var _810=_79e.getSelection(this.window);var doc=this.document;var rs,ret,_811,txt,_812,_813,_814,_815;if(_80f&&_810&&_810.isCollapsed){var _816=this.queryCommandValue(_80f);if(_816){var _817=this._tagNamesForCommand(_80f);_811=_810.getRangeAt(0);var fs=_811.startContainer;if(fs.nodeType===3){var _818=_811.endOffset;if(fs.length<_818){ret=this._adjustNodeAndOffset(rs,_818);fs=ret.node;_818=ret.offset;}}var _819;while(fs&&fs!==this.editNode){var _81a=fs.tagName?fs.tagName.toLowerCase():"";if(_78b.indexOf(_817,_81a)>-1){_819=fs;break;}fs=fs.parentNode;}if(_819){rs=_811.startContainer;var _81b=doc.createElement(_819.tagName);_791.place(_81b,_819,"after");if(rs&&rs.nodeType===3){var _81c,_81d;var _81e=_811.endOffset;if(rs.length<_81e){ret=this._adjustNodeAndOffset(rs,_81e);rs=ret.node;_81e=ret.offset;}txt=rs.nodeValue;_812=doc.createTextNode(txt.substring(0,_81e));var _81f=txt.substring(_81e,txt.length);if(_81f){_813=doc.createTextNode(_81f);}_791.place(_812,rs,"before");if(_813){_814=doc.createElement("span");_814.className="ieFormatBreakerSpan";_791.place(_814,rs,"after");_791.place(_813,_814,"after");_813=_814;}_791.destroy(rs);var _820=_812.parentNode;var _821=[];var _822;while(_820!==_819){var tg=_820.tagName;_822={tagName:tg};_821.push(_822);var _823=doc.createElement(tg);if(_820.style){if(_823.style){if(_820.style.cssText){_823.style.cssText=_820.style.cssText;_822.cssText=_820.style.cssText;}}}if(_820.tagName==="FONT"){if(_820.color){_823.color=_820.color;_822.color=_820.color;}if(_820.face){_823.face=_820.face;_822.face=_820.face;}if(_820.size){_823.size=_820.size;_822.size=_820.size;}}if(_820.className){_823.className=_820.className;_822.className=_820.className;}if(_813){_81c=_813;while(_81c){_81d=_81c.nextSibling;_823.appendChild(_81c);_81c=_81d;}}if(_823.tagName==_820.tagName){_814=doc.createElement("span");_814.className="ieFormatBreakerSpan";_791.place(_814,_820,"after");_791.place(_823,_814,"after");}else{_791.place(_823,_820,"after");}_812=_820;_813=_823;_820=_820.parentNode;}if(_813){_81c=_813;if(_81c.nodeType===1||(_81c.nodeType===3&&_81c.nodeValue)){_81b.innerHTML="";}while(_81c){_81d=_81c.nextSibling;_81b.appendChild(_81c);_81c=_81d;}}var _824;if(_821.length){_822=_821.pop();var _825=doc.createElement(_822.tagName);if(_822.cssText&&_825.style){_825.style.cssText=_822.cssText;}if(_822.className){_825.className=_822.className;}if(_822.tagName==="FONT"){if(_822.color){_825.color=_822.color;}if(_822.face){_825.face=_822.face;}if(_822.size){_825.size=_822.size;}}_791.place(_825,_81b,"before");while(_821.length){_822=_821.pop();var _826=doc.createElement(_822.tagName);if(_822.cssText&&_826.style){_826.style.cssText=_822.cssText;}if(_822.className){_826.className=_822.className;}if(_822.tagName==="FONT"){if(_822.color){_826.color=_822.color;}if(_822.face){_826.face=_822.face;}if(_822.size){_826.size=_822.size;}}_825.appendChild(_826);_825=_826;}_815=doc.createTextNode(".");_814.appendChild(_815);_825.appendChild(_815);_824=_79e.create(this.window);_824.setStart(_815,0);_824.setEnd(_815,_815.length);_810.removeAllRanges();_810.addRange(_824);this._sCall("collapse",[false]);_815.parentNode.innerHTML="";}else{_814=doc.createElement("span");_814.className="ieFormatBreakerSpan";_815=doc.createTextNode(".");_814.appendChild(_815);_791.place(_814,_81b,"before");_824=_79e.create(this.window);_824.setStart(_815,0);_824.setEnd(_815,_815.length);_810.removeAllRanges();_810.addRange(_824);this._sCall("collapse",[false]);_815.parentNode.innerHTML="";}if(!_81b.firstChild){_791.destroy(_81b);}return true;}}return false;}else{_811=_810.getRangeAt(0);rs=_811.startContainer;if(rs&&rs.nodeType===3){var _818=_811.startOffset;if(rs.length<_818){ret=this._adjustNodeAndOffset(rs,_818);rs=ret.node;_818=ret.offset;}txt=rs.nodeValue;_812=doc.createTextNode(txt.substring(0,_818));var _81f=txt.substring(_818);if(_81f!==""){_813=doc.createTextNode(txt.substring(_818));}_814=doc.createElement("span");_815=doc.createTextNode(".");_814.appendChild(_815);if(_812.length){_791.place(_812,rs,"after");}else{_812=rs;}_791.place(_814,_812,"after");if(_813){_791.place(_813,_814,"after");}_791.destroy(rs);var _824=_79e.create(this.window);_824.setStart(_815,0);_824.setEnd(_815,_815.length);_810.removeAllRanges();_810.addRange(_824);doc.execCommand(_80f);_791.place(_814.firstChild,_814,"before");_791.destroy(_814);_824.setStart(_815,0);_824.setEnd(_815,_815.length);_810.removeAllRanges();_810.addRange(_824);this._sCall("collapse",[false]);_815.parentNode.innerHTML="";return true;}}}else{return false;}},_adaptIEList:function(_827){var _828=_79e.getSelection(this.window);if(_828.isCollapsed){if(_828.rangeCount&&!this.queryCommandValue(_827)){var _829=_828.getRangeAt(0);var sc=_829.startContainer;if(sc&&sc.nodeType==3){if(!_829.startOffset){var _82a="ul";if(_827==="insertorderedlist"){_82a="ol";}var list=this.document.createElement(_82a);var li=_791.create("li",null,list);_791.place(list,sc,"before");li.appendChild(sc);_791.create("br",null,list,"after");var _82b=_79e.create(this.window);_82b.setStart(sc,0);_82b.setEnd(sc,sc.length);_828.removeAllRanges();_828.addRange(_82b);this._sCall("collapse",[true]);return true;}}}}return false;},_handleTextColorOrProperties:function(_82c,_82d){var _82e=_79e.getSelection(this.window);var doc=this.document;var rs,ret,_82f,txt,_830,_831,_832,_833;_82d=_82d||null;if(_82c&&_82e&&_82e.isCollapsed){if(_82e.rangeCount){_82f=_82e.getRangeAt(0);rs=_82f.startContainer;if(rs&&rs.nodeType===3){var _834=_82f.startOffset;if(rs.length<_834){ret=this._adjustNodeAndOffset(rs,_834);rs=ret.node;_834=ret.offset;}txt=rs.nodeValue;_830=doc.createTextNode(txt.substring(0,_834));var _835=txt.substring(_834);if(_835!==""){_831=doc.createTextNode(txt.substring(_834));}_832=doc.createElement("span");_833=doc.createTextNode(".");_832.appendChild(_833);var _836=doc.createElement("span");_832.appendChild(_836);if(_830.length){_791.place(_830,rs,"after");}else{_830=rs;}_791.place(_832,_830,"after");if(_831){_791.place(_831,_832,"after");}_791.destroy(rs);var _837=_79e.create(this.window);_837.setStart(_833,0);_837.setEnd(_833,_833.length);_82e.removeAllRanges();_82e.addRange(_837);if(has("webkit")){var _838="color";if(_82c==="hilitecolor"||_82c==="backcolor"){_838="backgroundColor";}_793.set(_832,_838,_82d);this._sCall("remove",[]);_791.destroy(_836);_832.innerHTML="&#160;";this._sCall("selectElement",[_832]);this.focus();}else{this.execCommand(_82c,_82d);_791.place(_832.firstChild,_832,"before");_791.destroy(_832);_837.setStart(_833,0);_837.setEnd(_833,_833.length);_82e.removeAllRanges();_82e.addRange(_837);this._sCall("collapse",[false]);_833.parentNode.removeChild(_833);}return true;}}}return false;},_adjustNodeAndOffset:function(node,_839){while(node.length<_839&&node.nextSibling&&node.nextSibling.nodeType===3){_839=_839-node.length;node=node.nextSibling;}return {"node":node,"offset":_839};},_tagNamesForCommand:function(_83a){if(_83a==="bold"){return ["b","strong"];}else{if(_83a==="italic"){return ["i","em"];}else{if(_83a==="strikethrough"){return ["s","strike"];}else{if(_83a==="superscript"){return ["sup"];}else{if(_83a==="subscript"){return ["sub"];}else{if(_83a==="underline"){return ["u"];}}}}}}return [];},_stripBreakerNodes:function(node){if(!this.isLoaded){return;}_796(".ieFormatBreakerSpan",node).forEach(function(b){while(b.firstChild){_791.place(b.firstChild,b,"before");}_791.destroy(b);});return node;}});return _7a2;});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_83b,lang,has,_83c,_83d,_83e,_83f){var dhm=lang.getObject("dojox.html.metrics",true);var _840=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _841={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_83e.doc.documentElement.style.fontSize="100%";}var div=_83e.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_83e.body().appendChild(div);for(var p in _841){ds.fontSize=p;_841[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_83e.body().removeChild(div);div=null;return _841;};var _842=null;dhm.getCachedFontMeasurements=function(_843){if(_843||!_842){_842=dhm.getFontMeasurements();}return _842;};var _844=null,_845={};dhm.getTextBox=function(text,_846,_847){var m,s;if(!_844){m=_844=_83e.doc.createElement("div");var c=_83e.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_83e.body().appendChild(c);}else{m=_844;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_846){for(var i in _846){if(i in _845){continue;}s[i]=_846[i];}}if(arguments.length>2&&_847){m.className=_847;}m.innerHTML=text;var box=_83f.position(m);box.w=m.parentNode.scrollWidth;return box;};var _848={w:16,h:16};dhm.getScrollbar=function(){return {w:_848.w,h:_848.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_849){var f=dhm._fontResizeNode=_83e.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_840._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_840._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_83e.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_83d.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_83c(function(){try{var n=_83e.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_83e.body().appendChild(n);_848.w=n.offsetWidth-n.clientWidth;_848.h=n.offsetHeight-n.clientHeight;_83e.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _83b.config&&!!_83b.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"esri/layers/SelectionMode":function(){define("esri/layers/SelectionMode",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/layers/RenderMode"],function(_84a,lang,has,_84b,_84c){var _84d=_84a([_84c],{declaredClass:"esri.layers._SelectionMode",constructor:function(_84e){this.featureLayer=_84e;this._featureMap={};},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},resume:function(){this.propertyChangeHandler(0);}});if(has("extend-esri")){lang.setObject("layers._SelectionMode",_84d,_84b);}return _84d;});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_84f,_850,_851,has,util){return _850("dojox.grid._EditManager",null,{constructor:function(_852){this.grid=_852;if(has("ie")){this.connections=[_851.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_851.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_84f.forEach(this.connections,_851.disconnect);},cellFocus:function(_853,_854){if(this.grid.singleClickEdit||this.isEditRow(_854)){this.setEditCell(_853,_854);}else{this.apply();}if(this.isEditing()||(_853&&_853.editable&&_853.alwaysEditing)){this._focusEditor(_853,_854);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_855){if(_855.index==this.info.rowIndex){_855.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_856,_857){return (this.info.rowIndex===_856)&&(this.info.cell.index==_857);},isEditRow:function(_858){return this.info.rowIndex===_858;},setEditCell:function(_859,_85a){if(!this.isEditCell(_85a,_859.index)&&this.grid.canEdit&&this.grid.canEdit(_859,_85a)){this.start(_859,_85a,this.isEditRow(_85a)||_859.editable);}},_focusEditor:function(_85b,_85c){util.fire(_85b,"focus",[_85c]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_85d,_85e,_85f){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_85e)){this.applyRowEdit();this.grid.updateRow(_85e);}if(_85f){this.info={cell:_85d,rowIndex:_85e};this.grid.doStartEdit(_85d,_85e);this.grid.updateRow(_85e);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_85d,_85e);this._doCatchBoomerang();},_editorDo:function(_860){var c=this.info.cell;if(c&&c.editable){c[_860](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_861,_862,_863){if(this.grid.canEdit(_862,_863)){this.grid.doApplyCellEdit(_861,_863,_862.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_864,_865){var c=this.info.cell;if(this.isEditRow(_864)&&(!_865||c.view==_865)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_866,_867){var c=this.info.cell;if(this.isEditRow(_867)&&c.view==_866&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dijit/form/_AutoCompleterMixin":function(){define("dijit/form/_AutoCompleterMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/sniff","dojo/string","./DataList","../registry","./_TextBoxMixin","./_SearchMixin"],function(_868,_869,_86a,_86b,keys,lang,_86c,_86d,has,_86e,_86f,_870,_871,_872){return _869("dijit.form._AutoCompleterMixin",_872,{item:null,autoComplete:true,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_873){var pos=0;if(typeof (_873.selectionStart)=="number"){pos=_873.selectionStart;}else{if(has("ie")){var tr=_873.ownerDocument.selection.createRange().duplicate();var ntr=_873.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_874,_875){_875=parseInt(_875);_871.selectInputText(_874,_875,_875);},_setDisabledAttr:function(_876){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_876?"true":"false");},_onKey:function(evt){if(evt.charCode>=32){return;}var key=evt.charCode||evt.keyCode;if(key==keys.ALT||key==keys.CTRL||key==keys.META||key==keys.SHIFT){return;}var pw=this.dropDown;var _877=null;this._abortQuery();this.inherited(arguments);if(evt.altKey||evt.ctrlKey||evt.metaKey){return;}if(this._opened){_877=pw.getHighlightedOption();}switch(key){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:if(this._opened){this._announceOption(_877);}_86b.stop(evt);break;case keys.ENTER:if(_877){if(_877==pw.nextButton){this._nextSearch(1);_86b.stop(evt);break;}else{if(_877==pw.previousButton){this._nextSearch(-1);_86b.stop(evt);break;}}_86b.stop(evt);}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}case keys.TAB:var _878=this.get("displayedValue");if(pw&&(_878==pw._messages["previousMessage"]||_878==pw._messages["nextMessage"])){break;}if(_877){this._selectOption(_877);}case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;}},_autoCompleteText:function(text){var fn=this.focusNode;_871.selectInputText(fn,fn.value.length);var _879=this.ignoreCase?"toLowerCase":"substr";if(text[_879](0).indexOf(this.focusNode.value[_879](0))==0){var cpos=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((cpos+1)>fn.value.length){fn.value=text;_871.selectInputText(fn,cpos);}}else{fn.value=text;_871.selectInputText(fn);}},_openResultList:function(_87a,_87b,_87c){var _87d=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_87a.length&&_87c.start==0){this.closeDropDown();return;}this._nextSearch=this.dropDown.onPage=lang.hitch(this,function(_87e){_87a.nextPage(_87e!==-1);this.focus();});this.dropDown.createOptions(_87a,_87c,lang.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if("direction" in _87c){if(_87c.direction){this.dropDown.highlightFirstOption();}else{if(!_87c.direction){this.dropDown.highlightLastOption();}}if(_87d){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_87b[this.searchAttr].toString())){this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _87f=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_87f==pw._messages["previousMessage"]||_87f==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_87f);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(item,_880,_881){var _882="";if(item){if(!_881){_881=this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr];}_882=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_881;}this.set("value",_882,_880,_881,item);},_announceOption:function(node){if(!node){return;}var _883;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_883=node.innerHTML;this.item=undefined;this.value="";}else{var item=this.dropDown.items[node.getAttribute("item")];_883=(this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr]).toString();this.set("item",item,false,_883);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_86a.get(node,"id"));this._autoCompleteText(_883);},_selectOption:function(_884){this.closeDropDown();if(_884){this._announceOption(_884);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this.item=undefined;this.inherited(arguments);},_startSearch:function(key){if(!this.dropDown){var _885=this.id+"_popup",_886=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _886({onChange:lang.hitch(this,this._selectOption),id:_885,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_885);}this._lastInput=key;this.inherited(arguments);},_getValueField:function(){return this.searchAttr;},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _887=this.srcNodeRef;this.store=new _86f({},_887);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _888=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_888):item[_888];}}}},postCreate:function(){var _889=_86c("label[for=\""+this.id+"\"]");if(_889.length){if(!_889[0].id){_889[0].id=this.id+"_label";}this.domNode.setAttribute("aria-labelledby",_889[0].id);}this.inherited(arguments);this.connect(this,"onSearch","_openResultList");},_getMenuLabelFromItem:function(item){var _88a=this.labelFunc(item,this.store),_88b=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_88a=this.doHighlight(_88a,this._lastInput);_88b="html";}return {html:_88b=="html",label:_88a};},doHighlight:function(_88c,find){var _88d=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=_86d.escapeString(find);return this._escapeHtml(_88c.replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_88d),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_88e){return (_88e._oldAPI?_88e.getValue(item,this.labelAttr||this.searchAttr):item[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_88f,_890,_891,item){this._set("item",item||null);if(_88f==null){_88f="";}this.inherited(arguments);},_setTextDirAttr:function(_892){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_892);}}});});},"esri/layers/TrackManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/graphic","esri/geometry/Polyline","esri/layers/GraphicsLayer"],function(_893,lang,_894,has,_895,_896,_897,_898){var _899=_893(null,{declaredClass:"esri.layers._TrackManager",constructor:function(_89a){this.layer=_89a;this.trackMap={};},initialize:function(map){this.map=map;var _89b=this.layer,_89c=_89b.renderer.trackRenderer;if(_89c&&(_89b.geometryType==="esriGeometryPoint")){var _89d=(this.container=new _898._GraphicsLayer({id:_89b.id+"_tracks",_child:true}));_89d.loaded=true;_89d.onLoad(_89d);_89d._setMap(map,_89b._div);_89d.setRenderer(_89c);}},addFeatures:function(_89e){var tkid,_89f=this.trackMap,_8a0=this.layer,_8a1=_8a0._trackIdField;_894.forEach(_89e,function(_8a2){var _8a3=_8a2.attributes;tkid=_8a3[_8a1];var ary=(_89f[tkid]=(_89f[tkid]||[]));ary.push(_8a2);});var _8a4=_8a0._startTimeField,_8a5=_8a0.objectIdField;var _8a6=function(a,b){var _8a7=a.attributes[_8a4],_8a8=b.attributes[_8a4];if(_8a7===_8a8){return (a.attributes[_8a5]<b.attributes[_8a5])?-1:1;}else{return (_8a7<_8a8)?-1:1;}};for(tkid in _89f){_89f[tkid].sort(_8a6);}},drawTracks:function(){var _8a9=this.container;if(!_8a9){return;}var _8aa=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_8ab,_8ac=this.layer._trackIdField,_8ad;for(tkid in _8aa){ary=_8aa[tkid];path=[];for(i=ary.length-1;i>=0;i--){_8ab=ary[i].geometry;if(_8ab){path.push([_8ab.x,_8ab.y]);}}_8ad={};_8ad[_8ac]=tkid;if(path.length>0){_8a9.add(new _896(new _897({paths:[path],spatialReference:sr}),null,_8ad));}}},moveLatestToFront:function(){_894.forEach(this.getLatestObservations(),function(_8ae){var _8af=_8ae._shape;_8af&&_8af._moveToFront();this._repaint(_8ae,null,true);},this.layer);},getLatestObservations:function(){var _8b0=[];if(!this.layer.renderer.latestObservationRenderer){return _8b0;}var _8b1=this.trackMap,tkid;for(tkid in _8b1){var ary=_8b1[tkid];_8b0.push(ary[ary.length-1]);}return _8b0;},clearTracks:function(){var _8b2=this.getLatestObservations();this.trackMap={};var _8b3=this.container;if(_8b3){_8b3.clear();}_894.forEach(_8b2,function(_8b4){this._repaint(_8b4,null,true);},this.layer);},isLatestObservation:function(_8b5){var _8b6=this.layer._trackIdField;var _8b7=this.trackMap[_8b5.attributes[_8b6]];if(_8b7){return (_8b7[_8b7.length-1]===_8b5);}return false;},destroy:function(){var _8b8=this.container;if(_8b8){_8b8.clear();_8b8._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});if(has("extend-esri")){lang.setObject("layers._TrackManager",_899,_895);}return _899;});},"esri/dijit/editing/tools/ToolBase":function(){define("esri/dijit/editing/tools/ToolBase",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","dojo/i18n!esri/nls/jsapi"],function(_8b9,lang,has,_8ba,_8bb){var _8bc=_8b9(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:true,showLabel:false,constructor:function(_8bd,_8be){_8bd=_8bd||{};lang.mixin(this,_8bd);this.label=this._label?_8bb.widgets.editor.tools[this._label]:"";this._settings=_8bd.settings;this._toolbar=_8bd.settings.drawToolbar;this._editToolbar=_8bd.settings.editToolbar;this._initializeTool();},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments);},destroy:function(){},activate:function(_8bf){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}if(!this._enabled){return;}this._checked=true;this._layer=_8bf;if(this._toolbar&&this._drawType){this._toolbar.activate(this._drawType);}},deactivate:function(){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}this.setChecked(false);this._updateUI();},setEnabled:function(_8c0){this._enabled=_8c0;this._updateUI();},setChecked:function(_8c1){this._checked=_8c1;},enable:function(_8c2){this._updateUI();},isEnabled:function(){return this._enabled;},getToolName:function(){return this._toolName;},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ToolBase",_8bc,_8ba);}return _8bc;});},"esri/dijit/editing/tools/MenuItemBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/MenuItem","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_8c3,lang,has,_8c4,_8c5,_8c6){var MIB=_8c3([_8c4,_8c5],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",destroy:function(){_8c4.prototype.destroy.apply(this,arguments);_8c5.prototype.destroy.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.MenuItemBase",MIB,_8c6);}return MIB;});},"dojox/date/islamic":function(){define("dojox/date/islamic",["..","dojo/_base/lang","dojo/date","./islamic/Date"],function(_8c7,lang,dd,_8c8){var _8c9=lang.getObject("date.islamic",true,_8c7);_8c9.getDaysInMonth=function(_8ca){return _8ca.getDaysInIslamicMonth(_8ca.getMonth(),_8ca.getFullYear());};_8c9.compare=function(_8cb,_8cc,_8cd){if(_8cb instanceof _8c8){_8cb=_8cb.toGregorian();}if(_8cc instanceof _8c8){_8cc=_8cc.toGregorian();}return dd.compare.apply(null,arguments);};_8c9.add=function(date,_8ce,_8cf){var _8d0=new _8c8(date);switch(_8ce){case "day":_8d0.setDate(date.getDate()+_8cf);break;case "weekday":var day=date.getDay();if(((day+_8cf)<5)&&((day+_8cf)>0)){_8d0.setDate(date.getDate()+_8cf);}else{var _8d1=0,_8d2=0;if(day==5){day=4;_8d2=(_8cf>0)?-1:1;}else{if(day==6){day=4;_8d2=(_8cf>0)?-2:2;}}var add=(_8cf>0)?(5-day-1):-day;var _8d3=_8cf-add;var div=parseInt(_8d3/5);if(_8d3%5!=0){_8d1=(_8cf>0)?2:-2;}_8d1=_8d1+div*7+_8d3%5+add;_8d0.setDate(date.getDate()+_8d1+_8d2);}break;case "year":_8d0.setFullYear(date.getFullYear()+_8cf);break;case "week":_8cf*=7;_8d0.setDate(date.getDate()+_8cf);break;case "month":var _8d4=date.getMonth();_8d0.setMonth(_8d4+_8cf);break;case "hour":_8d0.setHours(date.getHours()+_8cf);break;case "minute":_8d0._addMinutes(_8cf);break;case "second":_8d0._addSeconds(_8cf);break;case "millisecond":_8d0._addMilliseconds(_8cf);break;}return _8d0;};_8c9.difference=function(_8d5,_8d6,_8d7){_8d6=_8d6||new _8c8();_8d7=_8d7||"day";var _8d8=_8d6.getFullYear()-_8d5.getFullYear();var _8d9=1;switch(_8d7){case "weekday":var days=Math.round(_8c9.difference(_8d5,_8d6,"day"));var _8da=parseInt(_8c9.difference(_8d5,_8d6,"week"));var mod=days%7;if(mod==0){days=_8da*5;}else{var adj=0;var aDay=_8d5.getDay();var bDay=_8d6.getDay();_8da=parseInt(days/7);mod=days%7;var _8db=new _8c8(_8d5);_8db.setDate(_8db.getDate()+(_8da*7));var _8dc=_8db.getDay();if(days>0){switch(true){case aDay==5:adj=-1;break;case aDay==6:adj=0;break;case bDay==5:adj=-1;break;case bDay==6:adj=-2;break;case (_8dc+mod)>5:adj=-2;}}else{if(days<0){switch(true){case aDay==5:adj=0;break;case aDay==6:adj=1;break;case bDay==5:adj=2;break;case bDay==6:adj=1;break;case (_8dc+mod)<0:adj=2;}}}days+=adj;days-=(_8da*2);}_8d9=days;break;case "year":_8d9=_8d8;break;case "month":var _8dd=(_8d6.toGregorian()>_8d5.toGregorian())?_8d6:_8d5;var _8de=(_8d6.toGregorian()>_8d5.toGregorian())?_8d5:_8d6;var _8df=_8dd.getMonth();var _8e0=_8de.getMonth();if(_8d8==0){_8d9=_8dd.getMonth()-_8de.getMonth();}else{_8d9=12-_8e0;_8d9+=_8df;var i=_8de.getFullYear()+1;var e=_8dd.getFullYear();for(i;i<e;i++){_8d9+=12;}}if(_8d6.toGregorian()<_8d5.toGregorian()){_8d9=-_8d9;}break;case "week":_8d9=parseInt(_8c9.difference(_8d5,_8d6,"day")/7);break;case "day":_8d9/=24;case "hour":_8d9/=60;case "minute":_8d9/=60;case "second":_8d9/=1000;case "millisecond":_8d9*=_8d6.toGregorian().getTime()-_8d5.toGregorian().getTime();}return Math.round(_8d9);};return _8c9;});},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(dojo,_8e1,_8e2){dojo.DeferredList=function(list,_8e3,_8e4,_8e5,_8e6){var _8e7=[];_8e1.call(this);var self=this;if(list.length===0&&!_8e3){this.resolve([0,[]]);}var _8e8=0;_8e2.forEach(list,function(item,i){item.then(function(_8e9){if(_8e3){self.resolve([i,_8e9]);}else{_8ea(true,_8e9);}},function(_8eb){if(_8e4){self.reject(_8eb);}else{_8ea(false,_8eb);}if(_8e5){return null;}throw _8eb;});function _8ea(_8ec,_8ed){_8e7[i]=[_8ec,_8ed];_8e8++;if(_8e8===list.length){self.resolve(_8e7);}};});};dojo.DeferredList.prototype=new _8e1();dojo.DeferredList.prototype.gatherResults=function(_8ee){var d=new dojo.DeferredList(_8ee,false,true,false);d.addCallback(function(_8ef){var ret=[];_8e2.forEach(_8ef,function(_8f0){ret.push(_8f0[1]);});return ret;});return d;};return dojo.DeferredList;});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_8f1,_8f2,_8f3,_8f4){return _8f1("dijit.CheckedMenuItem",_8f3,{templateString:_8f4,checked:false,_setCheckedAttr:function(_8f5){_8f2.toggle(this.domNode,"dijitCheckedMenuItemChecked",_8f5);this.domNode.setAttribute("aria-checked",_8f5?"true":"false");this._set("checked",_8f5);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_8f6,_8f7,_8f8,_8f9,dom,_8fa,_8fb,_8fc,keys,lang,on,has,win,_8fd,pm,_8fe,_8ff){if(has("dijit-legacy-requires")){_8ff(0,function(){var _900=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_8f6(_900);});}return _8f8("dijit.Menu",_8fe,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_8f7.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_901){return _8fd.get(this._iframeContentDocument(_901))||this._iframeContentDocument(_901)["__parent__"]||(_901.name&&win.doc.frames[_901.name])||null;},_iframeContentDocument:function(_902){return _902.contentDocument||(_902.contentWindow&&_902.contentWindow.document)||(_902.name&&win.doc.frames[_902.name]&&win.doc.frames[_902.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _903=node,_904=this._iframeContentWindow(_903);cn=win.body(_904.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _905={node:node,iframe:_903};_8fa.set(node,"_dijitMenu"+this.id,this._bindings.push(_905));var _906=lang.hitch(this,function(cn){var _907=this.selector,_908=_907?function(_909){return on.selector(_907,_909);}:function(_90a){return _90a;},self=this;return [on(cn,_908(this.leftClickToOpen?"click":"contextmenu"),function(evt){_8f9.stop(evt);self._scheduleOpen(this,_903,{x:evt.pageX,y:evt.pageY});}),on(cn,_908("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_8f9.stop(evt);self._scheduleOpen(this,_903);}})];});_905.connects=cn?_906(cn):[];if(_903){_905.onloadHandler=lang.hitch(this,function(){var _90b=this._iframeContentWindow(_903);cn=win.body(_90b.document);_905.connects=_906(cn);});if(_903.addEventListener){_903.addEventListener("load",_905.onloadHandler,false);}else{_903.attachEvent("onload",_905.onloadHandler);}}},unBindDomNode:function(_90c){var node;try{node=dom.byId(_90c,this.ownerDocument);}catch(e){return;}var _90d="_dijitMenu"+this.id;if(node&&_8fa.has(node,_90d)){var bid=_8fa.get(node,_90d)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _90e=b.iframe;if(_90e){if(_90e.removeEventListener){_90e.removeEventListener("load",b.onloadHandler,false);}else{_90e.detachEvent("onload",b.onloadHandler);}}_8fa.remove(node,_90d);delete this._bindings[bid];}},_scheduleOpen:function(_90f,_910,_911){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_90f,iframe:_910,coords:_911});},1);}},_openMyself:function(args){var _912=args.target,_913=args.iframe,_914=args.coords;this.currentTarget=_912;if(_914){if(_913){var ifc=_8fb.position(_913,true),_915=this._iframeContentWindow(_913),_916=_8fb.docScroll(_915.document);var cs=_8fc.getComputedStyle(_913),tp=_8fc.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_913,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_913,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_913,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_913,cs.borderTopWidth):0);_914.x+=ifc.x+left-_916.x;_914.y+=ifc.y+top-_916.y;}}else{_914=_8fb.position(_912,true);_914.x+=10;_914.y+=10;}var self=this;var _917=this._focusManager.get("prevNode");var _918=this._focusManager.get("curNode");var _919=!_918||(dom.isDescendant(_918,this.domNode))?_917:_918;function _91a(){if(self.refocus&&_919){_919.focus();}pm.close(self);};pm.open({popup:this,x:_914.x,y:_914.y,onExecute:_91a,onCancel:_91a,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_8f7.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"esri/layers/GridLayout":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Extent","esri/geometry/Polyline"],function(_91b,lang,_91c,has,_91d,_91e,_91f,_920){var _921=_91b(null,{declaredClass:"esri.layers._GridLayout",constructor:function(_922,_923,_924,_925){this.origin=_922;this.cellWidth=_923.width;this.cellHeight=_923.height;this.mapWidth=_924.width;this.mapHeight=_924.height;this.srInfo=_925;},setResolution:function(_926){this._resolution=(_926.xmax-_926.xmin)/this.mapWidth;if(this.srInfo){var _927=Math.round((2*this.srInfo.valid[1])/this._resolution),_928=Math.round(_927/this.cellWidth);this._frameStats=[_928,0,_928-1];}},getCellCoordinates:function(_929){var res=this._resolution,_92a=this.origin;return {row:Math.floor((_92a.y-_929.y)/(this.cellHeight*res)),col:Math.floor((_929.x-_92a.x)/(this.cellWidth*res))};},normalize:function(col){var _92b=this._frameStats;if(_92b){var _92c=_92b[0],m180=_92b[1],p180=_92b[2];if(col<m180){col=col%_92c;col=col<m180?col+_92c:col;}else{if(col>p180){col=col%_92c;}}}return col;},intersects:function(_92d,_92e){var _92f=this.srInfo;if(_92f){return _91c.some(_92e._getParts(_92f),function(_930){return _92d.intersects(_930.extent);});}else{return _92d.intersects(_92e);}},getCellExtent:function(row,col){var res=this._resolution,_931=this.origin,_932=this.cellWidth,_933=this.cellHeight;return new _91f((col*_932*res)+_931.x,_931.y-((row+1)*_933*res),((col+1)*_932*res)+_931.x,_931.y-(row*_933*res),new _91e(_931.spatialReference.toJson()));},getLatticeID:function(_934){var _935=this.getCellCoordinates({x:_934.xmin,y:_934.ymax}),_936=this.getCellCoordinates({x:_934.xmax,y:_934.ymin}),_937=_935.row,_938=_936.row,_939=this.normalize(_935.col),_93a=this.normalize(_936.col);return _937+"_"+_938+"_"+_939+"_"+_93a;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_93b,_93c){var _93d=this.getCellCoordinates({x:_93b.xmin,y:_93b.ymax}),_93e=this.getCellCoordinates({x:_93b.xmax,y:_93b.ymin}),_93f=_93d.row,_940=_93e.row,_941=_93d.col,_942=_93e.col,_943=[],i,j,nj,_944=[],_945=[],len,xmin,xmax,ymin,ymax,_946=[],_947,_948;for(i=_93f;i<=_940;i++){for(j=_941;j<=_942;j++){nj=this.normalize(j);_93b=this.getCellExtent(i,nj);_943.push({row:i,col:nj,extent:_93b,resolution:this._resolution});if(_93c){_944.push(_93b.xmin,_93b.xmax);_945.push(_93b.ymin,_93b.ymax);}}}_941=this.normalize(_941);_942=this.normalize(_942);_944.sort(this.sorter);_945.sort(this.sorter);len=_944.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_944[i]===_944[i+1]){_944.splice(i,1);}}}len=_945.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_945[i]===_945[i+1]){_945.splice(i,1);}}}if(_944.length&&_945.length){xmin=_944[0];xmax=_944[_944.length-1];ymin=_945[0];ymax=_945[_945.length-1];len=_944.length;for(i=0;i<len;i++){_946.push([[_944[i],ymax],[_944[i],ymin]]);}len=_945.length;for(i=0;i<len;i++){_946.push([[xmin,_945[i]],[xmax,_945[i]]]);}_947=new _920({paths:_946,spatialReference:this.origin.spatialReference.toJson()});_948=_93f+"_"+_940+"_"+_941+"_"+_942;_943.push({latticeID:_948,lattice:_947,resolution:this._resolution});}return {minRow:_93f,maxRow:_940,minCol:_941,maxCol:_942,cells:_943};}});if(has("extend-esri")){lang.setObject("layers._GridLayout",_921,_91d);}return _921;});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_949,_94a,_94b,_94c,lang,win,dom,_94d,_94e,_94f,has,on,_950,_951,_952,dnd){var _953=_94a("dojo.dnd.Container",_94f,{skipForm:false,allowNested:false,constructor:function(node,_954){this.node=dom.byId(node);if(!_954){_954={};}this.creator=_954.creator||null;this.skipForm=_954.skipForm;this.parent=_954.dropParent&&dom.byId(_954.dropParent);this.map={};this.current=null;this.containerState="";_94d.add(this.node,"dojoDndContainer");if(!(_954&&_954._skipStartup)){this.startup();}this.events=[on(this.node,_952.over,lang.hitch(this,"onMouseOver")),on(this.node,_952.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_94c.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _950((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_955,_956){if(!this.parent.firstChild){_956=null;}else{if(_955){if(!_956){_956=this.parent.firstChild;}}else{if(_956){_956=_956.nextSibling;}}}var i,t;if(_956){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_956.parentNode.insertBefore(t.node,_956);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_949.forEach(this.events,function(_957){_957.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_958,node,Ctor){_958._skipStartup=true;return new Ctor(node,_958);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_94b.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_959){var _95a="dojoDnd"+type;var _95b=type.toLowerCase()+"State";_94d.replace(this.node,_95a+_959,_95a+this[_95b]);this[_95b]=_959;},_addItemClass:function(node,type){_94d.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_94d.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _95c=node.parentNode;_95c;node=_95c,_95c=node.parentNode){if((_95c==this.parent||this.allowNested)&&_94d.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_94d.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _94e.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_94e.create("tr");_94e.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _94e.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _95d=item&&lang.isObject(item),data,type,n;if(_95d&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_95d&&item.data)?item.data:item;type=(_95d&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _953;});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_95e,has,_95f){return _95e("dojox.grid._ViewManager",null,{constructor:function(_960){this.grid=_960;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_961){_961.idx=this.views.length;this.views.push(_961);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _962=[];for(var i=0,v;v=this.views[i];i++){_962.push(v.contentNode);}return _962;},forEach:function(_963){for(var i=0,v;v=this.views[i];i++){_963(v,i);}},onEach:function(_964,_965){_965=_965||[];for(var i=0,v;v=this.views[i];i++){if(_964 in v){v[_964].apply(v,_965);}}},normalizeHeaderNodeHeight:function(){var _966=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_966.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_966);},normalizeRowNodeHeights:function(_967){var h=0;var _968=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_967.length<=1){return;}for(var i=0,n;(n=_967[i]);i++){if(!_95f.contains(n,"dojoxGridNonNormalizedCell")){_968[i]=n.firstChild.offsetHeight;h=Math.max(h,_968[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_967[i]);i++){if(_968[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_969){var _96a=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_969));i++){n.firstChild.style.height="";_96a.push(n);}this.normalizeRowNodeHeights(_96a);},getViewWidth:function(_96b){return this.views[_96b].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_96c){_96c.headerContentNode.style.height="";});var h=0;this.forEach(function(_96d){h=Math.max(_96d.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_96e){h=Math.max(_96e.domNode.offsetHeight,h);});return h;},findClient:function(_96f){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _970=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_970(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_970(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_970(v,l);}return l;},renderRow:function(_971,_972,_973){var _974=[];for(var i=0,v,n,_975;(v=this.views[i])&&(n=_972[i]);i++){_975=v.renderRow(_971);n.appendChild(_975);_974.push(_975);}if(!_973){this.normalizeRowNodeHeights(_974);}},rowRemoved:function(_976){this.onEach("rowRemoved",[_976]);},updateRow:function(_977,_978){for(var i=0,v;v=this.views[i];i++){v.updateRow(_977);}if(!_978){this.renormalizeRow(_977);}},updateRowStyles:function(_979){this.onEach("updateRowStyles",[_979]);},setScrollTop:function(_97a){var top=_97a;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_97a);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"esri/dijit/editing/Union":function(){define("esri/dijit/editing/Union",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase","esri/dijit/editing/Cut"],function(_97b,lang,has,_97c,_97d,Cut){var _97e=_97b(_97d,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(_97f){_97f=_97f||{};this._cut=new Cut({featureLayer:_97f.featureLayer,addedGraphics:_97f.deletedGraphics,preUpdatedGraphics:_97f.preUpdatedGraphics,postUpdatedGraphics:_97f.postUpdatedGraphics});},performUndo:function(){this._cut.performRedo();},performRedo:function(){this._cut.performUndo();}});if(has("extend-esri")){lang.setObject("dijit.editing.Union",_97e,_97c);}return _97e;});},"dijit/form/NumberTextBox":function(){define("dijit/form/NumberTextBox",["dojo/_base/declare","dojo/_base/lang","dojo/number","./RangeBoundTextBox"],function(_980,lang,_981,_982){var _983=_980("dijit.form.NumberTextBoxMixin",null,{pattern:_981.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:_981.format,postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},_setConstraintsAttr:function(_984){var _985=typeof _984.places=="number"?_984.places:0;if(_985){_985++;}if(typeof _984.max!="number"){_984.max=9*Math.pow(10,15-_985);}if(typeof _984.min!="number"){_984.min=-9*Math.pow(10,15-_985);}this.inherited(arguments,[_984]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _986=this.format(val,this.constraints);if(_986!==undefined){this.textbox.value=_986;}}this.inherited(arguments);},format:function(_987,_988){var _989=String(_987);if(typeof _987!="number"){return _989;}if(isNaN(_987)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_987,_988))&&_988.exponent!==false&&/\de[-+]?\d/i.test(_989)){return _989;}if(this.editOptions&&this.focused){_988=lang.mixin({},_988,this.editOptions);}return this._formatter(_987,_988);},_parser:_981.parse,parse:function(_98a,_98b){var v=this._parser(_98a,lang.mixin({},_98b,(this.editOptions&&this.focused)?this.editOptions:{}));if(this.editOptions&&this.focused&&isNaN(v)){v=this._parser(_98a,_98b);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_98c){return (_98c==null||_98c==="")?NaN:this.inherited(arguments);},serialize:function(_98d,_98e){return (typeof _98d!="number"||isNaN(_98d))?"":this.inherited(arguments);},_setBlurValue:function(){var val=lang.hitch(lang.mixin({},this,{focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_98f,_990,_991){if(_98f!==undefined&&_991===undefined){_991=String(_98f);if(typeof _98f=="number"){if(isNaN(_98f)){_991="";}else{if(("rangeCheck" in this&&this.rangeCheck(_98f,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_991)){_991=undefined;}}}else{if(!_98f){_991="";_98f=NaN;}else{_98f=undefined;}}}this.inherited(arguments,[_98f,_990,_991]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+_981._realNumberRegexp(lang.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_992){if(!this.focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});var _993=_980("dijit.form.NumberTextBox",[_982,_983],{baseClass:"dijitTextBox dijitNumberTextBox"});_993.Mixin=_983;return _993;});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_994,_995,keys,_996,_997,_998){return _994("dijit.DropDownMenu",[_998,_997],{templateString:_996,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_995.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_995.stop(evt);}break;}}});});},"dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_999){return _999.grid.cells;});},"esri/dijit/editing/tools/Editing":function(){define("esri/dijit/editing/tools/Editing",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/layers/FeatureTemplate","esri/dijit/editing/tools/Edit","esri/dijit/editing/tools/EditingTools","esri/dijit/editing/tools/DropDownToolBase","esri/kernel","esri/lang"],function(_99a,lang,_99b,has,_99c,Edit,_99d,_99e,_99f,_9a0){var _9a1=_99a([_99e],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:false,deactivate:function(){if(!this._enabled){return;}this._enabled=false;this.inherited(arguments);this._settings.templatePicker.clearSelection();},onItemClicked:function(_9a2,evt){this.inherited(arguments);if(this._activeTool===this._tools.AUTOCOMPLETE){this._settings.editor._drawingTool=_99c.TOOL_AUTO_COMPLETE_POLYGON;}},_activateTool:function(_9a3,_9a4){var i;this.enable(_9a4);for(i in this._tools){if(this._tools.hasOwnProperty(i)){this.dropDown.removeChild(this._tools[i]);if(this._tools[i]._enabled===true){this.dropDown.addChild(this._tools[i]);}}}if(this._geometryType!==_9a4||this._activeTool._enabled===false){this._activeTool=this._tools[_9a3.toUpperCase()];}this._geometryType=_9a4;this._activeTool.activate();this._activeTool.setChecked(true);this._updateUI();},_initializeTool:function(_9a5){this.inherited(arguments);this._initializeTools();},_initializeTools:function(){var _9a6=this._settings.layers;var _9a7=this._settings.editor;var _9a8=false,line=false,poly=false;var _9a9=this._toolTypes=[];var _9aa;_99b.forEach(_9a6,function(_9ab){_9aa=_9ab.geometryType;_9a8=_9a8||_9aa==="esriGeometryPoint";line=line||_9aa==="esriGeometryPolyline";poly=poly||_9aa==="esriGeometryPolygon";_9a9=_9a9.concat(_99b.map(this._getTemplatesFromLayer(_9ab),lang.hitch(this,function(_9ac){return _9a7._toDrawTool(_9ac.drawingTool,_9ab);})));},this);var _9ad=this._settings.createOptions;if(_9a8){this._toolTypes.push("point");}if(line){this._toolTypes=this._toolTypes.concat(_9ad.polylineDrawTools);}if(poly){this._toolTypes=this._toolTypes.concat(_9ad.polygonDrawTools);}this._toolTypes=this._toUnique(this._toolTypes.concat(_9a9));},_toUnique:function(arr){var test={};return _99b.filter(arr,function(val){return test[val]?false:(test[val]=true);});},_getTemplatesFromLayer:function(_9ae){var _9af=_9ae.templates||[];var _9b0=_9ae.types;_99b.forEach(_9b0,function(type){_9af=_9af.concat(type.templates);});return _99b.filter(_9af,_9a0.isDefined);},_createTools:function(){_99b.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_9b1){var _9b2=lang.mixin(_99d[_9b1],{settings:this._settings,onClick:lang.hitch(this,"onItemClicked",_99d[_9b1].id)});this._tools[_9b1.toUpperCase()]=new Edit(_9b2);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Editing",_9a1,_99f);}return _9a1;});},"esri/dijit/editing/tools/ToggleToolBase":function(){define("esri/dijit/editing/tools/ToggleToolBase",["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/form/ToggleButton","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_9b3,lang,has,_9b4,_9b5,_9b6){var TTB=_9b3([_9b4,_9b5],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_9b4.prototype.destroy.apply(this,arguments);_9b5.prototype.destroy.apply(this,arguments);},setChecked:function(_9b7){_9b4.prototype.setChecked.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ToggleToolBase",TTB,_9b6);}return TTB;});},"dojox/date/islamic/Date":function(){define("dojox/date/islamic/Date",["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(lang,_9b8,dd){var _9b9=_9b8("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var len=arguments.length;if(!len){this.fromGregorian(new Date());}else{if(len==1){var arg0=arguments[0];if(typeof arg0=="number"){arg0=new Date(arg0);}if(arg0 instanceof Date){this.fromGregorian(arg0);}else{if(arg0==""){this._date=new Date("");}else{this._year=arg0._year;this._month=arg0._month;this._date=arg0._date;this._hours=arg0._hours;this._minutes=arg0._minutes;this._seconds=arg0._seconds;this._milliseconds=arg0._milliseconds;}}}else{if(len>=3){this._year+=arguments[0];this._month+=arguments[1];this._date+=arguments[2];this._hours+=arguments[3]||0;this._minutes+=arguments[4]||0;this._seconds+=arguments[5]||0;this._milliseconds+=arguments[6]||0;}}}},getDate:function(){return this._date;},getMonth:function(){return this._month;},getFullYear:function(){return this._year;},getDay:function(){return this.toGregorian().getDay();},getHours:function(){return this._hours;},getMinutes:function(){return this._minutes;},getSeconds:function(){return this._seconds;},getMilliseconds:function(){return this._milliseconds;},setDate:function(date){date=parseInt(date);if(date>0&&date<=this.getDaysInIslamicMonth(this._month,this._year)){this._date=date;}else{var _9ba;if(date>0){for(_9ba=this.getDaysInIslamicMonth(this._month,this._year);date>_9ba;date-=_9ba,_9ba=this.getDaysInIslamicMonth(this._month,this._year)){this._month++;if(this._month>=12){this._year++;this._month-=12;}}this._date=date;}else{for(_9ba=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1);date<=0;_9ba=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1)){this._month--;if(this._month<0){this._year--;this._month+=12;}date+=_9ba;}this._date=date;}}return this;},setFullYear:function(year){this._year=+year;},setMonth:function(_9bb){this._year+=Math.floor(_9bb/12);if(_9bb>0){this._month=Math.floor(_9bb%12);}else{this._month=Math.floor(((_9bb%12)+12)%12);}},setHours:function(){var _9bc=arguments.length;var _9bd=0;if(_9bc>=1){_9bd=parseInt(arguments[0]);}if(_9bc>=2){this._minutes=parseInt(arguments[1]);}if(_9bc>=3){this._seconds=parseInt(arguments[2]);}if(_9bc==4){this._milliseconds=parseInt(arguments[3]);}while(_9bd>=24){this._date++;var _9be=this.getDaysInIslamicMonth(this._month,this._year);if(this._date>_9be){this._month++;if(this._month>=12){this._year++;this._month-=12;}this._date-=_9be;}_9bd-=24;}this._hours=_9bd;},_addMinutes:function(_9bf){_9bf+=this._minutes;this.setMinutes(_9bf);this.setHours(this._hours+parseInt(_9bf/60));return this;},_addSeconds:function(_9c0){_9c0+=this._seconds;this.setSeconds(_9c0);this._addMinutes(parseInt(_9c0/60));return this;},_addMilliseconds:function(_9c1){_9c1+=this._milliseconds;this.setMilliseconds(_9c1);this._addSeconds(parseInt(_9c1/1000));return this;},setMinutes:function(_9c2){this._minutes=_9c2%60;return this;},setSeconds:function(_9c3){this._seconds=_9c3%60;return this;},setMilliseconds:function(_9c4){this._milliseconds=_9c4%1000;return this;},toString:function(){if(isNaN(this._date)){return "Invalidate Date";}else{var x=new Date();x.setHours(this._hours);x.setMinutes(this._minutes);x.setSeconds(this._seconds);x.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+x.toTimeString();}},toGregorian:function(){var _9c5=this._year;var _9c6=this._month;var _9c7=this._date;var _9c8=_9c7+Math.ceil(29.5*_9c6)+(_9c5-1)*354+Math.floor((3+(11*_9c5))/30)+this._ISLAMIC_EPOCH-1;var wjd=Math.floor(_9c8-0.5)+0.5,_9c9=wjd-this._GREGORIAN_EPOCH,_9ca=Math.floor(_9c9/146097),dqc=this._mod(_9c9,146097),cent=Math.floor(dqc/36524),_9cb=this._mod(dqc,36524),quad=Math.floor(_9cb/1461),_9cc=this._mod(_9cb,1461),_9cd=Math.floor(_9cc/365),year=(_9ca*400)+(cent*100)+(quad*4)+_9cd;if(!(cent==4||_9cd==4)){year++;}var _9ce=this._GREGORIAN_EPOCH+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400);var _9cf=wjd-_9ce;var tjd=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((739/12)+((dd.isLeapYear(new Date(year,3,1))?-1:-2))+1);var _9d0=((wjd<tjd)?0:(dd.isLeapYear(new Date(year,3,1))?1:2));var _9d1=Math.floor((((_9cf+_9d0)*12)+373)/367);var tjd2=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((((367*_9d1)-362)/12)+((_9d1<=2)?0:(dd.isLeapYear(new Date(year,_9d1,1))?-1:-2))+1);var day=(wjd-tjd2)+1;var _9d2=new Date(year,(_9d1-1),day,this._hours,this._minutes,this._seconds,this._milliseconds);return _9d2;},fromGregorian:function(_9d3){var date=new Date(_9d3);var _9d4=date.getFullYear(),_9d5=date.getMonth(),gDay=date.getDate();var _9d6=(this._GREGORIAN_EPOCH-1)+(365*(_9d4-1))+Math.floor((_9d4-1)/4)+(-Math.floor((_9d4-1)/100))+Math.floor((_9d4-1)/400)+Math.floor((((367*(_9d5+1))-362)/12)+(((_9d5+1)<=2)?0:(dd.isLeapYear(date)?-1:-2))+gDay);_9d6=Math.floor(_9d6)+0.5;var days=_9d6-this._ISLAMIC_EPOCH;var _9d7=Math.floor((30*days+10646)/10631);var _9d8=Math.ceil((days-29-this._yearStart(_9d7))/29.5);_9d8=Math.min(_9d8,11);var hDay=Math.ceil(days-this._monthStart(_9d7,_9d8))+1;this._date=hDay;this._month=_9d8;this._year=_9d7;this._hours=date.getHours();this._minutes=date.getMinutes();this._seconds=date.getSeconds();this._milliseconds=date.getMilliseconds();this._day=date.getDay();return this;},valueOf:function(){return this.toGregorian().valueOf();},_yearStart:function(year){return (year-1)*354+Math.floor((3+11*year)/30);},_monthStart:function(year,_9d9){return Math.ceil(29.5*_9d9)+(year-1)*354+Math.floor((3+11*year)/30);},_civilLeapYear:function(year){return (14+11*year)%30<11;},getDaysInIslamicMonth:function(_9da,year){var _9db=0;_9db=29+((_9da+1)%2);if(_9da==11&&this._civilLeapYear(year)){_9db++;}return _9db;},_mod:function(a,b){return a-(b*Math.floor(a/b));}});_9b9.getDaysInIslamicMonth=function(_9dc){return new _9b9().getDaysInIslamicMonth(_9dc.getMonth(),_9dc.getFullYear());};return _9b9;});},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel"],function(lang,_9dd,has,_9de){var util={};util={findFeatures:function(ids,_9df,_9e0){var _9e1=_9df.objectIdField;var _9e2=_9df.graphics;var _9e3=_9dd.filter(_9e2,function(_9e4){return _9dd.some(ids,function(id){return _9e4.attributes[_9e1]===id.objectId;});});if(_9e0){_9e0(_9e3);}else{return _9e3;}},getSelection:function(_9e5){var _9e6=[];_9dd.forEach(_9e5,function(_9e7){var _9e8=_9e7.getSelectedFeatures();_9dd.forEach(_9e8,function(_9e9){_9e6.push(_9e9);});});return _9e6;}};if(has("extend-esri")){lang.setObject("dijit.editing.Util.LayerHelper",util,_9de);}return util;});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_9ea,lang,dom){var dgu=lang.getObject("grid.util",true,_9ea);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_9eb,_9ec){if(_9ec>=0){var s=_9eb.style;var v=_9ec+"px";if(_9eb&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_9ed,_9ee,_9ef,_9f0){var evts=(_9f0?_9f0:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_9ee.connect(_9ed,"on"+evts[i],_9ef);}};dgu.removeNode=function(_9f1){_9f1=dom.byId(_9f1);_9f1&&_9f1.parentNode&&_9f1.parentNode.removeChild(_9f1);return _9f1;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_9f2,_9f3,_9f4){if(_9f2.length<=_9f3){_9f2[_9f3]=_9f4;}else{_9f2.splice(_9f3,0,_9f4);}};dgu.arrayRemove=function(_9f5,_9f6){_9f5.splice(_9f6,1);};dgu.arraySwap=function(_9f7,inI,inJ){var _9f8=_9f7[inI];_9f7[inI]=_9f7[inJ];_9f7[inJ]=_9f8;};return dgu;});},"dijit/form/_ListBase":function(){define("dijit/form/_ListBase",["dojo/_base/declare","dojo/on","dojo/window"],function(_9f9,on,_9fa){return _9f9("dijit.form._ListBase",null,{selected:null,_listConnect:function(_9fb,_9fc){var self=this;return self.own(on(self.containerNode,on.selector(function(_9fd,_9fe,_9ff){return _9fd.parentNode==_9ff;},_9fb),function(evt){evt.preventDefault();self[_9fc](evt,this);}));},selectFirstNode:function(){var _a00=this.containerNode.firstChild;while(_a00&&_a00.style.display=="none"){_a00=_a00.nextSibling;}this._setSelectedAttr(_a00);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _a01=this.selected;if(!_a01){this.selectFirstNode();}else{var next=_a01.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _a02=this.selected;if(!_a02){this.selectLastNode();}else{var prev=_a02.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _a03=this.selected;if(_a03){this.onDeselect(_a03);this.selected=null;}if(node){this.selected=node;_9fa.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}}});});},"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_a04,_a05,lang,json,has,_a06,_a07,_a08,html){var _a09=_a06("dojox.grid.DataGrid",_a07,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _a08(this);},get:function(_a0a,_a0b){if(_a0b&&this.field=="_item"&&!this.fields){return _a0b;}else{if(_a0b&&this.fields){var ret=[];var s=this.grid.store;_a05.forEach(this.fields,function(f){ret=ret.concat(s.getValues(_a0b,f));});return ret;}else{if(!_a0b&&typeof _a0a==="string"){return this.inherited(arguments);}}}return (!_a0b?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_a0b:this.grid.store.getValue(_a0b,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _a0c=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_a0c=true;}if(!this.updating){this.beginUpdate();_a0c=true;}if(_a0c){var _a0d=this;this._endUpdateDelay=setTimeout(function(){delete _a0d._endUpdateDelay;_a0d.endUpdate();},this.updateDelay);}}},_onSet:function(item,_a0e,_a0f,_a10){this._checkUpdateStatus();var idx=this.getItemIndex(item);if(idx>-1){this.updateRow(idx);}},_createItem:function(item,_a11){var idty=this._hasIdentity?this.store.getIdentity(item):json.toJson(this.query)+":idx:"+_a11+":sort:"+json.toJson(this.getSortProps());var o=this._by_idty[idty]={idty:idty,item:item};return o;},_addItem:function(item,_a12,_a13){this._by_idx[_a12]=this._createItem(item,_a12);if(!_a13){this.updateRow(_a12);}},_onNew:function(item,_a14){this._checkUpdateStatus();var _a15=this.get("rowCount");this._addingItem=true;this.updateRowCount(_a15+1);this._addingItem=false;this._addItem(item,_a15);this.showMessage();},_onDelete:function(item){this._checkUpdateStatus();var idx=this._getItemIndex(item,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_a16,_a17,_a18){if(this._requestsPending(0)){return;}this._setQuery(_a17,_a18);this._setStore(_a16);this._refresh(true);},setQuery:function(_a19,_a1a){if(this._requestsPending(0)){return;}this._setQuery(_a19,_a1a);this._refresh(true);},setItems:function(_a1b){this.items=_a1b;this._setStore(this.store);this._refresh(true);},_setQuery:function(_a1c,_a1d){this.query=_a1c;this.queryOptions=_a1d||this.queryOptions;},_setStore:function(_a1e){if(this.store&&this._store_connects){_a05.forEach(this._store_connects,this.disconnect,this);}this.store=_a1e;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(size,req){if(!this.scroller){return;}if(this.rowCount!=size){if(req.isRender){this.scroller.init(size,this.keepRows,this.rowsPerPage);this.rowCount=size;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(size);}}if(!size){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_a1f,req){if(!this.scroller){return;}if(_a1f&&_a1f.length>0){_a05.forEach(_a1f,function(item,idx){this._addItem(item,req.start+idx,true);},this);this.updateRows(req.start,_a1f.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(has("ie")){html.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_a20,_a21){_a20=_a20||0;if(this.store&&!this._pending_requests[_a20]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_a20]=true;try{if(this.items){var _a22=this.items;var _a23=this.store;this.rowsPerPage=_a22.length;var req={start:_a20,count:this.rowsPerPage,isRender:_a21};this._onFetchBegin(_a22.length,req);var _a24=0;_a05.forEach(_a22,function(i){if(!_a23.isItemLoaded(i)){_a24++;}});if(_a24===0){this._onFetchComplete(_a22,req);}else{var _a25=function(item){_a24--;if(_a24===0){this._onFetchComplete(_a22,req);}};_a05.forEach(_a22,function(i){if(!_a23.isItemLoaded(i)){_a23.loadItem({item:i,onItem:_a25,scope:this});}},this);}}else{this.store.fetch({start:_a20,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_a21,onBegin:lang.hitch(this,"_onFetchBegin"),onComplete:lang.hitch(this,"_onFetchComplete"),onError:lang.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_a20,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var data=this._by_idx[idx];if(!data||(data&&!data.item)){this._preparePage(idx);return null;}return data.item;},getItemIndex:function(item){return this._getItemIndex(item,false);},_getItemIndex:function(item,_a26){if(!_a26&&!this.store.isItem(item)){return -1;}var idty=this._hasIdentity?this.store.getIdentity(item):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((idty&&d.idty==idty)||(d.item===item))){return i;}}return -1;},filter:function(_a27,_a28){this.query=_a27;if(_a28){this._clearData();}this._fetch();},_getItemAttr:function(idx,attr){var item=this.getItem(idx);return (!item?this.fetchText:this.store.getValue(item,attr));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_a29){return this._pending_requests[_a29];},_rowToPage:function(_a2a){return (this.rowsPerPage?Math.floor(_a2a/this.rowsPerPage):_a2a);},_pageToRow:function(_a2b){return (this.rowsPerPage?this.rowsPerPage*_a2b:_a2b);},_preparePage:function(_a2c){if((_a2c<this._bop||_a2c>=this._eop)&&!this._addingItem){var _a2d=this._rowToPage(_a2c);this._needPage(_a2d);this._bop=_a2d*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_a2e){if(!this._pages[_a2e]){this._pages[_a2e]=true;this._requestPage(_a2e);}},_requestPage:function(_a2f){var row=this._pageToRow(_a2f);var _a30=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_a30>0){this._requests++;if(!this._requestsPending(row)){setTimeout(lang.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_a31){return _a31.field;},_refresh:function(_a32){this._clearData();this._fetch(0,_a32);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var desc=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof desc=="undefined"){desc=si;}else{desc=si?!desc:desc;}return [{attribute:c.field,descending:desc}];}},styleRowState:function(_a33){if(this.store&&this.store.getState){var _a34=this.store.getState(_a33.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_a34[s]){c=" dojoxGridRow-"+s;break;}}_a33.customClasses+=c;}},onStyleRow:function(_a35){this.styleRowState(_a35);this.inherited(arguments);},canEdit:function(_a36,_a37){return this._canEdit;},_copyAttr:function(idx,attr){var row={};var _a38={};var src=this.getItem(idx);return this.store.getValue(src,attr);},doStartEdit:function(_a39,_a3a){if(!this._cache[_a3a]){this._cache[_a3a]=this._copyAttr(_a3a,_a39.field);}this.onStartEdit(_a39,_a3a);},doApplyCellEdit:function(_a3b,_a3c,_a3d){this.store.fetchItemByIdentity({identity:this._by_idx[_a3c].idty,onItem:lang.hitch(this,function(item){var _a3e=this.store.getValue(item,_a3d);if(typeof _a3e=="number"){_a3b=isNaN(_a3b)?_a3b:parseFloat(_a3b);}else{if(typeof _a3e=="boolean"){_a3b=_a3b=="true"?true:_a3b=="false"?false:_a3b;}else{if(_a3e instanceof Date){var _a3f=new Date(_a3b);_a3b=isNaN(_a3f.getTime())?_a3b:_a3f;}}}this.store.setValue(item,_a3d,_a3b);this.onApplyCellEdit(_a3b,_a3c,_a3d);})});},doCancelEdit:function(_a40){var _a41=this._cache[_a40];if(_a41){this.updateRow(_a40);delete this._cache[_a40];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_a42,_a43){var _a44=this._cache[_a42];this.onApplyEdit(_a42);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=lang.hitch(this,function(_a45){if(_a45.length){_a05.forEach(_a45,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_a09.cell_markupFactory=function(_a46,node,_a47){var _a48=lang.trim(html.attr(node,"field")||"");if(_a48){_a47.field=_a48;}_a47.field=_a47.field||_a47.name;var _a49=lang.trim(html.attr(node,"fields")||"");if(_a49){_a47.fields=_a49.split(",");}if(_a46){_a46(node,_a47);}};_a09.markupFactory=function(_a4a,node,ctor,_a4b){return _a07.markupFactory(_a4a,node,ctor,lang.partial(_a09.cell_markupFactory,_a4b));};return _a09;});},"esri/dijit/editing/SelectionHelper":function(){define("esri/dijit/editing/SelectionHelper",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dojo/DeferredList","esri/geometry/Extent","esri/geometry/Point","esri/geometry/ScreenPoint","esri/layers/FeatureLayer","esri/tasks/query","esri/kernel"],function(_a4c,lang,_a4d,_a4e,has,_a4f,_a50,_a51,_a52,_a53,_a54,_a55){var SH=_a4c(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(_a56){this._settings=_a56||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers);},destroy:function(){var _a57;for(_a57 in this._sConnects){if(this._sConnects.hasOwnProperty(_a57)){_a57.disconnect(this._sConnects[_a57]);}}},selectFeatures:function(_a58,_a59,_a5a,_a5b){if(_a5a===_a53.SELECTION_NEW){this._resetMapServiceInfos();this.getSelection(_a58);}var _a5c=[];_a4e.forEach(_a58,function(_a5d){if(_a5d.visible===true&&_a5d._isMapAtVisibleScale()===true){var _a5e=_a5a;if(_a5d._isSelOnly&&_a5e===_a53.SELECTION_NEW){_a5e=_a53.SELECTION_ADD;}_a5c.push(_a5d.selectFeatures(_a59,_a5e));}});var _a5f=new _a4f(_a5c);_a5f.addCallback(lang.hitch(this,function(_a60){var _a61=[];_a4e.forEach(_a60,function(set,idx){_a4e.forEach(set[1],function(_a62){var _a63=_a62.attributes[_a58[idx].objectIdField];_a62=_a58[idx]._mode._getFeature(_a63)||null;if(_a62){_a61.push(_a62);}},this);},this);if(!this._mapServiceCount){_a5b(_a61);return;}var _a64=_a5a===_a53.SELECTION_SUBTRACT;if(_a64){this._resetMapServiceInfos();this._createLayerDefs(this._getLayerInfosFromSelection(_a58));}else{this._createLayerDefs(this._getLayerInfosFromFeatures(_a61));}this._updateLayerDefs(this._mapServiceInfos,false,!((_a61&&_a61.length)||_a64),lang.hitch(this,_a5b,_a61));}));},selectFeaturesByGeometry:function(_a65,_a66,_a67,_a68){var _a69=_a66;if(_a66.declaredClass.indexOf("Extent")!==-1){if(_a66.xmax===_a66.xmin&&_a66.ymax===_a66.ymin){_a69=new _a51(_a66.xmax,_a66.ymax,_a66.spatialReference);}}_a69=(_a69.declaredClass.indexOf("Point")!==-1)?this._extentFromPoint(_a69):_a69;var _a6a=new _a54();_a6a.geometry=_a69;this.selectFeatures(_a65,_a6a,_a67,_a68);},clearSelection:function(_a6b){var _a6c=this._nonSelOnlyLayers;_a4e.forEach(_a6c,function(item){if(item.clearSelection){item.clearSelection();}});if(!this._mapServiceCount){return;}this._resetMapServiceInfos();var _a6d=this._getLayerInfosFromSelection(this._settings.layers);var _a6e=_a4e.some(_a6d,function(item){return item.oids&&item.oids.length;});if(_a6e){this._createLayerDefs(_a6d);this._updateLayerDefs(this._mapServiceInfos,true,_a6b||false);}},findMapService:function(_a6f){var map=this._map,_a70=map.layerIds,_a71=(_a6f&&_a6f._url)?_a6f._url.path.toLowerCase():"",_a72,_a73,_a74;for(_a73 in _a70){if(_a70.hasOwnProperty(_a73)){_a72=map.getLayer(_a70[_a73]);_a74=_a72._url?_a72._url.path.toLowerCase().replace("mapserver","featureserver"):"";if(_a71.substr(0,_a74.length)===_a74&&_a72.declaredClass==="esri.layers.ArcGISDynamicMapServiceLayer"){return _a72;}}}},getSelection:function(_a75){var _a76=[];_a4e.forEach(_a75,function(_a77){if(_a77._isSelOnly){_a76.push(this._createLayerInfo(_a77));}},this);_a4e.forEach(_a76,function(_a78){var _a79=this._createMapServiceInfo(this.findMapService(_a78.layer));if(_a79){_a79.layerInfos[_a78.layer.layerId]=_a78;}},this);},_initMapServiceInfos:function(_a7a){this._nonSelOnlyLayers=[];this._mapServiceInfos=[];_a4e.forEach(_a7a,function(_a7b){var _a7c=this.findMapService(_a7b);if(_a7c){this._mapServiceCount++;this._createMapServiceInfo(_a7c);if(_a7c){_a7c.setDisableClientCaching(true);}}else{this._nonSelOnlyLayers.push(_a7b);}},this);},_createMapServiceInfo:function(_a7d){if(!_a7d){return null;}var _a7e=this._mapServiceInfos;var _a7f=_a7e[_a7d.id];if(!_a7f){_a7f=_a7e[_a7d.id]={mapService:_a7d,layerInfos:[],layerDefs:lang.mixin([],_a7d.layerDefinitions||[]),origLayerDefs:lang.mixin([],_a7d.layerDefinitions||[])};}return _a7f;},_resetMapServiceInfo:function(_a80){_a4e.forEach(_a80.layerInfos,this._resetLayerInfo);_a80.layerDefs=lang.mixin([],_a80.origLayerDefs||[]);},_resetMapServiceInfos:function(){var _a81=this._mapServiceInfos,_a82;for(_a82 in _a81){if(_a81.hasOwnProperty(_a82)){this._resetMapServiceInfo(_a81[_a82]);}}},_createLayerInfo:function(_a83,_a84){var _a85=_a83.objectIdField;var _a86=_a84?[]:_a83.getSelectedFeatures();return {layer:_a83,selectedFeatures:_a86||[],oids:_a4e.map(_a86,function(_a87){return _a87.attributes[_a85];})};},_resetLayerInfo:function(_a88){if(!_a88){return;}_a88.selectedFeatures=[];_a88.oids=[];},_updateLayerDefs:function(_a89,_a8a,_a8b,_a8c){var _a8d;for(_a8d in _a89){if(_a89.hasOwnProperty(_a8d)){var _a8e=_a89[_a8d];var _a8f=_a8e.mapService;var _a90=_a8e.layerDefs=(_a8a?lang.mixin([],_a8e.origLayerDefs||[]):_a8e.layerDefs);if(_a90){if(!_a8b){this._sConnects[_a8f.id]=(_a4d.connect(_a8f,"onUpdateEnd",lang.hitch(this,"_onMapServiceUpdate",_a8e,_a8a,_a8c)));}else{if(_a8c){_a8c();}}_a8f.setLayerDefinitions(_a90,_a8b||false);}else{if(_a8c){_a8c();}}}}},_onMapServiceUpdate:function(_a91,_a92,_a93){_a4d.disconnect(this._sConnects[_a91.mapService.id]);_a4e.forEach(_a91.layerInfos,function(_a94){if(_a92){if(_a94){_a94.layer.clearSelection();}}else{var _a95=new _a54();_a95.objectIds=_a94?_a94.oids:[];if(_a95.objectIds.length){_a94.layer.selectFeatures(_a95,_a53.SELECTION_SUBTRACT);}}},this);if(_a92){this._resetMapServiceInfo(_a91);}if(_a93){_a93();}},_createLayerDefs:function(_a96){_a4e.forEach(_a96,function(_a97){var _a98=_a97.layer;var _a99=this._createMapServiceInfo(this.findMapService(_a97.layer));if(!_a99){return;}var _a9a=_a99.mapService;var _a9b=_a99.layerDefs;var _a9c=_a98.objectIdField;var _a9d=_a98.layerId;var _a9e="(\""+_a9c+"\" NOT IN (";var oids=_a97.oids;if(oids&&oids.length){_a4e.forEach(_a97.oids,function(oid,idx){oids=true;if(idx){_a9e+=",";}_a9e+="'"+oid+"'";});_a9e+="))";if(_a9b.length&&(_a9b[_a9d]&&_a9b[_a9d].length)){_a9b[_a9d]+=" AND"+_a9e;}else{_a9b[_a9d]=_a9e;}}},this);},_getLayerInfosFromFeatures:function(_a9f){var _aa0=[];_a4e.forEach(_a9f,function(_aa1){var _aa2=_aa1.getLayer();if(_aa2&&_aa2._isSelOnly){if(!_aa0[_aa2.id]){_aa0[_aa2.id]=this._createLayerInfo(_aa2,true);}_aa0[_aa2.id].selectedFeatures.push(_aa1);_aa0[_aa2.id].oids.push(_aa1.attributes[_aa2.objectIdField]);}},this);var _aa3=[],_aa4;for(_aa4 in _aa0){if(_aa0.hasOwnProperty(_aa4)){_aa3.push(_aa0[_aa4]);}}return _aa3;},_getLayerInfosFromSelection:function(_aa5){var _aa6=[];_a4e.forEach(_aa5,function(_aa7){if(_aa7._isSelOnly){_aa6.push(this._createLayerInfo(_aa7,false));}},this);return _aa6;},_extentFromPoint:function(_aa8){var _aa9=this._tolerance;var map=this._map;var _aaa=map.toScreen(_aa8);var pnt1=new _a52(_aaa.x-_aa9,_aaa.y+_aa9);var pnt2=new _a52(_aaa.x+_aa9,_aaa.y-_aa9);var _aab=map.toMap(pnt1);var _aac=map.toMap(pnt2);return new _a50(_aab.x,_aab.y,_aac.x,_aac.y,map.spatialReference);}});if(has("extend-esri")){lang.setObject("dijit.editing.SelectionHelper",SH,_a55);}return SH;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dijit/_editor/plugins/LinkDialog":function(){define("dijit/_editor/plugins/LinkDialog",["require","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/query","dojo/string","../../_Widget","../_Plugin","../../form/DropDownButton","../range"],function(_aad,_aae,_aaf,keys,lang,has,_ab0,_ab1,_ab2,_ab3,_ab4,_ab5){var _ab6=_aae("dijit._editor.plugins.LinkDialog",_ab3,{buttonClass:_ab4,useDefaultCommand:false,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",emailRegExp:"<?(mailto\\:)([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+"+"@"+"((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*>?",htmlTemplate:"<a href=\"${urlInput}\" _djrealurl=\"${urlInput}\""+" target=\"${targetSelect}\""+">${textInput}</a>",tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' "+"id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_targetSelect'>${target}</label>","</td><td>","<select id='${id}_targetSelect' name='targetSelect' data-dojo-type='dijit.form.Select'>","<option selected='selected' value='_self'>${currentWindow}</option>","<option value='_blank'>${newWindow}</option>","<option value='_top'>${topWindow}</option>","<option value='_parent'>${parentWindow}</option>","</select>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),_initButton:function(){this.inherited(arguments);this.button.loadDropDown=lang.hitch(this,"_loadDropDown");this._connectTagEvents();},_loadDropDown:function(_ab7){_aad(["dojo/i18n","../../TooltipDialog","../../registry","../../form/Button","../../form/Select","../../form/ValidationTextBox","dojo/i18n!../../nls/common","dojo/i18n!../nls/LinkDialog"],lang.hitch(this,function(i18n,_ab8,_ab9){var _aba=this;this.tag=this.command=="insertImage"?"img":"a";var _abb=lang.delegate(i18n.getLocalization("dijit","common",this.lang),i18n.getLocalization("dijit._editor","LinkDialog",this.lang));var _abc=(this.dropDown=this.button.dropDown=new _ab8({title:_abb[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:lang.hitch(this,"setValue"),onOpen:function(){_aba._onOpenDialog();_ab8.prototype.onOpen.apply(this,arguments);},onCancel:function(){setTimeout(lang.hitch(_aba,"_onCloseDialog"),0);}}));_abb.urlRegExp=this.urlRegExp;_abb.id=_ab9.getUniqueId(this.editor.id);this._uniqueId=_abb.id;this._setContent(_abc.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+_ab1.substitute(this.linkDialogTemplate,_abb));_abc.startup();this._urlInput=_ab9.byId(this._uniqueId+"_urlInput");this._textInput=_ab9.byId(this._uniqueId+"_textInput");this._setButton=_ab9.byId(this._uniqueId+"_setButton");this.connect(_ab9.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel();});if(this._urlInput){this.connect(this._urlInput,"onChange","_checkAndFixInput");}if(this._textInput){this.connect(this._textInput,"onChange","_checkAndFixInput");}this._urlRegExp=new RegExp("^"+this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=lang.hitch(this,function(){var _abd=this._urlInput.get("value");return this._urlRegExp.test(_abd)||this._emailRegExp.test(_abd);});this.connect(_abc.domNode,"onkeypress",function(e){if(e&&e.charOrCode==keys.ENTER&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey&&!e.altKey){if(!this._setButton.get("disabled")){_abc.onExecute();_abc.execute(_abc.get("value"));}}});_ab7();}));},_checkAndFixInput:function(){var self=this;var url=this._urlInput.get("value");var _abe=function(url){var _abf=false;var _ac0=false;if(url&&url.length>1){url=lang.trim(url);if(url.indexOf("mailto:")!==0){if(url.indexOf("/")>0){if(url.indexOf("://")===-1){if(url.charAt(0)!=="/"&&url.indexOf("./")&&url.indexOf("../")!==0){if(self._hostRxp.test(url)){_abf=true;}}}}else{if(self._userAtRxp.test(url)){_ac0=true;}}}}if(_abf){self._urlInput.set("value","http://"+url);}if(_ac0){self._urlInput.set("value","mailto:"+url);}self._setButton.set("disabled",!self._isValid());};if(this._delayedCheck){clearTimeout(this._delayedCheck);this._delayedCheck=null;}this._delayedCheck=setTimeout(function(){_abe(url);},250);},_connectTagEvents:function(){this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);}));},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid();},_setContent:function(_ac1){this.dropDown.set({parserScope:"dojo",content:_ac1});},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}return args;},setValue:function(args){this._onCloseDialog();if(has("ie")<9){var sel=_ab5.getSelection(this.editor.window);var _ac2=sel.getRangeAt(0);var a=_ac2.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(a&&(a.nodeName&&a.nodeName.toLowerCase()===this.tag)){if(this.editor.queryCommandEnabled("unlink")){this.editor._sCall("selectElementChildren",[a]);this.editor.execCommand("unlink");}}}args=this._checkValues(args);this.editor.execCommand("inserthtml",_ab1.substitute(this.htmlTemplate,args));_ab0("a",this.editor.document).forEach(function(a){if(!a.innerHTML&&!_aaf.has(a,"name")){a.parentNode.removeChild(a);}},this);},_onCloseDialog:function(){this.editor.focus();},_getCurrentValues:function(a){var url,text,_ac3;if(a&&a.tagName.toLowerCase()===this.tag){url=a.getAttribute("_djrealurl")||a.getAttribute("href");_ac3=a.getAttribute("target")||"_self";text=a.textContent||a.innerText;this.editor._sCall("selectElement",[a,true]);}else{text=this.editor._sCall("getSelectedText");}return {urlInput:url||"",textInput:text||"",targetSelect:_ac3||""};},_onOpenDialog:function(){var a,b,fc;if(has("ie")){var sel=_ab5.getSelection(this.editor.window);if(sel.rangeCount){var _ac4=sel.getRangeAt(0);a=_ac4.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(!a||(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){b=this.editor._sCall("getAncestorElement",[this.tag]);if(b&&(b.nodeName&&b.nodeName.toLowerCase()==this.tag)){a=b;this.editor._sCall("selectElement",[a]);}else{if(_ac4.startContainer===_ac4.endContainer){fc=_ac4.startContainer.firstChild;if(fc&&(fc.nodeName&&fc.nodeName.toLowerCase()==this.tag)){a=fc;this.editor._sCall("selectElement",[a]);}}}}}}else{a=this.editor._sCall("getAncestorElement",[this.tag]);}this.dropDown.reset();this._setButton.set("disabled",true);this.dropDown.set("value",this._getCurrentValues(a));},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_aaf.get(t,"href")){var _ac5=this.editor;this.editor._sCall("selectElement",[t]);_ac5.onDisplayChanged();if(_ac5._updateTimer){_ac5._updateTimer.remove();delete _ac5._updateTimer;}_ac5.onNormalizedDisplayChanged();var _ac6=this.button;setTimeout(function(){_ac6.set("disabled",false);_ac6.loadAndOpenDropDown().then(function(){if(_ac6.dropDown.focus){_ac6.dropDown.focus();}});},10);}}}});var _ac7=_aae("dijit._editor.plugins.ImgLinkDialog",[_ab6],{linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' "+"required='true' id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='false' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","</td><td>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),htmlTemplate:"<img src=\"${urlInput}\" _djrealurl=\"${urlInput}\" alt=\"${textInput}\" />",tag:"img",_getCurrentValues:function(img){var url,text;if(img&&img.tagName.toLowerCase()===this.tag){url=img.getAttribute("_djrealurl")||img.getAttribute("src");text=img.getAttribute("alt");this.editor._sCall("selectElement",[img,true]);}else{text=this.editor._sCall("getSelectedText",[]);}return {urlInput:url||"",textInput:text||""};},_isValid:function(){return this._urlInput.isValid();},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"onmousedown",this._selectTag);}));},_selectTag:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag){this.editor._sCall("selectElement",[t]);}}},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}if(args&&args.textInput){args.textInput=args.textInput.replace(/"/g,"&quot;");}return args;},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_aaf.get(t,"src")){var _ac8=this.editor;this.editor._sCall("selectElement",[t]);_ac8.onDisplayChanged();if(_ac8._updateTimer){_ac8._updateTimer.remove();delete _ac8._updateTimer;}_ac8.onNormalizedDisplayChanged();var _ac9=this.button;setTimeout(function(){_ac9.set("disabled",false);_ac9.loadAndOpenDropDown().then(function(){if(_ac9.dropDown.focus){_ac9.dropDown.focus();}});},10);}}}});_ab3.registry["createLink"]=function(){return new _ab6({command:"createLink"});};_ab3.registry["insertImage"]=function(){return new _ac7({command:"insertImage"});};_ab6.ImgLinkDialog=_ac7;return _ab6;});},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_aca,_acb,_acc){var base=null;return _aca("dojo.store.Memory",base,{constructor:function(_acd){for(var i in _acd){this[i]=_acd[i];}this.setData(this.data||[]);},data:null,idProperty:"id",index:null,queryEngine:_acc,get:function(id){return this.data[this.index[id]];},getIdentity:function(_ace){return _ace[this.idProperty];},put:function(_acf,_ad0){var data=this.data,_ad1=this.index,_ad2=this.idProperty;var id=_acf[_ad2]=(_ad0&&"id" in _ad0)?_ad0.id:_ad2 in _acf?_acf[_ad2]:Math.random();if(id in _ad1){if(_ad0&&_ad0.overwrite===false){throw new Error("Object already exists");}data[_ad1[id]]=_acf;}else{_ad1[id]=data.push(_acf)-1;}return id;},add:function(_ad3,_ad4){(_ad4=_ad4||{}).overwrite=false;return this.put(_ad3,_ad4);},remove:function(id){var _ad5=this.index;var data=this.data;if(id in _ad5){data.splice(_ad5[id],1);this.setData(data);return true;}},query:function(_ad6,_ad7){return _acb(this.queryEngine(_ad6,_ad7)(this.data));},setData:function(data){if(data.items){this.idProperty=data.identifier;data=this.data=data.items;}else{this.data=data;}this.index={};for(var i=0,l=data.length;i<l;i++){this.index[data[i][this.idProperty]]=i;}}});});},"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n","dijit/form/MappedTextBox":function(){define("dijit/form/MappedTextBox",["dojo/_base/declare","dojo/dom-construct","./ValidationTextBox"],function(_ad8,_ad9,_ada){return _ad8("dijit.form.MappedTextBox",_ada,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},_setNameAttr:null,serialize:function(val){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=_ad9.place("<input type='hidden'"+(this.name?" name=\""+this.name.replace(/"/g,"&quot;")+"\"":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});});},"dijit/form/DataList":function(){define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_adb,dom,lang,_adc,_add,_ade){function _adf(_ae0){return {id:_ae0.value,value:_ae0.value,name:lang.trim(_ae0.innerText||_ae0.textContent||"")};};return _adb("dijit.form.DataList",_add,{constructor:function(_ae1,_ae2){this.domNode=dom.byId(_ae2);lang.mixin(this,_ae1);if(this.id){_ade.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:_adc("option",this.domNode).map(_adf)}]);},destroy:function(){_ade.remove(this.id);},fetchSelectedItem:function(){var _ae3=_adc("> option[selected]",this.domNode)[0]||_adc("> option",this.domNode)[0];return _ae3&&_adf(_ae3);}});});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_ae4,lang,_ae5,_ae6,_ae7,has,_ae8,util,html){return _ae5("dojox.grid._FocusManager",null,{constructor:function(_ae9){this.grid=_ae9;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_ae6.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_ae6.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_ae6.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_ae6.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_ae6.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_ae6.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_ae6.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_ae6.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_ae6.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_ae4.forEach(this._connects,_ae6.disconnect);_ae4.forEach(this._headerConnects,_ae6.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_aea,_aeb){return (this.cell==_aea)&&(this.rowIndex==_aeb);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _ae4.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_aec){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){html.toggleClass(n,this.focusClass,_aec);if(_aec){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){util.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){html.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}util.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_ae4.forEach(this._headerConnects,_ae6.disconnect);this._headerConnects=[];var _aed=this._findHeaderCells();for(var i=0;i<_aed.length;i++){this._headerConnects.push(_ae6.connect(_aed[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_ae6.connect(_aed[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _aee=_ae8("th",this.grid.viewsHeaderNode);var _aef=[];for(var i=0;i<_aee.length;i++){var _af0=_aee[i];var _af1=html.hasAttr(_af0,"tabIndex");var _af2=html.attr(_af0,"tabIndex");if(_af1&&_af2<0){_aef.push(_af0);}}return _aef;},_setActiveColHeader:function(_af3,_af4,_af5){this.grid.domNode.setAttribute("aria-activedescendant",_af3.id);if(_af5!=null&&_af5>=0&&_af5!=_af4){html.toggleClass(this._findHeaderCells()[_af5],this.focusClass,false);}html.toggleClass(_af3,this.focusClass,true);this._colHeadNode=_af3;this._colHeadFocusIdx=_af4;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var info=(this.cell?this._scrollInfo(this.cell):null);if(!info||!info.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(info.n&&info.sr){if(info.n.offsetLeft+info.n.offsetWidth>info.sr.l+info.sr.w){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}}}if(info.r&&info.sr){if(rt+info.r.offsetHeight>info.sr.t+info.sr.h){this.grid.setScrollTop(rt+info.r.offsetHeight-info.sr.h);}else{if(rt<info.sr.t){this.grid.setScrollTop(rt);}}}return info.s.scrollLeft;},_scrollInfo:function(cell,_af6){if(cell){var cl=cell,sbn=cl.view.scrollboxNode,sbnr={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:sbnr,n:(_af6?_af6:cell.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_af7){var info=null;if(this._colHeadNode){var cell=this.grid.getCell(_af7);if(!cell){return;}info=this._scrollInfo(cell,cell.getNode(0));}if(info&&info.s&&info.sr&&info.n){var _af8=info.sr.l+info.sr.w;if(info.n.offsetLeft+info.n.offsetWidth>_af8){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}else{if(has("ie")<=7&&cell&&cell.view.headerNode){cell.view.headerNode.scrollLeft=info.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _af9=this.focusView;if(!_af9){for(var i=0,_afa;(_afa=this.grid.views.views[i]);i++){if(_afa.headerNode){_af9=_afa;break;}}}return (_af9&&html.getComputedStyle(_af9.headerNode).display=="none");},colSizeAdjust:function(e,_afb,_afc){var _afd=this._findHeaderCells();var view=this.focusView;if(!view||!view.header.tableMap.map){for(var i=0,_afe;(_afe=this.grid.views.views[i]);i++){if(_afe.header.tableMap.map){view=_afe;break;}}}var _aff=_afd[_afb];if(!view||(_afb==_afd.length-1&&_afb===0)){return;}view.content.baseDecorateEvent(e);e.cellNode=_aff;e.cellIndex=view.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(view.header.canResize(e)){var _b00={l:_afc};var drag=view.header.colResizeSetup(e,false);view.header.doResizeColumn(drag,null,_b00);view.update();}},styleRow:function(_b01){return;},setFocusIndex:function(_b02,_b03){this.setFocusCell(this.grid.getCell(_b03),_b02);},setFocusCell:function(_b04,_b05){if(_b04&&!this.isFocusCell(_b04,_b05)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_b04;this.rowIndex=_b05;this._focusifyCellNode(true);}if(has("opera")){setTimeout(lang.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _b06=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_b06.editable||this.grid.canEdit&&!this.grid.canEdit(_b06,row))){this.cell=_b06;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _b07=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_b07.editable){this.cell=_b07;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_b08,_b09){var _b0a=_b09<0?-1:1;if(this.isNavHeader()){var _b0b=this._findHeaderCells();var _b0c=currentIdx=_ae4.indexOf(_b0b,this._colHeadNode);currentIdx+=_b09;while(currentIdx>=0&&currentIdx<_b0b.length&&_b0b[currentIdx].style.display=="none"){currentIdx+=_b0a;}if((currentIdx>=0)&&(currentIdx<_b0b.length)){this._setActiveColHeader(_b0b[currentIdx],currentIdx,_b0c);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_b08));if(_b08){if(_b08>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_b08<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_b09));var cell=this.grid.getCell(col);while(col>=0&&col<cc&&cell&&cell.hidden===true){col+=_b0a;cell=this.grid.getCell(col);}if(!cell||cell.hidden===true){col=i;}var n=cell.getNode(row);if(!n&&_b08){if((row+_b08)>=0&&(row+_b08)<=rc){this.move(_b08>0?++_b08:--_b08,_b09);}return;}else{if((!n||html.style(n,"display")==="none")&&_b09){if((col+_b09)>=0&&(col+_b09)<=cc){this.move(_b08,_b09>0?++_b09:--_b09);}return;}}this.setFocusIndex(row,col);if(_b08){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_ae7.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_ae7.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){html.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _b0d=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_ae7.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_ae7.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_b0e){this.tabbingOut=true;_b0e.focus();},focusGridView:function(){util.fire(this.focusView,"focus");},focusGrid:function(_b0f){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _b10=true;var _b11=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_b11){var _b12=0;var cell=this.grid.getCell(_b12);if(cell.hidden){_b12=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_b12);}else{if(this.cell&&!_b11){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_b10=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _b10;},focusHeader:function(){var _b13=this._findHeaderCells();var _b14=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_b13[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_b13.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_b13[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_b14);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){html.removeClass(this._colHeadNode,this.focusClass);html.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _b15=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_b15);this._contextMenuBindNode=_b15;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_ae7.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_ae7.stop(e);},doBlur:function(e){_ae7.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_ae7.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_ae7.stop(e);},doLastNodeBlur:function(e){_ae7.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,html.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_ae7.stop(e);},doColHeaderBlur:function(e){html.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","esri/layers/SnapshotMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/tasks/query","esri/layers/RenderMode"],function(_b16,lang,has,_b17,_b18,_b19,_b1a){var _b1b=_b16([_b1a],{declaredClass:"esri.layers._SnapshotMode",constructor:function(_b1c){this.featureLayer=_b1c;this._featureMap={};this._drawFeatures=lang.hitch(this,this._drawFeatures);this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},startup:function(){if(this.featureLayer._collection){this._applyTimeFilter();}else{this._fetchAll();}},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},drawFeature:function(_b1d){var _b1e=this.featureLayer,_b1f=_b1e.objectIdField,oid=_b1d.attributes[_b1f];this._addFeatureIIf(oid,_b1d);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _b20=this.featureLayer;if(_b20._collection){_b20._fireUpdateStart();_b20._refresh(true);_b20._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_b21){var id="_"+_b21.name+_b21.layerId+_b21._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _b22=this.featureLayer;if(_b22._collection){return;}_b22._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_b23=this.featureLayer,_b24=_b23.getDefinitionExpression();var _b25=new _b19();_b25.outFields=_b23._getOutFields();_b25.where=_b24||"1=1";_b25.returnGeometry=true;_b25.outSpatialReference=new _b18(map.spatialReference.toJson());_b25.timeExtent=_b23.getTimeDefinition();_b25.maxAllowableOffset=_b23._maxOffset;if(_b23._ts){_b25._ts=(new Date()).getTime();}var _b26;if(_b23._usePatch){_b26=this._getRequestId(_b23);this._cancelPendingRequest(null,_b26);}_b23._task.execute(_b25,this._drawFeatures,this._queryErrorHandler,_b26);},_drawFeatures:function(_b27){this._purgeRequests();var _b28=_b27.features,_b29=this.featureLayer,_b2a=_b29.objectIdField,i,len=_b28.length,_b2b,oid;for(i=0;i<len;i++){_b2b=_b28[i];oid=_b2b.attributes[_b2a];this._addFeatureIIf(oid,_b2b);this._incRefCount(oid);}this._applyTimeFilter(true);_b29._fireUpdateEnd(null,_b27.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_b27.exceededTransferLimit){_b29.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _b2c=this.featureLayer;_b2c._errorHandler(err);_b2c._fireUpdateEnd(err);}});if(has("extend-esri")){lang.setObject("layers._SnapshotMode",_b1b,_b17);}return _b1b;});},"dijit/form/_Spinner":function(){require({cache:{"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n"}});define("dijit/form/_Spinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/mouse","../typematic","./RangeBoundTextBox","dojo/text!./templates/Spinner.html","./_TextBoxMixin"],function(_b2d,_b2e,keys,lang,has,_b2f,_b30,_b31,_b32,_b33){return _b2d("dijit.form._Spinner",_b31,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:_b32,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{"upArrowNode":"dijitUpArrowButton","downArrowNode":"dijitDownArrowButton"},adjust:function(val){return val;},_arrowPressed:function(_b34,_b35,_b36){if(this.disabled||this.readOnly){return;}this._setValueAttr(this.adjust(this.get("value"),_b35*_b36),false);_b33.selectInputText(this.textbox,this.textbox.value.length);},_arrowReleased:function(){this._wheelTimer=null;},_typematicCallback:function(_b37,node,evt){var inc=this.smallDelta;if(node==this.textbox){var key=evt.charOrCode;inc=(key==keys.PAGE_UP||key==keys.PAGE_DOWN)?this.largeDelta:this.smallDelta;node=(key==keys.UP_ARROW||key==keys.PAGE_UP)?this.upArrowNode:this.downArrowNode;}if(_b37==-1){this._arrowReleased(node);}else{this._arrowPressed(node,(node==this.upArrowNode)?1:-1,inc);}},_wheelTimer:null,_mouseWheeled:function(evt){_b2e.stop(evt);var _b38=evt.wheelDelta/120;if(Math.floor(_b38)!=_b38){_b38=evt.wheelDelta>0?1:-1;}var _b39=evt.detail?(evt.detail*-1):_b38;if(_b39!==0){var node=this[(_b39>0?"upArrowNode":"downArrowNode")];this._arrowPressed(node,_b39,this.smallDelta);if(this._wheelTimer){this._wheelTimer.remove();}this._wheelTimer=this.defer(function(){this._arrowReleased(node);},50);}},_setConstraintsAttr:function(_b3a){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){this.focusNode.setAttribute("aria-valuemin",this.constraints.min);}else{this.focusNode.removeAttribute("aria-valuemin");}if(this.constraints.max!==undefined){this.focusNode.setAttribute("aria-valuemax",this.constraints.max);}else{this.focusNode.removeAttribute("aria-valuemax");}}},_setValueAttr:function(_b3b,_b3c){this.focusNode.setAttribute("aria-valuenow",_b3b);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,_b2f.wheel,"_mouseWheeled");this.own(_b30.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.UP_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_b30.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.DOWN_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_b30.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.PAGE_UP,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_b30.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.PAGE_DOWN,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));}});});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_b3d,dom,_b3e,_b3f,_b40,has,_b41,_b42,_b43,_b44,_b45){return _b3d("dijit.MenuItem",[_b41,_b42,_b43,_b44],{templateString:_b45,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_b46){if(_b46&&!("label" in this.params)){this.set("label",_b46.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _b47=this.id+"_text";_b3e.set(this.containerNode,"id",_b47);if(this.accelKeyNode){_b3e.set(this.accelKeyNode,"id",this.id+"_accel");_b47+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_b47);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_b48){_b3f.toggle(this.domNode,"dijitMenuItemSelected",_b48);},setLabel:function(_b49){_b40.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_b49);},setDisabled:function(_b4a){_b40.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_b4a);},_setDisabledAttr:function(_b4b){this.focusNode.setAttribute("aria-disabled",_b4b?"true":"false");this._set("disabled",_b4b);},_setAccelKeyAttr:function(_b4c){this.accelKeyNode.style.display=_b4c?"":"none";this.accelKeyNode.innerHTML=_b4c;_b3e.set(this.containerNode,"colSpan",_b4c?"1":"2");this._set("accelKey",_b4c);},_setTextDirAttr:function(_b4d){if(!this._created||this.textDir!=_b4d){this._set("textDir",_b4d);this.applyTextDir(this.focusNode,this.label);}}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","dijit/form/NumberSpinner":function(){define("dijit/form/NumberSpinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","./_Spinner","./NumberTextBox"],function(_b4e,_b4f,keys,_b50,_b51){return _b4e("dijit.form.NumberSpinner",[_b50,_b51.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(val,_b52){var tc=this.constraints,v=isNaN(val),_b53=!isNaN(tc.max),_b54=!isNaN(tc.min);if(v&&_b52!=0){val=(_b52>0)?_b54?tc.min:_b53?tc.max:0:_b53?this.constraints.max:_b54?tc.min:0;}var _b55=val+_b52;if(v||isNaN(_b55)){return val;}if(_b53&&(_b55>tc.max)){_b55=tc.max;}if(_b54&&(_b55<tc.min)){_b55=tc.min;}return _b55;},_onKeyPress:function(e){if((e.charOrCode==keys.HOME||e.charOrCode==keys.END)&&!(e.ctrlKey||e.altKey||e.metaKey)&&typeof this.get("value")!="undefined"){var _b56=this.constraints[(e.charOrCode==keys.HOME?"min":"max")];if(typeof _b56=="number"){this._setValueAttr(_b56,false);}_b4f.stop(e);}}});});},"dijit/form/FilteringSelect":function(){define("dijit/form/FilteringSelect",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(_b57,_b58,lang,when,_b59,_b5a){return _b58("dijit.form.FilteringSelect",[_b59,_b5a],{required:true,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened;},isValid:function(){return !!this.item||(!this.required&&this.get("displayedValue")=="");},_refreshState:function(){if(!this.searchTimer){this.inherited(arguments);}},_callbackSetLabel:function(_b5b,_b5c,_b5d,_b5e){if((_b5c&&_b5c[this.searchAttr]!==this._lastQuery)||(!_b5c&&_b5b.length&&this.store.getIdentity(_b5b[0])!=this._lastQuery)){return;}if(!_b5b.length){this.set("value","",_b5e||(_b5e===undefined&&!this.focused),this.textbox.value,null);}else{this.set("item",_b5b[0],_b5e);}},_openResultList:function(_b5f,_b60,_b61){if(_b60[this.searchAttr]!==this._lastQuery){return;}this.inherited(arguments);if(this.item===undefined){this.validate(true);}},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(_b62,_b63,_b64,item){if(!this._onChangeActive){_b63=null;}if(item===undefined){if(_b62===null||_b62===""){_b62="";if(!lang.isString(_b64)){this._setDisplayedValueAttr(_b64||"",_b63);return;}}var self=this;this._lastQuery=_b62;when(this.store.get(_b62),function(item){self._callbackSetLabel(item?[item]:[],undefined,undefined,_b63);});}else{this.valueNode.value=_b62;this.inherited(arguments);}},_setItemAttr:function(item,_b65,_b66){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(_b67,_b68){if(_b67==null){_b67="";}if(!this._created){if(!("displayedValue" in this.params)){return;}_b68=false;}if(this.store){this.closeDropDown();var _b69=lang.clone(this.query);var qs=this._getDisplayQueryString(_b67),q;if(this.store._oldAPI){q=qs;}else{q=_b57.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_b69[this.searchAttr]=q;this.textbox.value=_b67;this._lastDisplayedValue=_b67;this._set("displayedValue",_b67);var _b6a=this;var _b6b={ignoreCase:this.ignoreCase,deep:true};lang.mixin(_b6b,this.fetchProperties);this._fetchHandle=this.store.query(_b69,_b6b);when(this._fetchHandle,function(_b6c){_b6a._fetchHandle=null;_b6a._callbackSetLabel(_b6c||[],_b69,_b6b,_b68);},function(err){_b6a._fetchHandle=null;if(!_b6a._cancelingQuery){console.error("dijit.form.FilteringSelect: "+err.toString());}});}},undo:function(){this.set("displayedValue",this._lastDisplayedValue);}});});},"dijit/form/SimpleTextarea":function(){define("dijit/form/SimpleTextarea",["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(_b6d,_b6e,has,_b6f){return _b6d("dijit.form.SimpleTextarea",_b6f,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(has("ie")&&this.cols){_b6e.add(this.textbox,"dijitTextAreaCols");}},filter:function(_b70){if(_b70){_b70=_b70.replace(/\r/g,"");}return this.inherited(arguments);},_onInput:function(e){if(this.maxLength){var _b71=parseInt(this.maxLength);var _b72=this.textbox.value.replace(/\r/g,"");var _b73=_b72.length-_b71;if(_b73>0){var _b74=this.textbox;if(_b74.selectionStart){var pos=_b74.selectionStart;var cr=0;if(has("opera")){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_b72.substring(0,pos-_b73-cr)+_b72.substring(pos-cr);_b74.setSelectionRange(pos-_b73,pos-_b73);}else{if(this.ownerDocument.selection){_b74.focus();var _b75=this.ownerDocument.selection.createRange();_b75.moveStart("character",-_b73);_b75.text="";_b75.select();}}}}this.inherited(arguments);}});});},"esri/dijit/editing/tools/Selection":function(){define("esri/dijit/editing/tools/Selection",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Color","dojo/has","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/dijit/editing/tools/Edit","esri/dijit/editing/tools/SelectionTools","esri/dijit/editing/tools/DropDownToolBase","esri/kernel"],function(_b76,lang,_b77,_b78,_b79,has,_b7a,_b7b,_b7c,Edit,_b7d,_b7e,_b7f){var _b80=_b76([_b7e],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:true,activate:function(){this.inherited(arguments);this._sConnect=_b78.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");},deactivate:function(){this.inherited(arguments);_b78.disconnect(this._sConnect);delete this._sConnect;},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"];},_onDrawEnd:function(_b81){this.inherited(arguments);this._settings.editor._hideAttributeInspector();var _b82=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(_b82,_b81,this._selectMethod,lang.hitch(this,"onFinished"));},_createSymbols:function(){this._pointSelectionSymbol=new _b7a(_b7a.STYLE_CIRCLE,10,new _b7b(_b7b.STYLE_SOLID,new _b79([0,0,0]),1),new _b79([255,0,0,0.5]));this._polylineSelectionSymbol=new _b7b(_b7b.STYLE_SOLID,new _b79([0,200,255]),2);this._polygonSelectionSymbol=new _b7c(_b7c.STYLE_SOLID,new _b7b(_b7b.STYLE_SOLID,new _b79([0,0,0]),1),new _b79([0,200,255,0.5]));},_initializeLayers:function(){var _b83=this._settings.layers;_b77.forEach(_b83,this._setSelectionSymbol,this);},_setSelectionSymbol:function(_b84){var _b85=null;switch(_b84.geometryType){case "esriGeometryPoint":_b85=this._pointSelectionSymbol;break;case "esriGeometryPolyline":_b85=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":_b85=this._polygonSelectionSymbol;break;}_b84.setSelectionSymbol(_b84._selectionSymbol||_b85);},_createTools:function(){_b77.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_b86){var _b87=lang.mixin(_b7d[_b86],{settings:this._settings,onClick:lang.hitch(this,"onItemClicked")});this._tools[_b86.toUpperCase()]=new Edit(_b87);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Selection",_b80,_b7f);}return _b80;});},"dijit/_editor/plugins/TextColor":function(){define("dijit/_editor/plugins/TextColor",["require","dojo/colors","dojo/_base/declare","dojo/_base/lang","../_Plugin","../../form/DropDownButton"],function(_b88,_b89,_b8a,lang,_b8b,_b8c){var _b8d=_b8a("dijit._editor.plugins.TextColor",_b8b,{buttonClass:_b8c,useDefaultCommand:false,_initButton:function(){this.inherited(arguments);var self=this;this.button.loadDropDown=function(_b8e){_b88(["../../ColorPalette"],lang.hitch(this,function(_b8f){this.dropDown=new _b8f({dir:self.editor.dir,ownerDocument:self.editor.ownerDocument,value:self.value,onChange:function(_b90){self.editor.execCommand(self.command,_b90);}});_b8e();}));};},updateState:function(){var _b91=this.editor;var _b92=this.command;if(!_b91||!_b91.isLoaded||!_b92.length){return;}if(this.button){var _b93=this.get("disabled");this.button.set("disabled",_b93);if(_b93){return;}var _b94;try{_b94=_b91.queryCommandValue(_b92)||"";}catch(e){_b94="";}}if(_b94==""){_b94="#000000";}if(_b94=="transparent"){_b94="#ffffff";}if(typeof _b94=="string"){if(_b94.indexOf("rgb")>-1){_b94=_b89.fromRgb(_b94).toHex();}}else{_b94=((_b94&255)<<16)|(_b94&65280)|((_b94&16711680)>>>16);_b94=_b94.toString(16);_b94="#000000".slice(0,7-_b94.length)+_b94;}this.value=_b94;var _b95=this.button.dropDown;if(_b95&&_b94!==_b95.get("value")){_b95.set("value",_b94,false);}}});_b8b.registry["foreColor"]=function(){return new _b8d({command:"foreColor"});};_b8b.registry["hiliteColor"]=function(){return new _b8d({command:"hiliteColor"});};return _b8d;});},"esri/dijit/editing/Delete":function(){define("esri/dijit/editing/Delete",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase","esri/dijit/editing/Add"],function(_b96,lang,has,_b97,_b98,Add){var _b99=_b96(_b98,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(_b9a){_b9a=_b9a||{};this._add=new Add({featureLayer:_b9a.featureLayer,addedGraphics:_b9a.deletedGraphics});},performUndo:function(){this._add.performRedo();},performRedo:function(){this._add.performUndo();}});if(has("extend-esri")){lang.setObject("dijit.editing.Delete",_b99,_b97);}return _b99;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_b9b,_b9c,dom,_b9d,_b9e,lang,_b9f,on,_ba0,_ba1,pm,_ba2,_ba3,_ba4,_ba5){return _b9c("dijit._MenuBase",[_ba3,_ba5,_ba4],{parentMenu:null,popupDelay:500,autoFocus:false,childSelector:function(node){var _ba6=_ba2.byNode(node);return node.parentNode==this.containerNode&&_ba6&&_ba6.focus;},postCreate:function(){var self=this,_ba7=typeof this.childSelector=="string"?this.childSelector:lang.hitch(this,"childSelector");this.own(on(this.containerNode,on.selector(_ba7,_b9f.enter),function(){self.onItemHover(_ba2.byNode(this));}),on(this.containerNode,on.selector(_ba7,_b9f.leave),function(){self.onItemUnhover(_ba2.byNode(this));}),on(this.containerNode,on.selector(_ba7,_ba1),function(evt){self.onItemClick(_ba2.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _ba8=this._getTopMenu();if(_ba8&&_ba8._isMenuBar){_ba8.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _ba9=this.currentPopup.parentMenu;if(_ba9.focusedChild){_ba9.focusedChild._setSelected(false);}_ba9.focusedChild=this.currentPopup.from_item;_ba9.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _baa=item.popup;if(_baa){this._stopPendingCloseTimer(_baa);_baa._pendingClose_timer=this.defer(function(){_baa._pendingClose_timer=null;if(_baa.parentMenu){_baa.parentMenu.currentPopup=null;}pm.close(_baa);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_bab){if(_bab._pendingClose_timer){_bab._pendingClose_timer=_bab._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_bac){this._stopPopupTimer();var _bad=this.focusedChild;if(!_bad){return;}var _bae=_bad.popup;if(!_bae.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_bae.parentMenu=this;_bae.from_item=_bad;var self=this;pm.open({parent:this,popup:_bae,around:_bad.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_bad);self._cleanUp();_bad._setSelected(true);self.focusedChild=_bad;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_bae;_bae.connect(_bae.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_bac&&_bae.focus){_bae._focus_timer=this.defer(lang.hitch(_bae,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_b9e.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_b9e.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_b9b.indexOf(this._focusManager.activeStack,this.id)>=0){_b9d.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dijit/_editor/selection":function(){define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(dom,lang,has,win,_baf){var _bb0={getType:function(){if(win.doc.getSelection){var _bb1="text";var oSel;try{oSel=win.global.getSelection();}catch(e){}if(oSel&&oSel.rangeCount==1){var _bb2=oSel.getRangeAt(0);if((_bb2.startContainer==_bb2.endContainer)&&((_bb2.endOffset-_bb2.startOffset)==1)&&(_bb2.startContainer.nodeType!=3)){_bb1="control";}}return _bb1;}else{return win.doc.selection.type.toLowerCase();}},getSelectedText:function(){if(win.doc.getSelection){var _bb3=win.global.getSelection();return _bb3?_bb3.toString():"";}else{if(_baf._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().text;}},getSelectedHtml:function(){if(win.doc.getSelection){var _bb4=win.global.getSelection();if(_bb4&&_bb4.rangeCount){var i;var html="";for(i=0;i<_bb4.rangeCount;i++){var frag=_bb4.getRangeAt(i).cloneContents();var div=win.doc.createElement("div");div.appendChild(frag);html+=div.innerHTML;}return html;}return null;}else{if(_baf._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().htmlText;}},getSelectedElement:function(){if(_baf._editor.selection.getType()=="control"){if(win.doc.getSelection){var _bb5=win.global.getSelection();return _bb5.anchorNode.childNodes[_bb5.anchorOffset];}else{var _bb6=win.doc.selection.createRange();if(_bb6&&_bb6.item){return win.doc.selection.createRange().item(0);}}}return null;},getParentElement:function(){if(_baf._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(win.doc.getSelection){var _bb7=win.global.getSelection();if(_bb7){var node=_bb7.anchorNode;while(node&&(node.nodeType!=1)){node=node.parentNode;}return node;}}else{var r=win.doc.selection.createRange();r.collapse(true);return r.parentElement();}}return null;},hasAncestorElement:function(_bb8){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_bb9){var node=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(node,arguments);},isTag:function(node,tags){if(node&&node.tagName){var _bba=node.tagName.toLowerCase();for(var i=0;i<tags.length;i++){var _bbb=String(tags[i]).toLowerCase();if(_bba==_bbb){return _bbb;}}}return "";},getParentOfType:function(node,tags){while(node){if(this.isTag(node,tags).length){return node;}node=node.parentNode;}return null;},collapse:function(_bbc){if(win.doc.getSelection){var _bbd=win.global.getSelection();if(_bbd.removeAllRanges){if(_bbc){_bbd.collapseToStart();}else{_bbd.collapseToEnd();}}else{_bbd.collapse(_bbc);}}else{var _bbe=win.doc.selection.createRange();_bbe.collapse(_bbc);_bbe.select();}},remove:function(){var sel=win.doc.selection;if(win.doc.getSelection){sel=win.global.getSelection();sel.deleteFromDocument();return sel;}else{if(sel.type.toLowerCase()!="none"){sel.clear();}return sel;}},selectElementChildren:function(_bbf,_bc0){var doc=win.doc;var _bc1;_bbf=dom.byId(_bbf);if(win.doc.getSelection){var _bc2=win.global.getSelection();if(has("opera")){if(_bc2.rangeCount){_bc1=_bc2.getRangeAt(0);}else{_bc1=doc.createRange();}_bc1.setStart(_bbf,0);_bc1.setEnd(_bbf,(_bbf.nodeType==3)?_bbf.length:_bbf.childNodes.length);_bc2.addRange(_bc1);}else{_bc2.selectAllChildren(_bbf);}}else{_bc1=_bbf.ownerDocument.body.createTextRange();_bc1.moveToElementText(_bbf);if(!_bc0){try{_bc1.select();}catch(e){}}}},selectElement:function(_bc3,_bc4){var _bc5;_bc3=dom.byId(_bc3);var doc=_bc3.ownerDocument;var _bc6=win.global;if(doc.getSelection){var _bc7=_bc6.getSelection();_bc5=doc.createRange();if(_bc7.removeAllRanges){if(has("opera")){if(_bc7.getRangeAt(0)){_bc5=_bc7.getRangeAt(0);}}_bc5.selectNode(_bc3);_bc7.removeAllRanges();_bc7.addRange(_bc5);}}else{try{var tg=_bc3.tagName?_bc3.tagName.toLowerCase():"";if(tg==="img"||tg==="table"){_bc5=win.body(doc).createControlRange();}else{_bc5=win.body(doc).createRange();}_bc5.addElement(_bc3);if(!_bc4){_bc5.select();}}catch(e){this.selectElementChildren(_bc3,_bc4);}}},inSelection:function(node){if(node){var _bc8;var doc=win.doc;var _bc9;if(win.doc.getSelection){var sel=win.global.getSelection();if(sel&&sel.rangeCount>0){_bc9=sel.getRangeAt(0);}if(_bc9&&_bc9.compareBoundaryPoints&&doc.createRange){try{_bc8=doc.createRange();_bc8.setStart(node,0);if(_bc9.compareBoundaryPoints(_bc9.START_TO_END,_bc8)===1){return true;}}catch(e){}}}else{_bc9=doc.selection.createRange();try{_bc8=node.ownerDocument.body.createControlRange();if(_bc8){_bc8.addElement(node);}}catch(e1){try{_bc8=node.ownerDocument.body.createTextRange();_bc8.moveToElementText(node);}catch(e2){}}if(_bc9&&_bc8){if(_bc9.compareEndPoints("EndToStart",_bc8)===1){return true;}}}}return false;}};lang.setObject("dijit._editor.selection",_bb0);return _bb0;});},"esri/dijit/editing/tools/SelectionTools":function(){define(["dojo/_base/lang","dojo/has","esri/layers/FeatureLayer","esri/toolbars/draw","esri/kernel"],function(lang,has,_bca,Draw,_bcb){var _bcc={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_bca.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_bca.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_bca.SELECTION_SUBTRACT,_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:false,_label:"NLS_selectionClearLbl"}};if(has("extend-esri")){lang.setObject("dijit.editing.tools.SelectionTools",_bcc,_bcb);}return _bcc;});},"esri/dijit/editing/tools/ButtonToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/form/Button","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_bcd,lang,has,_bce,_bcf,_bd0){var BTB=_bcd([_bce,_bcf],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_bce.prototype.destroy.apply(this,arguments);_bcf.prototype.destroy.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ButtonToolBase",BTB,_bd0);}return BTB;});},"esri/dijit/editing/TemplatePicker":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/json","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojo/data/ItemFileReadStore","dojox/grid/DataGrid","dojox/gfx","esri/layers/FeatureLayer","esri/symbols/PictureMarkerSymbol","esri/dijit/editing/TemplatePickerItem","esri/kernel","esri/lang","esri/request","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/TemplatePicker.html"],function(_bd1,_bd2,lang,_bd3,html,_bd4,_bd5,_bd6,has,_bd7,_bd8,_bd9,_bda,_bdb,_bdc,_bdd,_bde,_bdf,_be0,gfx,_be1,_be2,_be3,_be4,_be5,_be6,_be7,_be8){var TP=_bd2([_bdd,_bde],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:true,templateString:_be8,basePath:_bd1.toUrl("esri/dijit/editing")+"/",featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_be9,_bea){_be9=_be9||{};if(!_be9.items&&!_be9.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(_bd6.version.minor>=4);this._itemWidgets={};if(_be9.featureLayers&&_be9.featureLayers.length){this._flChanged=1;}this._nls=_be7.widgets.templatePicker;this.emptyMessage=_be9.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=_bdb.getContentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=_bdb.getContentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();_bd3.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(has("ie")<9){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _beb=this._selectedCell,info=this._selectedInfo;if(_beb){this._rowClicked({cellNode:_beb,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_bec){var _bed=(this.rows==="auto"&&this.columns==="auto"&&_bec)?true:false,grid=this.grid,box;if(_bed){var _bee=this.domNode,id=_bee.id,_bef,item=_bd6.query("#"+id+".templatePicker div.item")[0];box=_bdb.getContentBox(_bee);item=item&&item.parentNode;if(item){_bef=html.coords(item).w;}else{_bef=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_bef);this._columns=this._columns||1;}var _bf0=this._rows;this._preprocess();var _bf1=this._rows;this._setGridLayout();this._setGridData();if(_bf1!==_bf0){grid.set("autoHeight",this._rows,false);}if(_bed){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_bf2=this.getSelected();if(_bf2){grid.store.fetch({onComplete:function(its){var _bf3=self._locate(_bf2,self._selectedInfo,its);var _bf4=_bf3&&grid.views.views[0].getCellNode(_bf3[0],_bf3[1]);if(_bf4){self._rowClicked({cellNode:_bf4,rowIndex:_bf3[0],cellIndex:_bf3[1]},true);}}});}if(has("ie")<9){setTimeout(this._repaintItems,this._ieTimer);}var _bf5=this.featureLayers,_bf6=this.items;if((!_bf5||!_bf5.length)&&(!_bf6||!_bf6.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _bf7=this.useLegend;if(!this._started||_bf7!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_bf8){var _bf9=this.featureLayers;if(!this._started||_bf9!==_bf8){this._flChanged=1;}this.featureLayers=_bf8;},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _bfa;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}_bfa=this._flItems=this._getItemsFromLayers(this.featureLayers);}else{_bfa=this._itItems=this._getItemsFromItems(this.items);}if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_bfa.length;_bd4.forEach(_bfa,function(_bfb){len+=Math.ceil(_bfb.length/this.columns);},this);}else{_bd4.forEach(_bfa,function(_bfc){len+=_bfc.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_bfa.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{_bd4.forEach(_bfa,function(_bfd){len+=_bfd.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_bfa.length/this.rows);}this._columns=len;}}},_processSelectionLayers:function(){var map,_bfe,info,_bff,key,_c00,_c01,_c02={};_bd4.forEach(this.featureLayers,function(_c03,idx){if(_c03.mode===_be1.MODE_SELECTION&&_c03._map&&_c03.url&&_c03._params.drawMode&&!_c03.source){_bfe=lang.trim(_c03._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_c02[_bfe]=_c02[_bfe]||{});_bff=(info.featureLayers=info.featureLayers||{});_c00=(info.indices=info.indices||[]);_bff[idx]=_c03;_c00.push(idx);map=_c03._map;}});if(map){_bd4.forEach(map.layerIds,function(_c04){_c04=map.getLayer(_c04);if(_c04&&_c04.url&&(_c04.getImageUrl||_c04.getTileUrl)&&_c04.loaded&&_c04.version>=10.1){_bfe=lang.trim(_c04._url.path).replace(/(\/MapServer).*/ig,"$1");key=_bfe.replace(/^https?:\/\//ig,"").toLowerCase();if(_c02[key]&&(!_c02[key].mapServiceUrl)){info=_c02[key];info.mapServiceUrl=_bfe;info.mapServiceLayer=_c04;this._legendIndices=this._legendIndices.concat(info.indices);_c01=this._fetchLegend({pickerInstance:this,info:info},key);if(_c01.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_c01);}else{this._processLegendResponse(_c01,info);}}}},this);}},_fetchLegend:function(_c05,key){var _c06=TP.prototype,_c07=_c06.legendCache[key];if(!_c07){_c07=(_c06.legendCache[key]=_be6({url:_c05.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_c07._contexts=[_c05];_c07.addBoth(function(_c08){if(_c07.canceled){return;}_c06.legendCache[key]=_c08;var _c09=_c07._contexts;_c07._contexts=null;_bd4.forEach(_c09,function(ctxt){var _c0a=ctxt.pickerInstance,info=ctxt.info,_c0b;if(_c0a._destroyed){return;}_bd4.forEach(info.indices,function(idx){_c0b=_bd4.indexOf(_c0a._loadingIndices,idx);if(_c0b>-1){_c0a._loadingIndices.splice(_c0b,1);}});_c0b=_bd4.indexOf(_c0a._loadingLegends,_c07);if(_c0b>-1){_c0a._loadingLegends.splice(_c0b,1);}_c0a._processLegendResponse(_c08,info);});});}else{if(_c07.then){_c07._contexts.push(_c05);}}return _c07;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){_bd4.forEach(this._loadingLegends,function(_c0c){var _c0d=-1;_bd4.some(_c0c._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_c0d=idx;}return (_c0d>-1);},this);if(_c0d>-1){_c0c._contexts.splice(_c0d,1);}},this);}},_processLegendResponse:function(_c0e,info){if(_c0e&&!(_c0e instanceof Error)){_bd4.forEach(info.indices,function(idx){var _c0f=info.featureLayers[idx].layerId,i,_c10=info.mapServiceUrl+"/"+_c0f+"/images/",_c11=info.mapServiceLayer._getToken(),_c12,obj,_c13,url;if(this._legendSymbols[idx]){return;}_c12=null;_bd4.some(_c0e.layers,function(_c14){if(_c14.layerId==_c0f){_c12=_c14;}return !!_c12;});if(_c12){obj=(this._legendSymbols[idx]={});_bd4.forEach(_c12.legend,function(_c15){_c13=_c15.values;if(_c13&&_c13.length){for(i=0;i<_c13.length;i++){obj[_c13[i]]=_c15;}}else{obj.defaultSymbol=_c15;}url=_c15.url;if(url&&!_c15._fixed){_c15._fixed=1;if((url.search(/https?\:/)===-1)){_c15.url=_c10+url;}if(_c11&&_c15.url.search(/https?\:/)!==-1){_c15.url+=(((_c15.url.indexOf("?")>-1)?"&":"?")+"token="+_c11);}}});}},this);}else{var _c16;_bd4.forEach(info.indices,function(idx){_c16=_bd4.indexOf(this._legendIndices,idx);if(_c16>-1){this._legendIndices.splice(_c16,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _c17=grid.adaptWidth,_c18,i,view;grid.adaptWidth=function(){_c18=this.views.views;for(i=0;view=_c18[i];i++){_bdc.set(view.headerNode,"display","block");}_c17.apply(this,arguments);for(i=0;view=_c18[i];i++){_bdc.set(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _c19=_bd3.connect(grid,"_onFetchComplete",this,function(){_bd3.disconnect(_c19);this.grid.set("autoHeight",this._rows);});}_bd3.connect(grid,"_onDelete",this,this._destroyItems);_bd3.connect(grid,"_clearData",this,this._destroyItems);_bd3.connect(grid,"destroy",this,this._destroyItems);var _c1a=grid.focus;if(_c1a&&_c1a.findAndFocusGridCell){_c1a.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _c1b=function(_c1c){return function(_c1d,_c1e){return this._cellGet(_c1c,_c1d,_c1e);};};var _c1f=lang.hitch(this,this._cellFormatter),_c20=[],cols=this._columns,i;for(i=0;i<cols;i++){_c20.push({field:"cell"+i,get:lang.hitch(this,_c1b(i)),formatter:_c1f});}var _c21={cells:[_c20]};if(this.grouping){var _c22={field:"groupName",colSpan:cols,get:lang.hitch(this,this._cellGetGroup),formatter:lang.hitch(this,this._cellGroupFormatter)};_c21.cells.push([_c22]);}var grid=this.grid,_c23=_be0.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_c23)?this._rows:_c23);grid.set("structure",_c21);},_setGridData:function(){var _c24=[];if(this.grouping){this._groupRowIndices=[];var _c25,_c26,cols=this._columns;_bd4.forEach(this._flItems,function(_c27,idx){_c24.push({});var _c28=(idx===0)?0:(_c25+_c26+1);this._groupRowIndices.push(_c28);_c25=_c28;_c26=Math.ceil(_c27.length/cols);_c24=_c24.concat(this._getStoreItems(_c27));},this);}else{if(this.featureLayers){_bd4.forEach(this._flItems,function(_c29){_c24=_c24.concat(_c29);});_c24=this._getStoreItems(_c24);}else{_c24=this._getStoreItems(this._itItems);}}var _c2a=new _bdf({data:{items:_c24}});this.grid.setStore(_c2a);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=_bda.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=_bd3.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=_bd3.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){_bd3.disconnect(this._mouseOverConnect);_bd3.disconnect(this._mouseOutConnect);_bda.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_c2b){var _c2c=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_c2c,row,col);if(!cell){return;}var _c2d=this.grid.store;if(_c2d.getValue(cell,"loadingCell")){return;}if(this._selectedCell){_bd9.remove(this._selectedCell,"selectedItem");}if(_c2c!==this._selectedCell){_bd9.add(_c2c,"selectedItem");this._selectedCell=_c2c;this._selectedItem={featureLayer:_c2d.getValue(cell,"layer"),type:_c2d.getValue(cell,"type"),template:_c2d.getValue(cell,"template"),symbolInfo:_c2d.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_c2d.getValue(cell,"index1"),index2:_c2d.getValue(cell,"index2"),index:_c2d.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_c2b){this.onSelectionChange();}},_locate:function(_c2e,info,_c2f){var _c30=this.grid.store,cols=new Array(this._columns);var _c31,_c32=info.index1,_c33=info.index2,_c34=info.index,item=_c2e.item;_bd4.some(_c2f,function(_c35,_c36){return _bd4.some(cols,function(_c37,_c38){var cell=_c30.getValue(_c35,"cell"+_c38);if(cell&&(item?(_c34===_c30.getValue(cell,"index")):(_c32===_c30.getValue(cell,"index1")&&_c33===_c30.getValue(cell,"index2")))){_c31=[_c36,_c38];return true;}else{return false;}});});return _c31;},_getCellInfo:function(_c39,row,col){if(!_c39){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _c3a=this.items;if(_c3a){return _c3a[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _c3b=this.tooltip;var _c3c=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_c3c,row,col);if(_c3b&&cell){var _c3d=this.grid.store;var _c3e=_c3d.getValue(cell,"template");var type=_c3d.getValue(cell,"type");var _c3f=_c3d.getValue(cell,"symbolInfo");var _c40=_c3d.getValue(cell,"layer");var item=this._getItem(cell);var _c41=(item&&(item.label+(item.description?(": "+item.description):"")))||(_c3e&&(_c3e.name+(_c3e.description?(": "+_c3e.description):"")))||(type&&type.name)||(_c3f&&(_c3f.label+(_c3f.description?(": "+_c3f.description):"")))||((_c40&&_c40.name+": ")+"Default");_c3b.style.display="none";_c3b.innerHTML=_c41;var _c42=html.coords(_c3c.firstChild);_bdc.set(_c3b,{left:(_c42.x)+"px",top:(_c42.y+_c42.h+5)+"px"});_c3b.style.display="";}},_cellMouseOut:function(){var _c43=this.tooltip;if(_c43){_c43.style.display="none";}},_destroyItems:function(){var _c44=this._itemWidgets,w;for(w in _c44){if(!_c44[w]){continue;}_c44[w].destroy();delete _c44[w];}},_repaintItems:function(){var _c45=this._itemWidgets,w;for(w in _c45){var _c46=_c45[w];if(_c46){_c46._repaint(_c46._surface);}}},_getStoreItems:function(_c47){var uid=this._uniqueId;_c47=_bd4.map(_c47,function(item){return lang.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_c47.length,_c48=0,obj={},k=0,prop,_c49=[],flag=true,cols=this._columns;while(_c48<len){flag=true;prop="cell"+k;obj[prop]=_c47[_c48];_c48++;k++;if(k%cols===0){flag=false;_c49.push(obj);obj={};k=0;}}if(flag&&len){_c49.push(obj);}return _c49;},_getItemsFromLayers:function(_c4a){var _c4b=[];_bd4.forEach(_c4a,function(_c4c,_c4d){_c4b.push(this._getItemsFromLayer(_c4c,_c4d));},this);return _c4b;},_getItemsFromLayer:function(_c4e,_c4f){var _c50=[];if(this.useLegend&&_bd4.indexOf(this._loadingIndices,_c4f)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_c4e,type:null,template:null,index1:_c4f,index2:0,loadingCell:1}];}var _c51=[];_c51=_c51.concat(_c4e.templates);_bd4.forEach(_c4e.types,function(_c52){var _c53=_c52.templates;_bd4.forEach(_c53,function(_c54){_c54._type_=_c52;});_c51=_c51.concat(_c53);});_c51=_bd4.filter(_c51,_be5.isDefined);var _c55=_c4e.renderer;if(_c55){var _c56=_c55.declaredClass.replace("esri.renderer.","");if(_c51.length>0){_bd4.forEach(_c51,function(_c57){var _c58=_c57.prototype;if(_c58){var _c59=_c55.getSymbol(_c58);if(_c59){var _c5a=null,pms,_c5b;if(this.useLegend&&_bd4.indexOf(this._legendIndices,_c4f)>-1){_c5b=this._legendSymbols&&this._legendSymbols[_c4f];if(_c5b){switch(_c56){case "SimpleRenderer":_c5a=_c5b.defaultSymbol;break;case "UniqueValueRenderer":_bd4.some(_c55.infos,function(info){if(info.symbol===_c59){_c5a=_c5b[info.value];}return !!_c5a;});break;case "ClassBreaksRenderer":_bd4.some(_c55.infos,function(info){if(info.symbol===_c59){_c5a=_c5b[info.maxValue];}return !!_c5a;});break;}}if(_c5a){pms=_bd5.fromJson(_bd5.toJson(_be2.defaultProps));pms.url=_c5a.url;pms.imageData=_c5a.imageData;pms.contentType=_c5a.contentType;pms.width=_c5a.width;pms.height=_c5a.height;if(!_be5.isDefined(pms.width)||!_be5.isDefined(pms.height)){pms.width=15;pms.height=15;}_c5a=new _be2(pms);}}_c50.push({label:this._trimLabel(_c57.name),symbol:_c5a||_c59,legendOverride:!!_c5a,layer:_c4e,type:_c57._type_,template:_c57,index1:_c4f,index2:_c50.length});}}delete _c57._type_;},this);}else{var _c5c=[];if(_c56==="TemporalRenderer"){_c55=_c55.observationRenderer;if(_c55){_c56=_c55.declaredClass.replace("esri.renderer.","");}}switch(_c56){case "SimpleRenderer":_c5c=[{symbol:_c55.symbol,label:_c55.label,description:_c55.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_c5c=_c55.infos;break;}_c50=_bd4.map(_c5c,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:lang.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_c4e,index1:_c4f,index2:idx};},this);}}return _c50;},_getItemsFromItems:function(_c5d){return _bd4.map(_c5d,function(item,idx){item=lang.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_c5e){var max=this.maxLabelLength;if(max&&_c5e){if(_c5e.length>max){_c5e=_c5e.substr(0,max)+"...";}}return _c5e||"";},_cellGet:function(_c5f,_c60,_c61){if(!_c61){return "";}return this.grid.store.getValue(_c61,"cell"+_c5f);},_cellFormatter:function(_c62){if(_c62){var _c63=this._itemWidgets,_c64=this.grid.store;var sid=_c64.getValue(_c62,"surfaceId");var w=_c63[sid];if(!w){w=(_c63[sid]=new _be3({id:sid,label:_c64.getValue(_c62,"label"),symbol:_c64.getValue(_c62,"symbol"),legendOverride:_c64.getValue(_c62,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_c64.getValue(_c62,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_c65,_c66){if(!this._groupRowIndices){return "";}var _c67=_bd4.indexOf(this._groupRowIndices,_c65);if(!_c66||_c67===-1){return "";}return (this.featureLayers[_c67]&&this.featureLayers[_c67].name)||"";},_cellGroupFormatter:function(_c68){if(_c68){return "<div class='groupLabel'>"+_c68+"</div>";}else{return "";}}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePicker",TP,_be4);}return TP;});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_c69,lang,_c6a,_c6b,xhr,_c6c,_c6d,_c6e,_c6f){var _c70=_c6a("dojo.data.ItemFileReadStore",[_c6c],{constructor:function(_c71){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_c71.url;this._ccUrl=_c71.url;this.url=_c71.url;this._jsonData=_c71.data;this.data=null;this._datatypeMap=_c71.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_c72){return _c6f.fromISOString(_c72);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_c71.urlPreventCache!==undefined){this.urlPreventCache=_c71.urlPreventCache?true:false;}if(_c71.hierarchical!==undefined){this.hierarchical=_c71.hierarchical?true:false;}if(_c71.clearOnClose){this.clearOnClose=true;}if("failOk" in _c71){this.failOk=_c71.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_c73){if(typeof _c73!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_c74,_c75){var _c76=this.getValues(item,_c74);return (_c76.length>0)?_c76[0]:_c75;},getValues:function(item,_c77){this._assertIsItem(item);this._assertIsAttribute(_c77);return (item[_c77]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _c78=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_c78.push(key);}}return _c78;},hasAttribute:function(item,_c79){this._assertIsItem(item);this._assertIsAttribute(_c79);return (_c79 in item);},containsValue:function(item,_c7a,_c7b){var _c7c=undefined;if(typeof _c7b==="string"){_c7c=_c6d.patternToRegExp(_c7b,false);}return this._containsValue(item,_c7a,_c7b,_c7c);},_containsValue:function(item,_c7d,_c7e,_c7f){return _c6b.some(this.getValues(item,_c7d),function(_c80){if(_c80!==null&&!lang.isObject(_c80)&&_c7f){if(_c80.toString().match(_c7f)){return true;}}else{if(_c7e===_c80){return true;}}});},isItem:function(_c81){if(_c81&&_c81[this._storeRefPropName]===this){if(this._arrayOfAllItems[_c81[this._itemNumPropName]]===_c81){return true;}}return false;},isItemLoaded:function(_c82){return this.isItem(_c82);},loadItem:function(_c83){this._assertIsItem(_c83.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_c84,_c85,_c86){var _c87=[],i,key;if(_c84.query){var _c88,_c89=_c84.queryOptions?_c84.queryOptions.ignoreCase:false;var _c8a={};for(key in _c84.query){_c88=_c84.query[key];if(typeof _c88==="string"){_c8a[key]=_c6d.patternToRegExp(_c88,_c89);}else{if(_c88 instanceof RegExp){_c8a[key]=_c88;}}}for(i=0;i<_c85.length;++i){var _c8b=true;var _c8c=_c85[i];if(_c8c===null){_c8b=false;}else{for(key in _c84.query){_c88=_c84.query[key];if(!this._containsValue(_c8c,key,_c88,_c8a[key])){_c8b=false;}}}if(_c8b){_c87.push(_c8c);}}_c86(_c87,_c84);}else{for(i=0;i<_c85.length;++i){var item=_c85[i];if(item!==null){_c87.push(item);}}_c86(_c87,_c84);}},_fetchItems:function(_c8d,_c8e,_c8f){var self=this;if(this._loadFinished){this.filter(_c8d,this._getItemsArray(_c8d.queryOptions),_c8e);}else{if(this._jsonFileUrl!==this._ccUrl){_c69.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_c8d,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_c8e)});}else{this._loadInProgress=true;var _c90={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _c91=xhr.get(_c90);_c91.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_c8d,self._getItemsArray(_c8d.queryOptions),_c8e);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_c8f(e,_c8d);}});_c91.addErrback(function(_c92){self._loadInProgress=false;_c8f(_c92,_c8d);});var _c93=null;if(_c8d.abort){_c93=_c8d.abort;}_c8d.abort=function(){var df=_c91;if(df&&df.fired===-1){df.cancel();df=null;}if(_c93){_c93.call(_c8d);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_c8d,this._getItemsArray(_c8d.queryOptions),_c8e);}catch(e){_c8f(e,_c8d);}}else{_c8f(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_c8d);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _c94=this._queuedFetches[i],_c95=_c94.args,_c96=_c94.filter,_c97=_c94.findCallback;if(_c96){_c96(_c95,this._getItemsArray(_c95.queryOptions),_c97);}else{this.fetchItemByIdentity(_c95);}}this._queuedFetches=[];}},_getItemsArray:function(_c98){if(_c98&&_c98.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_c99){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_c9a){var _c9b=false,self=this;function _c9c(_c9d){return (_c9d!==null)&&(typeof _c9d==="object")&&(!lang.isArray(_c9d)||_c9b)&&(!lang.isFunction(_c9d))&&(_c9d.constructor==Object||lang.isArray(_c9d))&&(typeof _c9d._reference==="undefined")&&(typeof _c9d._type==="undefined")&&(typeof _c9d._value==="undefined")&&self.hierarchical;};function _c9e(_c9f){self._arrayOfAllItems.push(_c9f);for(var _ca0 in _c9f){var _ca1=_c9f[_ca0];if(_ca1){if(lang.isArray(_ca1)){var _ca2=_ca1;for(var k=0;k<_ca2.length;++k){var _ca3=_ca2[k];if(_c9c(_ca3)){_c9e(_ca3);}}}else{if(_c9c(_ca1)){_c9e(_ca1);}}}}};this._labelAttr=_c9a.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_c9a.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_c9b=true;}_c9e(item);item[this._rootItemPropName]=true;}var _ca4={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _ca5=item[key];if(_ca5!==null){if(!lang.isArray(_ca5)){item[key]=[_ca5];}}else{item[key]=[null];}}_ca4[key]=key;}}while(_ca4[this._storeRefPropName]){this._storeRefPropName+="_";}while(_ca4[this._itemNumPropName]){this._itemNumPropName+="_";}while(_ca4[this._reverseRefMap]){this._reverseRefMap+="_";}var _ca6;var _ca7=_c9a.identifier;if(_ca7){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_ca7;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_ca6=item[_ca7];var _ca8=_ca6[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_ca8)){this._itemsByIdentity[_ca8]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_ca7+"].  Value collided: ["+_ca8+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_ca7+"].  Value collided: ["+_ca8+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_ca6=item[key];for(var j=0;j<_ca6.length;++j){_ca5=_ca6[j];if(_ca5!==null&&typeof _ca5=="object"){if(("_type" in _ca5)&&("_value" in _ca5)){var type=_ca5._type;var _ca9=this._datatypeMap[type];if(!_ca9){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_ca9)){_ca6[j]=new _ca9(_ca5._value);}else{if(lang.isFunction(_ca9.deserialize)){_ca6[j]=_ca9.deserialize(_ca5._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_ca5._reference){var _caa=_ca5._reference;if(!lang.isObject(_caa)){_ca6[j]=this._getItemByIdentity(_caa);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _cab=this._arrayOfAllItems[k],_cac=true;for(var _cad in _caa){if(_cab[_cad]!=_caa[_cad]){_cac=false;}}if(_cac){_ca6[j]=_cab;}}}if(this.referenceIntegrity){var _cae=_ca6[j];if(this.isItem(_cae)){this._addReferenceToMap(_cae,item,key);}}}else{if(this.isItem(_ca5)){if(this.referenceIntegrity){this._addReferenceToMap(_ca5,item,key);}}}}}}}},_addReferenceToMap:function(_caf,_cb0,_cb1){},getIdentity:function(item){var _cb2=this._features["dojo.data.api.Identity"];if(_cb2===Number){return item[this._itemNumPropName];}else{var _cb3=item[_cb2];if(_cb3){return _cb3[0];}}return null;},fetchItemByIdentity:function(_cb4){var item,_cb5;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_c69.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_cb4});}else{this._loadInProgress=true;var _cb6={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _cb7=xhr.get(_cb6);_cb7.addCallback(function(data){var _cb8=_cb4.scope?_cb4.scope:_c69.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_cb4.identity);if(_cb4.onItem){_cb4.onItem.call(_cb8,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_cb4.onError){_cb4.onError.call(_cb8,error);}}});_cb7.addErrback(function(_cb9){self._loadInProgress=false;if(_cb4.onError){var _cba=_cb4.scope?_cb4.scope:_c69.global;_cb4.onError.call(_cba,_cb9);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_cb4.identity);if(_cb4.onItem){_cb5=_cb4.scope?_cb4.scope:_c69.global;_cb4.onItem.call(_cb5,item);}}}}else{item=this._getItemByIdentity(_cb4.identity);if(_cb4.onItem){_cb5=_cb4.scope?_cb4.scope:_c69.global;_cb4.onItem.call(_cb5,item);}}},_getItemByIdentity:function(_cbb){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_cbb)){item=this._itemsByIdentity[_cbb];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_cbb)){item=this._arrayOfAllItems[_cbb];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _cbc=this._features["dojo.data.api.Identity"];if(_cbc===Number){return null;}else{return [_cbc];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_c69.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _cbd={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _cbe=xhr.get(_cbd);_cbe.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_cbe.addErrback(function(_cbf){throw _cbf;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_c70,_c6e);return _c70;});},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dijit/_editor/plugins/EnterKeyHandling",["dojo/_base/declare","dojo/dom-construct","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/window","dojo/window","../_Plugin","../RichText","../range","../../_base/focus"],function(_cc0,_cc1,_cc2,keys,lang,has,win,_cc3,_cc4,_cc5,_cc6,_cc7){return _cc0("dijit._editor.plugins.EnterKeyHandling",_cc4,{blockNodeForEnter:"BR",constructor:function(args){if(args){if("blockNodeForEnter" in args){args.blockNodeForEnter=args.blockNodeForEnter.toUpperCase();}lang.mixin(this,args);}},setEditor:function(_cc8){if(this.editor===_cc8){return;}this.editor=_cc8;if(this.blockNodeForEnter=="BR"){this.editor.customUndo=true;_cc8.onLoadDeferred.then(lang.hitch(this,function(d){this.connect(_cc8.document,"onkeypress",function(e){if(e.charOrCode==keys.ENTER){var ne=lang.mixin({},e);ne.shiftKey=true;if(!this.handleEnterKey(ne)){_cc2.stop(e);}}});if(has("ie")>=9){this.connect(_cc8.document,"onpaste",function(e){setTimeout(dojo.hitch(this,function(){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();r.move("character",1);r.select();}),0);});}return d;}));}else{if(this.blockNodeForEnter){var h=lang.hitch(this,this.handleEnterKey);_cc8.addKeyHandler(13,0,0,h);_cc8.addKeyHandler(13,0,1,h);this.connect(this.editor,"onKeyPressed","onKeyPressed");}}},onKeyPressed:function(){if(this._checkListLater){if(win.withGlobal(this.editor.window,"isCollapsed",_cc7)){var _cc9=this.editor._sCall("getAncestorElement",["LI"]);if(!_cc9){_cc5.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);var _cca=this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]);if(_cca){_cca.innerHTML=this.bogusHtmlContent;if(has("ie")<=9){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();}}else{console.error("onKeyPressed: Cannot find the new block node");}}else{if(has("mozilla")){if(_cc9.parentNode.parentNode.nodeName=="LI"){_cc9=_cc9.parentNode.parentNode;}}var fc=_cc9.firstChild;if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){_cc9.insertBefore(fc.ownerDocument.createTextNode(""),fc);var _ccb=_cc6.create(this.editor.window);_ccb.setStart(_cc9.firstChild,0);var _ccc=_cc6.getSelection(this.editor.window,true);_ccc.removeAllRanges();_ccc.addRange(_ccb);}}}this._checkListLater=false;}if(this._pressedEnterInBlock){if(this._pressedEnterInBlock.previousSibling){this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);}delete this._pressedEnterInBlock;}},bogusHtmlContent:"&#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){var _ccd,_cce,_ccf,_cd0,_cd1,_cd2,doc=this.editor.document,br,rs,txt;if(e.shiftKey){var _cd3=this.editor._sCall("getParentElement",[]);var _cd4=_cc6.getAncestor(_cd3,this.blockNodes);if(_cd4){if(_cd4.tagName=="LI"){return true;}_ccd=_cc6.getSelection(this.editor.window);_cce=_ccd.getRangeAt(0);if(!_cce.collapsed){_cce.deleteContents();_ccd=_cc6.getSelection(this.editor.window);_cce=_ccd.getRangeAt(0);}if(_cc6.atBeginningOfContainer(_cd4,_cce.startContainer,_cce.startOffset)){br=doc.createElement("br");_ccf=_cc6.create(this.editor.window);_cd4.insertBefore(br,_cd4.firstChild);_ccf.setStartAfter(br);_ccd.removeAllRanges();_ccd.addRange(_ccf);}else{if(_cc6.atEndOfContainer(_cd4,_cce.startContainer,_cce.startOffset)){_ccf=_cc6.create(this.editor.window);br=doc.createElement("br");_cd4.appendChild(br);_cd4.appendChild(doc.createTextNode(""));_ccf.setStart(_cd4.lastChild,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);}else{rs=_cce.startContainer;if(rs&&rs.nodeType==3){txt=rs.nodeValue;_cd0=doc.createTextNode(txt.substring(0,_cce.startOffset));_cd1=doc.createTextNode(txt.substring(_cce.startOffset));_cd2=doc.createElement("br");if(_cd1.nodeValue==""&&has("webkit")){_cd1=doc.createTextNode("");}_cc1.place(_cd0,rs,"after");_cc1.place(_cd2,_cd0,"after");_cc1.place(_cd1,_cd2,"after");_cc1.destroy(rs);_ccf=_cc6.create(this.editor.window);_ccf.setStart(_cd1,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);return false;}return true;}}}else{_ccd=_cc6.getSelection(this.editor.window);if(_ccd.rangeCount){_cce=_ccd.getRangeAt(0);if(_cce&&_cce.startContainer){if(!_cce.collapsed){_cce.deleteContents();_ccd=_cc6.getSelection(this.editor.window);_cce=_ccd.getRangeAt(0);}rs=_cce.startContainer;if(rs&&rs.nodeType==3){var _cd5=false;var _cd6=_cce.startOffset;if(rs.length<_cd6){ret=this._adjustNodeAndOffset(rs,_cd6);rs=ret.node;_cd6=ret.offset;}txt=rs.nodeValue;_cd0=doc.createTextNode(txt.substring(0,_cd6));_cd1=doc.createTextNode(txt.substring(_cd6));_cd2=doc.createElement("br");if(!_cd1.length){_cd1=doc.createTextNode("");_cd5=true;}if(_cd0.length){_cc1.place(_cd0,rs,"after");}else{_cd0=rs;}_cc1.place(_cd2,_cd0,"after");_cc1.place(_cd1,_cd2,"after");_cc1.destroy(rs);_ccf=_cc6.create(this.editor.window);_ccf.setStart(_cd1,0);_ccf.setEnd(_cd1,_cd1.length);_ccd.removeAllRanges();_ccd.addRange(_ccf);if(_cd5&&!has("webkit")){this.editor._sCall("remove",[]);}else{this.editor._sCall("collapse",[true]);}}else{var _cd7;if(_cce.startOffset>=0){_cd7=rs.childNodes[_cce.startOffset];}var _cd2=doc.createElement("br");var _cd1=doc.createTextNode("");if(!_cd7){rs.appendChild(_cd2);rs.appendChild(_cd1);}else{_cc1.place(_cd2,_cd7,"before");_cc1.place(_cd1,_cd2,"after");}_ccf=_cc6.create(this.editor.window);_ccf.setStart(_cd1,0);_ccf.setEnd(_cd1,_cd1.length);_ccd.removeAllRanges();_ccd.addRange(_ccf);this.editor._sCall("collapse",[true]);}}}else{_cc5.prototype.execCommand.call(this.editor,"inserthtml","<br>");}}return false;}var _cd8=true;_ccd=_cc6.getSelection(this.editor.window);_cce=_ccd.getRangeAt(0);if(!_cce.collapsed){_cce.deleteContents();_ccd=_cc6.getSelection(this.editor.window);_cce=_ccd.getRangeAt(0);}var _cd9=_cc6.getBlockAncestor(_cce.endContainer,null,this.editor.editNode);var _cda=_cd9.blockNode;if((this._checkListLater=(_cda&&(_cda.nodeName=="LI"||_cda.parentNode.nodeName=="LI")))){if(has("mozilla")){this._pressedEnterInBlock=_cda;}if(/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(_cda.innerHTML)){_cda.innerHTML="";if(has("webkit")){_ccf=_cc6.create(this.editor.window);_ccf.setStart(_cda,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);}this._checkListLater=false;}return true;}if(!_cd9.blockNode||_cd9.blockNode===this.editor.editNode){try{_cc5.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);}catch(e2){}_cd9={blockNode:this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]),blockContainer:this.editor.editNode};if(_cd9.blockNode){if(_cd9.blockNode!=this.editor.editNode&&(!(_cd9.blockNode.textContent||_cd9.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){this.removeTrailingBr(_cd9.blockNode);return false;}}else{_cd9.blockNode=this.editor.editNode;}_ccd=_cc6.getSelection(this.editor.window);_cce=_ccd.getRangeAt(0);}var _cdb=doc.createElement(this.blockNodeForEnter);_cdb.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(_cd9.blockNode);var _cdc=_cce.endOffset;var node=_cce.endContainer;if(node.length<_cdc){var ret=this._adjustNodeAndOffset(node,_cdc);node=ret.node;_cdc=ret.offset;}if(_cc6.atEndOfContainer(_cd9.blockNode,node,_cdc)){if(_cd9.blockNode===_cd9.blockContainer){_cd9.blockNode.appendChild(_cdb);}else{_cc1.place(_cdb,_cd9.blockNode,"after");}_cd8=false;_ccf=_cc6.create(this.editor.window);_ccf.setStart(_cdb,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);if(this.editor.height){_cc3.scrollIntoView(_cdb);}}else{if(_cc6.atBeginningOfContainer(_cd9.blockNode,_cce.startContainer,_cce.startOffset)){_cc1.place(_cdb,_cd9.blockNode,_cd9.blockNode===_cd9.blockContainer?"first":"before");if(_cdb.nextSibling&&this.editor.height){_ccf=_cc6.create(this.editor.window);_ccf.setStart(_cdb.nextSibling,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);_cc3.scrollIntoView(_cdb.nextSibling);}_cd8=false;}else{if(_cd9.blockNode===_cd9.blockContainer){_cd9.blockNode.appendChild(_cdb);}else{_cc1.place(_cdb,_cd9.blockNode,"after");}_cd8=false;if(_cd9.blockNode.style){if(_cdb.style){if(_cd9.blockNode.style.cssText){_cdb.style.cssText=_cd9.blockNode.style.cssText;}}}rs=_cce.startContainer;var _cdd;if(rs&&rs.nodeType==3){var _cde,_cdf;_cdc=_cce.endOffset;if(rs.length<_cdc){ret=this._adjustNodeAndOffset(rs,_cdc);rs=ret.node;_cdc=ret.offset;}txt=rs.nodeValue;_cd0=doc.createTextNode(txt.substring(0,_cdc));_cd1=doc.createTextNode(txt.substring(_cdc,txt.length));_cc1.place(_cd0,rs,"before");_cc1.place(_cd1,rs,"after");_cc1.destroy(rs);var _ce0=_cd0.parentNode;while(_ce0!==_cd9.blockNode){var tg=_ce0.tagName;var _ce1=doc.createElement(tg);if(_ce0.style){if(_ce1.style){if(_ce0.style.cssText){_ce1.style.cssText=_ce0.style.cssText;}}}if(_ce0.tagName==="FONT"){if(_ce0.color){_ce1.color=_ce0.color;}if(_ce0.face){_ce1.face=_ce0.face;}if(_ce0.size){_ce1.size=_ce0.size;}}_cde=_cd1;while(_cde){_cdf=_cde.nextSibling;_ce1.appendChild(_cde);_cde=_cdf;}_cc1.place(_ce1,_ce0,"after");_cd0=_ce0;_cd1=_ce1;_ce0=_ce0.parentNode;}_cde=_cd1;if(_cde.nodeType==1||(_cde.nodeType==3&&_cde.nodeValue)){_cdb.innerHTML="";}_cdd=_cde;while(_cde){_cdf=_cde.nextSibling;_cdb.appendChild(_cde);_cde=_cdf;}}_ccf=_cc6.create(this.editor.window);var _ce2;var _ce3=_cdd;if(this.blockNodeForEnter!=="BR"){while(_ce3){_ce2=_ce3;_cdf=_ce3.firstChild;_ce3=_cdf;}if(_ce2&&_ce2.parentNode){_cdb=_ce2.parentNode;_ccf.setStart(_cdb,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);if(this.editor.height){_cc3.scrollIntoView(_cdb);}if(has("mozilla")){this._pressedEnterInBlock=_cd9.blockNode;}}else{_cd8=true;}}else{_ccf.setStart(_cdb,0);_ccd.removeAllRanges();_ccd.addRange(_ccf);if(this.editor.height){_cc3.scrollIntoView(_cdb);}if(has("mozilla")){this._pressedEnterInBlock=_cd9.blockNode;}}}}return _cd8;},_adjustNodeAndOffset:function(node,_ce4){while(node.length<_ce4&&node.nextSibling&&node.nextSibling.nodeType==3){_ce4=_ce4-node.length;node=node.nextSibling;}return {"node":node,"offset":_ce4};},removeTrailingBr:function(_ce5){var para=/P|DIV|LI/i.test(_ce5.tagName)?_ce5:this.editor._sCall("getParentOfType",[_ce5,["P","DIV","LI"]]);if(!para){return;}if(para.lastChild){if((para.childNodes.length>1&&para.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(para.lastChild.nodeValue))||para.lastChild.tagName=="BR"){_cc1.destroy(para.lastChild);}}if(!para.childNodes.length){para.innerHTML=this.bogusHtmlContent;}}});});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_ce6,_ce7,lang,_ce8){return _ce6("dojox.grid._SelectionPreserver",null,{constructor:function(_ce9){this.selection=_ce9;var grid=this.grid=_ce9.grid;this.reset();this._connects=[_ce7.connect(grid,"_setStore",this,"reset"),_ce7.connect(grid,"_addItem",this,"_reSelectById"),_ce7.connect(_ce9,"onSelected",lang.hitch(this,"_selectById",true)),_ce7.connect(_ce9,"onDeselected",lang.hitch(this,"_selectById",false)),_ce7.connect(_ce9,"deselectAll",this,"reset")];},destroy:function(){this.reset();_ce8.forEach(this._connects,_ce7.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_cea){if(item&&this.grid._hasIdentity){this.selection.selected[_cea]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_ceb,_cec){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_cec,g=this.grid;if(typeof _cec=="number"||typeof _cec=="string"){var _ced=g._by_idx[_cec];item=_ced&&_ced.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_ceb;}return item;}});});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_cee,_cef){var _cf0={};lang.setObject("dojo.data.util.simpleFetch",_cf0);_cf0.errorHandler=function(_cf1,_cf2){if(_cf2.onError){var _cf3=_cf2.scope||_cee.global;_cf2.onError.call(_cf3,_cf1,_cf2);}};_cf0.fetchHandler=function(_cf4,_cf5){var _cf6=_cf5.abort||null,_cf7=false,_cf8=_cf5.start?_cf5.start:0,_cf9=(_cf5.count&&(_cf5.count!==Infinity))?(_cf8+_cf5.count):_cf4.length;_cf5.abort=function(){_cf7=true;if(_cf6){_cf6.call(_cf5);}};var _cfa=_cf5.scope||_cee.global;if(!_cf5.store){_cf5.store=this;}if(_cf5.onBegin){_cf5.onBegin.call(_cfa,_cf4.length,_cf5);}if(_cf5.sort){_cf4.sort(_cef.createSortFunction(_cf5.sort,this));}if(_cf5.onItem){for(var i=_cf8;(i<_cf4.length)&&(i<_cf9);++i){var item=_cf4[i];if(!_cf7){_cf5.onItem.call(_cfa,item,_cf5);}}}if(_cf5.onComplete&&!_cf7){var _cfb=null;if(!_cf5.onItem){_cfb=_cf4.slice(_cf8,_cf9);}_cf5.onComplete.call(_cfa,_cfb,_cf5);}};_cf0.fetch=function(_cfc){_cfc=_cfc||{};if(!_cfc.store){_cfc.store=this;}this._fetchItems(_cfc,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _cfc;};return _cf0;});},"dijit/form/_ComboBoxMenuMixin":function(){define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/ComboBox"],function(_cfd,_cfe,_cff,i18n){return _cfe("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_d00){this.value=_d00;this.onChange(_d00);},onClick:function(node){if(node==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(node==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(node);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(item,_d01){var _d02=this._createMenuItem();var _d03=_d01(item);if(_d03.html){_d02.innerHTML=_d03.label;}else{_d02.appendChild(_d02.ownerDocument.createTextNode(_d03.label));}if(_d02.innerHTML==""){_d02.innerHTML="&#160;";}this.applyTextDir(_d02,(_d02.innerText||_d02.textContent||""));return _d02;},createOptions:function(_d04,_d05,_d06){this.items=_d04;this.previousButton.style.display=(_d05.start==0)?"none":"";_cff.set(this.previousButton,"id",this.id+"_prev");_cfd.forEach(_d04,function(item,i){var _d07=this._createOption(item,_d06);_d07.setAttribute("item",i);_cff.set(_d07,"id",this.id+i);this.nextButton.parentNode.insertBefore(_d07,this.nextButton);},this);var _d08=false;if(_d04.total&&!_d04.total.then&&_d04.total!=-1){if((_d05.start+_d05.count)<_d04.total){_d08=true;}else{if((_d05.start+_d05.count)>_d04.total&&_d05.count==_d04.length){_d08=true;}}}else{if(_d05.count==_d04.length){_d08=true;}}this.nextButton.style.display=_d08?"":"none";_cff.set(this.nextButton,"id",this.id+"_next");},clearResultList:function(){var _d09=this.containerNode;while(_d09.childNodes.length>2){_d09.removeChild(_d09.childNodes[_d09.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this.selected;}});});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,_d0a,_d0b){var _d0c={};lang.setObject("dojo.colors",_d0c);var _d0d=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=_d0a.fromRgb=function(_d0e,obj){var m=_d0e.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_d0b.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _d0a.fromArray(a,obj);}return _d0a.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_d0d(m1,m2,H+1/3)*256,_d0d(m1,m2,H)*256,_d0d(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _d0a.fromArray(a,obj);}}return null;};var _d0f=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_d0a.prototype.sanitize=function(){var t=this;t.r=Math.round(_d0f(t.r,0,255));t.g=Math.round(_d0f(t.g,0,255));t.b=Math.round(_d0f(t.b,0,255));t.a=_d0f(t.a,0,1);return this;};_d0c.makeGrey=_d0a.makeGrey=function(g,a){return _d0a.fromArray([g,g,g,a]);};lang.mixin(_d0a.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return _d0a;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_d10,_d11,lang,win,_d12,has,_d13,_d14,_d15,util,html){var dg=_d10.grid;var _d16=function(td){return td.cellIndex>=0?td.cellIndex:_d11.indexOf(td.parentNode.cells,td);};var _d17=function(tr){return tr.rowIndex>=0?tr.rowIndex:_d11.indexOf(tr.parentNode.childNodes,tr);};var _d18=function(_d19,_d1a){return _d19&&((_d19.rows||0)[_d1a]||_d19.childNodes[_d1a]);};var _d1b=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _d1c=function(_d1d,_d1e){for(var n=_d1d;n&&_d1e(n);n=n.parentNode){}return n;};var _d1f=function(_d20){var name=_d20.toUpperCase();return function(node){return node.tagName!=name;};};var _d21=util.rowIndexTag;var _d22=util.gridViewTag;var _d23=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_d24,_d25,_d26,_d27){var _d28=[],html;if(_d27){var _d29=_d24.index!=_d24.grid.getSortIndex()?"":_d24.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_d24.id){_d24.id=this.grid.id+"Hdr"+_d24.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_d29,"id=\"",_d24.id,"\""];}else{var _d2a=this.grid.editable&&!_d24.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_d2a];}if(_d24.colSpan){html.push(" colspan=\"",_d24.colSpan,"\"");}if(_d24.rowSpan){html.push(" rowspan=\"",_d24.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_d24.classes){html.push(_d24.classes," ");}if(_d26){html.push(_d26," ");}_d28.push(html.join(""));_d28.push("");html=["\" idx=\"",_d24.index,"\" style=\""];if(_d25&&_d25[_d25.length-1]!=";"){_d25+=";";}html.push(_d24.styles,_d25||"",_d24.hidden?"display:none;":"");if(_d24.unitWidth){html.push("width:",_d24.unitWidth,";");}_d28.push(html.join(""));_d28.push("");html=["\""];if(_d24.attrs){html.push(" ",_d24.attrs);}html.push(">");_d28.push(html.join(""));_d28.push("");_d28.push(_d27?"</th>":"</td>");return _d28;},isCellNode:function(_d2b){return Boolean(_d2b&&_d2b!=win.doc&&html.attr(_d2b,"idx"));},getCellNodeIndex:function(_d2c){return _d2c?Number(html.attr(_d2c,"idx")):-1;},getCellNode:function(_d2d,_d2e){for(var i=0,row;((row=_d18(_d2d.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_d2e){return cell;}}}return null;},findCellTarget:function(_d2f,_d30){var n=_d2f;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_d22 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_d22]!=this.view.id))&&(n!=_d30)){n=n.parentNode;}return n!=_d30?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_d31,_d32){var n=_d31;while(n&&(n!=this.domNode)&&(!(_d32 in n)||(_d22 in n&&n[_d22]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_d33){return this.findTarget(_d33,_d21);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _d34=dg._ContentBuilder=lang.extend(function(view){_d23.call(this,view);},_d23.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _d35=this.grid.get,_d36=this.view.structure.cells;for(var j=0,row;(row=_d36[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_d35;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_d37,_d38){var html=this.getTableArray(),v=this.view,_d39=v.structure.cells,item=this.grid.getItem(_d38);util.fire(this.view,"onBeforeRow",[_d38,_d39]);for(var j=0,row;(row=_d39[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_d38,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_d21];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _d3a=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_d23.call(this,view);},_d23.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_d3b,_d3c){var html=this.getTableArray(),_d3d=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_d3d]);for(var j=0,row;(row=_d3d[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_d3e;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_d3e=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_d3e[5]=(_d3c!=undefined?_d3c:_d3b(cell));_d3e[3]=cell.customStyles.join(";");_d3e[1]=cell.customClasses.join(" ");html.push(_d3e.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_d1c(e.target,_d1f("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_d1c(n,_d1f("table"));x-=(table&&table.offsetLeft)||0;}}n=_d1c(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_d12.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_d12.stop(e);return true;}return false;},colResizeSetup:function(e,_d3f){var _d40=html.contentBox(e.sourceView.headerNode);if(_d3f){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _d41=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_d15.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_d41.h+_d40.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _d42=[],_d43=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_d43[i]);i++){_d42.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _d44=e.grid.views.views;var _d45=[];for(var j=view.idx+adj,_d46;(_d46=_d44[j]);j=j+adj){_d45.push({node:_d46.headerNode,left:window.parseInt(_d46.headerNode.style.left)});}var _d47=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_d40.w,table:_d47,tw:html.contentBox(_d47).w,spanners:_d42,followers:_d45};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _d14(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_d13.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_d48,_d49,_d4a){var _d4b=_d4a.l;var data={deltaX:_d4b,w:_d48.w+(this.grid.isLeftToRight()?_d4b:-_d4b),vw:_d48.vw+_d4b,tw:_d48.tw+_d4b};this.dragRecord={inDrag:_d48,mover:_d49,leftTop:_d4a};if(data.w>=this.minColWidth){if(!_d49){this.doResizeNow(_d48,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_d4c){if(this.dragRecord){var _d4d=this.dragRecord.leftTop;var _d4e=this.grid.isLeftToRight()?_d4d.l:-_d4d.l;_d4e+=Math.max(_d4c.w+_d4e,this.minColWidth)-(_d4c.w+_d4e);if(has("webkit")&&_d4c.spanners.length){_d4e+=html._getPadBorderExtents(_d4c.spanners[0].node).w;}var data={deltaX:_d4e,w:_d4c.w+_d4e,vw:_d4c.vw+_d4e,tw:_d4c.tw+_d4e};this.doResizeNow(_d4c,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_d4c.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_d4c.index);},doResizeNow:function(_d4f,data){_d4f.view.convertColPctToFixed();if(_d4f.view.flexCells&&!_d4f.view.testFlexCells()){var t=_d1b(_d4f.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_d4f.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_d4f.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_d4f.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_d4f.node.style.width=data.w+"px";_d4f.view.setColWidth(_d4f.index,data.w);_d4f.view.headerNode.style.width=data.vw+"px";_d4f.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_d4f.view.headerNode.scrollLeft=_d4f.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_d50){var _d51=_d50.length;if(!_d51){return;}this.map=[];var row;for(var k=0;(row=_d50[k]);k++){this.map[k]=[];}for(var j=0;(row=_d50[j]);j++){for(var i=0,x=0,cell,_d52,_d53;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_d53=cell.rowSpan||1;_d52=cell.colSpan||1;for(var y=0;y<_d53;y++){for(var s=0;s<_d52;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_d52;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_d54,_d55){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_d55&&cell.r==_d54){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_d56,_d57,_d58){var row=_d56&&_d56.rows[_d57];return row&&row.cells[_d58];},_findOverlappingNodes:function(_d59,_d5a,_d5b){var _d5c=[];var m=this.getMapCoords(_d5a,_d5b);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_d59,rw.r,rw.c):null);if(n){_d5c.push(n);}}return _d5c;},findOverlappingNodes:function(_d5d){return this._findOverlappingNodes(_d1b(_d5d),_d17(_d5d.parentNode),_d16(_d5d));}});return {_Builder:_d23,_HeaderBuilder:_d3a,_ContentBuilder:_d34};});},"url:esri/dijit/editing/templates/Editor.html":"<div class=\"esriEditor\">\r\n    <div class=\"esriTemplatePicker\" dojoAttachPoint=\"templatePickerDiv\"></div>\r\n    <div class=\"esriDrawingToolbar\" dojoAttachPoint=\"drawingToolbarDiv\"></div>\r\n    <div class=\"progressBar\" dojoAttachPoint=\"progressBar\" indeterminate=\"true\" dojoType=\"dijit.ProgressBar\" />\r\n</div>","dijit/_editor/range":function(){define("dijit/_editor/range",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","../main"],function(_d5e,_d5f,lang,win,_d60){_d60.range={};_d60.range.getIndex=function(node,_d61){var ret=[],retR=[];var _d62=node;var _d63,n;while(node!=_d61){var i=0;_d63=node.parentNode;while((n=_d63.childNodes[i++])){if(n===node){--i;break;}}ret.unshift(i);retR.unshift(i-_d63.childNodes.length);node=_d63;}if(ret.length>0&&_d62.nodeType==3){n=_d62.previousSibling;while(n&&n.nodeType==3){ret[ret.length-1]--;n=n.previousSibling;}n=_d62.nextSibling;while(n&&n.nodeType==3){retR[retR.length-1]++;n=n.nextSibling;}}return {o:ret,r:retR};};_d60.range.getNode=function(_d64,_d65){if(!lang.isArray(_d64)||_d64.length==0){return _d65;}var node=_d65;_d5e.every(_d64,function(i){if(i>=0&&i<node.childNodes.length){node=node.childNodes[i];}else{node=null;return false;}return true;});return node;};_d60.range.getCommonAncestor=function(n1,n2,root){root=root||n1.ownerDocument.body;var _d66=function(n){var as=[];while(n){as.unshift(n);if(n!==root){n=n.parentNode;}else{break;}}return as;};var n1as=_d66(n1);var n2as=_d66(n2);var m=Math.min(n1as.length,n2as.length);var com=n1as[0];for(var i=1;i<m;i++){if(n1as[i]===n2as[i]){com=n1as[i];}else{break;}}return com;};_d60.range.getAncestor=function(node,_d67,root){root=root||node.ownerDocument.body;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(_d67.test(name)){return node;}node=node.parentNode;}return null;};_d60.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;_d60.range.getBlockAncestor=function(node,_d68,root){root=root||node.ownerDocument.body;_d68=_d68||_d60.range.BlockTagNames;var _d69=null,_d6a;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(!_d69&&_d68.test(name)){_d69=node;}if(!_d6a&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){_d6a=node;}node=node.parentNode;}return {blockNode:_d69,blockContainer:_d6a||node.ownerDocument.body};};_d60.range.atBeginningOfContainer=function(_d6b,node,_d6c){var _d6d=false;var _d6e=(_d6c==0);if(!_d6e&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(0,_d6c))){_d6e=true;}}if(_d6e){var _d6f=node;_d6d=true;while(_d6f&&_d6f!==_d6b){if(_d6f.previousSibling){_d6d=false;break;}_d6f=_d6f.parentNode;}}return _d6d;};_d60.range.atEndOfContainer=function(_d70,node,_d71){var _d72=false;var _d73=(_d71==(node.length||node.childNodes.length));if(!_d73&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(_d71))){_d73=true;}}if(_d73){var _d74=node;_d72=true;while(_d74&&_d74!==_d70){if(_d74.nextSibling){_d72=false;break;}_d74=_d74.parentNode;}}return _d72;};_d60.range.adjacentNoneTextNode=function(_d75,next){var node=_d75;var len=(0-_d75.length)||0;var prop=next?"nextSibling":"previousSibling";while(node){if(node.nodeType!=3){break;}len+=node.length;node=node[prop];}return [node,len];};_d60.range.create=function(win){win=win||window;if(win.getSelection){return win.document.createRange();}else{return new _d60.range.W3CRange();}};_d60.range.getSelection=function(_d76,_d77){if(_d76.getSelection){return _d76.getSelection();}else{var s=new _d60.range.ie.selection(_d76);if(!_d77){s._getCurrentSelection();}return s;}};if(!window.getSelection){_d60.range.ie={cachedSelection:{},selection:function(_d78){this._ranges=[];this.addRange=function(r,_d79){this._ranges.push(r);if(!_d79){r._select();}this.rangeCount=this._ranges.length;};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0;};var _d7a=function(){var r=_d78.document.selection.createRange();var type=_d78.document.selection.type.toUpperCase();if(type=="CONTROL"){return new _d60.range.W3CRange(_d60.range.ie.decomposeControlRange(r));}else{return new _d60.range.W3CRange(_d60.range.ie.decomposeTextRange(r));}};this.getRangeAt=function(i){return this._ranges[i];};this._getCurrentSelection=function(){this.removeAllRanges();var r=_d7a();if(r){this.addRange(r,true);this.isCollapsed=r.collapsed;}else{this.isCollapsed=true;}};},decomposeControlRange:function(_d7b){var _d7c=_d7b.item(0),_d7d=_d7b.item(_d7b.length-1);var _d7e=_d7c.parentNode,_d7f=_d7d.parentNode;var _d80=_d60.range.getIndex(_d7c,_d7e).o[0];var _d81=_d60.range.getIndex(_d7d,_d7f).o[0]+1;return [_d7e,_d80,_d7f,_d81];},getEndPoint:function(_d82,end){var _d83=_d82.duplicate();_d83.collapse(!end);var _d84="EndTo"+(end?"End":"Start");var _d85=_d83.parentElement();var _d86,_d87,_d88;if(_d85.childNodes.length>0){_d5e.every(_d85.childNodes,function(node,i){var _d89;if(node.nodeType!=3){_d83.moveToElementText(node);if(_d83.compareEndPoints(_d84,_d82)>0){if(_d88&&_d88.nodeType==3){_d86=_d88;_d89=true;}else{_d86=_d85;_d87=i;return false;}}else{if(i==_d85.childNodes.length-1){_d86=_d85;_d87=_d85.childNodes.length;return false;}}}else{if(i==_d85.childNodes.length-1){_d86=node;_d89=true;}}if(_d89&&_d86){var _d8a=_d60.range.adjacentNoneTextNode(_d86)[0];if(_d8a){_d86=_d8a.nextSibling;}else{_d86=_d85.firstChild;}var _d8b=_d60.range.adjacentNoneTextNode(_d86);_d8a=_d8b[0];var _d8c=_d8b[1];if(_d8a){_d83.moveToElementText(_d8a);_d83.collapse(false);}else{_d83.moveToElementText(_d85);}_d83.setEndPoint(_d84,_d82);_d87=_d83.text.length-_d8c;return false;}_d88=node;return true;});}else{_d86=_d85;_d87=0;}if(!end&&_d86.nodeType==1&&_d87==_d86.childNodes.length){var _d8d=_d86.nextSibling;if(_d8d&&_d8d.nodeType==3){_d86=_d8d;_d87=0;}}return [_d86,_d87];},setEndPoint:function(_d8e,_d8f,_d90){var _d91=_d8e.duplicate(),node,len;if(_d8f.nodeType!=3){if(_d90>0){node=_d8f.childNodes[_d90-1];if(node){if(node.nodeType==3){_d8f=node;_d90=node.length;}else{if(node.nextSibling&&node.nextSibling.nodeType==3){_d8f=node.nextSibling;_d90=0;}else{_d91.moveToElementText(node.nextSibling?node:_d8f);var _d92=node.parentNode;var _d93=_d92.insertBefore(node.ownerDocument.createTextNode(" "),node.nextSibling);_d91.collapse(false);_d92.removeChild(_d93);}}}}else{_d91.moveToElementText(_d8f);_d91.collapse(true);}}if(_d8f.nodeType==3){var _d94=_d60.range.adjacentNoneTextNode(_d8f);var _d95=_d94[0];len=_d94[1];if(_d95){_d91.moveToElementText(_d95);_d91.collapse(false);if(_d95.contentEditable!="inherit"){len++;}}else{_d91.moveToElementText(_d8f.parentNode);_d91.collapse(true);_d91.move("character",1);_d91.move("character",-1);}_d90+=len;if(_d90>0){if(_d91.move("character",_d90)!=_d90){console.error("Error when moving!");}}}return _d91;},decomposeTextRange:function(_d96){var _d97=_d60.range.ie.getEndPoint(_d96);var _d98=_d97[0],_d99=_d97[1];var _d9a=_d97[0],_d9b=_d97[1];if(_d96.htmlText.length){if(_d96.htmlText==_d96.text){_d9b=_d99+_d96.text.length;}else{_d97=_d60.range.ie.getEndPoint(_d96,true);_d9a=_d97[0],_d9b=_d97[1];}}return [_d98,_d99,_d9a,_d9b];},setRange:function(_d9c,_d9d,_d9e,_d9f,_da0,_da1){var _da2=_d60.range.ie.setEndPoint(_d9c,_d9d,_d9e);_d9c.setEndPoint("StartToStart",_da2);if(!_da1){var end=_d60.range.ie.setEndPoint(_d9c,_d9f,_da0);}_d9c.setEndPoint("EndToEnd",end||_da2);return _d9c;}};_d5f("dijit.range.W3CRange",null,{constructor:function(){if(arguments.length>0){this.setStart(arguments[0][0],arguments[0][1]);this.setEnd(arguments[0][2],arguments[0][3]);}else{this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}},_updateInternal:function(){if(this.startContainer!==this.endContainer){this.commonAncestorContainer=_d60.range.getCommonAncestor(this.startContainer,this.endContainer);}else{this.commonAncestorContainer=this.startContainer;}this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);},setStart:function(node,_da3){_da3=parseInt(_da3);if(this.startContainer===node&&this.startOffset==_da3){return;}delete this._cachedBookmark;this.startContainer=node;this.startOffset=_da3;if(!this.endContainer){this.setEnd(node,_da3);}else{this._updateInternal();}},setEnd:function(node,_da4){_da4=parseInt(_da4);if(this.endContainer===node&&this.endOffset==_da4){return;}delete this._cachedBookmark;this.endContainer=node;this.endOffset=_da4;if(!this.startContainer){this.setStart(node,_da4);}else{this._updateInternal();}},setStartAfter:function(node,_da5){this._setPoint("setStart",node,_da5,1);},setStartBefore:function(node,_da6){this._setPoint("setStart",node,_da6,0);},setEndAfter:function(node,_da7){this._setPoint("setEnd",node,_da7,1);},setEndBefore:function(node,_da8){this._setPoint("setEnd",node,_da8,0);},_setPoint:function(what,node,_da9,ext){var _daa=_d60.range.getIndex(node,node.parentNode).o;this[what](node.parentNode,_daa.pop()+ext);},_getIERange:function(){var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();_d60.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return r;},getBookmark:function(){this._getIERange();return this._cachedBookmark;},_select:function(){var r=this._getIERange();r.select();},deleteContents:function(){var s=this.startContainer,r=this._getIERange();if(s.nodeType===3&&!this.startOffset){this.setStartBefore(s);}r.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=true;},cloneRange:function(){var r=new _d60.range.W3CRange([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);r._body=this._body;return r;},detach:function(){this._body=null;this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}});}return _d60.range;});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_dab,_dac,_dad,_dae,lang,_daf,_db0,_db1,_db2,_db3,dnd,_db4,_db5){if(!_dae.isAsync){_db2(0,function(){var _db6=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_db6);});}var _db7=_dad("dojo.dnd.Source",_db4,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_db8){lang.mixin(this,lang.mixin({},_db8));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_daf.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_daf.add(this.node,"dojoDndTarget");}if(this.horizontal){_daf.add(this.node,"dojoDndHorizontal");}this.topics=[_db3.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_db3.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_db3.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_db3.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_db9,_dba){if(this==_db9){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_dba.length;++i){var type=_db9.getItem(_dba[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_dbb,self){if(_dbb){return true;}if(arguments.length<2){self=this==_db5.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_db7.superclass.destroy.call(this);_dab.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_db7.superclass.onMouseMove.call(this,e);var m=_db5.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _dbc=this.getSelectedNodes();if(_dbc.length){m.startDrag(this,_dbc,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _dbd=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_db0.position(this.current,true);}if(this.horizontal){_dbd=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_db0.isBodyLtr(this.current.ownerDocument);}else{_dbd=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_dbd!=this.before){this._markTargetAnchor(_dbd);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_db7.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_db7.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_dbe){if(this!==_dbe){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_db5.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_dbf,_dc0,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_dbf?(copy?"Copied":"Moved"):"");}var _dc1=this.accept&&this.checkAcceptance(_dbf,_dc0);this._changeState("Target",_dc1?"":"Disabled");if(this==_dbf){_db5.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_dc2,_dc3,copy,_dc4){if(this==_dc4){this.onDrop(_dc2,_dc3,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_dc5,_dc6,copy){if(this!=_dc5){this.onDropExternal(_dc5,_dc6,copy);}else{this.onDropInternal(_dc6,copy);}},onDropExternal:function(_dc7,_dc8,copy){var _dc9=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _dc9.call(this,_dc7.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_dc7.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_dc7.getItem(node.id);_dc7.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_dc7.selectNone();}this.insertNodes(true,_dc8,this.before,this.current);if(!copy&&this.creator){_dc7.deleteSelectedNodes();}this._normalizedCreator=_dc9;},onDropInternal:function(_dca,copy){var _dcb=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _dcb.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_dca,this.before,this.current);this._normalizedCreator=_dcb;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_db7.superclass.onOverEvent.call(this);_db5.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_db7.superclass.onOutEvent.call(this);_db5.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_dcc){if(this.current==this.targetAnchor&&this.before==_dcc){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_dcc;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_db1.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_daf.contains(node,"dojoDndHandle")){return true;}if(_daf.contains(node,"dojoDndItem")||_daf.contains(node,"dojoDndIgnore")){break;}}return false;}});return _db7;});},"dijit/Calendar":function(){define("dijit/Calendar",["dojo/_base/array","dojo/date","dojo/date/locale","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/sniff","./CalendarLite","./_Widget","./_CssStateMixin","./_TemplatedMixin","./form/DropDownButton"],function(_dcd,date,_dce,_dcf,_dd0,_dd1,_dd2,_dd3,keys,lang,has,_dd4,_dd5,_dd6,_dd7,_dd8){var _dd9=_dcf("dijit.Calendar",[_dd4,_dd5,_dd6],{cssStateNodes:{"decrementMonth":"dijitCalendarArrow","incrementMonth":"dijitCalendarArrow","previousYearLabelNode":"dijitCalendarPreviousYear","nextYearLabelNode":"dijitCalendarNextYear"},setValue:function(_dda){_dd3.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",_dda);},_createMonthWidget:function(){return new _dd9._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:lang.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onkeydown","_onKeyDown");this.connect(this.dateRowsNode,"onmouseover","_onDayMouseOver");this.connect(this.dateRowsNode,"onmouseout","_onDayMouseOut");this.connect(this.dateRowsNode,"onmousedown","_onDayMouseDown");this.connect(this.dateRowsNode,"onmouseup","_onDayMouseUp");},_onMonthSelect:function(_ddb){var date=new this.dateClassObj(this.currentFocus);date.setDate(1);date.setMonth(_ddb);var _ddc=this.dateModule.getDaysInMonth(date);var _ddd=this.currentFocus.getDate();date.setDate(Math.min(_ddd,_ddc));this._setCurrentFocusAttr(date);},_onDayMouseOver:function(evt){var node=_dd1.contains(evt.target,"dijitCalendarDateLabel")?evt.target.parentNode:evt.target;if(node&&((node.dijitDateValue&&!_dd1.contains(node,"dijitCalendarDisabledDate"))||node==this.previousYearLabelNode||node==this.nextYearLabelNode)){_dd1.add(node,"dijitCalendarHoveredDate");this._currentNode=node;}},_onDayMouseOut:function(evt){if(!this._currentNode){return;}if(evt.relatedTarget&&evt.relatedTarget.parentNode==this._currentNode){return;}var cls="dijitCalendarHoveredDate";if(_dd1.contains(this._currentNode,"dijitCalendarActiveDate")){cls+=" dijitCalendarActiveDate";}_dd1.remove(this._currentNode,cls);this._currentNode=null;},_onDayMouseDown:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue&&!_dd1.contains(node,"dijitCalendarDisabledDate")){_dd1.add(node,"dijitCalendarActiveDate");this._currentNode=node;}},_onDayMouseUp:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue){_dd1.remove(node,"dijitCalendarActiveDate");}},handleKey:function(evt){var _dde=-1,_ddf,_de0=this.currentFocus;switch(evt.keyCode){case keys.RIGHT_ARROW:_dde=1;case keys.LEFT_ARROW:_ddf="day";if(!this.isLeftToRight()){_dde*=-1;}break;case keys.DOWN_ARROW:_dde=1;case keys.UP_ARROW:_ddf="week";break;case keys.PAGE_DOWN:_dde=1;case keys.PAGE_UP:_ddf=evt.ctrlKey||evt.altKey?"year":"month";break;case keys.END:_de0=this.dateModule.add(_de0,"month",1);_ddf="day";case keys.HOME:_de0=new this.dateClassObj(_de0);_de0.setDate(1);break;case keys.ENTER:case keys.SPACE:this.set("value",this.currentFocus);break;default:return true;}if(_ddf){_de0=this.dateModule.add(_de0,_ddf,_dde);}this._setCurrentFocusAttr(_de0);return false;},_onKeyDown:function(evt){if(!this.handleKey(evt)){_dd2.stop(evt);}},onValueSelected:function(){},onChange:function(_de1){this.onValueSelected(_de1);},getClassForDate:function(){}});_dd9._MonthDropDownButton=_dcf("dijit.Calendar._MonthDropDownButton",_dd8,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new _dd9._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect});},_setMonthAttr:function(_de2){var _de3=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_de2);this.dropDown.set("months",_de3);this.containerNode.innerHTML=(has("ie")==6?"":"<div class='dijitSpacer'>"+this.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_de3[_de2.getMonth()]+"</div>";}});_dd9._MonthDropDown=_dcf("dijit.Calendar._MonthDropDown",[_dd5,_dd7],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' "+"data-dojo-attach-event='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(_de4){this.domNode.innerHTML=_dcd.map(_de4,function(_de5,idx){return _de5?"<div class='dijitCalendarMonthLabel' month='"+idx+"'>"+_de5+"</div>":"";}).join("");},_onClick:function(evt){this.onChange(_dd0.get(evt.target,"month"));},onChange:function(){},_onMenuHover:function(evt){_dd1.toggle(evt.target,"dijitCalendarMonthLabelHover",evt.type=="mouseover");}});return _dd9;});},"esri/layers/OnDemandMode":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/geometry/Point","esri/tasks/query","esri/layers/RenderMode","esri/layers/GridLayout"],function(_de6,_de7,lang,_de8,has,_de9,_dea,_deb,_dec,_ded){var _dee=_de6([_dec],{declaredClass:"esri.layers._OnDemandMode",constructor:function(_def){this.featureLayer=_def;this._featureMap={};this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},initialize:function(map){this.inherited(arguments);var _df0=this.featureLayer,_df1=_df0._srInfo;this._gridLayer=new _ded(new _dea(_df1?_df1.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_df0._tileWidth,height:_df0._tileHeight},{width:map.width,height:map.height},_df1);this._cellMap={};this._gridLayer.setResolution(map.extent);},startup:function(){this._ioQueue=[];if(!this.featureLayer.suspended){this._zoomHandler();this._enableConnectors();}},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this.inherited(arguments);},drawFeature:function(_df2){var _df3=this._gridLayer,geom=_df2.geometry,_df4=[];if(!geom){return;}_df4=_df3.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _df5=this._cellMap,i,cell,oid=_df2.attributes[this.featureLayer.objectIdField],_df6,row,col;for(i=0;i<_df4.length;i++){cell=_df4[i];_df6=cell.latticeID;row=cell.row;col=cell.col;if(_df6){cell=(_df5[_df6]=(_df5[_df6]||cell));}else{_df5[row]=_df5[row]||{};cell=(_df5[row][col]=(_df5[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_df2);this._addFeatureIIf(oid,_df2);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_enableConnectors:function(){var map=this.map;this._zoomConnect=_de7.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_de7.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=_de7.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){_de7.disconnect(this._zoomConnect);_de7.disconnect(this._panConnect);_de7.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _df7=this.featureLayer,map=this.map;if(_df7.suspended){return;}_df7._fireUpdateStart();this._clearIIf();var _df8=_df7._trackManager;if(_df8){_df8.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_df9,cell){var id="_"+_df9.name+_df9.layerId+_df9._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_dfa){this._exceeds=false;var _dfb=this.featureLayer,map=this.map,_dfc=_dfa||map.extent,_dfd=this._gridLayer.getCellsInExtent(_dfc,_dfb.latticeTiling),_dfe=_dfd.cells;if(!_dfb.isEditable()){var _dff=this._cellMap;_dfe=_de8.filter(_dfe,function(cell){if(cell.lattice){if(_dff[cell.latticeID]){return false;}}else{if(_dff[cell.row]&&_dff[cell.row][cell.col]){return false;}}return true;});}var _e00=_dfb._getOutFields(),_e01=_dfb.getDefinitionExpression(),time=_dfb._getOffsettedTE(_dfb._mapTimeExtent),_e02=_dfb._usePatch,_e03=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_e04,_e05;this._pending=this._pending||0;for(i=0;i<_dfe.length;i++){cell=_dfe[i];_e04=new _deb();_e04.geometry=cell.extent||cell.lattice;_e04.outFields=_e00;_e04.where=_e01;if(_dfb.latticeTiling&&cell.extent){_e04.spatialRelationship=_deb.SPATIAL_REL_CONTAINS;}_e04.returnGeometry=true;_e04.timeExtent=time;_e04.maxAllowableOffset=_dfb._maxOffset;if(_dfb._ts){_e04._ts=(new Date()).getTime();}_e05=null;if(_e02){_e05=this._getRequestId(_dfb,cell);if(this._isPending(_e05)){continue;}}this._pending++;_e03.push(_dfb._task.execute(_e04,function(){var _e06=cell;return function(_e07){func.apply(self,[_e07,_e06]);};}.call(this),this._queryErrorHandler,_e05));}this._removeOldCells(_dfc);this._endCheck();},_drawFeatures:function(_e08,cell){this._exceeds=this._exceeds||_e08.exceededTransferLimit;this._finalizeIO();var _e09=this.featureLayer,map=this.map,_e0a=map.extent,_e0b=cell.extent,row=cell.row,col=cell.col,_e0c=_e09.objectIdField,_e0d=_e08.features,_e0e=this._gridLayer,_e0f=this._cellMap,i,len,_e10=cell.latticeID,_e11=_e10?_e0f[_e10]:(_e0f[row]&&_e0f[row][col]);if((cell.resolution!=_e0e._resolution)||(_e10?(_e10!==_e0e.getLatticeID(_e0a)):(!_e0e.intersects(_e0b,_e0a)))){if(_e11){this._removeCell(row,col,_e10);}}else{if(_e11){this._updateCell(_e11,_e0d);}else{cell.features=_e0d;if(_e10){_e0f[_e10]=cell;}else{_e0f[row]=_e0f[row]||{};_e0f[row][col]=cell;}len=_e0d.length;for(i=0;i<len;i++){var _e12=_e0d[i];var oid=_e12.attributes[_e0c];this._addFeatureIIf(oid,_e12);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_e13){if(this._pending===0){this._processIOQueue();var _e14=this.featureLayer,_e15=_e14._trackManager;if(_e15){_e15.clearTracks();_e15.addFeatures(_e14.graphics);if(_e14._ager){_de8.forEach(_e14.graphics,function(_e16){if(_e16._shape){_e14._repaint(_e16);}});}_e15.moveLatestToFront();_e15.drawTracks();}this.featureLayer._fireUpdateEnd(_e13&&new Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_e14.onQueryLimitExceeded();}}},_processIOQueue:function(_e17){this._ioQueue=_de8.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_e17){_de8.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_e18){var _e19=this._cellMap,_e1a=this._gridLayer,_e1b,_e1c;for(_e1b in _e19){if(_e19[_e1b]){var row=_e19[_e1b],_e1d=row.latticeID,_e1e=0,_e1f=0;if(_e1d){_e1e++;if(_e1d!==_e1a.getLatticeID(_e18)){this._removeCell(null,null,_e1d);_e1f++;}}else{for(_e1c in row){if(row[_e1c]){_e1e++;var _e20=row[_e1c].extent;if(!_e1a.intersects(_e20,_e18)){this._removeCell(_e1b,_e1c);_e1f++;}}}}if(_e1f===_e1e){delete _e19[_e1b];}}}},_updateCell:function(cell,_e21){var _e22=this.featureLayer,_e23=_e22.objectIdField,_e24=_e22._selectedFeatures,i,len=_e21.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _e25=_e21[i];var oid=_e25.attributes[_e23];var _e26=this._addFeatureIIf(oid,_e25);if(_e26===_e25){this._incRefCount(oid);cell.features.push(_e26);}else{if(!(oid in _e24)){_e26.setGeometry(_e25.geometry);_e26.setAttributes(_e25.attributes);}}}},_removeCell:function(row,col,_e27){var _e28=this._cellMap,_e29=this.featureLayer,_e2a=_e29.objectIdField;var cell=_e27?_e28[_e27]:(_e28[row]&&_e28[row][col]);if(cell){if(_e27){delete _e28[_e27];}else{delete _e28[row][col];}var _e2b=cell.features,i;for(i=0;i<_e2b.length;i++){var _e2c=_e2b[i];var oid=_e2c.attributes[_e2a];this._decRefCount(oid);if(oid in _e29._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});if(has("extend-esri")){lang.setObject("layers._OnDemandMode",_dee,_de9);}return _dee;});},"dijit/form/_ComboBoxMenu":function(){define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_e2d,_e2e,_e2f,keys,_e30,_e31,_e32,_e33){return _e2d("dijit.form._ComboBoxMenu",[_e30,_e31,_e33,_e32],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;' role='listbox'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_e2e.add(this.previousButton,"dijitMenuItemRtl");_e2e.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){var item=this.ownerDocument.createElement("div");item.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");item.setAttribute("role","option");return item;},onHover:function(node){_e2e.add(node,"dijitMenuItemHover");},onUnhover:function(node){_e2e.remove(node,"dijitMenuItemHover");},onSelect:function(node){_e2e.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_e2e.remove(node,"dijitMenuItemSelected");},_page:function(up){var _e34=0;var _e35=this.domNode.scrollTop;var _e36=_e2f.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_e34<_e36){var _e37=this.getHighlightedOption();if(up){if(!_e37.previousSibling||_e37.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_e37.nextSibling||_e37.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _e38=this.domNode.scrollTop;_e34+=(_e38-_e35)*(up?-1:1);_e35=_e38;}},handleKey:function(evt){switch(evt.keyCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_e39,lang,_e3a,_e3b,_e3c,has,dom,_e3d,_e3e,_e3f,util){var _e40=_e39("dojox.grid._DeferredTextWidget",_e3f,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _e41=function(_e42){try{util.fire(_e42,"focus");util.fire(_e42,"select");}catch(e){}};var _e43=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _e44=_e39("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_e45){this._props=_e45||{};lang.mixin(this,_e45);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_e46,_e47){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_e46!=this.defaultValue&&f)?f.apply(s,_e47):_e46;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _e40({deferred:v},_e3e.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_e48,_e49){var f,i=this.grid.edit.info,d=this.get?this.get(_e48,_e49):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_e48&&i.cell==this))){return this.formatEditing(d,_e48);}else{return this._defaultFormat(d,[d,_e48,this]);}},formatEditing:function(_e4a,_e4b){},getNode:function(_e4c){return this.view.getCellNode(_e4c,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_e4d){return (this.getNode(_e4d)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_e4e,_e4f){if(this.getNode(_e4f)){this.grid.edit.applyCellEdit(_e4e,this,_e4f);}},cancelEdit:function(_e50){this.grid.doCancelEdit(_e50);},_onEditBlur:function(_e51){if(this.grid.edit.isEditCell(_e51,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_e52,_e53){if(this.commitOnBlur){_e3b.connect(_e52,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_e53),250);});}},needFormatNode:function(_e54,_e55){this._formatPending=true;_e43(this,"_formatNode",_e54,_e55);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_e56,_e57){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_e57),_e56,_e57);}},formatNode:function(_e58,_e59,_e5a){if(has("ie")){_e43(this,"focus",_e5a,_e58);}else{this.focus(_e5a,_e58);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_e5b){return this.getEditNode(_e5b)[this._valueProp];},setValue:function(_e5c,_e5d){var n=this.getEditNode(_e5c);if(n){n[this._valueProp]=_e5d;}},focus:function(_e5e,_e5f){_e41(_e5f||this.getEditNode(_e5e));},save:function(_e60){this.value=this.value||this.getValue(_e60);},restore:function(_e61){this.setValue(_e61,this.value);},_finish:function(_e62){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_e63){this.applyEdit(this.getValue(_e63),_e63);this._finish(_e63);},cancel:function(_e64){this.cancelEdit(_e64);this._finish(_e64);}});_e44.markupFactory=function(node,_e65){var _e66=lang.trim(_e3d.get(node,"formatter")||"");if(_e66){_e65.formatter=lang.getObject(_e66)||_e66;}var get=lang.trim(_e3d.get(node,"get")||"");if(get){_e65.get=lang.getObject(get);}var _e67=function(attr,cell,_e68){var _e69=lang.trim(_e3d.get(node,attr)||"");if(_e69){cell[_e68||attr]=!(_e69.toLowerCase()=="false");}};_e67("sortDesc",_e65);_e67("editable",_e65);_e67("alwaysEditing",_e65);_e67("noresize",_e65);_e67("draggable",_e65);var _e6a=lang.trim(_e3d.get(node,"loadingText")||_e3d.get(node,"defaultValue")||"");if(_e6a){_e65.defaultValue=_e6a;}var _e6b=function(attr,cell,_e6c){var _e6d=lang.trim(_e3d.get(node,attr)||"")||undefined;if(_e6d){cell[_e6c||attr]=_e6d;}};_e6b("styles",_e65);_e6b("headerStyles",_e65);_e6b("cellStyles",_e65);_e6b("classes",_e65);_e6b("headerClasses",_e65);_e6b("cellClasses",_e65);};var Cell=_e39("dojox.grid.cells.Cell",_e44,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_e6e,_e6f){this.needFormatNode(_e6e,_e6f);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_e6e+"\">";},formatNode:function(_e70,_e71,_e72){this.inherited(arguments);this.registerOnBlur(_e70,_e72);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_e3a.stop(e);}}},_finish:function(_e73){this.inherited(arguments);var n=this.getEditNode(_e73);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_e74){_e44.markupFactory(node,_e74);var _e75=lang.trim(_e3d.get(node,"keyFilter")||"");if(_e75){_e74.keyFilter=new RegExp(_e75);}};var _e76=_e39("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_e77){return _e77+1;}});_e76.markupFactory=function(node,_e78){Cell.markupFactory(node,_e78);};var _e79=_e39("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_e7a){this.values=this.values||this.options;},formatEditing:function(_e7b,_e7c){this.needFormatNode(_e7b,_e7c);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_e7b==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_e7d,_e7e){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_e3c.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_e7f){var n=this.getEditNode(_e7f);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_e79.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _e80=lang.trim(_e3d.get(node,"options")||"");if(_e80){var o=_e80.split(",");if(o[0]!=_e80){cell.options=o;}}var _e81=lang.trim(_e3d.get(node,"values")||"");if(_e81){var v=_e81.split(",");if(v[0]!=_e81){cell.values=v;}}};var _e82=_e39("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_e83,_e84){this.formatNode(this.getEditNode(_e84),_e83,_e84);},applyStaticValue:function(_e85){var e=this.grid.edit;e.applyCellEdit(this.getValue(_e85),this,_e85);e.start(this,_e85,true);}});_e82.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_e39("dojox.grid.cells.Bool",_e82,{_valueProp:"checked",formatEditing:function(_e86,_e87){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_e86?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_e82.markupFactory(node,cell);};return _e44;});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/Color","dojo/has","esri/kernel","esri/lang","esri/sniff","esri/toolbars/_toolbar","esri/toolbars/_Box","esri/toolbars/_GraphicMover","esri/toolbars/_VertexEditor","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"],function(_e88,lang,_e89,_e8a,_e8b,has,_e8c,_e8d,_e8e,_e8f,Box,_e90,_e91,_e92,_e93){var EDT=_e88(_e8f,{declaredClass:"esri.toolbars.Edit",constructor:function(map,_e94){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _e95=has("esri-touch")||has("esri-pointer");this._defaultOptions=lang.mixin({vertexSymbol:new _e92(_e92.STYLE_CIRCLE,_e95?20:12,new _e93(_e93.STYLE_SOLID,new _e8b([0,0,0,0.5]),1),new _e8b([128,128,128])),ghostVertexSymbol:new _e92(_e92.STYLE_CIRCLE,_e95?18:10,new _e93(_e93.STYLE_SOLID,new _e8b([0,0,0,0.5]),1),new _e8b([255,255,255,0.75])),ghostLineSymbol:new _e93(_e93.STYLE_DOT,new _e8b([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_e95?24:16,boxLineSymbol:new _e93(_e93.STYLE_DASH,new _e8b([64,64,64]),1),boxHandleSymbol:new _e92(_e92.STYLE_SQUARE,_e95?16:9,new _e93(_e93.STYLE_SOLID,new _e8b([0,0,0,0.5]),1),new _e8b([255,255,255,0.75]))},_e94||{});},activate:function(tool,_e96,_e97){this.deactivate();this._graphic=_e96;this._options=lang.mixin(lang.mixin({},this._defaultOptions),_e97||{});var MOVE=EDT.MOVE,EDIT=EDT.EDIT_VERTICES,_e98=EDT.SCALE,_e99=EDT.ROTATE,move=false,edit=false,box=false,map=this._map,_e9a=map.spatialReference,_e9b=_e96.geometry.spatialReference;this._geo=!!(_e9a&&_e9b&&!_e9a.equals(_e9b)&&_e9a.isWebMercator()&&_e9b.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_e96);}var _e9c=((tool&_e98)===_e98),_e9d=((tool&_e99)===_e99);if(_e9c||_e9d){box=this._enableBoxEditing(_e96,_e9c,_e9d);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_e96);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");}this._tool=tool;if(this._tool){this._mapPanEndHandle=_e89.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=_e89.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_e96);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_e9e=this._graphic;if(!tool){return;}var _e9f=!!this._modified;this._clear();_e89.disconnect(this._mapPanEndHandle);_e89.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_e9e,{isModified:_e9f});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_ea0){},onDeactivate:function(tool,_ea1,info){},onGraphicMoveStart:function(_ea2){},onGraphicFirstMove:function(_ea3){this._modified=true;},onGraphicMove:function(_ea4,_ea5){},onGraphicMoveStop:function(_ea6,_ea7){},onGraphicClick:function(_ea8,info){},onVertexMoveStart:function(_ea9,_eaa){},onVertexFirstMove:function(_eab,_eac){this._modified=true;},onVertexMove:function(_ead,_eae,_eaf){},onVertexMoveStop:function(_eb0,_eb1,_eb2){},onVertexAdd:function(_eb3,_eb4){this._modified=true;},onVertexClick:function(_eb5,_eb6){},onVertexMouseOver:function(_eb7,_eb8){},onVertexMouseOut:function(_eb9,_eba){},onVertexDelete:function(_ebb,_ebc){this._modified=true;},onScaleStart:function(_ebd){},onScaleFirstMove:function(_ebe){this._modified=true;},onScale:function(_ebf,info){},onScaleStop:function(_ec0,info){},onRotateStart:function(_ec1){},onRotateFirstMove:function(_ec2){this._modified=true;},onRotate:function(_ec3,info){},onRotateStop:function(_ec4,info){},_enableMove:function(_ec5){var map=this._map,type=_ec5.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new _e90(_ec5,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_ec6){var map=this._map,type=_ec6.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=_e91.create(_ec6,map,this);return true;}return false;},_enableBoxEditing:function(_ec7,_ec8,_ec9){var map=this._map,type=_ec7.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new Box(_ec7,map,this,_ec8,_ec9,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _eca=this._graphicMover;if(_eca){_eca.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _ecb=this._vertexEditor;if(_ecb){_ecb.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_ecc){if(_ecc){this._refreshMoveables();}},_refreshMoveables:function(_ecd){var _ece=_e8a.filter([this._graphicMover,this._vertexEditor,this._boxEditor],_e8d.isDefined);_e8a.forEach(_ece,function(mov){mov.refresh(_ecd);});},_beginOperation:function(_ecf){_e8a.forEach(this._getAffectedTools(_ecf),function(tool){tool.suspend();});},_endOperation:function(_ed0){_e8a.forEach(this._getAffectedTools(_ed0),function(tool){tool.resume();});},_getAffectedTools:function(_ed1){var _ed2=[];switch(_ed1){case "MOVE":_ed2=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_ed2=[this._boxEditor];break;case "BOX":_ed2=[this._vertexEditor];break;}_ed2=_e8a.filter(_ed2,_e8d.isDefined);return _ed2;}});lang.mixin(EDT,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});if(has("extend-esri")){lang.setObject("toolbars.Edit",EDT,_e8c);}return EDT;});},"esri/toolbars/_VertexMover":function(){define("esri/toolbars/_VertexMover",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/has","dojo/sniff","dojo/dom-style","dojox/gfx/Moveable","esri/kernel","esri/geometry/Point","esri/graphic","esri/geometry/webMercatorUtils"],function(_ed3,lang,_ed4,has,_ed5,_ed6,_ed7,_ed8,_ed9,_eda,_edb){var VM=_ed3(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(_edc,_edd,_ede,_edf,_ee0,_ee1,_ee2,_ee3){this.point=_edc;this.symbol=_edd;this.relatedGraphic=_ede;this.segIndex=_edf;this.ptIndex=_ee0;this.segLength=_ee1;this.editor=_ee2;this.map=_ee2.map;this._scratchGL=_ee2.toolbar._scratchGL;this._placeholder=_ee3||false;this._type=_ede.geometry.type;this._init();this._enable();},refresh:function(_ee4){if(_ee4||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _ee5=new _ed9(this.point.toJson());var _ee6=new _eda(_ee5,this.symbol);switch(this._type){case "multipoint":_ee6._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_ee6);break;}this.graphic=_ee6;},_enable:function(){var _ee7=this.graphic.getDojoShape();if(_ee7){_ee7._hasMover=true;this._moveable=this._getMoveable(_ee7);var node=_ee7.getEventSource();if(node){_ed6.set(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _ee8=this._moveable;if(_ee8){_ed4.disconnect(this._startHandle);_ed4.disconnect(this._firstHandle);_ed4.disconnect(this._movingHandle);_ed4.disconnect(this._stopHandle);var _ee9=_ee8.shape;if(_ee9){var node=_ee9.getEventSource();if(node){_ed6.set(node,"cursor",null);}}_ee8.destroy();this._moveable=null;}},_needRefresh:function(){var _eea=this.graphic.getDojoShape(),need=false;if(_eea){switch(this._type){case "multipoint":var _eeb=this.relatedGraphic.getDojoShape();if(_eeb){var _eec=_eeb.children[this.ptIndex];if(_eea!==_eec){_eea=_eec;this.graphic._shape=_eea;need=true;}}break;case "polyline":case "polygon":need=!_eea._hasMover;break;}}return need;},_getMoveable:function(_eed){var _eee=new _ed7(_eed,_ed5("mac")&&_ed5("ff")&&!has("esri-touch")&&{leftButtonOnly:true});this._startHandle=_ed4.connect(_eee,"onMoveStart",this,this._moveStartHandler);this._firstHandle=_ed4.connect(_eee,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_ed4.connect(_eee,"onMoving",this,this._movingHandler);this._stopHandle=_ed4.connect(_eee,"onMoveStop",this,this._moveStopHandler);return _eee;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_eef){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_eef.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_ef0){var _ef1=_ef0.shape;var _ef2=this._getControlEdges();var _ef3=this._scratchGL._div;var i,_ef4=[],_ef5=_ef0.host.shape._wrapOffsets[0]||0;for(i=0;i<_ef2.length;i++){var edge=_ef2[i];edge.x1+=_ef5;edge.x2+=_ef5;_ef4.push([_ef3.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_ef1._lines=_ef4;_ef0.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_ef6){var _ef7=_ef6.shape,tx=_ef7.getTransform();var i,_ef8=_ef7._lines;for(i=0;i<_ef8.length;i++){var line=_ef8[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_ef9){var _efa=_ef9.shape,_efb=this.editor.toolbar,tx=_efa.getTransform(),map=this.map,host=this.graphic,_efc=_efb._geo?_edb.geographicToWebMercator(host.geometry):host.geometry;var i,_efd=_efa._lines;if(_efd){for(i=0;i<_efd.length;i++){_efd[i][0].removeShape();}_efa._lines=null;}var ph=false,_efe=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_efe=false;}var _eff;if(map.snappingManager){_eff=map.snappingManager._snappingPoint;}var _f00=_eff||map.toMap(map.toScreen(_efc).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_efa.setTransform(null);host.setGeometry(_efb._geo?_edb.webMercatorToGeographic(_f00,true):_f00);this.constructor.onMoveStop(this,tx);_efb.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_efe){_efb.onVertexClick(this.relatedGraphic,info);}if(ph){_efb.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _f01=this.relatedGraphic.geometry;var _f02=this.segIndex,_f03=this.ptIndex,_f04=this.segLength;var _f05=this._scratchGL._div;var _f06=_f05.getTransform();var sdx=_f06.dx,sdy=_f06.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _f07=[];var _f08=this.editor._getControlPoints(this,_f01,_f02,_f03,_f04);if(_f08[0]){_f07.push({x1:x,y1:y,x2:_f08[0].x-sdx,y2:_f08[0].y-sdy});}if(_f08[1]){_f07.push({x1:x,y1:y,x2:_f08[1].x-sdx,y2:_f08[1].y-sdy});}return _f07;}});if(has("extend-esri")){lang.setObject("toolbars.VertexMover",VM,_ed8);}lang.mixin(VM,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return VM;});},"dijit/CalendarLite":function(){require({cache:{"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n"}});define("dijit/CalendarLite",["dojo/_base/array","dojo/_base/declare","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dojo/date/stamp","dojo/dom","dojo/dom-class","dojo/_base/event","dojo/_base/lang","dojo/sniff","dojo/string","./_WidgetBase","./_TemplatedMixin","dojo/text!./templates/Calendar.html","./hccss"],function(_f09,_f0a,_f0b,date,_f0c,_f0d,dom,_f0e,_f0f,lang,has,_f10,_f11,_f12,_f13){var _f14=_f0a("dijit.CalendarLite",[_f11,_f12],{templateString:_f13,dowTemplateString:"<th class=\"dijitReset dijitCalendarDayLabelTemplate\" role=\"columnheader\"><span class=\"dijitCalendarDayLabel\">${d}</span></th>",dateTemplateString:"<td class=\"dijitReset\" role=\"gridcell\" data-dojo-attach-point=\"dateCells\"><span class=\"dijitCalendarDateLabel\" data-dojo-attach-point=\"dateLabels\"></span></td>",weekTemplateString:"<tr class=\"dijitReset dijitCalendarWeekTemplate\" role=\"row\">${d}${d}${d}${d}${d}${d}${d}</tr>",value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date(),baseClass:"dijitCalendar",_isValidDate:function(_f15){return _f15&&!isNaN(_f15)&&typeof _f15=="object"&&_f15.toString()!=this.constructor.prototype.value.toString();},_getValueAttr:function(){if(this.value&&!isNaN(this.value)){var _f16=new this.dateClassObj(this.value);_f16.setHours(0,0,0,0);if(_f16.getDate()<this.value.getDate()){_f16=this.dateModule.add(_f16,"hour",1);}return _f16;}else{return null;}},_setValueAttr:function(_f17,_f18){if(typeof _f17=="string"){_f17=_f0d.fromISOString(_f17);}_f17=this._patchDate(_f17);if(this._isValidDate(_f17)&&!this.isDisabledDate(_f17,this.lang)){this._set("value",_f17);this.set("currentFocus",_f17);this._markSelectedDates([_f17]);if(this._created&&(_f18||typeof _f18=="undefined")){this.onChange(this.get("value"));}}else{this._set("value",null);this._markSelectedDates([]);}},_patchDate:function(_f19){if(_f19){_f19=new this.dateClassObj(_f19);_f19.setHours(1,0,0,0);}return _f19;},_setText:function(node,text){while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(node.ownerDocument.createTextNode(text));},_populateGrid:function(){var _f1a=new this.dateClassObj(this.currentFocus);_f1a.setDate(1);var _f1b=_f1a.getDay(),_f1c=this.dateModule.getDaysInMonth(_f1a),_f1d=this.dateModule.getDaysInMonth(this.dateModule.add(_f1a,"month",-1)),_f1e=new this.dateClassObj(),_f1f=_f0b.getFirstDayOfWeek(this.lang);if(_f1f>_f1b){_f1f-=7;}this._date2cell={};_f09.forEach(this.dateCells,function(_f20,idx){var i=idx+_f1f;var date=new this.dateClassObj(_f1a),_f21,_f22="dijitCalendar",adj=0;if(i<_f1b){_f21=_f1d-_f1b+i+1;adj=-1;_f22+="Previous";}else{if(i>=(_f1b+_f1c)){_f21=i-_f1b-_f1c+1;adj=1;_f22+="Next";}else{_f21=i-_f1b+1;_f22+="Current";}}if(adj){date=this.dateModule.add(date,"month",adj);}date.setDate(_f21);if(!this.dateModule.compare(date,_f1e,"date")){_f22="dijitCalendarCurrentDate "+_f22;}if(this.isDisabledDate(date,this.lang)){_f22="dijitCalendarDisabledDate "+_f22;_f20.setAttribute("aria-disabled","true");}else{_f22="dijitCalendarEnabledDate "+_f22;_f20.removeAttribute("aria-disabled");_f20.setAttribute("aria-selected","false");}var _f23=this.getClassForDate(date,this.lang);if(_f23){_f22=_f23+" "+_f22;}_f20.className=_f22+"Month dijitCalendarDateTemplate";var _f24=date.valueOf();this._date2cell[_f24]=_f20;_f20.dijitDateValue=_f24;this._setText(this.dateLabels[idx],date.getDateLocalized?date.getDateLocalized(this.lang):date.getDate());},this);},_populateControls:function(){var _f25=new this.dateClassObj(this.currentFocus);_f25.setDate(1);this.monthWidget.set("month",_f25);var y=_f25.getFullYear()-1;var d=new this.dateClassObj();_f09.forEach(["previous","current","next"],function(name){d.setFullYear(y++);this._setText(this[name+"YearLabelNode"],this.dateLocaleModule.format(d,{selector:"year",locale:this.lang}));},this);},goToToday:function(){this.set("value",new this.dateClassObj());},constructor:function(_f26){this.dateModule=_f26.datePackage?lang.getObject(_f26.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_f26.datePackage?lang.getObject(_f26.datePackage+".locale",false):_f0c;},_createMonthWidget:function(){return _f14._MonthWidget({id:this.id+"_mw",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},buildRendering:function(){var d=this.dowTemplateString,_f27=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),_f28=_f0b.getFirstDayOfWeek(this.lang);this.dayCellsHtml=_f10.substitute([d,d,d,d,d,d,d].join(""),{d:""},function(){return _f27[_f28++%7];});var r=_f10.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[r,r,r,r,r,r].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);dom.setSelectable(this.domNode,false);var _f29=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",_f29,false);},postCreate:function(){this.inherited(arguments);this._connectControls();},_connectControls:function(){var _f2a=lang.hitch(this,function(_f2b,part,_f2c){this.connect(this[_f2b],"onclick",function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,part,_f2c));});});_f2a("incrementMonth","month",1);_f2a("decrementMonth","month",-1);_f2a("nextYearLabelNode","year",1);_f2a("previousYearLabelNode","year",-1);},_setCurrentFocusAttr:function(date,_f2d){var _f2e=this.currentFocus,_f2f=this._getNodeByDate(_f2e);date=this._patchDate(date);this._set("currentFocus",date);if(!this._date2cell||this.dateModule.difference(_f2e,date,"month")!=0){this._populateGrid();this._populateControls();this._markSelectedDates([this.value]);}var _f30=this._getNodeByDate(date);_f30.setAttribute("tabIndex",this.tabIndex);if(this.focused||_f2d){_f30.focus();}if(_f2f&&_f2f!=_f30){if(has("webkit")){_f2f.setAttribute("tabIndex","-1");}else{_f2f.removeAttribute("tabIndex");}}},focus:function(){this._setCurrentFocusAttr(this.currentFocus,true);},_onDayClick:function(evt){_f0f.stop(evt);for(var node=evt.target;node&&!node.dijitDateValue;node=node.parentNode){}if(node&&!_f0e.contains(node,"dijitCalendarDisabledDate")){this.set("value",node.dijitDateValue);}},_getNodeByDate:function(_f31){_f31=this._patchDate(_f31);return _f31&&this._date2cell?this._date2cell[_f31.valueOf()]:null;},_markSelectedDates:function(_f32){function mark(_f33,cell){_f0e.toggle(cell,"dijitCalendarSelectedDate",_f33);cell.setAttribute("aria-selected",_f33?"true":"false");};_f09.forEach(this._selectedCells||[],lang.partial(mark,false));this._selectedCells=_f09.filter(_f09.map(_f32,this._getNodeByDate,this),function(n){return n;});_f09.forEach(this._selectedCells,lang.partial(mark,true));},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});_f14._MonthWidget=_f0a("dijit.CalendarLite._MonthWidget",_f11,{_setMonthAttr:function(_f34){var _f35=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_f34),_f36=(has("ie")==6?"":"<div class='dijitSpacer'>"+_f09.map(_f35,function(s){return "<div>"+s+"</div>";}).join("")+"</div>");this.domNode.innerHTML=_f36+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_f35[_f34.getMonth()]+"</div>";}});return _f14;});},"esri/toolbars/_VertexEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dijit/Menu","dijit/MenuItem","esri/kernel","esri/toolbars/_VertexMover","esri/geometry/Point","esri/geometry/jsonUtils","dojo/i18n!esri/nls/jsapi"],function(_f37,lang,_f38,_f39,has,Menu,_f3a,_f3b,_f3c,_f3d,_f3e,_f3f){var GVE=_f37(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(_f40,map,_f41){this.graphic=_f40;this.map=map;this.toolbar=_f41;var _f42=_f41._options;this._symbol1=_f42.vertexSymbol;this._symbol2=_f42.ghostVertexSymbol;var _f43=_f42.ghostLineSymbol;this._lineStroke={style:_f43.style,width:_f43.width,color:_f43.color};this._canDel=_f42.allowDeleteVertices;this._canAdd=_f42.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_f44){if(_f44){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_f38.connect(_f3c,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_f38.connect(_f3c,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _f45=this._getGraphicsLayer();this._mouseOverHandle=_f38.connect(_f45,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_f38.connect(_f45,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _f46=(this._ctxDelete=new _f3a({label:_f3f.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_f38.connect(_f46,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_f46);this._ctxMenu.startup();}},_removeControllers:function(){_f38.disconnect(this._firstMoveHandle);_f38.disconnect(this._moveStopHandle);_f38.disconnect(this._mouseOverHandle);_f38.disconnect(this._mouseOutHandle);_f38.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_f47,_f48,_f49){var i,j,_f4a=this.graphic,_f4b=[];for(i=0;i<_f47.length;i++){var _f4c=_f47[i],_f4d=[];for(j=0;j<_f4c.length;j++){_f4d.push(new _f3c(_f4c[j],_f48,_f4a,i,j,_f4c.length,this,_f49));}_f4b.push(_f4d);}return _f4b;},_remove:function(_f4e){if(_f4e){_f39.forEach(_f4e,function(_f4f){_f39.forEach(_f4f,function(_f50){_f50.destroy();});});}},_refresh:function(_f51){if(_f51){_f39.forEach(_f51,function(_f52){_f39.forEach(_f52,function(_f53){_f53.refresh();});});}},_isNew:function(_f54){return (_f39.indexOf(this._vertexMovers[_f54.segIndex],_f54)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _f55=this._selectedMover,_f56=_f55.ptIndex;this._updateRelatedGraphic(_f55,_f55.relatedGraphic,_f55.graphic.geometry,_f55.segIndex,_f55.ptIndex,_f55.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_f55);}this._deleteVertex(_f55);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _f57=evt.graphic,_f58=this._findMover(_f57);if(_f58){this.toolbar.onVertexMouseOver(this.graphic,_f58._getInfo());if(!_f58._placeholder){this._selectedMover=_f58;if(this._canDel){this._bindCtxNode(_f57.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _f59=evt.graphic,_f5a=this._findMover(_f59);if(_f5a){this.toolbar.onVertexMouseOut(this.graphic,_f5a._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_f5b){var i,_f5c=[],_f5d=this._mpVertexMovers;_f39.forEach(this._vertexMovers,function(_f5e){_f5c=_f5c.concat(_f5e);});if(_f5d){_f39.forEach(_f5d,function(_f5f){_f5c=_f5c.concat(_f5f);});}for(i=0;i<_f5c.length;i++){var _f60=_f5c[i];if(_f60.graphic===_f5b){return _f60;}}},_firstMoveHandler:function(_f61){if(!this._isNew(_f61)&&this._canAdd){this._hideRelatedMidpoints(_f61);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_f62,tx){var add=this._isNew(_f62);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_f62);}return;}this._updateRelatedGraphic(_f62,_f62.relatedGraphic,_f62.graphic.geometry,_f62.segIndex,_f62.ptIndex,_f62.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_f62);}else{this._repositionRelatedMidpoints(_f62);this._showRelatedMidpoints(_f62);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_f63){var i,_f64=this._getAdjacentMidpoints(_f63.ptIndex,_f63.segLength),_f65=this._mpVertexMovers[_f63.segIndex];for(i=0;i<_f64.length;i++){var mvr=_f65[_f64[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_f66){var i,_f67=this._getAdjacentMidpoints(_f66.ptIndex,_f66.segLength),_f68=this._mpVertexMovers[_f66.segIndex];for(i=0;i<_f67.length;i++){_f68[_f67[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_f69){var i,_f6a=this._getAdjacentMidpoints(_f69.ptIndex,_f69.segLength),_f6b=this._mpVertexMovers[_f69.segIndex];for(i=0;i<_f6a.length;i++){var _f6c=this._getAdjacentVertices(_f6a[i],_f69.segLength);var _f6d=_f69.relatedGraphic.geometry.getPoint(_f69.segIndex,_f6c[0]),_f6e=_f69.relatedGraphic.geometry.getPoint(_f69.segIndex,_f6c[1]);var _f6f=new _f3d({x:(_f6d.x+_f6e.x)/2,y:(_f6d.y+_f6e.y)/2,spatialReference:_f6d.spatialReference.toJson()});_f6b[_f6a[i]].graphic.setGeometry(_f6f);}},_addMidpoints:function(_f70){var _f71=_f70.segIndex,_f72=_f70.ptIndex,_f73=_f70.segLength;var _f74=_f72+1;var i,_f75=_f73+1;this._mpVertexMovers[_f71].splice(_f72,1);var _f76=this._vertexMovers[_f71];for(i=0;i<_f74;i++){_f76[i].segLength+=1;}for(i=_f74;i<_f76.length;i++){_f76[i].ptIndex+=1;_f76[i].segLength+=1;}_f70.ptIndex=_f74;_f70.segLength=_f76.length+1;_f76.splice(_f74,0,_f70);_f70.graphic.setSymbol(this._symbol1);_f76=this._mpVertexMovers[_f71];for(i=0;i<_f72;i++){_f76[i].segLength+=1;}for(i=_f72;i<_f73-1;i++){_f76[i].ptIndex+=1;_f76[i].segLength+=1;}var _f77=this._getAdjacentVertices(_f72,_f75);var _f78=this._getAdjacentVertices(_f72+1,_f75);var _f79,_f7a;_f79=_f70.relatedGraphic.geometry.getPoint(_f70.segIndex,_f77[0]);_f7a=_f70.relatedGraphic.geometry.getPoint(_f70.segIndex,_f77[1]);var _f7b=new _f3d({x:(_f79.x+_f7a.x)/2,y:(_f79.y+_f7a.y)/2,spatialReference:_f79.spatialReference.toJson()});_f79=_f70.relatedGraphic.geometry.getPoint(_f70.segIndex,_f78[0]);_f7a=_f70.relatedGraphic.geometry.getPoint(_f70.segIndex,_f78[1]);var _f7c=new _f3d({x:(_f79.x+_f7a.x)/2,y:(_f79.y+_f7a.y)/2,spatialReference:_f79.spatialReference.toJson()});var mvr1=new _f3c(_f7b,this._symbol2,this.graphic,_f70.segIndex,_f72,_f75,this,true);var mvr2=new _f3c(_f7c,this._symbol2,this.graphic,_f70.segIndex,_f72+1,_f75,this,true);_f76.splice(_f72,0,mvr1,mvr2);},_deleteVertex:function(_f7d){var i,_f7e=_f7d.segIndex,_f7f=_f7d.ptIndex;var _f80=this._vertexMovers[_f7e];for(i=0;i<_f7f;i++){_f80[i].segLength-=1;}for(i=_f7f+1;i<_f80.length;i++){var mvr=_f80[i];mvr.ptIndex-=1;mvr.segLength-=1;}_f80.splice(_f7f,1);var info=_f7d._getInfo();_f7d.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});lang.mixin(GVE,{create:function(_f81,map,_f82){var type=_f81.geometry.type;switch(type){case "multipoint":return new GVE.MultipointVertexEditor(_f81,map,_f82);break;case "polyline":return new GVE.PolylineVertexEditor(_f81,map,_f82);break;case "polygon":return new GVE.PolygonVertexEditor(_f81,map,_f82);break;}}});GVE.MultipointVertexEditor=_f37(GVE,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=_f38.connect(_f3c,"onMoveStart",this,this._moveStartHandler);_f38.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_f38.disconnect(this._moveStartHandle);},_getSegments:function(_f83){var i,_f84=_f83.points,_f85=[],sr=_f83.spatialReference;for(i=0;i<_f84.length;i++){var _f86=_f84[i];_f85.push(new _f3d({x:_f86[0],y:_f86[1],spatialReference:sr.toJson()}));}return [_f85];},_getMidpointSegments:function(_f87){return [];},_getControlPoints:function(_f88,_f89,_f8a,_f8b,_f8c){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _f8d=evt.graphic,_f8e=this._findMover(evt);if(_f8e){this.toolbar.onVertexMouseOver(_f8d,_f8e._getInfo());this._selectedMover=_f8e;if(this._canDel){this._bindCtxNode(_f8e.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _f8f=evt.graphic,_f90=this._findMover(evt);if(_f90){this.toolbar.onVertexMouseOut(_f8f,_f90._getInfo());}},_findMover:function(evt){var i,_f91=[].concat(this._vertexMovers[0]),_f92=evt.target;for(i=0;i<_f91.length;i++){var _f93=_f91[i];if(_f93.graphic.getDojoShape().getNode()===_f92){return _f93;}}},_moveStartHandler:function(_f94){var geom=_f94.relatedGraphic.geometry,_f95=_f94.ptIndex;var _f96=_f94.segLength-1;var _f97=geom.points;var _f98=_f97.splice(_f95,1);_f97.push(_f98[0]);var j,_f99=this._vertexMovers[0];for(j=_f96;j>_f95;j--){_f99[j].ptIndex-=1;}_f98=_f99.splice(_f95,1);_f99.push(_f98[0]);_f98[0].ptIndex=_f96;},_moveStopHandler:function(_f9a){this._updateRelatedGraphic(_f9a,_f9a.relatedGraphic,_f9a.graphic.geometry,_f9a.segIndex,_f9a.ptIndex,_f9a.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_f9b,_f9c,_f9d,_f9e,_f9f,_fa0,add,del){var geom=_f9c.geometry;if(del){geom.removePoint(_f9f);}else{geom.setPoint(_f9f,_f9d);}_f9c.setGeometry(geom);},_deleteMidpoints:function(_fa1){}});GVE.PolylineVertexEditor=_f37(GVE,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(_fa2){var i,j,_fa3=_fa2.paths,_fa4=[];for(i=0;i<_fa3.length;i++){var path=_fa3[i],_fa5=[];for(j=0;j<path.length;j++){_fa5.push(_fa2.getPoint(i,j));}_fa4.push(_fa5);}return _fa4;},_getMidpointSegments:function(_fa6){var i,j,_fa7=_fa6.paths,_fa8=[],sr=_fa6.spatialReference;for(i=0;i<_fa7.length;i++){var path=_fa7[i],_fa9=[];for(j=0;j<path.length-1;j++){var _faa=_fa6.getPoint(i,j),_fab=_fa6.getPoint(i,j+1);var midX=(_faa.x+_fab.x)/2,midY=(_faa.y+_fab.y)/2;var _fac=new _f3d({x:midX,y:midY,spatialReference:sr.toJson()});_fa9.push(_fac);}_fa8.push(_fa9);}return _fa8;},_getControlPoints:function(_fad,_fae,_faf,_fb0,_fb1){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_fad)){idx1=_fb0;idx2=_fb0+1;if(idx1>=0){pt1=map.toScreen(_fae.getPoint(_faf,idx1));}if(idx2<=_fb1){pt2=map.toScreen(_fae.getPoint(_faf,idx2));}}else{idx1=_fb0-1;idx2=_fb0+1;if(idx1>=0){pt1=map.toScreen(_fae.getPoint(_faf,idx1));}if(idx2<_fb1){pt2=map.toScreen(_fae.getPoint(_faf,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_fb2,_fb3){var _fb4=[];var idx1=_fb2-1;if(idx1>=0){_fb4.push(idx1);}var idx2=_fb2;if(idx2<_fb3-1){_fb4.push(idx2);}return _fb4;},_getAdjacentVertices:function(_fb5,_fb6){return [_fb5,_fb5+1];},_deleteMidpoints:function(_fb7){var _fb8=_fb7.segIndex,_fb9=_fb7.ptIndex,_fba=_fb7.segLength;var _fbb=this._mpVertexMovers[_fb8],_fbc=_fbb.length-1;var _fbd=this._getAdjacentMidpoints(_fb9,_fba).sort();var i,min=_fbd[0];for(i=0;i<min;i++){_fbb[i].segLength-=1;}for(i=min+1;i<_fbb.length;i++){var mvr=_fbb[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_fbd.length===1){_fbb.splice(min,1)[0].destroy();}else{var _fbe=this._getAdjacentVertices(min,_fbc);var _fbf=_fb7.relatedGraphic.geometry.getPoint(_fb7.segIndex,_fbe[0]);var _fc0=_fb7.relatedGraphic.geometry.getPoint(_fb7.segIndex,_fbe[1]);var _fc1=new _f3d({x:(_fbf.x+_fc0.x)/2,y:(_fbf.y+_fc0.y)/2,spatialReference:_fbf.spatialReference.toJson()});var mvr1=new _f3c(_fc1,this._symbol2,this.graphic,_fb7.segIndex,min,_fbc,this,true);var _fc2=_fbb.splice(min,_fbd.length,mvr1);for(i=0;i<_fc2.length;i++){_fc2[i].destroy();}}},_updateRelatedGraphic:function(_fc3,_fc4,_fc5,_fc6,_fc7,_fc8,add,del){var geom=_fc4.geometry;if(add){geom.insertPoint(_fc6,_fc7+1,_f3e.fromJson(_fc5.toJson()));}else{if(del){geom.removePoint(_fc6,_fc7);}else{geom.setPoint(_fc6,_fc7,_f3e.fromJson(_fc5.toJson()));}}_fc4.setGeometry(geom);}});GVE.PolygonVertexEditor=_f37(GVE,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(_fc9){var i,j,_fca=_fc9.rings,_fcb=[];for(i=0;i<_fca.length;i++){var ring=_fca[i],_fcc=[];for(j=0;j<ring.length-1;j++){_fcc.push(_fc9.getPoint(i,j));}_fcb.push(_fcc);}return _fcb;},_getMidpointSegments:function(_fcd){var i,j,_fce=_fcd.rings,_fcf=[],sr=_fcd.spatialReference;for(i=0;i<_fce.length;i++){var ring=_fce[i],_fd0=[];for(j=0;j<ring.length-1;j++){var _fd1=_fcd.getPoint(i,j),_fd2=_fcd.getPoint(i,j+1);var midX=(_fd1.x+_fd2.x)/2,midY=(_fd1.y+_fd2.y)/2;var _fd3=new _f3d({x:midX,y:midY,spatialReference:sr.toJson()});_fd0.push(_fd3);}_fcf.push(_fd0);}return _fcf;},_getControlPoints:function(_fd4,_fd5,_fd6,_fd7,_fd8){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_fd4)){idx1=_fd7;idx2=(_fd7+1)%_fd8;}else{idx1=_fd7-1;idx1=idx1<0?(_fd8+idx1)%_fd8:idx1;idx2=(_fd7+1)%_fd8;}pt1=map.toScreen(_fd5.getPoint(_fd6,idx1));pt2=map.toScreen(_fd5.getPoint(_fd6,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_fd9,_fda){var idx1=_fd9-1;idx1=idx1<0?(_fda+idx1)%_fda:idx1;var idx2=_fd9;return [idx1,idx2];},_getAdjacentVertices:function(_fdb,_fdc){return [_fdb,(_fdb+1)%_fdc];},_deleteMidpoints:function(_fdd){var _fde=_fdd.segIndex,_fdf=_fdd.ptIndex,_fe0=_fdd.segLength;var _fe1=this._mpVertexMovers[_fde],_fe2=_fe1.length-1,_fe3=this._getAdjacentMidpoints(_fdf,_fe0).sort(),_fe4,_fe5,_fe6,_fe7,i,mvr1,mvr,min=_fe3[0],max=_fe3[_fe3.length-1];if(_fdf===0){_fe4=this._getAdjacentVertices(_fe2-1,_fe2);_fe5=_fdd.relatedGraphic.geometry.getPoint(_fdd.segIndex,_fe4[0]);_fe6=_fdd.relatedGraphic.geometry.getPoint(_fdd.segIndex,_fe4[1]);_fe7=new _f3d({x:(_fe5.x+_fe6.x)/2,y:(_fe5.y+_fe6.y)/2,spatialReference:_fe5.spatialReference.toJson()});mvr1=new _f3c(_fe7,this._symbol2,this.graphic,_fdd.segIndex,_fe2-1,_fe2,this,true);_fe1.splice(max,1,mvr1)[0].destroy();_fe1.splice(min,1)[0].destroy();for(i=0;i<_fe1.length-1;i++){mvr=_fe1[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_fe4=this._getAdjacentVertices(min,_fe2);_fe5=_fdd.relatedGraphic.geometry.getPoint(_fdd.segIndex,_fe4[0]);_fe6=_fdd.relatedGraphic.geometry.getPoint(_fdd.segIndex,_fe4[1]);_fe7=new _f3d({x:(_fe5.x+_fe6.x)/2,y:(_fe5.y+_fe6.y)/2,spatialReference:_fe5.spatialReference.toJson()});mvr1=new _f3c(_fe7,this._symbol2,this.graphic,_fdd.segIndex,min,_fe2,this,true);var _fe8=_fe1.splice(min,_fe3.length,mvr1);for(i=0;i<_fe8.length;i++){_fe8[i].destroy();}for(i=0;i<min;i++){_fe1[i].segLength-=1;}for(i=min+1;i<_fe1.length;i++){mvr=_fe1[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_fe9,_fea,_feb,_fec,_fed,_fee,add,del){var geom=_fea.geometry;if(add){geom.insertPoint(_fec,_fed+1,_f3e.fromJson(_feb.toJson()));}else{if(del){geom.removePoint(_fec,_fed);if(_fed===0){geom.setPoint(_fec,_fee-1,_f3e.fromJson(geom.getPoint(_fec,0).toJson()));}}else{geom.setPoint(_fec,_fed,_f3e.fromJson(_feb.toJson()));if(_fed===0){geom.setPoint(_fec,_fee,_f3e.fromJson(_feb.toJson()));}}}_fea.setGeometry(geom);}});if(has("extend-esri")){lang.setObject("toolbars._GraphicVertexEditor",GVE,_f3b);lang.setObject("toolbars._MultipointVertexEditor",GVE.MultipointVertexEditor,_f3b);lang.setObject("toolbars._PolylineVertexEditor",GVE.PolylineVertexEditor,_f3b);lang.setObject("toolbars._PolygonVertexEditor",GVE.PolygonVertexEditor,_f3b);}return GVE;});},"*now":function(r){r(["dojo/i18n!*preload*esri/dijit/editing/nls/Editor-all*[\"ar\",\"az\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ro\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);},"*noref":1}});define("esri/dijit/editing/Editor-all",["esri/layers/FeatureLayer","esri/toolbars/_toolbar","esri/toolbars/draw","esri/toolbars/edit","esri/tasks/geometry","esri/dijit/AttributeInspector","esri/dijit/editing/AttachmentEditor","esri/dijit/editing/Editor","esri/dijit/editing/TemplatePicker","esri/dijit/editing/Util","esri/dijit/editing/SelectionHelper"],function(_fef,_ff0,Draw,Edit,_ff1,_ff2,_ff3,_ff4,_ff5,Util,_ff6){return {};});