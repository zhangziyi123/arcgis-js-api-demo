//>>built
define("dgrid/selector",["dojo/_base/kernel","dojo/_base/array","dojo/_base/lang","dojo/on","dojo/aspect","dojo/_base/sniff","put-selector/put"],function(_1,_2,_3,on,_4,_5,_6){_3.getObject("dgrid.selector",true);return (dgrid.selector=function(_7,_8){var _9=[],_a,_b;if(!_7){_7={};}if(_7.type){_7.selectorType=_7.type;_1.deprecated("columndef.type","use columndef.selectorType instead","dgrid 1.0");}_7.selectorType=_8=_8||_7.selectorType||"checkbox";_7.sortable=false;function _c(_d){return function(_e){var _f=_e.rows,len=_f.length,_10="false",_11,_12,i;for(i=0;i<len;i++){var _13=_a.cell(_f[i],_7.id).element;if(!_13){continue;}_13=(_13.contents||_13).input;if(!_13.disabled){_13.checked=_d;_13.setAttribute("aria-checked",_d);}}if(_b.type=="checkbox"){_11=_a.selection;_12=false;for(i in _11){if(_11[i]!=_a.allSelected){_12=true;break;}}_b.indeterminate=_12;_b.checked=_a.allSelected;if(_12){_10="mixed";}else{if(_a.allSelected){_10="true";}}_b.setAttribute("aria-checked",_10);}};};function _14(_15){if(_15.type=="click"||_15.keyCode==32||(!_5("opera")&&_15.keyCode==13)||_15.keyCode===0){var row=_a.row(_15),_16=_a._lastSelected&&_a.row(_a._lastSelected);_a._selectionTriggerEvent=_15;if(_8=="radio"){if(!_16||_16.id!=row.id){_a.clearSelection();_a.select(row,null,true);_a._lastSelected=row.element;}}else{if(row){if(_15.shiftKey){_c(true)({rows:[row]});}else{_16=null;}_16=_15.shiftKey?_16:null;_a.select(_16||row,row,_16?undefined:null);_a._lastSelected=row.element;}else{_6(this,(_a.allSelected?"!":".")+"dgrid-select-all");_a[_a.allSelected?"clearSelection":"selectAll"]();}}_a._selectionTriggerEvent=null;}};function _17(){_a._hasSelectorInputListener=true;_9.push(_4.before(_a,"_initSelectionEvents",function(){this.on(".dgrid-selector:click,.dgrid-selector:keydown",_14);}));var _18=_a._handleSelect;_a._handleSelect=function(_19){if(this.cell(_19).column!=_7){_18.apply(this,arguments);}};if(typeof _7.disabled=="function"){var _1a=_a.allowSelect;_a.allowSelect=function(row){return _1a.call(this,row)&&!_7.disabled(row.data);};}_9.push(_a.on("dgrid-select",_c(true)));_9.push(_a.on("dgrid-deselect",_c(false)));};var _1b=_7.disabled;var _1c=typeof _8=="function"?_8:function(_1d,_1e,_1f){var _20=_1e.parentNode;_6(_20&&_20.contents?_20:_1e,".dgrid-selector");var _21=_1e.input||(_1e.input=_6(_1e,"input[type="+_8+"]",{tabIndex:isNaN(_7.tabIndex)?-1:_7.tabIndex,disabled:_1b&&(typeof _1b=="function"?_1b(_1f):_1b),checked:_1d}));_21.setAttribute("aria-checked",!!_1d);if(!_a._hasSelectorInputListener){_17();}return _21;};_4.after(_7,"init",function(){_a=_7.grid;});_4.after(_7,"destroy",function(){_2.forEach(_9,function(l){l.remove();});_a._hasSelectorInputListener=false;});_7.renderCell=function(_22,_23,_24,_25,_26){var row=_22&&_a.row(_22);_23=row&&_a.selection[row.id];_1c(_23,_24,_22);};_7.renderHeaderCell=function(th){var _27=_7.label||_7.field||"";if(_8=="radio"||!_a.allowSelectAll){th.appendChild(document.createTextNode(_27));if(!_a._hasSelectorInputListener){_17();}}else{_1c(false,th,{});}_b=th.lastChild;};return _7;});});