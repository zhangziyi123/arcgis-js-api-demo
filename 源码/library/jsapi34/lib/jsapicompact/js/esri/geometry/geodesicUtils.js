/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
define("esri/geometry/geodesicUtils",["dojo/_base/array","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon"],function(_1,_2,_3,_4,_5,_6,_7,_8){var _9={"esriMiles":1,"esriKilometers":1.609344,"esriFeet":5280,"esriMeters":1609.34,"esriYards":1760,"esriNauticalMiles":0.869,"esriCentimeters":160934,"esriDecimeters":16093.4,"esriInches":63360,"esriMillimeters":1609340,"esriAcres":1,"esriAres":40.4685642,"esriSquareKilometers":0.00404685642,"esriSquareMiles":0.0015625,"esriSquareFeet":43560,"esriSquareMeters":4046.85642,"esriHectares":0.404685642,"esriSquareYards":4840,"esriSquareInches":6272640,"esriSquareMillimeters":4046856420,"esriSquareCentimeters":40468564.2,"esriSquareDecimeters":404685.642};function _a(pt){var _b=Math.PI/180;var a=6378137;var _c=0.006694379990197414,e=0.0818191908429643;var _d=Math.sin(pt.y*_b);var q=(1-_c)*((_d/(1-_c*(_d*_d))-(1/(2*e))*Math.log((1-e*_d)/(1+e*_d))));var x=a*pt.x*_b;var y=a*q*0.5;var _e=new _6(x,y);return _e;};function _f(_10,_11,_12,s){var a=6378137,b=6356752.31424518,f=1/298.257223563;var _13=Math.sin(_12);var _14=Math.cos(_12);var _15=(1-f)*Math.tan(_10);var _16=1/Math.sqrt((1+_15*_15)),_17=_15*_16;var _18=Math.atan2(_15,_14);var _19=_16*_13;var _1a=1-_19*_19;var uSq=_1a*(a*a-b*b)/(b*b);var A=1+uSq/16384*(4096+uSq*(-768+uSq*(320-175*uSq)));var B=uSq/1024*(256+uSq*(-128+uSq*(74-47*uSq)));var _1b=s/(b*A),_1c=2*Math.PI;var _1d,_1e,_1f;while(Math.abs(_1b-_1c)>1e-12){_1f=Math.cos(2*_18+_1b);_1d=Math.sin(_1b);_1e=Math.cos(_1b);var _20=B*_1d*(_1f+B/4*(_1e*(-1+2*_1f*_1f)-B/6*_1f*(-3+4*_1d*_1d)*(-3+4*_1f*_1f)));_1c=_1b;_1b=s/(b*A)+_20;}var tmp=_17*_1d-_16*_1e*_14;var _21=Math.atan2(_17*_1e+_16*_1d*_14,(1-f)*Math.sqrt(_19*_19+tmp*tmp));var _22=Math.atan2(_1d*_13,_16*_1e-_17*_1d*_14);var C=f/16*_1a*(4+f*(4-3*_1a));var L=_22-(1-C)*f*_19*(_1b+C*_1d*(_1f+C*_1e*(-1+2*_1f*_1f)));var _23=_21/(Math.PI/180);var _24=(_11+L)/(Math.PI/180);var pt=new _6(_24,_23,new _5({wkid:4326}));return pt;};function _25(_26,_27,_28,_29){var a=6378137,b=6356752.31424518,f=1/298.257223563;var L=(_29-_27);var U1=Math.atan((1-f)*Math.tan(_26));var U2=Math.atan((1-f)*Math.tan(_28));var _2a=Math.sin(U1),_2b=Math.cos(U1);var _2c=Math.sin(U2),_2d=Math.cos(U2);var _2e=L,_2f,_30=1000;var _31,_32,_33,_34,_35;do{var _36=Math.sin(_2e),_37=Math.cos(_2e);_32=Math.sqrt((_2d*_36)*(_2d*_36)+(_2b*_2c-_2a*_2d*_37)*(_2b*_2c-_2a*_2d*_37));if(_32===0){return 0;}_34=_2a*_2c+_2b*_2d*_37;_35=Math.atan2(_32,_34);var _38=_2b*_2d*_36/_32;_31=1-_38*_38;_33=_34-2*_2a*_2c/_31;if(isNaN(_33)){_33=0;}var C=f/16*_31*(4+f*(4-3*_31));_2f=_2e;_2e=L+(1-C)*f*_38*(_35+C*_32*(_33+C*_34*(-1+2*_33*_33)));}while(Math.abs(_2e-_2f)>1e-12&&--_30>0);if(_30===0){var _39=6371009;var _3a=Math.acos(Math.sin(_26)*Math.sin(_28)+Math.cos(_26)*Math.cos(_28)*Math.cos(_29-_27))*_39;var _3b=_29-_27;var y=Math.sin(_3b)*Math.cos(_28);var x=Math.cos(_26)*Math.sin(_28)-Math.sin(_26)*Math.cos(_28)*Math.cos(_3b);var _3c=Math.atan2(y,x);return {"azimuth":_3c,"geodesicDistance":_3a};}var uSq=_31*(a*a-b*b)/(b*b);var A=1+uSq/16384*(4096+uSq*(-768+uSq*(320-175*uSq)));var B=uSq/1024*(256+uSq*(-128+uSq*(74-47*uSq)));var _3d=B*_32*(_33+B/4*(_34*(-1+2*_33*_33)-B/6*_33*(-3+4*_32*_32)*(-3+4*_33*_33)));var s=b*A*(_35-_3d);var _3e=Math.atan2(_2d*Math.sin(_2e),_2b*_2c-_2a*_2d*Math.cos(_2e));var _3f=Math.atan2(_2b*Math.sin(_2e),_2b*_2c*Math.cos(_2e)-_2a*_2d);var _40={azimuth:_3e,geodesicDistance:s,reverseAzimuth:_3f};return _40;};function _41(_42,_43){var _44=Math.PI/180;var _45=6371008.771515059;if(_43<_45/10000){_43=_45/10000;}if(!(_42 instanceof _7||_42 instanceof _8)){var msg="_geodesicDensify: the input geometry is neither polyline nor polygon";console.error(msg);throw new Error(msg);}var _46=_42 instanceof _7,_47=_46?_42.paths:_42.rings,_48=[],_49;_1.forEach(_47,function(_4a){_48.push(_49=[]);_49.push([_4a[0][0],_4a[0][1]]);var _4b,_4c,_4d,_4e,i,j;_4b=_4a[0][0]*_44;_4c=_4a[0][1]*_44;for(i=0;i<_4a.length-1;i++){_4d=_4a[i+1][0]*_44;_4e=_4a[i+1][1]*_44;var _4f=_25(_4c,_4b,_4e,_4d);var _50=_4f.azimuth;var _51=_4f.geodesicDistance;var _52=_51/_43;if(_52>1){for(j=1;j<=_52-1;j++){var _53=j*_43;var pt=_f(_4c,_4b,_50,_53);_49.push([pt.x,pt.y]);}var _54=(_51+Math.floor(_52-1)*_43)/2;var _55=_f(_4c,_4b,_50,_54);_49.push([_55.x,_55.y]);}var _56=_f(_4c,_4b,_50,_51);_49.push([_56.x,_56.y]);_4b=_56.x*_44;_4c=_56.y*_44;}});if(_46){return new _7({paths:_48,spatialReference:_42.spatialReference});}else{return new _8({rings:_48,spatialReference:_42.spatialReference});}};function _57(_58,_59){var _5a=Math.PI/180;var _5b=[];_1.forEach(_58,function(_5c,idx){var _5d=0;_1.forEach(_5c.paths,function(_5e,idx){var _5f=0;var i,_60,_61,_62,_63,_64;for(i=1;i<_5e.length;i++){_60=_5e[i-1][0]*_5a;_61=_5e[i][0]*_5a;_62=_5e[i-1][1]*_5a;_63=_5e[i][1]*_5a;_64=_25(_62,_60,_63,_61);_5f+=_64.geodesicDistance/1609.344;}_5d+=_5f;});_5d*=_9[_59];_5b.push(_5d);});return _5b;};function _65(_66,_67){var _68=[];_1.forEach(_66,function(_69,idx){var _6a=_41(_69,10000);_68.push(_6a);});var _6b=[];var _6c,_6d;_1.forEach(_68,function(_6e,idx){var _6f=0;_1.forEach(_6e.rings,function(_70,idx){_6c=_a(new _6(_70[0][0],_70[0][1]));_6d=_a(new _6(_70[_70.length-1][0],_70[_70.length-1][1]));var _71=_6d.x*_6c.y-_6c.x*_6d.y;var i;for(i=0;i<_70.length-1;i++){_6c=_a(new _6(_70[i+1][0],_70[i+1][1]));_6d=_a(new _6(_70[i][0],_70[i][1]));_71+=_6d.x*_6c.y-_6c.x*_6d.y;}_71/=4046.87;_6f+=_71;});_6f*=_9[_67];_6b.push(_6f/(-2));});return _6b;};var _72={geodesicDensify:_41,geodesicLengths:_57,geodesicAreas:_65,_unitsDictionary:_9,_toEqualAreaPoint:_a,_directGeodeticSolver:_f,_inverseGeodeticSolver:_25};if(_3("extend-esri")){_2.mixin(_2.getObject("geometry",true,_4),_72);}return _72;});