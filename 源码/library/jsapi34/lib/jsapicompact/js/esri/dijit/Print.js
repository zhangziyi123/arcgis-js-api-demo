/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
define("esri/dijit/Print",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dojo/dom","dojo/dom-class","dojo/dom-construct","dijit/Menu","dijit/MenuItem","dijit/form/Button","dijit/form/ComboButton","esri/tasks/PrintTask","esri/tasks/PrintParameters","esri/kernel","esri/domUtils","dojo/i18n!esri/nls/jsapi"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){var _12=_1(null,{declaredClass:"esri.dijit.Print",onPrintComplete:function(){},onError:function(){},onPrintStart:function(){},constructor:function(_13,_14){_13=_13||{};this.url=_13.url;this.async=_13.async;this.map=_13.map;this.templates=_13.templates;this.extraParams=_13.extraParameters;var _15=_11.widgets.print;this._printText=_15.NLS_print;this._printingText=_15.NLS_printing;this._printoutText=_15.NLS_printout;if(!this.templates){this.templates=[{label:this._printText,format:"PNG32",layout:"MAP_ONLY",exportOptions:{width:800,height:1100,dpi:96}}];}this.printDomNode=_8.create("div");_7.add(this.printDomNode,"esriPrint");_14=_6.byId(_14);_14.appendChild(this.printDomNode);},startup:function(){this._createPrintButton();},destroy:function(){this.map=null;_8.destroy(this.printDomNode);},hide:function(){_10.hide(this.printDomNode);},show:function(){_10.show(this.printDomNode);},printMap:function(_16){this.onPrintStart();this._printButton.setAttribute("label",this._printingText);this._printButton.setAttribute("disabled",true);var map=this.map;var _17=new _d(this.url,{async:this.async});var _18=new _e();_18.map=map;_18.template=_16;_18.extraParameters=this.extraParams;_17.execute(_18,_2.hitch(this,this._printComplete),_2.hitch(this,this._printError));},_createPrintButton:function(){var _19=this.templates;if(_19.length===1){this._printButton=new _b({label:this._printText,onClick:_2.hitch(this,function(){this.printMap(_19[0]);})});this.printDomNode.appendChild(this._printButton.domNode);}else{this._printButton=new _c({label:this._printText,onClick:_2.hitch(this,function(){this.printMap(_19[0]);})});this.printDomNode.appendChild(this._printButton.domNode);var _1a=new _9({style:"display: none;"});_4.forEach(_19,function(_1b){var _1c=new _a({label:_1b.label,onClick:_2.hitch(this,function(){this.printMap(_1b);})});_1a.addChild(_1c);},this);this._printButton.setAttribute("dropDown",_1a);}_7.add(this._printButton.domNode,"esriPrintButton");},_printComplete:function(_1d){this.onPrintComplete(_1d);var _1e=window.location.host.split(".");var _1f=_1e.length>1?_1e[_1e.length-2]+"."+_1e[_1e.length-1]:window.location.host;var _20=_1d.url.split("://")[1].split("/")[0].split(".");var _21=_20.length>1?_20[_20.length-2]+"."+_20[_20.length-1]:_1d.url.split("://")[1].split("/")[0];if(_1f.toLowerCase()===_21.toLowerCase()){window.open(_1d.url);this._removeAllChildren(this.printDomNode);this._createPrintButton();}else{this._printButton.domNode.style.display="none";var _22=_8.create("a",{href:_1d.url,target:"_blank",innerHTML:this._printoutText});_3.connect(_22,"onclick",_2.hitch(this,this._hyperlinkClick));this._removeAllChildren(this.printDomNode);_7.add(_22,"esriPrintout");this.printDomNode.appendChild(_22);}},_printError:function(err){this._removeAllChildren(this.printDomNode);this._createPrintButton();console.error(err);this.onError(err);},_hyperlinkClick:function(){this._removeAllChildren(this.printDomNode);this._createPrintButton();},_removeAllChildren:function(_23){while(_23.hasChildNodes()){_23.removeChild(_23.lastChild);}}});if(_5("extend-esri")){_2.setObject("dijit.Print",_12,_f);}return _12;});