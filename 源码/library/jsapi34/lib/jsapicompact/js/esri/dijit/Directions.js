/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"url:esri/dijit/templates/Directions.html":"<div class=\"${options.theme}\" role=\"presentation\">\r\n    <div data-dojo-attach-point=\"_widgetContainer\" class=\"${_widgetContainerClass}\" role=\"presentation\">\r\n        <div class=\"${_stopsContainerClass}\" data-dojo-attach-point=\"_dndNode\" role=\"presentation\">\r\n            <table class=\"${_stopsClass}\" data-dojo-attach-point=\"_dndNode\"></table>\r\n            <div class=\"${_clearClass}\" role=\"presentation\"></div>\r\n            <div class=\"${_stopsButtonContainerClass}\">\r\n                <div role=\"button\" class=\"${_stopsAddDestinationClass}\" data-dojo-attach-point=\"_addDestinationNode\" data-dojo-attach-event=\"ondijitclick:_addStopButton\">${_i18n.widgets.directions.addDestination}</div>\r\n                <div role=\"button\" class=\"${_stopsOptionsButtonClass}\" data-dojo-attach-point=\"_optionsButtonNode\" data-dojo-attach-event=\"ondijitclick:_toggleOptionsMenu\">${_i18n.widgets.directions.showOptions}</div>\r\n            \t<div class=\"${_clearClass}\" role=\"presentation\"></div>\r\n            </div>\r\n            <div role=\"presentation\" class=\"${_stopsOptionsMenuClass}\" data-dojo-attach-point=\"_optionsMenuNode\">\r\n                <ul>\r\n                    <li class=\"${_stopsFindOptimalOrderClass}\"><input data-dojo-attach-point=\"_findOptimalOrderNode\" type=\"checkbox\" id=\"${id}_find_optimal_order\" /><label for=\"${id}_find_optimal_order\">${_i18n.widgets.directions.findOptimalOrder}</label></li>\r\n                </ul>\r\n                <div class=\"${_clearClass}\" role=\"presentation\"></div>\r\n            </div>\r\n            <div class=\"${_stopsGetDirectionsContainerClass}\">\r\n                <div role=\"button\" class=\"${_stopsGetDirectionsClass}\" data-dojo-attach-event=\"ondijitclick:_directionsButton\">${_i18n.widgets.directions.getDirections}</div>\r\n                <div class=\"${_clearClass}\" role=\"presentation\"></div>\r\n            </div>\r\n    \t</div>\r\n    \t<div class=\"${_clearClass}\" role=\"presentation\"></div>\r\n    \t<div class=\"${_resultsContainerClass}\" role=\"presentation\">\r\n        \t<div class=\"${_routesContainerClass}\" data-dojo-attach-point=\"_resultsNode\" role=\"presentation\"></div>\r\n    \t</div>\r\n    </div>\r\n</div>"}});define("esri/dijit/Directions",["require","dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/Color","dijit/_WidgetBase","dijit/_OnDijitClickMixin","dijit/_TemplatedMixin","dojo/has","dojo/on","dojo/mouse","dojo/dom","dojo/dom-style","dojo/dom-attr","dojo/query","dojo/number","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/templates/Directions.html","dojo/dom-construct","dojo/promise/all","dojo/Deferred","dojo/dnd/Source","esri/kernel","esri/graphic","esri/units","esri/InfoTemplate","esri/SpatialReference","esri/geometry/Point","esri/geometry/Extent","esri/geometry/Polyline","esri/geometry/mathUtils","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/TextSymbol","esri/symbols/Font","esri/dijit/Geocoder","esri/dijit/Popup","esri/tasks/FeatureSet","esri/tasks/RouteTask","esri/tasks/RouteParameters","esri/tasks/locator","esri/toolbars/edit","dojo/NodeList-dom","dojo/NodeList-traverse","dojo/uacss"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,on,_b,_c,_d,_e,_f,_10,_11,_12,_13,all,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24,_25,_26,_27,_28,_29){var _2a=_2([_7,_8,_9],{declaredClass:"esri.dijit.Directions",templateString:_12,basePath:_1.toUrl("esri/dijit"),constructor:function(_2b,_2c){var _2d=this;_2d._setClasses();_2d._setTemplates();_2d._setPublicDefaults();_2.safeMixin(_2d.options,_2b);_2d._setPrivateDefaults();_2d.theme=_2d.options.theme;_2d.stops=["",""];if(_2d.options.stops&&_2d.options.stops.length){_2d.stops=_2d.options.stops;}_2d.domNode=_2c;_2d.watch("theme",_2d._updateTheme);_2d.watch("stops",_2d._updateStops);},startup:function(){var _2e=this;_2e._geocoders=[];_2e._dnd=new _15(_2e._dndNode,{withHandles:true});_2e.addStops(_2e.stops);if(_2e.options.map){if(_2e.options.map.loaded){_2e._init();}else{_3.connect(_2e.options.map,"onLoad",function(){_2e._init();});}}else{_2e._init();}},destroy:function(){var _2f=this;var i;if(_2f._dnd){_2f._dnd.destroy();}if(_2f._geocoders.length){for(i=0;i<_2f._geocoders.length;i++){_2f._geocoders[i].destroy();}}_13.empty(_2f.domNode);if(_2f._onEvents){for(i=0;i<_2f._onEvents.length;i++){_2f._onEvents[i].remove();}}if(_2f._geocoderFindEvents){for(i=0;i<_2f._geocoderFindEvents.length;i++){_2f._geocoderFindEvents[i].remove();}}if(_2f._geocoderSelectEvents){for(i=0;i<_2f._geocoderSelectEvents.length;i++){_2f._geocoderSelectEvents[i].remove();}}if(_2f._connectEvents){for(i=0;i<_2f._connectEvents.length;i++){_3.disconnect(_2f._connectEvents[i]);}}_2f._disconnectResults();_2f.inherited(arguments);},clearDirections:function(){var _30=this;_30._routeParams.stops.features=[];_30.directions=null;_30._clearStopGraphics();_30._clearRouteGraphics();_30._clearInfoWindow();_30._clearResultsHTML();_30.onDirectionsClear();},reset:function(){var _31=this;_31.clearDirections();_31.updateStops(_31.options.stops);},onLoad:function(){},onDirectionsStart:function(){var _32=this;_f(_32._widgetContainer).addClass(_32._resultsLoadingClass);_32._solveActive=true;},onDirectionsFinish:function(){var _33=this;_f(_33._widgetContainer).removeClass(_33._resultsLoadingClass);_33._solveActive=false;},onDirectionsClear:function(){},onSegmentSelect:function(){},onSegmentHighlight:function(){},removeStops:function(){var _34=this;while(_34._dnd.getAllNodes().length){_34.removeStop(0,true);}},removeStop:function(_35){var _36=this;var _37=_36._dnd.getAllNodes();_36.stops.splice(_35,1);var _38=_37[_35];_36._geocoders[_35].destroy();_36._geocoders.splice(_35,1);_36._geocoderSelectEvents[_38.id].remove();_36._geocoderFindEvents[_38.id].remove();_13.destroy(_38);_36._dnd.sync();_36._stopsRemovable();_36._optionsMenu();_36._checkMaxStops();_36._fixIcons();_36._sortGeocoders();},updateStops:function(_39){var _3a=this;return _3a._updateStops(null,null,_39);},addStops:function(_3b,_3c){var _3d=this;var _3e=[];var i;var _3f=new _14();if(_3b&&_3b.length){for(i=0;i<_3b.length;i++){_3e.push(_3d._getStopAddress(_3b[i]));}all(_3e).then(function(_40){if(_40&&_40.length){for(i=0;i<_40.length;i++){_3d._insertStop(_40[i],_3c);_3c++;}_3f.resolve(_40);}else{_3f.reject(_11.widgets.directions.error.noAddresses);}});}else{_3f.reject(_11.widgets.directions.error.noStops);}return _3f;},addStop:function(_41,_42){var _43=this;var _44=new _14();_43._getStopAddress(_41).then(function(_45){_43._insertStop(_45,_42);_44.resolve(_45);});return _44;},updateStop:function(_46,_47){var _48=this;var _49=new _14();_48._getStopAddress(_46).then(function(_4a){_48._updateStop(_4a,_47);_49.resolve(_4a);});return _49;},getDirections:function(){var _4b=this;_4b._directionsDeferred=new _14();if(_4b._calculateValidStops()>=_4b._minStops){if(!_4b._solveActive){_4b.onDirectionsStart();_4b.clearDirections();_4b._dnd.sync();_4b._sortGeocoders();var _4c=[],i;for(i=0;i<_4b._geocoders.length;i++){if(_4b._geocoders[i].value){var _4d=_4b._geocoders[i].find();_4c.push(_4d);}}var _4e=all(_4c);_4e.then(function(_4f){var _50=_4b._validateStops(_4f);if(_50.error){_4b.geocoderResults=[];var _51=_4f[_50.index];var _52=_11.widgets.directions.error.unknownStop.replace("<name>",_51.value);_4b._resultError(_52);_4b._directionsDeferred.reject(_52);_4b.onDirectionsFinish();}else{_4b.geocoderResults=_4f;_4b._configureRoute();}});}}else{_4b.clearDirections();_4b._resultError(_11.widgets.directions.error.notEnoughStops);_4b._directionsDeferred.reject(_11.widgets.directions.error.notEnoughStops);_4b.onDirectionsFinish();}return _4b._directionsDeferred;},unhighlightSegment:function(){var _53=this;if(_53.options.map&&_53.options.map.graphics&&_53.options.showSegmentHighlight){_53.options.map.graphics.remove(_53._segmentGraphic);_53._segmentGraphic=null;}},highlightSegment:function(_54){var _55=this;var _56=_55.directions.features[_54];var _57=new _1d(_56.geometry);var _58;var _59=_57.getPoint(0,0);var _5a=_57.getPoint(0,1);var _5b=_1e.getLength(_59,_5a);if(!_5b){_57=_59;_58=_59;}else{_58=_57.getPoint(0,0);}_55.unhighlightSegment();_55._segmentGraphic=new _17(_57,_55.options.segmentSymbol,_56.attributes,_55.options.segmentInfoTemplate);if(_55._segmentGraphic&&_55.options.map&&_55.options.map.graphics){if(_55.options.showSegmentHighlight){_55.options.map.graphics.add(_55._segmentGraphic);}}},zoomToSegment:function(_5c){var _5d=this;if(_5d.options.map){var _5e=_5d.directions.features[_5c];var _5f=_5e.geometry;var _60=new _1d(_5f);var _61=_60.getExtent();var _62=_5d.options.map.setExtent(_61,true);_62.then(function(){_5d._showSegmentPopup(_5e);});}},centerAtSegmentStart:function(_63){var _64=this;if(_64.options.map){var _65=_64.directions.features[_63];var _66=_65.geometry;var _67=_66.getPoint(0,0);var _68=_64.options.map.centerAt(_67);_68.then(function(){_64._showSegmentPopup(_65);});}},zoomToFullRoute:function(){var _69=this;if(_69.options.map){_69._clearInfoWindow();_69.unhighlightSegment();_69.options.map.setExtent(_69.directions.extent,true);}},_clearResultsHTML:function(){var _6a=this;if(_6a._resultsNode){_6a._resultsNode.innerHTML="";}},_showSegmentPopup:function(_6b){var _6c=this;if(_6b&&_6c.options.showSegmentPopup&&_6c.options.map&&_6c.options.map.infoWindow){var _6d=_6b.geometry;var _6e=_6d.getPoint(0,0);var _6f=new _17(_6e,null,_6b.attributes,_6c.options.segmentInfoTemplate);_6c.options.map.infoWindow.setFeatures([_6f]);_6c.options.map.infoWindow.show(_6e);}},_removeStopButton:function(_70){var _71=this;var _72=_71._dnd.getAllNodes();if(_72.length>_71._minStops){_71.removeStop(_70);}},_getStopAddress:function(_73){var _74=this;var _75=new _14();var _76=typeof _73;if(!_73){_75.resolve("");}else{if(_76==="string"){_75.resolve(_73);}else{if(_74.options.locatorUrl){var _77=new _28(_74.options.locatorUrl);if(_74.options.map){_77.outSpatialReference=_74.options.map.spatialReference;}else{_77.outSpatialReference=_74._defaultSR;}var _78,_79;_78=_3.connect(_77,"onError",function(_7a){_75.resolve("");var _7b=_11.widgets.directions.error.locator;_74._resultError(_7b);console.log(_7a.toString());_3.disconnect(_78);_3.disconnect(_79);});_79=_3.connect(_77,"onLocationToAddressComplete",function(_7c){var _7d=_74._getCandidateAddress(_7c);_75.resolve(_7d);_3.disconnect(_78);_3.disconnect(_79);});if(_76==="object"&&_73.type==="point"){_77.locationToAddress(_73,_74.options.locatorDistance);}else{if(_73 instanceof Array&&_73.length===2){var _7e=new _1b(_73,new _1a({wkid:4326}));_77.locationToAddress(_7e,_74.options.locatorDistance);}else{_75.reject(_11.widgets.directions.error.invalidStopType);}}}else{_75.reject(_11.widgets.directions.error.locatorUndefined);}}}return _75;},_updateStop:function(_7f,_80){var _81=this;if(_81._geocoders[_80]){_81._geocoders[_80].set("value",_7f);}_81.stops[_80]=_7f;},_insertStop:function(_82,_83){var _84=this;_84._checkMaxStops();if(!_84.maxStopsReached){var _85=_84._dnd.getAllNodes();var _86=false,_87=false;var _88=_85.length;if(!_85[_83]){_87=false;_86=false;_84.stops[_88]=_82;}else{_87=_85[_83];_86=true;_84.stops.splice(_83,0,_82);}var tr=_13.create("tr",{className:_84._stopClass});var _89=_13.create("td",{className:_84._stopIconColumnClass},tr);_13.create("div",{className:_84._stopIconClass+" dojoDndHandle",innerHTML:_84._getLetter(_88)},_89);var _8a=_13.create("td",{className:_84._esriStopGeocoderColumnClass},tr);var _8b=_13.create("div",{},_8a);if(_84.options.canModifyStops){var _8c=_13.create("td",{className:_84._stopIconRemoveColumnClass},tr);_13.create("div",{className:_84._stopIconRemoveClass,role:"button","data-remove":"true"},_8c);}_84._dnd.insertNodes(false,[tr],_86,_87);if(_84.options.map){_84.options.geocoderOptions.map=_84.options.map;}if(!_84.options.geocoderOptions.theme){_84.options.geocoderOptions.theme=_84.theme;}_84.options.geocoderOptions._dndId=tr.id;_84.options.geocoderOptions.value="";if(_82){_84.options.geocoderOptions.value=_82;}var _8d=new _23(_84.options.geocoderOptions,_8b);_8d.startup();var _8e=on(_8d,"select",function(){_84.getDirections().then(function(){_84.zoomToFullRoute();});});_84._geocoderSelectEvents[tr.id]=_8e;var _8f=on(_8d,"onEnterKeySelect",function(){_84.getDirections().then(function(){_84.zoomToFullRoute();});});_84._geocoderFindEvents[tr.id]=_8f;_84._checkMaxStops();_84._fixIcons();if(_84._focusOnNewStop){_8d.focus();}_84._geocoders.push(_8d);_84._stopsRemovable();_84._optionsMenu();_84._sortGeocoders();}else{_84._resultError(_11.widgets.directions.error.maximumStops);}},_addStopButton:function(){var _90=this;_90.addStop();},_sortGeocoders:function(){var _91=this;var _92=_91._dnd.getAllNodes();_91._geocoders.sort(function(a,b){return _91._sortGeocodersToNodes(a,b,_92);});},_validateStops:function(_93){var i;if(_93){for(i=0;i<_93.length;i++){if(_93[i].results.length===0){return {error:true,index:i};}}}return {error:false};},_disconnectResults:function(){var _94=this,i;if(_94._resultEvents.length){for(i=0;i<_94._resultEvents.length;i++){_94._resultEvents[i].remove();}}},_formatTime:function(_95){var hr,min,str="";hr=Math.floor(_95/60);min=Math.floor(_95%60);if(hr){str+=hr+" ";if(hr>1){str+=_11.widgets.directions.time.hours;}else{str+=_11.widgets.directions.time.hour;}}if(hr&&min){str+=" ";}if(min){str+=min+" ";if(min>1){str+=_11.widgets.directions.time.minutes;}else{str+=_11.widgets.directions.time.minute;}}if(str){str+=".";}return str;},_formatDistance:function(_96,_97){var d=Math.round(_96*100)/100;if(d===0){return "";}return _10.format(d)+" "+_97;},_setMoveSymbol:function(_98){var _99=this;_99._moveSymbolSet=true;var _9a=_99._setStopSymbol(_98._index,true);_98.setSymbol(_9a);},_unsetMoveSymbol:function(_9b){var _9c=this;var _9d=_9c._setStopSymbol(_9b._index);_9b.setSymbol(_9d);_9c._moveSymbolSet=false;},_removeTextGraphic:function(_9e){var _9f=this;var _a0=_9f._textGraphics[_9e];_9f.options.map.graphics.remove(_a0);},_setDraggableObject:function(_a1){var _a2=this;if(_a1._drag&&_a2.options.map&&_a2.options.map.graphics){_a2._removeTextGraphic(_a1._index);_a2._dragGraphic=_a1;_a2._dragGeometry=_a1.geometry;_a2.edit.activate(_29.MOVE,_a1);}},_setTextGraphic:function(_a3){var _a4=this;if(_a3._drag&&_a4.options.map&&_a4.options.map.graphics){var _a5=_a4._textGraphics[_a3._index];_a5.setGeometry(_a3.geometry);_a4.options.map.graphics.add(_a5);var _a6=_a5.getDojoShape();if(_a6){_a6.moveToFront();}}},_unsetDraggableObject:function(_a7){var _a8=this;if(_a7._drag){if(_a8._moveSymbolSet){_a8._unsetMoveSymbol(_a7);}_a8._setTextGraphic(_a7);_a8.edit.deactivate();}},_editToolbar:function(){var _a9=this;if(_a9.options.map){_a9.edit=new _29(_a9.options.map);}},_init:function(){var _aa=this;_aa._createRouteTask();_aa._editToolbar();_aa._setEvents();if(!_aa.options.canModifyStops){_13.destroy(_aa._addDestinationNode);}_aa._focusOnNewStop=_aa.options.focusOnNewStop;_aa.loaded=true;_aa.onLoad();},_removeEmptyStops:function(){var _ab=this,i;if(_ab._geocoders.length>_ab._minStops){_ab._sortGeocoders();for(i=(_ab._geocoders.length-1);_ab._geocoders.length>_ab._minStops&&i>-1;i--){var _ac=_ab._geocoders[i];if(_ac){var _ad=_ac.get("value");if(!_ad){_ab.removeStop(i);}}}}},_calculateValidStops:function(){var _ae=this,_af=0,i;for(i=0;i<_ae._geocoders.length;i++){var _b0=_ae._geocoders[i].get("value");if(_b0){_af++;}}return _af;},_setStopSymbol:function(i,_b1){var _b2=this;if(i===0){if(_b1&&_b2.options.fromSymbolDrag){return _b2.options.fromSymbolDrag;}return _b2.options.fromSymbol;}else{if(i===(_b2.geocoderResults.length-1)){if(_b1&&_b2.options.toSymbolDrag){return _b2.options.toSymbolDrag;}return _b2.options.toSymbol;}else{if(_b1&&_b2.options.stopSymbolDrag){return _b2.options.stopSymbolDrag;}return _b2.options.stopSymbol;}}},_setRouteSymbols:function(){var _b3=this,i;for(i=0;i<_b3.geocoderResults.length;i++){var _b4=_b3.geocoderResults[i].results[0];if(_b4&&_b4.feature){var _b5=_b3._setStopSymbol(i);var _b6=_b4.name||"";var _b7=_b3._defaultSR;if(_b3.options.map){_b7=_b3.options.map.spatialReference;}var _b8=new _1b(_b4.feature.geometry.x,_b4.feature.geometry.y,_b7);var _b9=_b3._getLetter(i);var _ba=new _21(_b9,_b3.options.textSymbolFont,_b3.options.textSymbolColor);if(_b3.options.textSymbolOffset){_ba.setOffset(_b3.options.textSymbolOffset.x,_b3.options.textSymbolOffset.y);}var _bb=new _17(_b8,_ba,{address:_b6},_b3.options.stopsInfoTemplate);_bb._textGraphic=true;_bb._index=i;var _bc=new _17(_b8,_b5,{address:_b6},_b3.options.stopsInfoTemplate);_bc._drag=true;_bc._index=i;var _bd=new _17(_b8,null,{address:_b6});_b3.stops[i]=_bd;_b3._stopGraphics[i]=_bc;_b3._textGraphics[i]=_bb;}}},_addRouteSymbols:function(){var _be=this;var i;if(_be._stopGraphics.length&&_be.options.map&&_be.options.map.graphics){for(i=0;i<_be._stopGraphics.length;i++){_be.options.map.graphics.add(_be._stopGraphics[i]);var _bf=_be._stopGraphics[i].getDojoShape();if(_bf){_bf.moveToFront();}_be.options.map.graphics.add(_be._textGraphics[i]);var _c0=_be._textGraphics[i].getDojoShape();if(_c0){_c0.moveToFront();}}}},_configureRoute:function(){var _c1=this;_c1._setRouteSymbols();if(_c1._findOptimalOrderNode){_c1._routeParams.findBestSequence=_e.get(_c1._findOptimalOrderNode,"checked");if(_c1._routeParams.findBestSequence){_c1._routeParams.returnStops=true;}else{_c1._routeParams.returnStops=false;}}_c1.directions=null;_c1._routeParams.stops.features=_c1._stopGraphics;_c1._routeTask.solve(_c1._routeParams);},_boldText:function(_c2,_c3){return _c2.replace(new RegExp("(^|\\s)("+_c3+")(\\s|$)","ig"),"$1<strong>$2</strong>$3");},_clearStopGraphics:function(){var _c4=this,i;if(_c4._stopGraphics.length&&_c4.options.map&&_c4.options.map.graphics){for(i=0;i<_c4._stopGraphics.length;i++){_c4.options.map.graphics.remove(_c4._stopGraphics[i]);_c4.options.map.graphics.remove(_c4._textGraphics[i]);}}_c4.stops=[];_c4._stopGraphics=[];_c4._textGraphics=[];},_clearRouteGraphics:function(){var _c5=this;if(_c5.mergedRouteGraphic&&_c5.options.map&&_c5.options.map.graphics){_c5.options.map.graphics.remove(_c5.mergedRouteGraphic);_c5.mergedRouteGraphic=null;}_c5.unhighlightSegment();},_clearInfoWindow:function(){var _c6=this;if(_c6.options.map&&_c6.options.map.infoWindow){_c6.options.map.infoWindow.hide();if(_c6.options.map.infoWindow.features){_c6.options.map.infoWindow.clearFeatures();}}},_showRoute:function(_c7){var _c8=this;_c8._clearInfoWindow();_c8.directions=_c7.routeResults[0].directions;var _c9=_c7.routeResults[0].stops;if(_c9&&_c9.length){var _ca=[];for(var i=0;i<_c9.length;i++){var _cb=_c9[i];_c8.updateStop(_cb.attributes.Name,i);var _cc={results:[{extent:new _1c({"xmin":_cb.geometry.x-0.25,"ymin":_cb.geometry.y-0.25,"xmax":_cb.geometry.x+0.25,"ymax":_cb.geometry.y+0.25,"spatialReference":_cb.geometry.spatialReference}),feature:_cb,name:_cb.attributes.Name}],value:_cb.attributes.Name};_ca.push(_cc);}_c8.geocoderResults=_ca;_c8._clearStopGraphics();_c8._setRouteSymbols();}_c8._clearRouteGraphics();_c8.mergedRouteGraphic=new _17(_c8.directions.mergedGeometry,_c8.options.routeSymbol);if(_c8.options.map&&_c8.options.map.graphics){_c8.options.map.graphics.add(_c8.mergedRouteGraphic);var _cd=_c8.mergedRouteGraphic.getDojoShape();if(_cd){_cd.moveToBack();}}_c8._addRouteSymbols();var _ce="";if(_c8._resultsNode){_ce+="<div class=\""+_c8._resultsRouteNameClass+"\">";_ce+=_c8.directions.routeName;_ce+="</div>";if(_c8.directions.totalLength||_c8.directions.totalTime){_ce+="<div class=\""+_c8._resultsSummaryClass+"\">";if(_c8.directions.totalLength){_ce+=_c8._formatDistance(_c8.directions.totalLength,_11.widgets.directions.units[_c8._units].name)+". ";}if(_c8.directions.totalTime){_ce+=_c8._formatTime(_c8.directions.totalTime);}_ce+="</div>";}_ce+="<div class=\""+_c8._resultsRouteButtonContainerClass+"\">";_ce+="<div role=\"button\" class=\""+_c8._resultsViewFullRouteClass+"\" data-full-route=\"true\">"+_11.widgets.directions.viewFullRoute+"</div>";if(_c8.options.showPrintPage){_ce+="<div role=\"button\" title=\""+_11.widgets.directions.print+"\" class=\""+_c8._resultsPrintClass+"\" data-print-directions=\"true\"></div>";}_ce+="<div class=\""+_c8._clearClass+"\"></div>";_ce+="</div>";_ce+="<div class=\""+_c8._routesClass+"\">";_ce+="<table summary=\""+_c8.directions.routeName+"\">";_ce+="<tbody role=\"menu\">";var _cf=0;_5.forEach(_c8.directions.features,function(_d0,i){var _d1=_c8._routeClass;if(_d0.attributes.maneuverType){_d1+=" "+_d0.attributes.maneuverType;}if(i===0){_d1+=" "+_c8._routeOriginClass;}else{if(i===(_c8.directions.features.length-1)){_d1+=" "+_c8._routeDestinationClass;}}_ce+="<tr role=\"menuitem\" class=\""+_d1+" "+_c8._routeZoomClass+"\" data-segment=\""+i+"\">";_ce+="<td class=\""+_c8._routeIconColumnClass+"\">";_ce+="<div class=\""+_c8._routeIconClass+"\">";if(i===0){_ce+=_c8._getLetter(_cf);_cf++;}else{if(_d0.attributes.maneuverType==="esriDMTStop"){_ce+=_c8._getLetter(_cf);}else{if(_d0.attributes.maneuverType==="esriDMTDepart"){_ce+=_c8._getLetter(_cf);_cf++;}}}_ce+="</div>";_ce+="</td>";_ce+="<td class=\""+_c8._routeTextColumnClass+"\">";_ce+="<div class=\""+_c8._routeInfoClass+"\">";_ce+="<div class=\""+_c8._routeTextClass+"\">";var _d2=_d0.attributes.text;var _d3=_c8.directions.strings[i],j;if(_d3){for(j=0;j<_d3.length;j++){_d2=_c8._boldText(_d2,_d3[j].string);}}_ce+=_d2;_ce+="</div>";var _d4=_c8._formatDistance(_d0.attributes.length,_11.widgets.directions.units[_c8._units].abbr);var _d5=_c8._formatTime(_d0.attributes.time);if(_d4){_ce+="<div class=\""+_c8._routeLengthClass+"\">";_ce+=_d4;if(_d5){_ce+=" "+_d5;}_ce+="</div>";}_ce+="</div>";_ce+="</td>";_ce+="</tr>";});_ce+="</tbody>";_ce+="</table>";_ce+="</div>";if(_c8._resultsNode){_c8._resultsNode.innerHTML=_ce;}_c8._disconnectResults();var _d6=_f("[data-segment]",_c8._resultsNode);if(_d6&&_d6.length){_d6.forEach(function(_d7){var _d8=on(_d7,_b.enter,function(){var i=parseInt(_f(this).attr("data-segment")[0],10);_c8.highlightSegment(i);_c8.onSegmentHighlight(_c8.directions.features[i]);});_c8._resultEvents.push(_d8);var _d9=on(_d7,_b.leave,function(){_c8.unhighlightSegment();});_c8._resultEvents.push(_d9);if(_c8.options.centerAtSegmentStart){var _da=on(_d7,"click",function(){var i=parseInt(_f(this).attr("data-segment")[0],10);_c8.centerAtSegmentStart(i);_c8.onSegmentSelect(_c8.directions.features[i]);});_c8._resultEvents.push(_da);}});}}_c8.onDirectionsFinish(_c7);_c8._directionsDeferred.resolve(_c7);},_getLetter:function(i){var _db=this.options.alphabet;var _dc="";if(_db&&_db.length){if(!i){i=0;}if(i>=_db.length){i=_db.length-1;}if(typeof _db==="string"){_dc=_db.substr(i,1);}else{if(_db instanceof Array){_dc=_db[i];}}}return _dc;},_directionsButton:function(){var _dd=this;_dd._removeEmptyStops();_dd.getDirections().then(function(){_dd.zoomToFullRoute();});},_fixIcons:function(){var _de=this,i,_df=_de._dnd.getAllNodes();for(i=0;i<_df.length;i++){var _e0=_f("."+_de._stopIconClass,_df[i])[0];if(_e0){_e0.innerHTML=_de._getLetter(i);}_f(_df[i]).removeClass(_de._stopOriginClass+" "+_de._stopDestinationClass);if(i===0){_f(_df[i]).addClass(_de._stopOriginClass);}else{if(i===(_df.length-1)){_f(_df[i]).addClass(_de._stopDestinationClass);}}}if(_de.options.showReverseStopsButton){_f("[data-reverse-td]",_de._dndNode).orphan();_13.create("td",{"data-reverse-td":"true",rowspan:_df.length,className:_de._esriStopReverseColumnClass,innerHTML:"<div role=\"button\" class=\""+_de._reverseStopsClass+"\" data-reverse-stops=\"true\" title=\""+_11.widgets.directions.reverseDirections+"\"></div>"},_df[0]);}},_getCandidateAddress:function(_e1){var _e2="";if(_e1&&_e1.address){_e2+=_e1.address.Address+" ";_e2+=_e1.address.City+" ";_e2+=_e1.address.Region+" ";_e2+=_e1.address.Postal+" ";_e2+=_e1.address.CountryCode+" ";}return _e2;},_setReverseGeocode:function(_e3){var _e4=this;if(_e3.address){var _e5=_e3.location;var _e6=_e4._getCandidateAddress(_e3);var _e7=_e4._stopGraphics[_e4._dragGraphic._index].attributes;_e7.address=_e6;if(_e4.stops[_e4._dragGraphic._index]){_e4.stops[_e4._dragGraphic._index].setAttributes(_e7);_e4.stops[_e4._dragGraphic._index].setGeometry(_e5);_e4._stopGraphics[_e4._dragGraphic._index].setAttributes(_e7);_e4._stopGraphics[_e4._dragGraphic._index].setGeometry(_e5);_e4._textGraphics[_e4._dragGraphic._index].setAttributes(_e7);_e4._textGraphics[_e4._dragGraphic._index].setGeometry(_e5);}if(!_e4._moveInProgress){_e4._unsetDraggableObject(_e4._dragGraphic);}if(_e4._geocoders[_e4._dragGraphic._index]){_e4._geocoders[_e4._dragGraphic._index].set("value",_e6);}_e4._directionsDeferred=new _14();_e4._routeParams.stops.features=_e4._stopGraphics;_e4.directions=null;_e4._routeTask.solve(_e4._routeParams);}},_setEvents:function(){var _e8=this;var _e9=on(_e8._dndNode,"[data-reverse-stops]:click",function(){_e8._reverseStops();});_e8._onEvents.push(_e9);var _ea=on(_e8._resultsNode,"[data-print-directions]:click",function(){_e8._printDirections();});_e8._onEvents.push(_ea);var _eb=on(_e8._resultsNode,"[data-full-route]:click",function(){_e8.zoomToFullRoute();});_e8._onEvents.push(_eb);var _ec=on(_e8._dndNode,"[data-remove]:click",function(){var _ed=_f("[data-remove]",_e8._dndNode);var _ee=_5.indexOf(_ed,this);_e8._removeStopButton(_ee);});_e8._onEvents.push(_ec);var _ef=on(_e8._dnd,"Drop",function(){_e8._dnd.sync();_e8._sortGeocoders();_e8._fixIcons();if(_e8._calculateValidStops()===_e8._geocoders.length&&_e8._routeParams.stops.features.length){_e8.getDirections().then(function(){_e8.zoomToFullRoute();});}});_e8._onEvents.push(_ef);if(_e8.options.map&&_e8.options.map.graphics&&_e8.options.locatorUrl){if(_e8.options.dragging){var _f0=_3.connect(_e8.options.map.graphics,"onMouseOver",function(e){if(e.graphic._drag){var _f1=_e8.edit.getCurrentState();if(!_f1.graphic){_e8._setDraggableObject(e.graphic);}if(!_e8._moveSymbolSet){_e8._setMoveSymbol(e.graphic);}}else{if(e.graphic._textGraphic){_e8._removeTextGraphic(e.graphic._index);}}});_e8._connectEvents.push(_f0);var _f2=_3.connect(_e8.options.map.graphics,"onMouseOut",function(e){if(!_e8._moveInProgress&&e.graphic._drag){_e8._unsetDraggableObject(e.graphic);}});_e8._connectEvents.push(_f2);}var _f3=_3.connect(_e8.edit,"onGraphicClick",function(e){if(_e8.options.map&&_e8.options.map.infoWindow){_e8.options.map.infoWindow.setFeatures([e]);_e8.options.map.infoWindow.show(e.geometry);}});_e8._connectEvents.push(_f3);var _f4=_3.connect(_e8.edit,"onGraphicFirstMove",function(){_e8._moveInProgress=true;});_e8._connectEvents.push(_f4);var _f5=_3.connect(_e8.edit,"onGraphicMoveStop",function(_f6){_e8._moveInProgress=false;_e8._unsetDraggableObject(_f6);if(_e8._dragGeometry!==_f6.geometry){_e8._currentEditableGraphic=_f6;_e8.onDirectionsStart();_e8._clearInfoWindow();_e8._clearResultsHTML();_e8._editGraphicLocator.locationToAddress(_f6.geometry,_e8.options.locatorDistance);}});_e8._connectEvents.push(_f5);}var _f7=_3.connect(_e8._routeTask,"onSolveComplete",function(_f8){_e8._showRoute(_f8);});_e8._connectEvents.push(_f7);var _f9=_3.connect(_e8._routeTask,"onError",function(_fa){var _fb=_11.widgets.directions.error.routeTask;_e8._resultError(_fb);_e8._directionsDeferred.reject(_fb);_e8.onDirectionsFinish();console.log(_fa.toString());});_e8._connectEvents.push(_f9);if(_e8.options.locatorUrl){var _fc=_3.connect(_e8._editGraphicLocator,"onError",function(_fd){_e8.onDirectionsFinish();var _fe=_11.widgets.directions.error.locator;_e8._resultError(_fe);_e8._clearRouteGraphics();var _ff=_e8._currentEditableGraphic._index;_e8._geocoders[_ff].set("value","");console.log(_fd.toString());});_e8._connectEvents.push(_fc);var _100=_3.connect(_e8._editGraphicLocator,"onLocationToAddressComplete",function(_101){_e8._setReverseGeocode(_101);});_e8._connectEvents.push(_100);}},_resultError:function(_102){var _103=this;var html="";html+="<div class=\""+_103._routesErrorClass+"\">";html+=_102;html+="</div>";if(_103._resultsNode){_103._resultsNode.innerHTML=html;}},_getUnits:function(unit){switch(unit){case _18.KILOMETERS:return "KILOMETERS";case _18.METERS:return "METERS";case _18.NAUTICAL_MILES:return "NAUTICAL_MILES";default:return "MILES";}},_createRouteTask:function(){var _104=this;if(_104.options.locatorUrl){_104._editGraphicLocator=new _28(_104.options.locatorUrl);}if(_104.options.map){_104._editGraphicLocator.outSpatialReference=_104.options.map.spatialReference;}else{_104._editGraphicLocator.outSpatialReference=_104._defaultSR;}_104._routeTask=new _26(_104.options.routeTaskUrl);_104._routeParams=new _27();if(_104.options.routeParams.directionsLengthUnits){_104._routeParams.directionsLengthUnits=_104.options.routeParams.directionsLengthUnits;}else{if(_104.options.routeParams.directionsLanguage){_104._routeParams.directionsLengthUnits=_104.options.routeParams.directionsLanguage==="en"?_18.MILES:_18.KILOMETERS;}}_104._routeParams.returnRoutes=false;if(_104.options.routeParams){_2.safeMixin(_104._routeParams,_104.options.routeParams);}_104._routeParams.directionsOutputType="complete";_104._routeParams.stops=new _25();_104._routeParams.returnDirections=true;if(_104.options.map){_104._routeParams.outSpatialReference=_104.options.map.spatialReference;}else{_104._routeParams.outSpatialReference=_104._defaultSR;}_104._routeParams.doNotLocateOnRestrictedElements=true;_104._units=_104._getUnits(_104._routeParams.directionsLengthUnits);},_setPublicDefaults:function(){var _105=this;_105.options={map:null,theme:"simpleDirections",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",directions:null,routeTaskUrl:"http://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",routeParams:{returnRoutes:false,directionsLanguage:"en",directionsOutputType:"complete",directionsLengthUnits:_18.MILES},stops:["",""],locatorUrl:"http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",locatorDistance:1000,geocoderOptions:{autoComplete:true,autoNavigate:false},stopsInfoTemplate:new _19("Location",_105._stopTpl),segmentInfoTemplate:new _19("Route",_105._routeTpl),textSymbolFont:new _22("11px",_22.STYLE_NORMAL,_22.VARIANT_NORMAL,_22.WEIGHT_NORMAL,"Arial, Helvetica, sans-serif"),textSymbolColor:new _6([255,255,255]),textSymbolOffset:{x:0,y:10.875},fromSymbol:new _1f({"url":_105.basePath+"/images/Directions/greenPoint.png","height":21.75,"width":15.75,"type":"esriPMS"}).setOffset(0,10.875),fromSymbolDrag:new _1f({"url":_105.basePath+"/images/Directions/greenPointMove.png","height":21.75,"width":15.75,"type":"esriPMS"}).setOffset(0,10.875),stopSymbol:new _1f({"url":_105.basePath+"/images/Directions/bluePoint.png","height":21.75,"width":15.75,"type":"esriPMS"}).setOffset(0,10),stopSymbolDrag:new _1f({"url":_105.basePath+"/images/Directions/bluePointMove.png","height":21.75,"width":15.75,"type":"esriPMS"}).setOffset(0,10),toSymbol:new _1f({"url":_105.basePath+"/images/Directions/redPoint.png","height":21.75,"width":15.75,"type":"esriPMS"}).setOffset(0,10.875),toSymbolDrag:new _1f({"url":_105.basePath+"/images/Directions/redPointMove.png","height":21.75,"width":15.75,"type":"esriPMS"}).setOffset(0,10.875),routeSymbol:new _20().setColor(new _6([0,69,117,1])).setWidth(4),segmentSymbol:new _20().setColor(new _6([0,122,194,1])).setWidth(8),showPrintPage:true,showSegmentPopup:true,showSegmentHighlight:true,centerAtSegmentStart:true,showReverseStopsButton:true,focusOnNewStop:true,dragging:true,canModifyStops:true};},_reverseStops:function(){var _106=this;var _107=_106._dnd.getAllNodes();if(_107.length){_107.reverse();_106._dnd.clearItems();_106._dnd.insertNodes(false,_107);_106._dnd.sync();_106._stopsRemovable();_106._optionsMenu();_106._checkMaxStops();_106._fixIcons();_106.getDirections().then(function(){_106.zoomToFullRoute();});}},_setTemplates:function(){var _108=this;_108._routeTpl="";_108._routeTpl+="<div class=\"${maneuverType}\">";_108._routeTpl+="<div class=\""+_108._routeIconClass+" "+_108._infoWindowRouteClass+"\">";_108._routeTpl+="${text}";_108._routeTpl+="</div>";_108._routeTpl+="</div>";_108._stopTpl="Address: ${address}";},_setClasses:function(){var _109=this;_109._widgetContainerClass="esriDirectionsContainer";_109._stopsContainerClass="esriStopsContainer";_109._reverseStopsClass="esriStopsReverse";_109._addStopsClass="esriStopsAdd";_109._stopsClass="esriStops";_109._stopsRemovableClass="esriStopsRemovable";_109._stopsButtonContainerClass="esriStopsButtons";_109._stopsOptionsButtonClass="esriStopsOptionsButton";_109._stopsAddDestinationClass="esriStopsAddDestination";_109._stopsGetDirectionsContainerClass="esriStopsGetDirectionsContainer";_109._stopsGetDirectionsClass="esriStopsGetDirections";_109._stopsOptionsOptionsEnabledClass="esriStopsOptionsEnabled";_109._stopsOptionsMenuClass="esriStopsOptionsMenu";_109._stopsFindOptimalOrderClass="esriFindOptimalOrderOption";_109._stopClass="esriStop";_109._stopOriginClass="esriStopOrigin";_109._stopDestinationClass="esriStopDestination";_109._esriStopGeocoderColumnClass="esriStopGeocoderColumn";_109._esriStopReverseColumnClass="esriStopReverseColumn";_109._stopIconColumnClass="esriStopIconColumn";_109._stopIconClass="esriStopIcon";_109._stopIconRemoveColumnClass="esriStopIconRemoveColumn";_109._stopIconRemoveClass="esriStopIconRemove";_109._resultsContainerClass="esriResultsContainer";_109._resultsLoadingClass="esriResultsLoading";_109._resultsPrintClass="esriResultsPrint";_109._resultsSummaryClass="esriResultsSummary";_109._resultsViewFullRouteClass="esriResultsViewFullRoute";_109._resultsRouteNameClass="esriResultsRouteName";_109._resultsRouteButtonContainerClass="esriResultsButtonsContainer";_109._routesContainerClass="esriRoutesContainer";_109._routesClass="esriRoutes";_109._routesErrorClass="esriRoutesError";_109._routeClass="esriRoute";_109._routeTextColumnClass="esriRouteTextColumn";_109._routeTextClass="esriRouteText";_109._routeLengthClass="esriRouteLength";_109._routeOriginClass="esriDMTStopOrigin";_109._routeDestinationClass="esriDMTStopDestination";_109._routeInfoClass="esriRouteInfo";_109._routeIconColumnClass="esriRouteIconColumn";_109._routeIconClass="esriRouteIcon";_109._infoWindowRouteClass="esriInfoWindowRoute";_109._routeZoomClass="esriRouteZoom";_109._esriPrintPageClass="esriPrintPage";_109._esriPrintBarClass="esriPrintBar";_109._esriPrintButtonClass="esriPrintButton";_109._esriPrintMainClass="esriPrintMain";_109._esriPrintHeaderClass="esriPrintHeader";_109._esriPrintLogoClass="esriPrintLogo";_109._esriPrintNameClass="esriPrintName";_109._esriPrintNotesClass="esriPrintNotes";_109._esriPrintLengthClass="esriPrintLength";_109._esriPrintDirectionsClass="esriPrintDirections";_109._esriPrintFooterClass="esriPrintFooter";_109._esriPrintStopLabelClass="esriPrintStopLabel";_109._clearClass="esriClear";},_setPrivateDefaults:function(){var _10a=this;_10a._i18n=_11;_10a._minStops=2;_10a._maxStops=20;_10a._minOptionsStops=4;_10a._onEvents=[];_10a._connectEvents=[];_10a._geocoderSelectEvents=[];_10a._geocoderFindEvents=[];_10a._resultEvents=[];_10a._stopGraphics=[];_10a._textGraphics=[];_10a._defaultSR=new _1a(4326);},_sortGeocodersToNodes:function(a,b,_10b){var aId=a._dndId;var bId=b._dndId;var aDnd=_c.byId(aId);var bDnd=_c.byId(bId);var _10c=_5.indexOf(_10b,aDnd);var _10d=_5.indexOf(_10b,bDnd),i;for(i=0;i<_10b.length;i++){if(i===_10c){return -1;}else{if(i===_10d){return 1;}}}},_optionsMenu:function(){var _10e=this;if(_10e._geocoders.length>=_10e._minOptionsStops){_f(_10e._widgetContainer).addClass(_10e._stopsOptionsOptionsEnabledClass);}else{_f(_10e._widgetContainer).removeClass(_10e._stopsOptionsOptionsEnabledClass);var _10f=_d.get(_10e._optionsMenuNode,"display");if(_10f==="block"){_10e._toggleOptionsMenu();}if(_10e._routeParams){_10e._routeParams.findBestSequence=false;}_e.set(_10e._findOptimalOrderNode,"checked",false);}},_stopsRemovable:function(){var _110=this;if(_110._geocoders.length>_110._minStops){_f(_110._widgetContainer).addClass(_110._stopsRemovableClass);}else{_f(_110._widgetContainer).removeClass(_110._stopsRemovableClass);}},_checkMaxStops:function(){var _111=this;if(_111._dnd.getAllNodes().length<_111._maxStops){_111._showAddDestination();_111.maxStopsReached=false;}else{_111._hideAddDestination();_111.maxStopsReached=true;}},_updateStops:function(attr,_112,_113){var _114=this;if(_114.loaded){var _115=_114._dnd.getAllNodes(),i;for(i=0;i<_115.length;i++){_114.removeStops();}return _114.addStops(_113);}},_updateTheme:function(attr,_116,_117){var _118=this;if(_118.loaded){_f(_118.domNode).removeClass(_116).addClass(_117);_118.theme=_117;}},_toggleOptionsMenu:function(){var _119=this;var _11a=_d.get(_119._optionsMenuNode,"display");if(_11a==="block"){_d.set(_119._optionsMenuNode,"display","none");_119._optionsButtonNode.innerHTML=_11.widgets.directions.showOptions;}else{_d.set(_119._optionsMenuNode,"display","block");_119._optionsButtonNode.innerHTML=_11.widgets.directions.hideOptions;}},_hideAddDestination:function(){var _11b=this;_f(_11b._widgetContainer).removeClass(_11b._addStopsClass);},_showAddDestination:function(){var _11c=this;_f(_11c._widgetContainer).addClass(_11c._addStopsClass);},_getAbsoluteUrl:function(){var url=_1.toUrl("esri/dijit");if(/^http\:/i.test(url)){return url;}else{if(/^\/\//i.test(url)){return window.location.protocol+url;}else{if(/^\//i.test(url)){return window.location.protocol+"//"+window.location.host+url;}}}},_getManeuverImage:function(_11d){var _11e=this;if(_11d){var _11f=_11e._getAbsoluteUrl()+"/images/Directions/maneuvers/";var _120=".png";if(_11d==="esriDMTStop"||_11d==="esriDMTDepart"){return "";}return _11f+_11d+_120;}return "";},_loadPrintDirections:function(){var _121=this;_121._printWindow.document.title=_121.directions.routeName;var _122=_f("head",_121._printWindow.document)[0];var _123=_121._getAbsoluteUrl()+"/css/Directions.css";var _124=_121._getAbsoluteUrl()+"/css/DirectionsPrint.css";var _125="";_125+="<link rel=\"stylesheet\" media=\"screen\" type=\"text/css\" href=\""+_123+"\">";_125+="<link rel=\"stylesheet\" media=\"print\" type=\"text/css\" href=\""+_124+"\">";_13.place(_125,_122,"first");_f("html",_121._printWindow.document).addClass(_121.theme);_f("body",_121._printWindow.document).addClass(_121._esriPrintPageClass);var _126="";_126+="<div class=\""+_121._esriPrintBarClass+"\">";_126+="<div id=\"printButton\" class=\""+_121._esriPrintButtonClass+"\" title=\""+_11.widgets.directions.print+"\" onclick=\"window.print();\">"+_11.widgets.directions.print+"</div>";_126+="</div>";_126+="<div class=\""+_121._esriPrintMainClass+"\">";_126+="<div class=\""+_121._esriPrintHeaderClass+"\">";_126+="<img class=\""+_121._esriPrintLogoClass+"\" src=\"https://www.arcgis.com/about/graphics/logo-esri.png\" />";_126+="<div class=\""+_121._esriPrintNameClass+"\">"+_121.directions.routeName+"</div>";_126+="<div class=\""+_121._esriPrintLengthClass+"\">"+_121._formatDistance(_121.directions.totalLength,_11.widgets.directions.units[_121._units].name)+". "+_121._formatTime(_121.directions.totalTime)+"</div>";_126+="<textarea class=\""+_121._esriPrintNotesClass+"\" placeholder=\""+_11.widgets.directions.printNotes+"\"></textarea>";_126+="<div class=\""+_121._clearClass+"\"></div>";_126+="</div>";_126+="<div class=\""+_121._esriPrintDirectionsClass+"\">";_126+="<table>";_126+="<tbody>";var _127=0;_5.forEach(_121.directions.features,function(_128,i){_126+="<tr>";_126+="<td class=\""+_121._routeIconColumnClass+"\">";var _129=_121._getManeuverImage(_128.attributes.maneuverType);var _12a;if(i===0){_12a=_121._getLetter(_127);_127++;}else{if(_128.attributes.maneuverType==="esriDMTStop"){_12a=_121._getLetter(_127);}else{if(_128.attributes.maneuverType==="esriDMTDepart"){_12a=_121._getLetter(_127);_127++;}}}if(_129){_126+="<img src=\""+_129+"\" />";}else{if(_12a){_126+="<div class=\""+_121._esriPrintStopLabelClass+"\">";_126+=_12a;_126+="</div>";}}_126+="</td>";_126+="<td class=\""+_121._routeTextColumnClass+"\">";_126+="<div>"+_128.attributes.text+"</div>";_126+="</td>";_126+="<td class=\""+_121._routeTextColumnClass+"\">";_126+="<div class=\""+_121._routeLengthClass+"\">"+_121._formatDistance(_128.attributes.length,_11.widgets.directions.units[_121._units].abbr)+"</div>";_126+="</td>";_126+="</tr>";});_126+="</tbody>";_126+="</table>";_126+="</div>";_126+="<div class=\""+_121._esriPrintFooterClass+"\">";_126+="<p>"+_11.widgets.directions.printDisclaimer+"</p>";_126+="</div>";_126+="</div>";if(_121._printWindow.document&&_121._printWindow.document.body){_121._printWindow.document.body.innerHTML=_126;}},_printDirections:function(){var _12b=this;_12b._printWindow=window.open("","directions_widget_print",null,true);_12b._printWindow[_12b._printWindow.addEventListener?"addEventListener":"attachEvent"]((_12b._printWindow.attachEvent?"on":"")+"load",_12b._loadPrintDirections(),false);}});if(_a("extend-esri")){_4.setObject("dijit.Directions",_2a,_16);}return _2a;});