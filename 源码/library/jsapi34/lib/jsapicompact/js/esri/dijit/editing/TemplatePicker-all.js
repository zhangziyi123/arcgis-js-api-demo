/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"esri/layers/FeatureType":function(){define("esri/layers/FeatureType",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/symbols/jsonUtils","esri/layers/RangeDomain","esri/layers/CodedValueDomain","esri/layers/InheritedDomain","esri/layers/FeatureTemplate"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_1(null,{declaredClass:"esri.layers.FeatureType",constructor:function(_d){if(_d&&_2.isObject(_d)){this.id=_d.id;this.name=_d.name;var _e=_d.symbol;if(_e){this.symbol=_7.fromJson(_e);}var _f=_d.domains,_10,i;var _11=this.domains={};for(_10 in _f){if(_f.hasOwnProperty(_10)){var _12=_f[_10];switch(_12.type){case "range":_11[_10]=new _8(_12);break;case "codedValue":_11[_10]=new _9(_12);break;case "inherited":_11[_10]=new _a(_12);break;}}}var _13=_d.templates;if(_13){var _14=this.templates=[];for(i=0;i<_13.length;i++){_14.push(new _b(_13[i]));}}}},toJson:function(){var _15={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _16,_17=this.domains,_18=this.templates,_19=_6.fixJson;if(_17){var _1a=_15.domains={};for(_16 in _17){if(_17.hasOwnProperty(_16)){_1a[_16]=_17[_16]&&_17[_16].toJson();}}_19(_1a);}if(_18){_15.templates=_3.map(_18,function(_1b){return _1b.toJson();});}return _19(_15);}});if(_4("extend-esri")){_2.setObject("layers.FeatureType",_c,_5);}return _c;});},"dijit/hccss":function(){define("dijit/hccss",["dojo/dom-class","dojo/hccss","dojo/ready","dojo/_base/window"],function(_1c,has,_1d,win){_1d(90,function(){if(has("highcontrast")){_1c.add(win.body(),"dijit_a11y");}});return has;});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_1e,_1f){return _1e("dijit._Contained",null,{_getSibling:function(_20){var _21=this.domNode;do{_21=_21[_20+"Sibling"];}while(_21&&_21.nodeType!=1);return _21&&_1f.byNode(_21);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(_22,_23,_24,_25,_26,_27,_28,has,_29,win,_2a,_2b,_2c,_2d,_2e,_2f,_30,_31,_32,_33){var _34=function(_35,_36){return _35.style.cssText==undefined?_35.getAttribute("style"):_35.style.cssText;};var _37=_25("dojox.grid._View",[_2c,_2d],{defaultWidth:"18em",viewWidth:"",templateString:_2a,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_31._HeaderBuilder,_contentBuilderClass:_31._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");_2f.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);_2f.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){_30.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);_30.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_38){var vs=(this.structure=_38);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_39){if(_39){_26.forEach(_29("[widgetId]",_39).map(_23.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_3a,_3b){this._onBeforeRow(_3a,_3b);if(_3a>=0){this._cleanupRowWidgets(this.getRowNode(_3a));}},onAfterRow:function(_3c,_3d,_3e){this._onAfterRow(_3c,_3d,_3e);var g=this.grid;_26.forEach(_29(".dojoxGridStubNode",_3e),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _3f=window.parseInt(_30.attr(n,"cellIdx"),10);var _40=g.getCell(_3f);var w=_23.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}_22.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,_41;(_41=row[i]);i++){_41.view=this;this.flexCells=this.flexCells||_41.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _42=this.hasVScrollbar();var _43=_30.style(this.scrollboxNode,"overflow");if(this.noscroll||!_43||_43=="hidden"){_42=false;}else{if(_43=="scroll"){_42=true;}}return (_42?_2e.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?(h.firstChild.offsetWidth||_30.style(h.firstChild,"width")):0;},setColumnsWidth:function(_44){this.headerContentNode.firstChild.style.width=_44+"px";if(this.viewWidth){this.viewWidth=_44+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,_30._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _45=this.grid.layout.cells;var _46=_27.hitch(this,function(_47,_48){!this.grid.isLeftToRight()&&(_48=!_48);var inc=_48?-1:1;var idx=this.header.getCellNodeIndex(_47)+inc;var _49=_45[idx];while(_49&&_49.getHeaderNode()&&_49.getHeaderNode().style.display=="none"){idx+=inc;_49=_45[idx];}if(_49){return _49.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _4a="dojoxGrid_bottomMarker";var _4b="dojoxGrid_topMarker";if(this.bottomMarker){_30.destroy(this.bottomMarker);}this.bottomMarker=_30.byId(_4a);if(this.topMarker){_30.destroy(this.topMarker);}this.topMarker=_30.byId(_4b);if(!this.bottomMarker){this.bottomMarker=_30.create("div",{"id":_4a,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=_30.create("div",{"id":_4b,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=_30.contentBox(this.bottomMarker);var _4c=_30.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _2b(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:_27.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_2b.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:_27.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_2b.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:_27.hitch(this,function(_4d){var src=this.source;if(src.current==src.targetAnchor&&src.before==_4d){return;}if(src.targetAnchor&&_46(src.targetAnchor,src.before)){src._removeItemClass(_46(src.targetAnchor,src.before),src.before?"After":"Before");}_2b.prototype._markTargetAnchor.call(src,_4d);var _4e=_4d?src.targetAnchor:_46(src.targetAnchor,src.before);var _4f=0;if(!_4e){_4e=src.targetAnchor;_4f=_30.contentBox(_4e).w+this.arrowDim.w/2+2;}var pos=_30.position(_4e,true);var _50=Math.floor(pos.x-this.arrowDim.w/2+_4f);_30.style(this.bottomMarker,"visibility","visible");_30.style(this.topMarker,"visibility","visible");_30.style(this.bottomMarker,{"left":_50+"px","top":(_4c+pos.y)+"px"});_30.style(this.topMarker,{"left":_50+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_46(src.targetAnchor,src.before)){src._addItemClass(_46(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:_27.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_46(src.targetAnchor,src.before)){src._removeItemClass(_46(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_2b.prototype._unmarkTargetAnchor.call(src);}),destroy:_27.hitch(this,function(){_28.disconnect(this._source_conn);_28.unsubscribe(this._source_sub);_2b.prototype.destroy.call(this.source);if(this.bottomMarker){_30.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){_30.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:_27.hitch(this,function(){_2b.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_28.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_28.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(_51){_30.style(_51,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_52,_53,_54){if(_33.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _55=this.grid.views.views;var _56=_55[_52.viewIndex];var _57=_55[this.index];if(_57!=_56){_56.convertColPctToFixed();_57.convertColPctToFixed();}},_onDndDrop:function(_58,_59,_5a){if(_33.manager().target!==this.source){if(_33.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _5b=function(n){return n?_30.attr(n,"idx"):null;};var w=_30.marginBox(_59[0]).w;if(_58.viewIndex!==this.index){var _5c=this.grid.views.views;var _5d=_5c[_58.viewIndex];var _5e=_5c[this.index];if(_5d.viewWidth&&_5d.viewWidth!="auto"){_5d.setColumnsWidth(_5d.getColumnsWidth()-w);}if(_5e.viewWidth&&_5e.viewWidth!="auto"){_5e.setColumnsWidth(_5e.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _5f=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_5f.moveColumn(_58.viewIndex,idx,_5b(_59[0]),_5b(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}_2f.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_60){var n=_60.name||_60.grid.getCellName(_60);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_60.index!=_60.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_60.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_60.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_61){var _62=this._hasHScroll||false;if(this._hasHScroll==undefined||_61){if(this.noscroll){this._hasHScroll=false;}else{var _63=_30.style(this.scrollboxNode,"overflow");if(_63=="hidden"){this._hasHScroll=false;}else{if(_63=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_62!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_64){var _65=this._hasVScroll||false;if(this._hasVScroll==undefined||_64){if(this.noscroll){this._hasVScroll=false;}else{var _66=_30.style(this.scrollboxNode,"overflow");if(_66=="hidden"){this._hasVScroll=false;}else{if(_66=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_65!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _67=false;this.grid.initialWidth="";var _68=_29("th",this.headerContentNode);var _69=_26.map(_68,function(c,_6a){var w=c.style.width;_30.attr(c,"vIdx",_6a);if(w&&w.slice(-1)=="%"){_67=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return _30.contentBox(c).w;});if(_67){_26.forEach(this.grid.layout.cells,function(_6b,idx){if(_6b.view==this){var _6c=_6b.view.getHeaderCellNode(_6b.index);if(_6c&&_30.hasAttr(_6c,"vIdx")){var _6d=window.parseInt(_30.attr(_6c,"vIdx"));this.setColWidth(idx,_69[_6d]);_30.removeAttr(_6c,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_6e){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var _6f=this;var _70=function(){var v;for(var i in _6f.grid.views.views){v=_6f.grid.views.views[i];if(v!==_6f&&v.hasHScrollbar()){return true;}}return false;};if(_6e||(this.noscroll&&_70())){h-=_2e.getScrollbar().h;}_2f.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_71){var _72=this.createRowNode(_71);this.buildRow(_71,_72);return _72;},createRowNode:function(_73){var _74=document.createElement("div");_74.className=this.classTag+"Row";if(this instanceof _24.grid._RowSelector){_30.attr(_74,"role","presentation");}else{_30.attr(_74,"role","row");if(this.grid.selectionMode!="none"){_74.setAttribute("aria-selected","false");}}_74[_2f.gridViewTag]=this.id;_74[_2f.rowIndexTag]=_73;this.rowNodes[_73]=_74;return _74;},buildRow:function(_75,_76){this.buildRowContent(_75,_76);this.styleRow(_75,_76);},buildRowContent:function(_77,_78){_78.innerHTML=this.content.generateHtml(_77,_77);if(this.flexCells&&this.contentWidth){_78.firstChild.style.width=this.contentWidth;}_2f.fire(this,"onAfterRow",[_77,this.structure.cells,_78]);},rowRemoved:function(_79){if(_79>=0){this._cleanupRowWidgets(this.getRowNode(_79));}this.grid.edit.save(this,_79);delete this.rowNodes[_79];},getRowNode:function(_7a){return this.rowNodes[_7a];},getCellNode:function(_7b,_7c){var row=this.getRowNode(_7b);if(row){return this.content.getCellNode(row,_7c);}},getHeaderCellNode:function(_7d){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_7d);}},styleRow:function(_7e,_7f){_7f._style=_34(_7f);this.styleRowNode(_7e,_7f);},styleRowNode:function(_80,_81){if(_81){this.doStyleRowNode(_80,_81);}},doStyleRowNode:function(_82,_83){this.grid.styleRowNode(_82,_83);},updateRow:function(_84){var _85=this.getRowNode(_84);if(_85){_85.style.height="";this.buildRow(_84,_85);}return _85;},updateRowStyles:function(_86){this.styleRowNode(_86,this.getRowNode(_86));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_87){if(has("ff")>=13){this._nativeScroll=true;}var _88=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_88&&this.firstScroll==1)||(_88&&this.firstScroll===0)){var s=_30.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_88?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_89){this.lastTop=_89;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_89;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_8a,_8b){this.grid.setCellWidth(_8a,_8b+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var _8c=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=_8c;this.headerNode.scrollLeft=_8c;}});var _8d=_25("dojox.grid._GridAvatar",_32,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _8e=this.manager.source,_8f;if(_8e.creator){_8f=_8e._normalizedCreator(_8e.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{_8f=this.manager.nodes[0].cloneNode(true);var _90,_91;if(_8f.tagName.toLowerCase()=="tr"){_90=dd.createElement("table");_91=dd.createElement("tbody");_91.appendChild(_8f);_90.appendChild(_91);_8f=_90;}else{if(_8f.tagName.toLowerCase()=="th"){_90=dd.createElement("table");_91=dd.createElement("tbody");var r=dd.createElement("tr");_90.cellPadding=_90.cellSpacing="0";r.appendChild(_8f);_91.appendChild(r);_90.appendChild(_91);_8f=_90;}}}_8f.id="";td.appendChild(_8f);tr.appendChild(img);tr.appendChild(td);_30.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_33.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_33.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _92=_33.manager().makeAvatar;_33.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!_30.hasClass(win.body(),"dijit_a11y")){return new _8d(this);}return _92.call(_33.manager());};return _37;});},"esri/toolbars/_Box":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/matrix","esri/kernel","esri/lang","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/webMercatorUtils","esri/geometry/jsonUtils","esri/graphic"],function(_93,_94,_95,_96,has,_97,_98,_99,_9a,_9b,_9c,_9d,_9e,_9f,_a0){var BOX=_93(null,{declaredClass:"esri.toolbars._Box",constructor:function(_a1,map,_a2,_a3,_a4,_a5){this._graphic=_a1;this._map=map;this._toolbar=_a2;this._scale=_a3;this._rotate=_a4;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_a5;var _a6=_a2._options;this._markerSymbol=_a6.boxHandleSymbol;this._lineSymbol=_a6.boxLineSymbol;this._moveStartHandler=_94.hitch(this,this._moveStartHandler);this._firstMoveHandler=_94.hitch(this,this._firstMoveHandler);this._moveStopHandler=_94.hitch(this,this._moveStopHandler);this._moveHandler=_94.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){_95.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){_95.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){_95.forEach(this._connects,_96.disconnect);}var _a7=this._toolbar._scratchGL;if(this._anchors){_95.forEach(this._anchors,function(_a8){_a7.remove(_a8.graphic);var mov=_a8.moveable;if(mov){mov.destroy();}});}if(this._box){_a7.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_a9=this._toolbar._scratchGL;var _aa=this._getBoxCoords();var _ab=new _9d(map.spatialReference);var _ac=_94.clone(_95.filter(_aa,function(pt,_ad){return (_ad!==8&&_ad%2===0);}));if(_ac[0]){_ac.push([_ac[0][0],_ac[0][1]]);}_ab.addPath(_ac);if(this._rotate){_ab.addPath([_aa[1],_aa[8]]);}if(this._box){this._box.setGeometry(_ab);}else{this._box=new _a0(_ab,this._lineSymbol);_a9.add(this._box);}if(this._anchors){_95.forEach(this._anchors,function(_ae,_af){if(!this._scale){_af=8;}var _b0=new _9c(_aa[_af],map.spatialReference);_ae.graphic.setGeometry(_b0);var mov=_ae.moveable,_b1=_ae.graphic.getDojoShape();if(_b1){if(!mov){_ae.moveable=this._getMoveable(_ae.graphic,_af);}else{if(_b1!==mov.shape){mov.destroy();_ae.moveable=this._getMoveable(_ae.graphic,_af);}}}},this);}else{this._anchors=[];this._connects=[];_95.forEach(_aa,function(_b2,_b3){if(!this._scale&&_b3<8){return;}_b2=new _9c(_b2,map.spatialReference);var _b4=new _a0(_b2,this._markerSymbol);_a9.add(_b4);this._anchors.push({graphic:_b4,moveable:this._getMoveable(_b4,_b3)});},this);}},_getBoxCoords:function(_b5){var _b6=this._graphic,map=this._map,_b7=this._getTransformedBoundingBox(_b6),_b8=[],pt,_b9,_ba;_95.forEach(_b7,function(_bb,_bc,arr){pt=_bb;_b9=arr[_bc+1];if(!_b9){_b9=arr[0];}_ba={x:(pt.x+_b9.x)/2,y:(pt.y+_b9.y)/2};if(!_b5){pt=map.toMap(pt);_ba=map.toMap(_ba);}_b8.push([pt.x,pt.y]);_b8.push([_ba.x,_ba.y]);});if(this._rotate){var _bd=_94.clone(_b8[1]);_bd=_b5?{x:_bd[0],y:_bd[1]}:map.toScreen({x:_bd[0],y:_bd[1],spatialReference:map.spatialReference});_bd.y-=this._toolbar._options.rotateHandleOffset;if(!_b5){_bd=map.toMap(_bd);}_b8.push([_bd.x,_bd.y]);}return _b8;},_getTransformedBoundingBox:function(_be){var map=this._map,_bf=_be.geometry.getExtent(),_c0=_be.geometry.spatialReference,_c1=new _9c(_bf.xmin,_bf.ymax,_c0),_c2=new _9c(_bf.xmax,_bf.ymin,_c0);_c1=map.toScreen(_c1);_c2=map.toScreen(_c2);return [{x:_c1.x,y:_c1.y},{x:_c2.x,y:_c1.y},{x:_c2.x,y:_c2.y},{x:_c1.x,y:_c2.y}];},_getAllGraphics:function(){var _c3=[this._box];if(this._anchors){_95.forEach(this._anchors,function(_c4){_c3.push(_c4.graphic);});}_c3=_95.filter(_c3,_9b.isDefined);return _c3;},_getMoveable:function(_c5,_c6){var _c7=_c5.getDojoShape();if(!_c7){return;}var _c8=new _98(_c7);_c8._index=_c6;this._connects.push(_96.connect(_c8,"onMoveStart",this._moveStartHandler));this._connects.push(_96.connect(_c8,"onFirstMove",this._firstMoveHandler));this._connects.push(_96.connect(_c8,"onMoveStop",this._moveStopHandler));_c8.onMove=this._moveHandler;var _c9=_c7.getEventSource();if(_c9){_97.set(_c9,"cursor",this._toolbar._cursors["box"+_c6]);}return _c8;},_moveStartHandler:function(_ca){this._toolbar["on"+(_ca.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_cb){var _cc=_cb.host._index,_cd=(this._wrapOffset=_cb.host.shape._wrapOffsets[0]||0),_ce=this._graphic.getLayer()._div.getTransform(),mx=_99,_cf,_d0,_d1,_d2=_95.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_cd,y:arr[1]};});_d1={x:_d2[1].x,y:_d2[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_ce),_d1);if(_cc===8){_cf=mx.multiplyPoint(mx.invert(_ce),_d2[1]);this._startLine=[this._centerCoord,_cf];this._moveLine=_94.clone(this._startLine);}else{_cf=mx.multiplyPoint(mx.invert(_ce),_d2[_cc]);_d0=mx.multiplyPoint(mx.invert(_ce),_d2[(_cc+4)%8]);this._firstMoverToCenter=Math.sqrt((_cf.x-this._centerCoord.x)*(_cf.x-this._centerCoord.x)+(_cf.y-this._centerCoord.y)*(_cf.y-this._centerCoord.y));this._startBox=_d0;this._startBox.width=(_d2[4].x-_d2[0].x);this._startBox.height=(_d2[4].y-_d2[0].y);this._moveBox=_94.clone(this._startBox);this._xfactor=_cf.x>_d0.x?1:-1;this._yfactor=_cf.y>_d0.y?1:-1;if(_cc===1||_cc===5){this._xfactor=0;}else{if(_cc===3||_cc===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_cc===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_d3,_d4){var _d5=_d3.host._index,_d6=this._defaultEventArgs,_d7,_d8,tx,pt,_d9,_da,_db,_dc=0,_dd=0,_de,_df,_e0;_d6.angle=0;_d6.scaleX=1;_d6.scaleY=1;if(_d5===8){_d7=this._startLine;_d8=this._moveLine;pt=_d8[1];pt.x+=_d4.dx;pt.y+=_d4.dy;_d9=this._getAngle(_d7,_d8);tx=_99.rotategAt(_d9,_d7[0]);this._graphic.getDojoShape().setTransform(tx);_d6.transform=tx;_d6.angle=_d9;_d6.around=_d7[0];}else{_d7=this._startBox;_d8=this._moveBox;_d8.width+=(_d4.dx*this._xfactor);_d8.height+=(_d4.dy*this._yfactor);if(this._uniformScaling){_de=_d8.x+this._xfactor*_d8.width;_df=_d8.y+this._yfactor*_d8.height;_e0=Math.sqrt((_de-this._centerCoord.x)*(_de-this._centerCoord.x)+(_df-this._centerCoord.y)*(_df-this._centerCoord.y));_da=_db=_e0/this._firstMoverToCenter;_dc=this._xfactor*_d7.width/2;_dd=this._yfactor*_d7.height/2;}else{_da=_d8.width/_d7.width;_db=_d8.height/_d7.height;}if(isNaN(_da)||_da===Infinity||_da===-Infinity){_da=1;}if(isNaN(_db)||_db===Infinity||_db===-Infinity){_db=1;}tx=_99.scaleAt(_da,_db,_d7.x+_dc,_d7.y+_dd);this._graphic.getDojoShape().setTransform(tx);_d6.transform=tx;_d6.scaleX=_da;_d6.scaleY=_db;_d6.around={x:_d7.x+_dc,y:_d7.y+_dd};}this._toolbar["on"+(_d5===8?this._rotateEvent:this._scaleEvent)](this._graphic,_d6);},_moveStopHandler:function(_e1){var _e2=this._graphic,_e3=this._toolbar,_e4=_e3._geo?_9e.geographicToWebMercator(_e2.geometry):_e2.geometry,_e5=_e4.spatialReference,_e6=_e2.getDojoShape(),_e7=_e6.getTransform(),_e8=_e2.getLayer()._div.getTransform();_e4=_e4.toJson();this._updateSegments(_e4.paths||_e4.rings,_e7,_e8,_e5);_e6.setTransform(null);_e4=_9f.fromJson(_e4);_e2.setGeometry(_e3._geo?_9e.webMercatorToGeographic(_e4,true):_e4);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_e3._endOperation("BOX");this._defaultEventArgs.transform=_e7;_e3["on"+(_e1.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_e9,_ea,_eb,_ec){var mx=_99,map=this._map,_ed=this._wrapOffset||0;_95.forEach(_e9,function(_ee){_95.forEach(_ee,function(_ef){var _f0=map.toScreen({x:_ef[0],y:_ef[1],spatialReference:_ec},true);_f0.x+=_ed;_f0=mx.multiplyPoint([_eb,_ea,mx.invert(_eb)],_f0);_f0.x-=_ed;var _f1=map.toMap(_f0);_ef[0]=_f1.x;_ef[1]=_f1.y;});});},_getAngle:function(_f2,_f3){var _f4=Math.atan2(_f2[0].y-_f2[1].y,_f2[0].x-_f2[1].x)*180/Math.PI,_f5=Math.atan2(_f3[0].y-_f3[1].y,_f3[0].x-_f3[1].x)*180/Math.PI;return _f5-_f4;}});if(has("extend-esri")){_94.setObject("toolbars._Box",BOX,_9a);}return BOX;});},"esri/dijit/editing/TemplatePickerItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/sniff","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojox/gfx","esri/symbols/jsonUtils","esri/kernel"],function(_f6,_f7,_f8,has,_f9,_fa,_fb,_fc,gfx,_fd,_fe){var TPI=_f6([_fb,_fc],{declaredClass:"esri.dijit.editing.TemplatePickerItem",templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(_ff,_100,_101,_102,_103){if(!_100){return;}var _104=gfx.createSurface(_ff,_101,_102);if(has("ie")<9){var _105=_104.getEventSource();_fa.set(_105,"position","relative");_fa.set(_105.parentNode,"position","relative");}var _106=(!this.legendOverride&&this._getDrawingToolShape(_100,_103))||_fd.getShapeDescriptors(_100);var _107;try{_107=_104.createShape(_106.defaultShape).setFill(_106.fill).setStroke(_106.stroke);}catch(e){_104.clear();_104.destroy();return;}var bbox=_107.getBoundingBox(),_108=bbox.width,_109=bbox.height,_10a=-(bbox.x+(_108/2)),_10b=-(bbox.y+(_109/2)),dim=_104.getDimensions(),_10c={dx:_10a+dim.width/2,dy:_10b+dim.height/2};if(_108>_101||_109>_102){var _10d=_108>_109?_108:_109;var _10e=_101<_102?_101:_102;var _10f=(_10e-5)/_10d;_f7.mixin(_10c,{xx:_10f,yy:_10f});}_107.applyTransform(_10c);return _104;},_getDrawingToolShape:function(_110,_111){var _112,_113=_111?_111.drawingTool||null:null;switch(_113){case "esriFeatureEditToolArrow":_112={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_112={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_112={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_112={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_112={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_112={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_112={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_112={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_112={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_110.type==="simplelinesymbol"||_110.type==="cartographiclinesymbol"){_112={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_112={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_112,fill:_110.getFill(),stroke:_110.getStroke()};},_repaint:function(_114){if(!_114){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_114.getStroke&&_114.setStroke){_114.setStroke(_114.getStroke());}if(_114.getFill&&_114.setFill){_114.setFill(_114.getFill());}if(_114.children&&_f7.isArray(_114.children)){_f8.forEach(_114.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});if(has("extend-esri")){_f7.setObject("dijit.editing.TemplatePickerItem",TPI,_fe);}return TPI;});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_115,_116,_117,_118,lang,dom,_119,_11a,_11b,on,_11c,dnd,_11d){var _11e=_116("dojo.dnd.Selector",_11d,{constructor:function(node,_11f){if(!_11f){_11f={};}this.singular=_11f.singular;this.autoSync=_11f.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_11c.press,lang.hitch(this,"onMouseDown")),on(this.node,_11c.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _11b();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_119.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_118.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_11e.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_115.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_120,data,_121,_122){var _123=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_123.call(this,item,hint);if(_120){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_11e.superclass.insertNodes.call(this,data,_121,_122);this._normalizedCreator=_123;return this;},destroy:function(){_11e.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_11a.isLeft(e)){_117.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_117.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_11c.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _11e;});},"dojo/parser":function(){define(["require","./_base/kernel","./_base/lang","./_base/array","./_base/config","./_base/html","./_base/window","./_base/url","./_base/json","./aspect","./date/stamp","./Deferred","./has","./query","./on","./ready"],function(_124,dojo,_125,_126,_127,_128,_129,_12a,_12b,_12c,_12d,_12e,has,_12f,don,_130){new Date("X");var _131=0;_12c.after(_125,"extend",function(){_131++;},true);function _132(ctor){var map=ctor._nameCaseMap,_133=ctor.prototype;if(!map||map._extendCnt<_131){map=ctor._nameCaseMap={};for(var name in _133){if(name.charAt(0)==="_"){continue;}map[name.toLowerCase()]=name;}map._extendCnt=_131;}return map;};var _134={};function _135(_136){var ts=_136.join();if(!_134[ts]){var _137=[];for(var i=0,l=_136.length;i<l;i++){var t=_136[i];_137[_137.length]=(_134[t]=_134[t]||(_125.getObject(t)||(~t.indexOf("/")&&_124(t))));}var ctor=_137.shift();_134[ts]=_137.length?(ctor.createSubclass?ctor.createSubclass(_137):ctor.extend.apply(ctor,_137)):ctor;}return _134[ts];};var _138={_clearCache:function(){_131++;_134={};},_functionFromScript:function(_139,_13a){var _13b="",_13c="",_13d=(_139.getAttribute(_13a+"args")||_139.getAttribute("args")),_13e=_139.getAttribute("with");var _13f=(_13d||"").split(/\s*,\s*/);if(_13e&&_13e.length){_126.forEach(_13e.split(/\s*,\s*/),function(part){_13b+="with("+part+"){";_13c+="}";});}return new Function(_13f,_13b+_139.innerHTML+_13c);},instantiate:function(_140,_141,_142){_141=_141||{};_142=_142||{};var _143=(_142.scope||dojo._scopeName)+"Type",_144="data-"+(_142.scope||dojo._scopeName)+"-",_145=_144+"type",_146=_144+"mixins";var list=[];_126.forEach(_140,function(node){var type=_143 in _141?_141[_143]:node.getAttribute(_145)||node.getAttribute(_143);if(type){var _147=node.getAttribute(_146),_148=_147?[type].concat(_147.split(/\s*,\s*/)):[type];list.push({node:node,types:_148});}});return this._instantiate(list,_141,_142);},_instantiate:function(_149,_14a,_14b){var _14c=_126.map(_149,function(obj){var ctor=obj.ctor||_135(obj.types);if(!ctor){throw new Error("Unable to resolve constructor for: '"+obj.types.join()+"'");}return this.construct(ctor,obj.node,_14a,_14b,obj.scripts,obj.inherited);},this);if(!_14a._started&&!_14b.noStart){_126.forEach(_14c,function(_14d){if(typeof _14d.startup==="function"&&!_14d._started){_14d.startup();}});}return _14c;},construct:function(ctor,node,_14e,_14f,_150,_151){var _152=ctor&&ctor.prototype;_14f=_14f||{};var _153={};if(_14f.defaults){_125.mixin(_153,_14f.defaults);}if(_151){_125.mixin(_153,_151);}var _154;if(has("dom-attributes-explicit")){_154=node.attributes;}else{if(has("dom-attributes-specified-flag")){_154=_126.filter(node.attributes,function(a){return a.specified;});}else{var _155=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false),_156=_155.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,"");_154=_126.map(_156.split(/\s+/),function(name){var _157=name.toLowerCase();return {name:name,value:(node.nodeName=="LI"&&name=="value")||_157=="enctype"?node.getAttribute(_157):node.getAttributeNode(_157).value};});}}var _158=_14f.scope||dojo._scopeName,_159="data-"+_158+"-",hash={};if(_158!=="dojo"){hash[_159+"props"]="data-dojo-props";hash[_159+"type"]="data-dojo-type";hash[_159+"mixins"]="data-dojo-mixins";hash[_158+"type"]="dojoType";hash[_159+"id"]="data-dojo-id";}var i=0,item,_15a=[],_15b,_15c;while(item=_154[i++]){var name=item.name,_15d=name.toLowerCase(),_15e=item.value;switch(hash[_15d]||_15d){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":_15c=_15e;break;case "data-dojo-id":case "jsid":_15b=_15e;break;case "data-dojo-attach-point":case "dojoattachpoint":_153.dojoAttachPoint=_15e;break;case "data-dojo-attach-event":case "dojoattachevent":_153.dojoAttachEvent=_15e;break;case "class":_153["class"]=node.className;break;case "style":_153["style"]=node.style&&node.style.cssText;break;default:if(!(name in _152)){var map=_132(ctor);name=map[_15d]||name;}if(name in _152){switch(typeof _152[name]){case "string":_153[name]=_15e;break;case "number":_153[name]=_15e.length?Number(_15e):NaN;break;case "boolean":_153[name]=_15e.toLowerCase()!="false";break;case "function":if(_15e===""||_15e.search(/[^\w\.]+/i)!=-1){_153[name]=new Function(_15e);}else{_153[name]=_125.getObject(_15e,false)||new Function(_15e);}_15a.push(name);break;default:var pVal=_152[name];_153[name]=(pVal&&"length" in pVal)?(_15e?_15e.split(/\s*,\s*/):[]):(pVal instanceof Date)?(_15e==""?new Date(""):_15e=="now"?new Date():_12d.fromISOString(_15e)):(pVal instanceof _12a)?(dojo.baseUrl+_15e):_12b.fromJson(_15e);}}else{_153[name]=_15e;}}}for(var j=0;j<_15a.length;j++){var _15f=_15a[j].toLowerCase();node.removeAttribute(_15f);node[_15f]=null;}if(_15c){try{_15c=_12b.fromJson.call(_14f.propsThis,"{"+_15c+"}");_125.mixin(_153,_15c);}catch(e){throw new Error(e.toString()+" in data-dojo-props='"+_15c+"'");}}_125.mixin(_153,_14e);if(!_150){_150=(ctor&&(ctor._noScript||_152._noScript)?[]:_12f("> script[type^='dojo/']",node));}var _160=[],_161=[],_162=[],ons=[];if(_150){for(i=0;i<_150.length;i++){var _163=_150[i];node.removeChild(_163);var _164=(_163.getAttribute(_159+"event")||_163.getAttribute("event")),prop=_163.getAttribute(_159+"prop"),_165=_163.getAttribute(_159+"method"),_166=_163.getAttribute(_159+"advice"),_167=_163.getAttribute("type"),nf=this._functionFromScript(_163,_159);if(_164){if(_167=="dojo/connect"){_160.push({method:_164,func:nf});}else{if(_167=="dojo/on"){ons.push({event:_164,func:nf});}else{_153[_164]=nf;}}}else{if(_167=="dojo/aspect"){_160.push({method:_165,advice:_166,func:nf});}else{if(_167=="dojo/watch"){_162.push({prop:prop,func:nf});}else{_161.push(nf);}}}}}var _168=ctor.markupFactory||_152.markupFactory;var _169=_168?_168(_153,node,ctor):new ctor(_153,node);if(_15b){_125.setObject(_15b,_169);}for(i=0;i<_160.length;i++){_12c[_160[i].advice||"after"](_169,_160[i].method,_125.hitch(_169,_160[i].func),true);}for(i=0;i<_161.length;i++){_161[i].call(_169);}for(i=0;i<_162.length;i++){_169.watch(_162[i].prop,_162[i].func);}for(i=0;i<ons.length;i++){don(_169,ons[i].event,ons[i].func);}return _169;},scan:function(root,_16a){var list=[],mids=[],_16b={};var _16c=(_16a.scope||dojo._scopeName)+"Type",_16d="data-"+(_16a.scope||dojo._scopeName)+"-",_16e=_16d+"type",_16f=_16d+"textdir",_170=_16d+"mixins";var node=root.firstChild;var _171=_16a.inherited;if(!_171){function _172(node,attr){return (node.getAttribute&&node.getAttribute(attr))||(node.parentNode&&_172(node.parentNode,attr));};_171={dir:_172(root,"dir"),lang:_172(root,"lang"),textDir:_172(root,_16f)};for(var key in _171){if(!_171[key]){delete _171[key];}}}var _173={inherited:_171};var _174;var _175;function _176(_177){if(!_177.inherited){_177.inherited={};var node=_177.node,_178=_176(_177.parent);var _179={dir:node.getAttribute("dir")||_178.dir,lang:node.getAttribute("lang")||_178.lang,textDir:node.getAttribute(_16f)||_178.textDir};for(var key in _179){if(_179[key]){_177.inherited[key]=_179[key];}}}return _177.inherited;};while(true){if(!node){if(!_173||!_173.node){break;}node=_173.node.nextSibling;_175=false;_173=_173.parent;_174=_173.scripts;continue;}if(node.nodeType!=1){node=node.nextSibling;continue;}if(_174&&node.nodeName.toLowerCase()=="script"){type=node.getAttribute("type");if(type&&/^dojo\/\w/i.test(type)){_174.push(node);}node=node.nextSibling;continue;}if(_175){node=node.nextSibling;continue;}var type=node.getAttribute(_16e)||node.getAttribute(_16c);var _17a=node.firstChild;if(!type&&(!_17a||(_17a.nodeType==3&&!_17a.nextSibling))){node=node.nextSibling;continue;}var _17b;var ctor=null;if(type){var _17c=node.getAttribute(_170),_17d=_17c?[type].concat(_17c.split(/\s*,\s*/)):[type];try{ctor=_135(_17d);}catch(e){}if(!ctor){_126.forEach(_17d,function(t){if(~t.indexOf("/")&&!_16b[t]){_16b[t]=true;mids[mids.length]=t;}});}var _17e=ctor&&!ctor.prototype._noScript?[]:null;_17b={types:_17d,ctor:ctor,parent:_173,node:node,scripts:_17e};_17b.inherited=_176(_17b);list.push(_17b);}else{_17b={node:node,scripts:_174,parent:_173};}node=_17a;_174=_17e;_175=ctor&&ctor.prototype.stopParser&&!(_16a.template);_173=_17b;}var d=new _12e();if(mids.length){if(has("dojo-debug-messages")){console.warn("WARNING: Modules being Auto-Required: "+mids.join(", "));}_124(mids,function(){d.resolve(_126.filter(list,function(_17f){if(!_17f.ctor){try{_17f.ctor=_135(_17f.types);}catch(e){}}var _180=_17f.parent;while(_180&&!_180.types){_180=_180.parent;}var _181=_17f.ctor&&_17f.ctor.prototype;_17f.instantiateChildren=!(_181&&_181.stopParser&&!(_16a.template));_17f.instantiate=!_180||(_180.instantiate&&_180.instantiateChildren);return _17f.instantiate;}));});}else{d.resolve(list);}return d.promise;},_require:function(_182){var hash=_12b.fromJson("{"+_182.innerHTML+"}"),vars=[],mids=[],d=new _12e();for(var name in hash){vars.push(name);mids.push(hash[name]);}_124(mids,function(){for(var i=0;i<vars.length;i++){_125.setObject(vars[i],arguments[i]);}d.resolve(arguments);});return d.promise;},_scanAmd:function(root){var _183=new _12e(),_184=_183.promise;_183.resolve(true);var self=this;_12f("script[type='dojo/require']",root).forEach(function(node){_184=_184.then(function(){return self._require(node);});node.parentNode.removeChild(node);});return _184;},parse:function(_185,_186){var root;if(!_186&&_185&&_185.rootNode){_186=_185;root=_186.rootNode;}else{if(_185&&_125.isObject(_185)&&!("nodeType" in _185)){_186=_185;}else{root=_185;}}root=root?_128.byId(root):_129.body();_186=_186||{};var _187=_186.template?{template:true}:{},_188=[],self=this;var p=this._scanAmd(root,_186).then(function(){return self.scan(root,_186);}).then(function(_189){return _188=_188.concat(self._instantiate(_189,_187,_186));}).otherwise(function(e){console.error("dojo/parser::parse() error",e);throw e;});_125.mixin(_188,p);return _188;}};if(1){dojo.parser=_138;}if(_127.parseOnLoad){_130(100,_138,"parse");}return _138;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_18a,_18b,_18c){return _18a("dojox.grid.DataSelection",_18c,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _18b(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_18c.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_18d){var _18e=this.grid.getItemIndex(_18d);var idx=_18c.prototype.getNextSelected.call(this,_18e);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _18f=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_18f.push(this.grid.getItem(i));}}return _18f;},addToSelection:function(_190){if(this.mode=="none"){return;}var idx=null;if(typeof _190=="number"||typeof _190=="string"){idx=_190;}else{idx=this.grid.getItemIndex(_190);}_18c.prototype.addToSelection.call(this,idx);},deselect:function(_191){if(this.mode=="none"){return;}var idx=null;if(typeof _191=="number"||typeof _191=="string"){idx=_191;}else{idx=this.grid.getItemIndex(_191);}_18c.prototype.deselect.call(this,idx);},deselectAll:function(_192){var idx=null;if(_192||typeof _192=="number"){if(typeof _192=="number"||typeof _192=="string"){idx=_192;}else{idx=this.grid.getItemIndex(_192);}_18c.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"dijit/_Container":function(){define("dijit/_Container",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct"],function(_193,_194,_195){return _194("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_196,_197){var _198=this.containerNode;if(_197&&typeof _197=="number"){var _199=this.getChildren();if(_199&&_199.length>=_197){_198=_199[_197-1].domNode;_197="after";}}_195.place(_196.domNode,_198,_197);if(this._started&&!_196._started){_196.startup();}},removeChild:function(_19a){if(typeof _19a=="number"){_19a=this.getChildren()[_19a];}if(_19a){var node=_19a.domNode;if(node&&node.parentNode){node.parentNode.removeChild(node);}}},hasChildren:function(){return this.getChildren().length>0;},_getSiblingOfChild:function(_19b,dir){var _19c=this.getChildren(),idx=_193.indexOf(this.getChildren(),_19b);return _19c[idx+dir];},getIndexOfChild:function(_19d){return _193.indexOf(this.getChildren(),_19d);}});});},"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_19e,_19f,_1a0,lang,win,_1a1,_1a2,has,keys,on,_1a3,_1a4,dnd,_1a5,_1a6){var _1a7=_19f("dojo.dnd.Manager",[_1a2],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_1a8){if(this.avatar){this.target=(_1a8&&_1a8.targetState!="Disabled")?_1a8:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_1a3.publish("/dnd/source/over",_1a8);},outSource:function(_1a9){if(this.avatar){if(this.target==_1a9){this.target=null;this.canDropFlag=false;this.avatar.update();_1a3.publish("/dnd/source/over",null);}}else{_1a3.publish("/dnd/source/over",null);}},startDrag:function(_1aa,_1ab,copy){_1a5.autoScrollStart(win.doc);this.source=_1aa;this.nodes=_1ab;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_1a3.publish("/dnd/start",_1aa,_1ab,this.copy);this.events=[on(win.doc,_1a4.move,lang.hitch(this,"onMouseMove")),on(win.doc,_1a4.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_1a0.stop),on(win.body(),"selectstart",_1a0.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_1a1.add(win.body(),c);},canDrop:function(flag){var _1ac=Boolean(this.target&&flag);if(this.canDropFlag!=_1ac){this.canDropFlag=_1ac;this.avatar.update();}},stopDrag:function(){_1a1.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_19e.forEach(this.events,function(_1ad){_1ad.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _1a6(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_1a5.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_1a3.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_1a3.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_1a3.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_1a3.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_1a1.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_1a7.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _1a7();}return dnd._manager;};return _1a7;});},"dijit/a11yclick":function(){define("dijit/a11yclick",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/has","dojo/_base/unload","dojo/_base/window"],function(on,_1ae,keys,_1af,has,_1b0,win){var _1b1=null;if(has("dom-addeventlistener")){win.doc.addEventListener("keydown",function(evt){_1b1=evt.target;},true);}else{(function(){var _1b2=function(evt){_1b1=evt.srcElement;};win.doc.attachEvent("onkeydown",_1b2);_1b0.addOnWindowUnload(function(){win.doc.detachEvent("onkeydown",_1b2);});})();}function _1b3(e){return (e.keyCode===keys.ENTER||e.keyCode===keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey;};return function(node,_1b4){if(/input|button/i.test(node.nodeName)){return on(node,"click",_1b4);}else{var _1b5=[on(node,"keydown",function(e){if(_1b3(e)){_1b1=e.target;e.preventDefault();}}),on(node,"keyup",function(e){if(_1b3(e)&&e.target==_1b1){_1b1=null;on.emit(e.target,"click",{cancelable:true,bubbles:true});}}),on(node,"click",function(e){_1b4.call(this,e);})];if(has("touch")){var _1b6;_1b5.push(on(node,"touchend",function(e){var _1b7=e.target;_1b6=setTimeout(function(){_1b6=null;on.emit(_1b7,"click",{cancelable:true,bubbles:true});},600);}),on(node,"click",function(e){if(_1b6){clearTimeout(_1b6);}}));}return {remove:function(){_1ae.forEach(_1b5,function(h){h.remove();});if(_1b6){clearTimeout(_1b6);_1b6=null;}}};}};return ret;});},"esri/toolbars/draw":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Color","dojo/_base/window","dojo/has","dojo/keys","dojo/dom-construct","dojo/dom-style","esri/kernel","esri/sniff","esri/toolbars/_toolbar","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/graphic","esri/geometry/jsonUtils","esri/geometry/webMercatorUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/geometry/Multipoint","esri/geometry/Rect","dojo/i18n!esri/nls/jsapi"],function(_1b8,lang,_1b9,_1ba,_1bb,win,has,keys,_1bc,_1bd,_1be,_1bf,_1c0,_1c1,_1c2,_1c3,_1c4,_1c5,_1c6,_1c7,_1c8,_1c9,Rect,_1ca){var DRAW=_1b8(_1c0,{declaredClass:"esri.toolbars.Draw",constructor:function(map,_1cb){this.markerSymbol=new _1c1(_1c1.STYLE_SOLID,10,new _1c2(_1c2.STYLE_SOLID,new _1bb([255,0,0]),2),new _1bb([0,0,0,0.25]));this.lineSymbol=new _1c2(_1c2.STYLE_SOLID,new _1bb([255,0,0]),2);this.fillSymbol=new _1c3(_1c3.STYLE_SOLID,new _1c2(_1c2.STYLE_SOLID,new _1bb([255,0,0]),2),new _1bb([0,0,0,0.25]));this._points=[];this._defaultOptions={showTooltips:true,drawTime:75,tolerance:8,tooltipOffset:15};this._options=lang.mixin(lang.mixin({},this._defaultOptions),_1cb||{});this._mouse=!has("esri-touch")&&!has("esri-pointer");if(!this._mouse){this._options.showTooltips=false;}this._onKeyDownHandler=lang.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=lang.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=lang.hitch(this,this._onMouseUpHandler);this._onClickHandler=lang.hitch(this,this._onClickHandler);this._onMouseMoveHandler=lang.hitch(this,this._onMouseMoveHandler);this._onMouseDragHandler=lang.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=lang.hitch(this,this._onDblClickHandler);this._updateTooltip=lang.hitch(this,this._updateTooltip);this._hideTooltip=lang.hitch(this,this._hideTooltip);this._redrawGraphic=lang.hitch(this,this._redrawGraphic);},_geometryType:null,respectDrawingVertexOrder:false,setRespectDrawingVertexOrder:function(set){this.respectDrawingVertexOrder=set;},setMarkerSymbol:function(_1cc){this.markerSymbol=_1cc;},setLineSymbol:function(_1cd){this.lineSymbol=_1cd;},setFillSymbol:function(_1ce){this.fillSymbol=_1ce;},activate:function(_1cf,_1d0){if(this._geometryType){this.deactivate();}var map=this.map,dc=_1ba.connect,Draw=DRAW;this._options=lang.mixin(lang.mixin({},this._options),_1d0||{});map.navigationManager.setImmediateClick(false);switch(_1cf){case Draw.ARROW:case Draw.LEFT_ARROW:case Draw.RIGHT_ARROW:case Draw.UP_ARROW:case Draw.DOWN_ARROW:case Draw.TRIANGLE:case Draw.CIRCLE:case Draw.ELLIPSE:case Draw.RECTANGLE:this._deactivateMapTools(true,false,false,true);this._onClickHandler_connect=dc(map,"onClick",this._onClickHandler);this._onMouseDownHandler_connect=dc(map,!this._mouse?"onSwipeStart":"onMouseDown",this._onMouseDownHandler);this._onMouseDragHandler_connect=dc(map,!this._mouse?"onSwipeMove":"onMouseDrag",this._onMouseDragHandler);this._onMouseUpHandler_connect=dc(map,!this._mouse?"onSwipeEnd":"onMouseUp",this._onMouseUpHandler);break;case Draw.POINT:this._onClickHandler_connect=dc(map,"onClick",this._onClickHandler);break;case Draw.LINE:case Draw.EXTENT:case Draw.FREEHAND_POLYLINE:case Draw.FREEHAND_POLYGON:this._deactivateMapTools(true,false,false,true);this._onMouseDownHandler_connect=dc(map,!this._mouse?"onSwipeStart":"onMouseDown",this._onMouseDownHandler);this._onMouseDragHandler_connect=dc(map,!this._mouse?"onSwipeMove":"onMouseDrag",this._onMouseDragHandler);this._onMouseUpHandler_connect=dc(map,!this._mouse?"onSwipeEnd":"onMouseUp",this._onMouseUpHandler);break;case Draw.POLYLINE:case Draw.POLYGON:case Draw.MULTI_POINT:map.navigationManager.setImmediateClick(true);this._onClickHandler_connect=dc(map,"onClick",this._onClickHandler);this._onDblClickHandler_connect=dc(map,"onDblClick",this._onDblClickHandler);map.disableDoubleClickZoom();break;default:console.error("Unsupported geometry type: "+_1cf);return;}this._onKeyDown_connect=dc(map,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=dc(map,"onExtentChange",this._redrawGraphic);this._geometryType=_1cf;this._toggleTooltip(true);if(map.snappingManager&&this._geometryType!=="freehandpolyline"&&this._geometryType!=="freehandpolygon"&&this._mouse){map.snappingManager._startSelectionLayerQuery();map.snappingManager._setUpSnapping();}this.onActivate(this._geometryType);},deactivate:function(){var map=this.map;this._clear();var ddc=_1ba.disconnect;ddc(this._onMouseDownHandler_connect);ddc(this._onMouseMoveHandler_connect);ddc(this._onMouseDragHandler_connect);ddc(this._onMouseUpHandler_connect);ddc(this._onClickHandler_connect);ddc(this._onDblClickHandler_connect);ddc(this._onKeyDown_connect);ddc(this._redrawConnect);this._onMouseDownHandler_connect=this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null;if(map.snappingManager){map.snappingManager._stopSelectionLayerQuery();map.snappingManager._killOffSnapping();}switch(this._geometryType){case DRAW.CIRCLE:case DRAW.ELLIPSE:case DRAW.TRIANGLE:case DRAW.ARROW:case DRAW.LEFT_ARROW:case DRAW.RIGHT_ARROW:case DRAW.UP_ARROW:case DRAW.DOWN_ARROW:case DRAW.RECTANGLE:case DRAW.LINE:case DRAW.EXTENT:case DRAW.FREEHAND_POLYLINE:case DRAW.FREEHAND_POLYGON:this._activateMapTools(true,false,false,true);break;case this.POLYLINE:case this.POLYGON:case this.MULTI_POINT:map.enableDoubleClickZoom();break;}var _1d1=this._geometryType;this._geometryType=null;map.navigationManager.setImmediateClick(false);this._toggleTooltip(false);this.onDeactivate(_1d1);},_clear:function(){if(this._graphic){this.map.graphics.remove(this._graphic,true);}if(this._tGraphic){this.map.graphics.remove(this._tGraphic,true);}this._graphic=this._tGraphic=null;if(this.map.snappingManager){this.map.snappingManager._setGraphic(null);}this._points=[];},finishDrawing:function(){var _1d2,_1d3=this._points,map=this.map,_1d4=map.spatialReference,Draw=DRAW;_1d3=_1d3.slice(0,_1d3.length);switch(this._geometryType){case Draw.POLYLINE:if(!this._graphic||_1d3.length<2){return;}_1d2=new _1c7(_1d4);_1d2.addPath([].concat(_1d3));break;case Draw.POLYGON:if(!this._graphic||_1d3.length<3){return;}_1d2=new _1c8(_1d4);var ring=[].concat(_1d3,[_1d3[0].offset(0,0)]);if(!_1c8.prototype.isClockwise(ring)&&!this.respectDrawingVertexOrder){console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise.");ring.reverse();}_1d2.addRing(ring);break;case Draw.MULTI_POINT:_1d2=new _1c9(_1d4);_1b9.forEach(_1d3,function(pt){_1d2.addPoint(pt);});break;}_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(_1d2);},_drawEnd:function(_1d5){if(_1d5){var _1d6=this.map.spatialReference,geo;this.onDrawEnd(_1d5);if(_1d6){if(_1d6.isWebMercator()){geo=_1c6.webMercatorToGeographic(_1d5,true);}else{if(_1d6.wkid===4326){geo=_1c5.fromJson(_1d5.toJson());}}}this.onDrawComplete({geometry:_1d5,geographicGeometry:geo});}},_normalizeRect:function(_1d7,end,_1d8){var sx=_1d7.x,sy=_1d7.y,ex=end.x,ey=end.y,_1d9=Math.abs(sx-ex),_1da=Math.abs(sy-ey);return {x:Math.min(sx,ex),y:Math.max(sy,ey),width:_1d9,height:_1da,spatialReference:_1d8};},_onMouseDownHandler:function(evt){this._dragged=false;var _1db;if(this.map.snappingManager){_1db=this.map.snappingManager._snappingPoint;}var _1dc=_1db||evt.mapPoint,Draw=DRAW,map=this.map,_1dd=map.spatialReference;this._points.push(_1dc.offset(0,0));switch(this._geometryType){case Draw.LINE:this._graphic=map.graphics.add(new _1c4(new _1c7({paths:[[[_1dc.x,_1dc.y],[_1dc.x,_1dc.y]]],spatialReference:_1dd}),this.lineSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;case Draw.EXTENT:break;case Draw.FREEHAND_POLYLINE:this._oldPoint=evt.screenPoint;var _1de=new _1c7(_1dd);_1de.addPath(this._points);this._graphic=map.graphics.add(new _1c4(_1de,this.lineSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;case Draw.CIRCLE:case Draw.ELLIPSE:case Draw.TRIANGLE:case Draw.ARROW:case Draw.LEFT_ARROW:case Draw.RIGHT_ARROW:case Draw.UP_ARROW:case Draw.DOWN_ARROW:case Draw.RECTANGLE:case Draw.FREEHAND_POLYGON:this._oldPoint=evt.screenPoint;var _1df=new _1c8(_1dd);_1df.addRing(this._points);this._graphic=map.graphics.add(new _1c4(_1df,this.fillSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;}if(has("esri-touch")){evt.preventDefault();}},_onMouseMoveHandler:function(evt){var _1e0;if(this.map.snappingManager){_1e0=this.map.snappingManager._snappingPoint;}var _1e1=this._points[this._points.length-1],end=_1e0||evt.mapPoint,_1e2=this._tGraphic,geom=_1e2.geometry;switch(this._geometryType){case DRAW.POLYLINE:case DRAW.POLYGON:geom.setPoint(0,0,{x:_1e1.x,y:_1e1.y});geom.setPoint(0,1,{x:end.x,y:end.y});_1e2.setGeometry(geom);break;}},_onMouseDragHandler:function(evt){if(has("esri-touch")&&!this._points.length){evt.preventDefault();return;}this._dragged=true;var _1e3;if(this.map.snappingManager){_1e3=this.map.snappingManager._snappingPoint;}var _1e4=this._points[0],end=_1e3||evt.mapPoint,map=this.map,_1e5=map.spatialReference,_1e6=this._graphic,Draw=DRAW,_1e7=map.toScreen(_1e4),_1e8=map.toScreen(end),pts=[],a=_1e8.x-_1e7.x,b=_1e8.y-_1e7.y,_1e9=60,d=Math.sqrt(a*a+b*b);switch(this._geometryType){case Draw.CIRCLE:this._hideTooltip();_1e6.geometry=_1c8.createCircle({center:_1e7,r:d,numberOfPoints:_1e9,map:map});_1e6.setGeometry(_1e6.geometry);break;case Draw.ELLIPSE:this._hideTooltip();_1e6.geometry=_1c8.createEllipse({center:_1e7,longAxis:a,shortAxis:b,numberOfPoints:_1e9,map:map});_1e6.setGeometry(_1e6.geometry);break;case Draw.TRIANGLE:this._hideTooltip();pts=[[0,-d],[0.8660254037844386*d,0.5*d],[-0.8660254037844386*d,0.5*d],[0,-d]];_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.ARROW:this._hideTooltip();var sina=b/d,cosa=a/d,tana=b/a;var f=cosa*0.25*d,e=0.25*d/tana,g=sina*0.25*d;pts=[[a,b],[a-f*(1+24/e),b+24*cosa-g],[a-f*(1+12/e),b+12*cosa-g],[-12*sina,12*cosa],[12*sina,-12*cosa],[a-f*(1-12/e),b-12*cosa-g],[a-f*(1-24/e),b-24*cosa-g],[a,b]];_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.LEFT_ARROW:this._hideTooltip();if(a<=0){pts=[[a,0],[0.75*a,b],[0.75*a,0.5*b],[0,0.5*b],[0,-0.5*b],[0.75*a,-0.5*b],[0.75*a,-b],[a,0]];}else{pts=[[0,0],[0.25*a,b],[0.25*a,0.5*b],[a,0.5*b],[a,-0.5*b],[0.25*a,-0.5*b],[0.25*a,-b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.RIGHT_ARROW:this._hideTooltip();if(a>=0){pts=[[a,0],[0.75*a,b],[0.75*a,0.5*b],[0,0.5*b],[0,-0.5*b],[0.75*a,-0.5*b],[0.75*a,-b],[a,0]];}else{pts=[[0,0],[0.25*a,b],[0.25*a,0.5*b],[a,0.5*b],[a,-0.5*b],[0.25*a,-0.5*b],[0.25*a,-b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.UP_ARROW:this._hideTooltip();if(b<=0){pts=[[0,b],[-a,0.75*b],[-0.5*a,0.75*b],[-0.5*a,0],[0.5*a,0],[0.5*a,0.75*b],[a,0.75*b],[0,b]];}else{pts=[[0,0],[-a,0.25*b],[-0.5*a,0.25*b],[-0.5*a,b],[0.5*a,b],[0.5*a,0.25*b],[a,0.25*b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.DOWN_ARROW:this._hideTooltip();if(b>=0){pts=[[0,b],[-a,0.75*b],[-0.5*a,0.75*b],[-0.5*a,0],[0.5*a,0],[0.5*a,0.75*b],[a,0.75*b],[0,b]];}else{pts=[[0,0],[-a,0.25*b],[-0.5*a,0.25*b],[-0.5*a,b],[0.5*a,b],[0.5*a,0.25*b],[a,0.25*b],[0,0]];}_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.RECTANGLE:this._hideTooltip();pts=[[0,0],[a,0],[a,b],[0,b],[0,0]];_1e6.geometry=this._toPolygon(pts,_1e7.x,_1e7.y);_1e6.setGeometry(_1e6.geometry);break;case Draw.LINE:_1e6.setGeometry(lang.mixin(_1e6.geometry,{paths:[[[_1e4.x,_1e4.y],[end.x,end.y]]]}));break;case Draw.EXTENT:if(_1e6){map.graphics.remove(_1e6,true);}var rect=new Rect(this._normalizeRect(_1e4,end,_1e5));rect._originOnly=true;this._graphic=map.graphics.add(new _1c4(rect,this.fillSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}break;case Draw.FREEHAND_POLYLINE:this._hideTooltip();if(this._canDrawFreehandPoint(evt)===false){if(has("esri-touch")){evt.preventDefault();}return;}this._points.push(evt.mapPoint.offset(0,0));_1e6.geometry._insertPoints([end.offset(0,0)],0);_1e6.setGeometry(_1e6.geometry);break;case Draw.FREEHAND_POLYGON:this._hideTooltip();if(this._canDrawFreehandPoint(evt)===false){if(has("esri-touch")){evt.preventDefault();}return;}this._points.push(evt.mapPoint.offset(0,0));_1e6.geometry._insertPoints([end.offset(0,0)],0);_1e6.setGeometry(_1e6.geometry);break;}if(has("esri-touch")){evt.preventDefault();}},_canDrawFreehandPoint:function(evt){if(!this._oldPoint){return false;}var dx=this._oldPoint.x-evt.screenPoint.x;dx=(dx<0)?dx*-1:dx;var dy=this._oldPoint.y-evt.screenPoint.y;dy=(dy<0)?dy*-1:dy;var _1ea=this._options.tolerance;if(dx<_1ea&&dy<_1ea){return false;}var now=new Date();var _1eb=now-this._startTime;if(_1eb<this._options.drawTime){return false;}this._startTime=now;this._oldPoint=evt.screenPoint;return true;},_onMouseUpHandler:function(evt){if(!this._dragged){this._clear();return;}if(this._points.length===0){this._points.push(evt.mapPoint.offset(0,0));}var _1ec;if(this.map.snappingManager){_1ec=this.map.snappingManager._snappingPoint;}var _1ed=this._points[0],end=_1ec||evt.mapPoint,map=this.map,_1ee=map.spatialReference,Draw=DRAW,_1ef;switch(this._geometryType){case Draw.CIRCLE:case Draw.ELLIPSE:case Draw.TRIANGLE:case Draw.ARROW:case Draw.LEFT_ARROW:case Draw.RIGHT_ARROW:case Draw.UP_ARROW:case Draw.DOWN_ARROW:case Draw.RECTANGLE:_1ef=this._graphic.geometry;break;case Draw.LINE:_1ef=new _1c7({paths:[[[_1ed.x,_1ed.y],[end.x,end.y]]],spatialReference:_1ee});break;case Draw.EXTENT:_1ef=(new Rect(this._normalizeRect(_1ed,end,_1ee))).getExtent();break;case Draw.FREEHAND_POLYLINE:_1ef=new _1c7(_1ee);_1ef.addPath([].concat(this._points,[end.offset(0,0)]));break;case Draw.FREEHAND_POLYGON:_1ef=new _1c8(_1ee);var ring=[].concat(this._points,[end.offset(0,0),this._points[0].offset(0,0)]);if(!_1c8.prototype.isClockwise(ring)&&!this.respectDrawingVertexOrder){console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise.");ring.reverse();}_1ef.addRing(ring);break;}if(has("esri-touch")){evt.preventDefault();}this._clear();this._drawEnd(_1ef);},_onClickHandler:function(evt){var _1f0;if(this.map.snappingManager){_1f0=this.map.snappingManager._snappingPoint;}var _1f1=_1f0||evt.mapPoint,map=this.map,_1f2=map.toScreen(_1f1),Draw=DRAW,pts,dx,dy,_1f3,geom,_1f4;this._points.push(_1f1.offset(0,0));switch(this._geometryType){case Draw.POINT:this._drawEnd(_1f1.offset(0,0));this._setTooltipMessage(0);break;case Draw.POLYLINE:if(this._points.length===1){var _1f5=new _1c7(map.spatialReference);_1f5.addPath(this._points);this._graphic=map.graphics.add(new _1c4(_1f5,this.lineSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}this._onMouseMoveHandler_connect=_1ba.connect(map,"onMouseMove",this._onMouseMoveHandler);this._tGraphic=map.graphics.add(new _1c4(new _1c7({paths:[[[_1f1.x,_1f1.y],[_1f1.x,_1f1.y]]],spatialReference:map.spatialReference}),this.lineSymbol),true);}else{this._graphic.geometry._insertPoints([_1f1.offset(0,0)],0);this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol);_1f3=this._tGraphic;geom=_1f3.geometry;geom.setPoint(0,0,_1f1.offset(0,0));geom.setPoint(0,1,_1f1.offset(0,0));_1f3.setGeometry(geom);}break;case Draw.POLYGON:if(this._points.length===1){_1f4=new _1c8(map.spatialReference);_1f4.addRing(this._points);this._graphic=map.graphics.add(new _1c4(_1f4,this.fillSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}this._onMouseMoveHandler_connect=_1ba.connect(map,"onMouseMove",this._onMouseMoveHandler);this._tGraphic=map.graphics.add(new _1c4(new _1c7({paths:[[[_1f1.x,_1f1.y],[_1f1.x,_1f1.y]]],spatialReference:map.spatialReference}),this.fillSymbol),true);}else{this._graphic.geometry._insertPoints([_1f1.offset(0,0)],0);this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol);_1f3=this._tGraphic;geom=_1f3.geometry;geom.setPoint(0,0,_1f1.offset(0,0));geom.setPoint(0,1,_1f1.offset(0,0));_1f3.setGeometry(geom);}break;case Draw.MULTI_POINT:var tps=this._points;if(tps.length===1){var _1f6=new _1c9(map.spatialReference);_1f6.addPoint(tps[tps.length-1]);this._graphic=map.graphics.add(new _1c4(_1f6,this.markerSymbol),true);if(map.snappingManager){map.snappingManager._setGraphic(this._graphic);}}else{this._graphic.geometry.addPoint(tps[tps.length-1]);this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol);}break;case Draw.ARROW:pts=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.LEFT_ARROW:pts=[[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.RIGHT_ARROW:pts=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.UP_ARROW:pts=[[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.DOWN_ARROW:pts=[[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.TRIANGLE:pts=[[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]];dx=_1f2.x;dy=_1f2.y;this._addShape(pts,dx,dy);break;case Draw.RECTANGLE:pts=[[0,-96],[96,-96],[96,0],[0,0],[0,-96]];dx=_1f2.x-48;dy=_1f2.y+48;this._addShape(pts,dx,dy);break;case Draw.CIRCLE:_1f4=new _1c8(map.spatialReference);this._graphic=map.graphics.add(new _1c4(_1f4,this.fillSymbol),true);this._graphic.geometry=_1c8.createCircle({center:_1f2,r:48,numberOfPoints:60,map:map});this._graphic.setGeometry(this._graphic.geometry);this._drawEnd(this._graphic.geometry);break;case Draw.ELLIPSE:_1f4=new _1c8(map.spatialReference);this._graphic=map.graphics.add(new _1c4(_1f4,this.fillSymbol),true);this._graphic.geometry=_1c8.createEllipse({center:_1f2,longAxis:48,shortAxis:24,numberOfPoints:60,map:map});this._graphic.setGeometry(this._graphic.geometry);this._drawEnd(this._graphic.geometry);break;}this._setTooltipMessage(this._points.length);},_addShape:function(path,dx,dy){var _1f7=this.map.graphics.add(new _1c4(this._toPolygon(path,dx,dy),this.fillSymbol),true);this._setTooltipMessage(0);var geom;if(_1f7){geom=_1c5.fromJson(_1f7.geometry.toJson());this.map.graphics.remove(_1f7,true);}this._drawEnd(geom);_1f7=geom=null;},_toPolygon:function(path,dx,dy){var map=this.map;var _1f8=new _1c8(map.spatialReference);_1f8.addRing(_1b9.map(path,function(pt){return map.toMap({x:pt[0]+dx,y:pt[1]+dy});}));return _1f8;},_onDblClickHandler:function(evt){var _1f9,_1fa=this._points,map=this.map,_1fb=map.spatialReference,Draw=DRAW;if(has("esri-touch")){_1fa.push(evt.mapPoint);}_1fa=_1fa.slice(0,_1fa.length);switch(this._geometryType){case Draw.POLYLINE:if(!this._graphic||_1fa.length<2){_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(evt);return;}_1f9=new _1c7(_1fb);_1f9.addPath([].concat(_1fa));break;case Draw.POLYGON:if(!this._graphic||_1fa.length<2){_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(evt);return;}_1f9=new _1c8(_1fb);var ring=[].concat(_1fa,[_1fa[0].offset(0,0)]);if(!_1c8.prototype.isClockwise(ring)&&!this.respectDrawingVertexOrder){console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise.");ring.reverse();}_1f9.addRing(ring);break;case Draw.MULTI_POINT:_1f9=new _1c9(_1fb);_1b9.forEach(_1fa,function(pt){_1f9.addPoint(pt);});break;}_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(_1f9);},_onKeyDownHandler:function(evt){if(evt.keyCode===keys.ESCAPE){_1ba.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);}},_toggleTooltip:function(show){if(!this._options.showTooltips){return;}if(show){if(this._tooltip){return;}var _1fc=this.map.container;this._tooltip=_1bc.create("div",{"class":"tooltip"},_1fc);this._tooltip.style.display="none";this._tooltip.style.position="fixed";this._setTooltipMessage(0);this._onTooltipMouseEnterHandler_connect=_1ba.connect(this.map,"onMouseOver",this._updateTooltip);this._onTooltipMouseLeaveHandler_connect=_1ba.connect(this.map,"onMouseOut",this._hideTooltip);this._onTooltipMouseMoveHandler_connect=_1ba.connect(this.map,"onMouseMove",this._updateTooltip);}else{if(this._tooltip){_1ba.disconnect(this._onTooltipMouseEnterHandler_connect);_1ba.disconnect(this._onTooltipMouseLeaveHandler_connect);_1ba.disconnect(this._onTooltipMouseMoveHandler_connect);_1bc.destroy(this._tooltip);this._tooltip=null;}}},_hideTooltip:function(){var _1fd=this._tooltip;if(!_1fd){return;}_1fd.style.display="none";},_setTooltipMessage:function(_1fe){var _1ff=this._tooltip;if(!_1ff){return;}var _200=_1fe;var _201="";switch(this._geometryType){case DRAW.POINT:_201=_1ca.toolbars.draw.addPoint;break;case DRAW.ARROW:case DRAW.LEFT_ARROW:case DRAW.RIGHT_ARROW:case DRAW.UP_ARROW:case DRAW.DOWN_ARROW:case DRAW.TRIANGLE:case DRAW.RECTANGLE:case DRAW.CIRCLE:case DRAW.ELLIPSE:_201=_1ca.toolbars.draw.addShape;break;case DRAW.LINE:case DRAW.EXTENT:case DRAW.FREEHAND_POLYLINE:case DRAW.FREEHAND_POLYGON:_201=_1ca.toolbars.draw.freehand;break;case DRAW.POLYLINE:case DRAW.POLYGON:_201=_1ca.toolbars.draw.start;if(_200===1){_201=_1ca.toolbars.draw.resume;}else{if(_200>=2){_201=_1ca.toolbars.draw.complete;}}break;case DRAW.MULTI_POINT:_201=_1ca.toolbars.draw.addMultipoint;if(_200>=1){_201=_1ca.toolbars.draw.finish;}break;}_1ff.innerHTML=_201;},_updateTooltip:function(evt){var _202=this._tooltip;if(!_202){return;}var px,py;if(evt.clientX||evt.pageY){px=evt.clientX;py=evt.clientY;}else{px=evt.clientX+win.body().scrollLeft-win.body().clientLeft;py=evt.clientY+win.body().scrollTop-win.body().clientTop;}_202.style.display="none";_1bd.set(_202,{left:(px+this._options.tooltipOffset)+"px",top:py+"px"});_202.style.display="";},_redrawGraphic:function(_203,_204,_205,lod){if(_205||this.map.wrapAround180){var g=this._graphic;if(g){g.setGeometry(g.geometry);}g=this._tGraphic;if(g){g.setGeometry(g.geometry);}}},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});lang.mixin(DRAW,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"});if(has("extend-esri")){lang.setObject("toolbars.Draw",DRAW,_1be);}return DRAW;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_206,_207){return _206("dojox.grid._RowSelector",_207,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_208,_209){var w=this.contentWidth||0;_209.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_20a,_20b){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_20a)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_20a)){n.push("dojoxGridRowbarSelected");}_20b.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_20c,_20d,_20e,lang,_20f){return _20d("dojox.grid._Layout",null,{constructor:function(_210){this.grid=_210;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_211,_212,_213,_214,_215){var _216=this.structure[_211].cells[0];var _217=this.structure[_212].cells[0];var cell=null;var _218=0;var _219=0;for(var i=0,c;c=_216[i];i++){if(c.index==_213){_218=i;break;}}cell=_216.splice(_218,1)[0];cell.view=this.grid.views.views[_212];for(i=0,c=null;c=_217[i];i++){if(c.index==_214){_219=i;break;}}if(!_215){_219+=1;}_217.splice(_219,0,cell);var _21a=this.grid.getCell(this.grid.getSortIndex());if(_21a){_21a._currentlySorted=this.grid.getSortAsc();}this.cells=[];_213=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_213;this.cells.push(c);if("_currentlySorted" in c){var si=_213+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_213++;}}}_20e.forEach(this.cells,function(c){var _21b=c.markup[2].split(" ");var _21c=parseInt(_21b[1].substring(5));if(_21c!=c.index){_21b[1]="idx=\""+c.index+"\"";c.markup[2]=_21b.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_21d,_21e){var cell=this.cells[_21d];if(cell.hidden==_21e){cell.hidden=!_21e;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_20f.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_21f,_220,_221){var self=this;var _222=function(_223){var w=0;if(_223.colSpan>1){w=0;}else{w=_223.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _224={grid:this.grid,subrow:_21f,layoutIndex:_220,index:this.cells.length};if(_221&&_221 instanceof _20c.grid.cells._Base){var _225=lang.clone(_221);_224.unitWidth=_222(_225._props);_225=lang.mixin(_225,this._defaultCellProps,_221._props,_224);return _225;}var _226=_221.type||_221.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_20c.grid.cells.Cell;if(lang.isString(_226)){_226=lang.getObject(_226);}_224.unitWidth=_222(_221);return new _226(lang.mixin({},this._defaultCellProps,_221,_224));},addRowDef:function(_227,_228){var _229=[];var _22a=0,_22b=0,_22c=true;for(var i=0,def,cell;(def=_228[i]);i++){cell=this.addCellDef(_227,i,def);_229.push(cell);this.cells.push(cell);if(_22c&&cell.relWidth){_22a+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_22b+=window.parseInt(w,10);}else{if(w=="auto"){_22c=false;}}}}}if(_22a&&_22c){_20e.forEach(_229,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_22a)*(100-_22b))+"%";}});}return _229;},addRowsDef:function(_22d){var _22e=[];if(lang.isArray(_22d)){if(lang.isArray(_22d[0])){for(var i=0,row;_22d&&(row=_22d[i]);i++){_22e.push(this.addRowDef(i,row));}}else{_22e.push(this.addRowDef(0,_22d));}}return _22e;},addViewDef:function(_22f){this._defaultCellProps=_22f.defaultCell||{};if(_22f.width&&_22f.width=="auto"){delete _22f.width;}return lang.mixin({},_22f,{cells:this.addRowsDef(_22f.rows||_22f.cells)});},setStructure:function(_230){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_20c._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _231=this.grid.rowSelector;if(_231=="false"){sel=null;}else{if(_231!="true"){sel["width"]=_231;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _232=function(def){return ("name" in def||"field" in def||"get" in def);};var _233=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_232(def[0])){return true;}}return false;};var _234=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_232(def))));};if(lang.isArray(_230)){var _235=false;for(var i=0,st;(st=_230[i]);i++){if(_234(st)){_235=true;break;}}if(!_235){s.push(this.addViewDef({cells:_230}));}else{for(i=0;(st=_230[i]);i++){if(_233(st)){s.push(this.addViewDef({cells:st}));}else{if(_234(st)){s.push(this.addViewDef(st));}}}}}else{if(_234(_230)){s.push(this.addViewDef(_230));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"esri/layers/RenderMode":function(){define("esri/layers/RenderMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/io/script","esri/kernel"],function(_236,_237,lang,_238,has,_239,_23a){var _23b=_237(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(_236._scopeName||"dojo")+"IoScript";},initialize:function(map){this.map=map;this._init=true;},startup:function(){},propertyChangeHandler:function(type){},destroy:function(){this._init=false;},drawFeature:function(_23c){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _23d=this._featureMap[oid];if(_23d){_23d._count++;}},_decRefCount:function(oid){var _23e=this._featureMap[oid];if(_23e){_23e._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_23f){var fmap=this._featureMap,_240=fmap[oid],_241=this.featureLayer;if(!_240){fmap[oid]=_23f;_241._add(_23f);_23f._count=0;}return _240||_23f;},_removeFeatureIIf:function(oid){var _242=this._featureMap[oid],_243=this.featureLayer;if(_242){if(_242._count){return;}delete this._featureMap[oid];_243._remove(_242);}return _242;},_clearIIf:function(){var i,_244=this.featureLayer,_245=_244.graphics,_246=_244._selectedFeatures,_247=_244.objectIdField;for(i=_245.length-1;i>=0;i--){var _248=_245[i];var oid=_248.attributes[_247];if(oid in _246){_248._count=1;continue;}_248._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_239[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_239[this._prefix+id];if(dfd){try{dfd.cancel();_239._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_239._validCheck(null);},_toggleVisibility:function(show){var _249=this.featureLayer,_24a=_249.graphics,_24b=show?"show":"hide",i,len=_24a.length;show=show&&_249._ager;for(i=0;i<len;i++){var _24c=_24a[i];_24c[_24b]();if(show){_249._repaint(_24c);}}},_applyTimeFilter:function(_24d){var _24e=this.featureLayer;if(!_24e.timeInfo||_24e.suspended){return;}if(!_24d){_24e._fireUpdateStart();}var _24f=_24e._trackManager;if(_24f){_24f.clearTracks();}var defn=_24e.getTimeDefinition(),_250=_24e._getOffsettedTE(_24e._mapTimeExtent);if(_250){_250=_24e._getTimeOverlap(defn,_250);if(_250){var _251=_24e._filterByTime(_24e.graphics,_250.startTime,_250.endTime);if(_24f){_24f.addFeatures(_251.match);}_238.forEach(_251.match,function(_252){var _253=_252._shape;if(!_252.visible){_252.show();_253=_252._shape;_253&&_253._moveToFront();}if(_24e._ager&&_253){_24e._repaint(_252);}});_238.forEach(_251.noMatch,function(_254){if(_254.visible){_254.hide();}});}else{this._toggleVisibility(false);}}else{if(_24f){_24f.addFeatures(_24e.graphics);}this._toggleVisibility(true);}if(_24f){_24f.moveLatestToFront();_24f.drawTracks();}if(!_24d){_24e._fireUpdateEnd();}}});if(has("extend-esri")){lang.setObject("layers._RenderMode",_23b,_23a);}return _23b;});},"dijit/BackgroundIframe":function(){define("dijit/BackgroundIframe",["require","./main","dojo/_base/config","dojo/dom-construct","dojo/dom-style","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window"],function(_255,_256,_257,_258,_259,lang,on,has,win){var _25a=new function(){var _25b=[];this.pop=function(){var _25c;if(_25b.length){_25c=_25b.pop();_25c.style.display="";}else{if(has("ie")<9){var burl=_257["dojoBlankHtmlUrl"]||_255.toUrl("dojo/resources/blank.html")||"javascript:\"\"";var html="<iframe src='"+burl+"' role='presentation'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";_25c=win.doc.createElement(html);}else{_25c=_258.create("iframe");_25c.src="javascript:\"\"";_25c.className="dijitBackgroundIframe";_25c.setAttribute("role","presentation");_259.set(_25c,"opacity",0.1);}_25c.tabIndex=-1;}return _25c;};this.push=function(_25d){_25d.style.display="none";_25b.push(_25d);};}();_256.BackgroundIframe=function(node){if(!node.id){throw new Error("no id");}if(has("ie")||has("mozilla")){var _25e=(this.iframe=_25a.pop());node.appendChild(_25e);if(has("ie")<7||has("quirks")){this.resize(node);this._conn=on(node,"resize",lang.hitch(this,function(){this.resize(node);}));}else{_259.set(_25e,{width:"100%",height:"100%"});}}};lang.extend(_256.BackgroundIframe,{resize:function(node){if(this.iframe){_259.set(this.iframe,{width:node.offsetWidth+"px",height:node.offsetHeight+"px"});}},destroy:function(){if(this._conn){this._conn.remove();this._conn=null;}if(this.iframe){_25a.push(this.iframe);delete this.iframe;}}});return _256.BackgroundIframe;});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_25f,_260,_261,_262,_263,_264,_265,_266,_267,_268,_269,_26a,util,_26b,_26c,_26d,_26e,_26f,_270,lang,has,_271,html,_272){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _273=_260("dojox.grid._Grid",[_26b,_26c,_261],{templateString:_26e,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_263,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_271.initOnFontResize();this.connect(_271,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}if(this.rowHeight>0){html.addClass(this.viewsNode,this.classTag+"FixedRowHeight");}},postMixInProperties:function(){this.inherited(arguments);var _274=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_26f.substitute(this.loadingMessage,_274);this.errorMessage=_26f.substitute(this.errorMessage,_274);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_270.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_275){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_275){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _266(this);this.focus=new _267(this);this.edit=new _268(this);},createSelection:function(){this.selection=new _269(this);},createScroller:function(){this.scroller=new _262();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_276){},createViews:function(){this.views=new _265(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_277,idx){var c=lang.getObject(_277);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_25f._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_278){var s=_278;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_279){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_279);},getColumnTogglingItems:function(){var _27a,_27b=[];_27a=_270.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _26d({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_27c){if(self.layout.setColumnVisibility(this._gridCell.index,_27c)){var _27d=this._gridCell.menuItems;if(_27d.length>1){_270.forEach(_27d,function(item){if(item!==this){item.setAttribute("checked",_27c);}},this);}_27c=_270.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_270.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_27c.length==1){_270.forEach(_27c[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _27e=_270.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_27e,1);delete this._gridCell;_26d.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_27b.push(item);}return item;},this);if(_27b.length==1){_27b[0].set("disabled",true);}return _27a;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_270.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_270.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_27f){this.setScrollTop(0);},getItem:function(_280){return null;},showMessage:function(_281){if(_281){this.messagesNode.innerHTML=_281;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_282,_283){this._pendingChangeSize=_282;this._pendingResultSize=_283;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_284,_285){_284=_284||this._pendingChangeSize;_285=_285||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _286=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_286.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_285){_284=_285;}if(!this._autoHeight&&_284){html.marginBox(this.domNode,_284);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=(this._parentContentBoxHeight>0?this._parentContentBoxHeight:html._getContentBox(pn).h);this.domNode.style.height=Math.max(0,h)+"px";}}var _287=_270.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_287&&hh===undefined){hh=this._getHeaderHeight();}}if(_287){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _288=(!this.initialWidth&&this.autoWidth);var w=_288?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_288){this.domNode.style.width=vw+"px";}},adaptHeight:function(_289){var t=_289===undefined?this._getHeaderHeight():_289;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _28a=0,_28b=0;var _28c=_270.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_28a++;}else{_28b++;}return (!has);});if(_28a>0&&_28b>0){_270.forEach(_28c,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_28d,_28e){this.views.renderRow(_28d,_28e,this._skipRowRenormalize);},rowRemoved:function(_28f){this.views.rowRemoved(_28f);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_290){_290=Number(_290);if(this.updating){this.invalidated[_290]=true;}else{this.views.updateRow(_290);this.scroller.rowHeightChanged(_290);}},updateRows:function(_291,_292){_291=Number(_291);_292=Number(_292);var i;if(this.updating){for(i=0;i<_292;i++){this.invalidated[i+_291]=true;}}else{for(i=0;i<_292;i++){this.views.updateRow(i+_291,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_291);}},updateRowCount:function(_293){if(this.updating){this.invalidated.rowCount=_293;}else{this.rowCount=_293;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_293);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_294){this.views.updateRowStyles(_294);},getRowNode:function(_295){if(this.focus.focusView&&!(this.focus.focusView instanceof _26a)){return this.focus.focusView.rowNodes[_295];}else{for(var i=0,_296;(_296=this.views.views[i]);i++){if(!(_296 instanceof _26a)){return _296.rowNodes[_295];}}}return null;},rowHeightChanged:function(_297){this.views.renormalizeRow(_297);this.scroller.rowHeightChanged(_297);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_298){if(!this.fastScroll){this.setScrollTop(_298);return;}var _299=Math.abs(this.lastScrollTop-_298);this.lastScrollTop=_298;if(_299>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_298;this.views.setScrollTop(_298);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _29a=this;this._pendingScroll=window.setTimeout(function(){delete _29a._pendingScroll;_29a.finishScrollJob();},200);}else{this.setScrollTop(_298);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_29b){this.scroller.scroll(this.views.setScrollTop(_29b));},scrollToRow:function(_29c){this.setScrollTop(this.scroller.findScrollTop(_29c)+1);},styleRowNode:function(_29d,_29e){if(_29e){this.rows.styleRowNode(_29d,_29e);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_29f){return this.layout.cells[_29f];},setCellWidth:function(_2a0,_2a1){this.getCell(_2a0).unitWidth=_2a1;},getCellName:function(_2a2){return "Cell "+_2a2.index;},canSort:function(_2a3){},sort:function(){},getSortAsc:function(_2a4){_2a4=_2a4==undefined?this.sortInfo:_2a4;return Boolean(_2a4>0);},getSortIndex:function(_2a5){_2a5=_2a5==undefined?this.sortInfo:_2a5;return Math.abs(_2a5)-1;},setSortIndex:function(_2a6,_2a7){var si=_2a6+1;if(_2a7!=undefined){si*=(_2a7?1:-1);}else{if(this.getSortIndex()==_2a6){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_2a8){if(this.canSort(_2a8)){this.sortInfo=_2a8;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_2a9,_2aa){this.onStartEdit(_2a9,_2aa);},doApplyCellEdit:function(_2ab,_2ac,_2ad){this.onApplyCellEdit(_2ab,_2ac,_2ad);},doCancelEdit:function(_2ae){this.onCancelEdit(_2ae);},doApplyEdit:function(_2af){this.onApplyEdit(_2af);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_273.markupFactory=function(_2b0,node,ctor,_2b1){var _2b2=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_2b0.structure&&node.nodeName.toLowerCase()=="table"){_2b0.structure=_272("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_2b2(cg);}return v;});if(!_2b0.structure.length){_2b0.structure.push({__span:Infinity,cells:[]});}_272("thead > tr",node).forEach(function(tr,_2b3){var _2b4=0;var _2b5=0;var _2b6;var _2b7=null;_272("> th",tr).map(function(th){if(!_2b7){_2b6=0;_2b7=_2b0.structure[0];}else{if(_2b4>=(_2b6+_2b7.__span)){_2b5++;_2b6+=_2b7.__span;var _2b8=_2b7;_2b7=_2b0.structure[_2b5];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_2b4+=cell.colSpan;var _2b9=html.attr(th,"rowspan");if(_2b9){cell.rowSpan=_2b9;}if(html.hasAttr(th,"width")){cell.width=_2b2(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_2b1){_2b1(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_25f.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_2b7.cells[_2b3]){_2b7.cells[_2b3]=[];}_2b7.cells[_2b3].push(cell);});});}return new ctor(_2b0,node);};return _273;});},"dijit/_WidgetsInTemplateMixin":function(){define("dijit/_WidgetsInTemplateMixin",["dojo/_base/array","dojo/_base/declare","dojo/parser"],function(_2ba,_2bb,_2bc){return _2bb("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:false,widgetsInTemplate:true,_beforeFillContent:function(){if(this.widgetsInTemplate){var node=this.domNode;var cw=(this._startupWidgets=_2bc.parse(node,{noStart:!this._earlyTemplatedStartup,template:true,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,scope:"dojo"}));if(!cw.isFulfilled()){throw new Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), "+"unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}this._attachTemplateNodes(cw,function(n,p){return n[p];});}},startup:function(){_2ba.forEach(this._startupWidgets,function(w){if(w&&!w._started&&w.startup){w.startup();}});this.inherited(arguments);}});});},"esri/tasks/query":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/tasks/SpatialRelationship","dojo/has!extend-esri?esri/tasks/QueryTask","dojo/has!extend-esri?esri/tasks/RelationshipQuery","dojo/has!extend-esri?esri/tasks/StatisticDefinition"],function(_2bd,lang,_2be,_2bf,has,_2c0,_2c1,_2c2){var _2c3=_2bd(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=_2c3.SPATIAL_REL_INTERSECTS;},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:false,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,toJson:function(_2c4){var json={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},g=_2c4&&_2c4["geometry"]||this.geometry,ids=this.objectIds,_2c5=this.outFields,_2c6=this.outSpatialReference,_2c7=this.groupByFieldsForStatistics,_2c8=this.orderByFields,_2c9=this.outStatistics;if(g){json.geometry=g;json.geometryType=_2c1.getJsonType(g);json.inSR=g.spatialReference.wkid||_2bf.toJson(g.spatialReference.toJson());}if(ids){json.objectIds=ids.join(",");}if(_2c5){json.outFields=_2c5.join(",");}if(_2c7){json.groupByFieldsForStatistics=_2c7.join(",");}if(_2c8){json.orderByFields=_2c8.join(",");}if(_2c9){var _2ca=[];_2be.forEach(_2c9,function(item,idx){_2ca.push(item.toJson());});json.outStatistics=_2bf.toJson(_2ca);}if(_2c6!==null){json.outSR=_2c6.wkid||_2bf.toJson(_2c6.toJson());}else{if(g){json.outSR=g.spatialReference.wkid||_2bf.toJson(g.spatialReference.toJson());}}var _2cb=this.timeExtent;json.time=_2cb?_2cb.toJson().join(","):null;var _2cc=this.relationParam;if(_2cc&&this.spatialRelationship===_2c3.SPATIAL_REL_RELATION){json.relationParam=_2cc;}json._ts=this._ts;return json;}});lang.mixin(_2c3,_2c2);if(has("extend-esri")){lang.setObject("tasks.Query",_2c3,_2c0);}return _2c3;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"esri/layers/FeatureTemplate":function(){define("esri/layers/FeatureTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/lang","esri/graphic"],function(_2cd,lang,has,_2ce,_2cf,_2d0){var _2d1=_2cd(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(json){if(json&&lang.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _2d2=json.prototype;this.prototype=new _2d0(_2d2.geometry,null,_2d2.attributes);}},toJson:function(){return _2cf.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});lang.mixin(_2d1,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});if(has("extend-esri")){lang.setObject("layers.FeatureTemplate",_2d1,_2ce);}return _2d1;});},"dojo/dnd/Mover":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../sniff","../_base/window","../dom","../dom-geometry","../dom-style","../Evented","../on","../touch","./common","./autoscroll"],function(_2d3,_2d4,_2d5,lang,has,win,dom,_2d6,_2d7,_2d8,on,_2d9,dnd,_2da){return _2d4("dojo.dnd.Mover",[_2d8],{constructor:function(node,e,host){this.node=dom.byId(node);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;var h=(this.host=host),d=node.ownerDocument;this.events=[on(d,_2d9.move,lang.hitch(this,"onFirstMove")),on(d,_2d9.move,lang.hitch(this,"onMouseMove")),on(d,_2d9.release,lang.hitch(this,"onMouseUp")),on(d,"dragstart",_2d5.stop),on(d.body,"selectstart",_2d5.stop)];_2da.autoScrollStart(d);if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){_2da.autoScroll(e);var m=this.marginBox;this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY},e);_2d5.stop(e);},onMouseUp:function(e){if(has("webkit")&&has("mac")&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}_2d5.stop(e);},onFirstMove:function(e){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left))||0;t=Math.round(parseFloat(s.top))||0;break;default:s.position="absolute";var m=_2d6.getMarginBox(this.node);var b=win.doc.body;var bs=_2d7.getComputedStyle(b);var bm=_2d6.getMarginBox(b,bs);var bc=_2d6.getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this,e);}this.events.shift().remove();},destroy:function(){_2d3.forEach(this.events,function(_2db){_2db.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});});},"esri/layers/FeatureEditResult":function(){define("esri/layers/FeatureEditResult",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_2dc,lang,has,_2dd){var _2de=_2dc(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(json){if(json&&lang.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});if(has("extend-esri")){lang.setObject("layers.FeatureEditResult",_2de,_2dd);}return _2de;});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _2df={};lang.setObject("dojo.data.util.sorter",_2df);_2df.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_2df.createSortFunction=function(_2e0,_2e1){var _2e2=[];function _2e3(attr,dir,comp,s){return function(_2e4,_2e5){var a=s.getValue(_2e4,attr);var b=s.getValue(_2e5,attr);return dir*comp(a,b);};};var _2e6;var map=_2e1.comparatorMap;var bc=_2df.basicComparator;for(var i=0;i<_2e0.length;i++){_2e6=_2e0[i];var attr=_2e6.attribute;if(attr){var dir=(_2e6.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_2e2.push(_2e3(attr,dir,comp,_2e1));}}return function(rowA,rowB){var i=0;while(i<_2e2.length){var ret=_2e2[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _2df;});},"dojo/touch":function(){define(["./_base/kernel","./aspect","./dom","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(dojo,_2e7,dom,lang,on,has,_2e8,_2e9,win){var _2ea=navigator.msPointerEnabled;var _2eb;function _2ec(_2ed,_2ee,_2ef){if(_2ea&&_2ef){return function(node,_2f0){return on(node,_2ef,_2f0);};}else{if(has("touch")){return function(node,_2f1){var _2f2=on(node,_2ee,_2f1),_2f3=on(node,_2ed,function(evt){if(!_2eb||(new Date()).getTime()>_2eb+1000){_2f1.call(this,evt);}});return {remove:function(){_2f2.remove();_2f3.remove();}};};}else{return function(node,_2f4){return on(node,_2ed,_2f4);};}}};var _2f5,_2f6,_2f7;if(has("touch")&&!_2ea){_2e9(function(){_2f7=win.body();win.doc.addEventListener("touchstart",function(_2f8){_2eb=(new Date()).getTime();var _2f9=_2f7;_2f7=_2f8.target;if(_2f7.dojoElementFromPoint){_2f7=_2f7.dojoElementFromPoint(_2f8.changedTouches[0].clientX,_2f8.changedTouches[0].clientY);}if(_2f9){on.emit(_2f9,"dojotouchout",{target:_2f9,relatedTarget:_2f7,bubbles:true});}if(_2f7){on.emit(_2f7,"dojotouchover",{target:_2f7,relatedTarget:_2f9,bubbles:true});}},true);on(win.doc,"touchmove",function(_2fa){_2eb=(new Date()).getTime();_2f6=_2fa;var _2fb=win.doc.elementFromPoint(_2fa.clientX,_2fa.clientY);if(_2fb){var _2fc=_2fb;if(_2fb.dojoElementFromPoint){_2fb=_2fb.dojoElementFromPoint(_2fa.clientX,_2fa.clientY);}if(_2f7!==_2fb){if(_2f7){on.emit(_2fc,"dojotouchout",{target:_2f7,relatedTarget:_2fb,bubbles:true});}if(_2fb){on.emit(_2fc,"dojotouchover",{target:_2fb,relatedTarget:_2f7,bubbles:true});}_2f7=_2fb;}on.emit(_2fc,"dojotouchmove",{target:_2fb,bubbles:true});}});on(win.doc,"touchend",function(_2fd){var node=win.doc.elementFromPoint(_2fd.clientX,_2fd.clientY);var _2fe=node;if(node.dojoElementFromPoint){node=node.dojoElementFromPoint(_2fd.clientX,_2fd.clientY);}if(node){on.emit(_2fe,"dojotouchend",lang.delegate(_2fd,{target:node,bubbles:true}));}});});_2f5=function(node,_2ff){return on(node,"dojotouchmove",function(_300){_2ff(lang.delegate(_2f6,{target:_300.target,preventDefault:function(){_2f6.preventDefault();},stopPropagation:function(){_300.stopPropagation();}}));});};}var _301={press:_2ec("mousedown","touchstart","MSPointerDown"),move:_2ec("mousemove",_2f5,"MSPointerMove"),release:_2ec("mouseup","dojotouchend","MSPointerUp"),cancel:_2ec(_2e8.leave,"touchcancel",has("touch")?"MSPointerCancel":null),over:_2ec("mouseover","dojotouchover","MSPointerOver"),out:_2ec("mouseout","dojotouchout","MSPointerOut"),enter:_2e8._eventHandler(_2ec("mouseover","dojotouchover","MSPointerOver")),leave:_2e8._eventHandler(_2ec("mouseout","dojotouchout","MSPointerOut"))};1&&(dojo.touch=_301);return _301;});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_302,_303,lang,_304){return _302("dojox.grid.Selection",null,{constructor:function(_305){this.grid=_305;this.selected=[];this.setMode(_305.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_306){return this.grid.onCanSelect(_306);},onCanDeselect:function(_307){return this.grid.onCanDeselect(_307);},onSelected:function(_308){},onDeselected:function(_309){},onChanging:function(){},onChanged:function(){},isSelected:function(_30a){if(this.mode=="none"){return false;}return this.selected[_30a];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_30b){if(this.mode=="none"){return -1;}for(var i=_30b+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _30c=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_30c.push(i);}}return _30c;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_30d){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_30d);this.addToSelection(_30d);}else{this.toggleSelect(_30d);}},addToSelection:function(_30e){if(this.mode=="none"){return;}if(lang.isArray(_30e)){_303.forEach(_30e,this.addToSelection,this);return;}_30e=Number(_30e);if(this.selected[_30e]){this.selectedIndex=_30e;}else{if(this.onCanSelect(_30e)!==false){this.selectedIndex=_30e;var _30f=this.grid.getRowNode(_30e);if(_30f){_304.set(_30f,"aria-selected","true");}this._beginUpdate();this.selected[_30e]=true;this.onSelected(_30e);this._endUpdate();}}},deselect:function(_310){if(this.mode=="none"){return;}if(lang.isArray(_310)){_303.forEach(_310,this.deselect,this);return;}_310=Number(_310);if(this.selectedIndex==_310){this.selectedIndex=-1;}if(this.selected[_310]){if(this.onCanDeselect(_310)===false){return;}var _311=this.grid.getRowNode(_310);if(_311){_304.set(_311,"aria-selected","false");}this._beginUpdate();delete this.selected[_310];this.onDeselected(_310);this._endUpdate();}},setSelected:function(_312,_313){this[(_313?"addToSelection":"deselect")](_312);},toggleSelect:function(_314){if(lang.isArray(_314)){_303.forEach(_314,this.toggleSelect,this);return;}this.setSelected(_314,!this.selected[_314]);},_range:function(_315,inTo,func){var s=(_315>=0?_315:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_316,inTo){this._range(_316,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_317,inTo){this._range(_317,inTo,lang.hitch(this,"deselect"));},insert:function(_318){this.selected.splice(_318,0,false);if(this.selectedIndex>=_318){this.selectedIndex++;}},remove:function(_319){this.selected.splice(_319,1);if(this.selectedIndex>=_319){this.selectedIndex--;}},deselectAll:function(_31a){for(var i in this.selected){if((i!=_31a)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_31b,_31c,_31d){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_31b);}else{if(!_31d||this.rangeStartIndex<0){this.rangeStartIndex=_31b;}if(!_31c){this.deselectAll(_31b);}if(_31d){this.selectRange(this.rangeStartIndex,_31b);}else{if(_31c){this.toggleSelect(_31b);}else{this.addToSelection(_31b);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"dijit/_CssStateMixin":function(){define("dijit/_CssStateMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/has","dojo/_base/lang","dojo/on","dojo/ready","dojo/_base/window","./registry"],function(_31e,_31f,dom,_320,has,lang,on,_321,win,_322){var _323=_31f("dijit._CssStateMixin",[],{cssStateNodes:{},hovering:false,active:false,_applyAttributes:function(){this.inherited(arguments);_31e.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active","_opened"],function(attr){this.watch(attr,lang.hitch(this,"_setStateClass"));},this);for(var ap in this.cssStateNodes){this._trackMouseState(this[ap],this.cssStateNodes[ap]);}this._trackMouseState(this.domNode,this.baseClass);this._setStateClass();},_cssMouseEvent:function(_324){if(!this.disabled){switch(_324.type){case "mouseover":this._set("hovering",true);this._set("active",this._mouseDown);break;case "mouseout":this._set("hovering",false);this._set("active",false);break;case "mousedown":case "touchstart":this._set("active",true);break;case "mouseup":case "touchend":this._set("active",false);break;}}},_setStateClass:function(){var _325=this.baseClass.split(" ");function _326(_327){_325=_325.concat(_31e.map(_325,function(c){return c+_327;}),"dijit"+_327);};if(!this.isLeftToRight()){_326("Rtl");}var _328=this.checked=="mixed"?"Mixed":(this.checked?"Checked":"");if(this.checked){_326(_328);}if(this.state){_326(this.state);}if(this.selected){_326("Selected");}if(this._opened){_326("Opened");}if(this.disabled){_326("Disabled");}else{if(this.readOnly){_326("ReadOnly");}else{if(this.active){_326("Active");}else{if(this.hovering){_326("Hover");}}}}if(this.focused){_326("Focused");}var tn=this.stateNode||this.domNode,_329={};_31e.forEach(tn.className.split(" "),function(c){_329[c]=true;});if("_stateClasses" in this){_31e.forEach(this._stateClasses,function(c){delete _329[c];});}_31e.forEach(_325,function(c){_329[c]=true;});var _32a=[];for(var c in _329){_32a.push(c);}tn.className=_32a.join(" ");this._stateClasses=_325;},_subnodeCssMouseEvent:function(node,_32b,evt){if(this.disabled||this.readOnly){return;}function _32c(_32d){_320.toggle(node,_32b+"Hover",_32d);};function _32e(_32f){_320.toggle(node,_32b+"Active",_32f);};function _330(_331){_320.toggle(node,_32b+"Focused",_331);};switch(evt.type){case "mouseover":_32c(true);break;case "mouseout":_32c(false);_32e(false);break;case "mousedown":case "touchstart":_32e(true);break;case "mouseup":case "touchend":_32e(false);break;case "focus":case "focusin":_330(true);break;case "blur":case "focusout":_330(false);break;}},_trackMouseState:function(node,_332){node._cssState=_332;}});_321(function(){function _333(evt){if(!dom.isDescendant(evt.relatedTarget,evt.target)){for(var node=evt.target;node&&node!=evt.relatedTarget;node=node.parentNode){if(node._cssState){var _334=_322.getEnclosingWidget(node);if(_334){if(node==_334.domNode){_334._cssMouseEvent(evt);}else{_334._subnodeCssMouseEvent(node,node._cssState,evt);}}}}}};function _335(evt){evt.target=evt.srcElement;_333(evt);};var body=win.body(),_336=(has("touch")?[]:["mouseover","mouseout"]).concat(["mousedown","touchstart","mouseup","touchend"]);_31e.forEach(_336,function(type){if(body.addEventListener){body.addEventListener(type,_333,true);}else{body.attachEvent("on"+type,_335);}});on(body,"focusin, focusout",function(evt){var node=evt.target;if(node._cssState&&!node.getAttribute("widgetId")){var _337=_322.getEnclosingWidget(node);_337._subnodeCssMouseEvent(node,node._cssState,evt);}});});return _323;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_338,on,_339,_33a){return _338("dojox.gfx.Mover",null,{constructor:function(_33b,e,host){this.shape=_33b;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_33c=on(d,_339.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_339.move,lang.hitch(this,"onMouseMove")),on(d,_339.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_33a,"stop")),on(d,"selectstart",lang.hitch(_33a,"stop")),_33c];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_33a.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_33d){_33d.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_33e,lang,_33f){var _340=function(_341,_342){if(_341.style.cssText==undefined){_341.setAttribute("style",_342);}else{_341.style.cssText=_342;}};return _33e("dojox.grid._RowManager",null,{constructor:function(_343){this.grid=_343;},linesToEms:2,overRow:-2,prepareStylingRow:function(_344,_345){return {index:_344,node:_345,odd:Boolean(_344&1),selected:!!this.grid.selection.isSelected(_344),over:this.isOver(_344),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_346,_347){var row=this.prepareStylingRow(_346,_347);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_348){var i=_348;i.node.className=i.customClasses;var h=i.node.style.height;_340(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_349){this.grid.updateRowStyles(_349);},setOverRow:function(_34a){var last=this.overRow;this.overRow=_34a;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_34b){return (this.overRow==_34b&&!_33f.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"dojo/hccss":function(){define(["require","./_base/config","./dom-class","./dom-style","./has","./ready","./_base/window"],function(_34c,_34d,_34e,_34f,has,_350,win){has.add("highcontrast",function(){var div=win.doc.createElement("div");div.style.cssText="border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;"+"background-image: url("+(_34d.blankGif||_34c.toUrl("./resources/blank.gif"))+");";win.body().appendChild(div);var cs=_34f.getComputedStyle(div),_351=cs.backgroundImage,hc=(cs.borderTopColor==cs.borderRightColor)||(_351&&(_351=="none"||_351=="url(invalid-url:)"));if(has("ie")<=8){div.outerHTML="";}else{win.body().removeChild(div);}return hc;});_350(90,function(){if(has("highcontrast")){_34e.add(win.body(),"dj_a11y");}});return has;});},"dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_352,win,dom,_353,_354,_355,has,_356){return _352("dojo.dnd.Avatar",null,{constructor:function(_357){this.manager=_357;this.construct();},construct:function(){var a=_355.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_358=this.manager.source,node,b=_355.create("tbody",null,a),tr=_355.create("tr",null,b),td=_355.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_355.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_355.create("span",{innerHTML:_358.generateText?this._generateText():""},td);_353.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_358.creator){node=_358._normalizedCreator(_358.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _359=_355.create("table"),_35a=_355.create("tbody",null,_359);_35a.appendChild(node);node=_359;}}node.id="";tr=_355.create("tr",null,b);td=_355.create("td",null,tr);td.appendChild(node);_353.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_355.destroy(this.node);this.node=false;},update:function(){_354.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_356(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_35b,_35c,lang,util,html){var _35d=function(_35e){var i=0,n,p=_35e.parentNode;while((n=p.childNodes[i++])){if(n==_35e){return i-1;}}return -1;};var _35f=function(_360){if(!_360){return;}dojo.forEach(_35b.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_360,true)){w.destroy();}});};var _361=function(_362){var node=html.byId(_362);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _363=function(_364,_365){var _366=[];var i=0,n;while((n=_364.childNodes[i])){i++;if(_361(n)==_365){_366.push(n);}}return _366;};var _367=function(_368){return _363(_368,"div");};return _35c("dojox.grid._Scroller",null,{constructor:function(_369){this.setContentNodes(_369);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_36a,_36b,_36c){switch(arguments.length){case 3:this.rowsPerPage=_36c;case 2:this.keepRows=_36b;case 1:this.rowCount=_36a;default:break;}this.defaultPageHeight=(this.grid.rowHeight>0?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_36d,_36e){return _36d?(Math.ceil(_36d/_36e)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_36f){this.keepRows=_36f;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_370){this.contentNodes=_370;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_371){this.invalidateNodes();this.rowCount=_371;var _372=this.pageCount;if(_372===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_372){for(var i=_372-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_372){this.height+=this.defaultPageHeight*(this.pageCount-_372-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_373){return Boolean(this.getDefaultPageNode(_373));},measurePage:function(_374){if(this.grid.rowHeight){return ((_374+1)*this.rowsPerPage>this.rowCount?this.rowCount-_374*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight;}var n=this.getDefaultPageNode(_374);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_375,_376){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_375].style.top=_376+"px";}},repositionPages:function(_377){var _378=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_378[_377];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_377):0);for(var p=_377+1;p<=last;p++){n=_378[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_379){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_379]);}},preparePage:function(_37a,_37b){var p=(_37b?this.popPage():null);for(var i=0;i<this.colCount;i++){var _37c=this.pageNodes[i];var _37d=(p===null?this.createPageNode():this.invalidatePageNode(p,_37c));_37d.pageIndex=_37a;_37c[_37a]=_37d;}},renderPage:function(_37e){var _37f=[];var i,j;for(i=0;i<this.colCount;i++){_37f[i]=this.pageNodes[i][_37e];}for(i=0,j=_37e*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_37f);}},removePage:function(_380){for(var i=0,j=_380*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_381){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_381,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_382){},pacifying:false,pacifyTicks:200,setPacifying:function(_383){if(this.pacifying!=_383){this.pacifying=_383;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _384=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _384;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _385=(!this._invalidating);if(!_385){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_385=true;}}if(_385){this.needPage(this.page,this.pageTop);}var _386=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _387=this.getPageHeight(this.page);this.averageRowHeight=(_387>0&&_386>0)?(_387/_386):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _388=this.pageCount-1;var _389=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_388]=_389;return _389;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_38a,_38b,_38c){if(this.pageExists(_38a)){var oh=this.getPageHeight(_38a);var h=(this.measurePage(_38a));if(h===undefined){h=oh;}this.pageHeights[_38a]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_38b)){if(!_38c){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_38a);}}else{this.repositionPages(_38a);}}return h;}return 0;},rowHeightChanged:function(_38d,_38e){this.updatePageHeight(Math.floor(_38d/this.rowsPerPage),false,_38e);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_38f){var ph=this.pageHeights[_38f];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_390){return this.stack.push(_390);},popPage:function(){return this.stack.shift();},findPage:function(_391){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_391){break;}}this.page=i;this.pageTop=h;},buildPage:function(_392,_393,_394){this.preparePage(_392,_393);this.positionPage(_392,_394);this.installPage(_392);this.renderPage(_392);this.pushPage(_392);},needPage:function(_395,_396){var h=this.getPageHeight(_395),oh=h;if(!this.pageExists(_395)){this.buildPage(_395,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_396);h=this.updatePageHeight(_395,true);}else{this.positionPage(_395,_396);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_397){this.grid.scrollTop=_397;if(this.colCount){this.startPacify();this.findPage(_397);var h=this.height;var b=this.getScrollBottom(_397);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_397);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_398){return (this.windowHeight>=0?_398+this.windowHeight:-1);},processNodeEvent:function(e,_399){var t=e.target;while(t&&(t!=_399)&&t.parentNode&&(t.parentNode.parentNode!=_399)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_399)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_35d(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_39a,_39b){},removeRow:function(_39c){},getDefaultPageNode:function(_39d){return this.getDefaultNodes()[_39d];},positionPageNode:function(_39e,_39f){},getPageNodePosition:function(_3a0){return _3a0.offsetTop;},invalidatePageNode:function(_3a1,_3a2){var p=_3a2[_3a1];if(p){delete _3a2[_3a1];this.removePage(_3a1,p);_35f(p);p.innerHTML="";}return p;},getPageRow:function(_3a3){return _3a3*this.rowsPerPage;},getLastPageRow:function(_3a4){return Math.min(this.rowCount,this.getPageRow(_3a4+1))-1;},getFirstVisibleRow:function(_3a5,_3a6,_3a7){if(!this.pageExists(_3a5)){return 0;}var row=this.getPageRow(_3a5);var _3a8=this.getDefaultNodes();var rows=_367(_3a8[_3a5]);for(var i=0,l=rows.length;i<l&&_3a6<_3a7;i++,row++){_3a6+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_3a9,_3aa,_3ab){if(!this.pageExists(_3a9)){return 0;}var _3ac=this.getDefaultNodes();var row=this.getLastPageRow(_3a9);var rows=_367(_3ac[_3a9]);for(var i=rows.length-1;i>=0&&_3aa>_3ab;i--,row--){_3aa-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_3ad){var _3ae=this.getDefaultNodes();var rows=_367(_3ae[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_3ad){this.offset=h-(t-_3ad);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_3af){var _3b0=Math.floor(_3af/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_3b0;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_3b0;this.needPage(_3b0,this.pageTop);var _3b1=this.getDefaultNodes();var rows=_367(_3b1[_3b0]);var r=_3af-this.rowsPerPage*_3b0;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"url:esri/dijit/editing/templates/TemplatePicker.html":"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>","dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _3b2={};lang.setObject("dojo.data.util.filter",_3b2);_3b2.patternToRegExp=function(_3b3,_3b4){var rxp="^";var c=null;for(var i=0;i<_3b3.length;i++){c=_3b3.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_3b3.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_3b4){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _3b2;});},"esri/toolbars/_GraphicMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/Mover","dojox/gfx/matrix","esri/kernel","esri/geometry/webMercatorUtils","esri/geometry/ScreenPoint"],function(_3b5,lang,_3b6,_3b7,has,_3b8,_3b9,_3ba,_3bb,_3bc,_3bd,_3be){var GM=_3b5(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(_3bf,map,_3c0){this.graphic=_3bf;this.map=map;this.toolbar=_3c0;this._enableGraphicMover();this._moved=false;},refresh:function(_3c1){var _3c2=this.graphic.getDojoShape();if(_3c2&&(_3c1||!_3c2._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _3c3=this.graphic,_3c4=_3c3.getDojoShape();if(_3c4){_3c4._hostGraphic=_3c3;this._moveable=new _3b9(_3c4,{mover:GM.Mover});this._moveStartHandle=_3b6.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=_3b6.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_3b6.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=_3b6.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_3c4.getEventSource();if(node){_3b8.set(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _3c5=this._moveable;if(_3c5){_3b6.disconnect(this._moveStartHandle);_3b6.disconnect(this._firstMoveHandle);_3b6.disconnect(this._movingHandle);_3b6.disconnect(this._moveStopHandle);var _3c6=_3c5.shape;if(_3c6){_3c6._hostGraphic=null;var node=_3c6.getEventSource();if(node){_3b8.set(node,"cursor",null);}}_3c5.destroy();}this._moveable=null;},_moveStartHandler:function(){var _3c7=this.graphic,map=this.map;this._startTx=_3c7.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_3c7);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_3c8){this.toolbar.onGraphicMove(this.graphic,_3c8.shape.getTransform());},_moveStopHandler:function(_3c9){var _3ca=this.graphic,_3cb=this.toolbar,map=this.map,mx=_3bb,_3cc=_3cb._geo?_3bd.geographicToWebMercator(_3ca.geometry):_3ca.geometry,type=_3cc.type,_3cd=_3ca.getDojoShape(),tx=_3cd.getTransform();if(_3b7.toJson(tx)!==_3b7.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _3ce=[tx,mx.invert(this._startTx)],_3cf;if(map.snappingManager){_3cf=map.snappingManager._snappingPoint;}_3cc=_3cf||map.toMap(mx.multiplyPoint(_3ce,map.toScreen(_3cc,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_3cc=this._updatePolyGeometry(_3cc,_3cc.paths,tx);break;case "polygon":_3cc=this._updatePolyGeometry(_3cc,_3cc.rings,tx);break;}_3cd.setTransform(null);_3ca.setGeometry(_3cb._geo?_3bd.webMercatorToGeographic(_3cc,true):_3cc);}else{this._moved=false;}_3cb._endOperation("MOVE");_3cb.onGraphicMoveStop(_3ca,tx);if(!this._moved){var e=_3c9.__e,_3d0=this.map.position,pt=new _3be(e.pageX-_3d0.x,e.pageY-_3d0.y);_3cb.onGraphicClick(_3ca,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_3d1,_3d2,_3d3){var map=this.map,_3d4=_3d1.getPoint(0,0),_3d5=map.toMap(map.toScreen(_3d4).offset(_3d3.dx,_3d3.dy)),_3d6=_3d5.x-_3d4.x,_3d7=_3d5.y-_3d4.y,i,j,seg,_3d8;for(i=0;i<_3d2.length;i++){seg=_3d2[i];for(j=0;j<seg.length;j++){_3d8=_3d1.getPoint(i,j);_3d1.setPoint(i,j,_3d8.offset(_3d6,_3d7));}}return _3d1;}});GM.Mover=_3b5(_3ba,{declaredClass:"esri.toolbars._Mover",constructor:function(_3d9,e,host){this.__e=e;}});if(has("extend-esri")){lang.setObject("toolbars._GraphicMover",GM,_3bc);lang.setObject("toolbars._Mover",GM.Mover,_3bc);}return GM;});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_3da,_3db,_3dc,_3dd,keys,_3de,_3df,_3e0,lang){return _3de("dijit._KeyNavContainer",[_3dc,_3db],{tabIndex:"0",connectKeyNavHandlers:function(_3e1,_3e2){var _3e3=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_3dd.forEach(_3e1,function(code){_3e3[code]=prev;});_3dd.forEach(_3e2,function(code){_3e3[code]=next;});_3e3[keys.HOME]=lang.hitch(this,"focusFirstChild");_3e3[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_3da.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_3dd.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_3e4,_3e5){this.inherited(arguments);this._startupChild(_3e4);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_3e6,last){if(!_3e6){return;}if(this.focusedChild&&_3e6!==this.focusedChild){this._onChildBlur(this.focusedChild);}_3e6.set("tabIndex",this.tabIndex);_3e6.focus(last?"end":"start");this._set("focusedChild",_3e6);},_startupChild:function(_3e7){_3e7.set("tabIndex","-1");this.connect(_3e7,"_onFocus",function(){_3e7.set("tabIndex",this.tabIndex);});this.connect(_3e7,"_onBlur",function(){_3e7.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_3e0.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_3e0.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_3df.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_3e8,dir){if(_3e8){_3e8=this._getSiblingOfChild(_3e8,dir);}var _3e9=this.getChildren();for(var i=0;i<_3e9.length;i++){if(!_3e8){_3e8=_3e9[(dir>0)?0:(_3e9.length-1)];}if(_3e8.isFocusable()){return _3e8;}_3e8=this._getSiblingOfChild(_3e8,dir);}return null;}});});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_3ea,_3eb,_3ec,has){return _3eb("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_3ed){var i=_3ed;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_3ed);this.edit.styleRow(_3ed);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _3ee;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_3ee=this.focus.getHeaderIndex();if(_3ee>=0){this.setSortIndex(_3ee);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_3ec.stop(e);}if(!e.shiftKey){var _3ef=this.edit.isEditing();this.edit.apply();if(!_3ef){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _3f0=this.focus.focusView||this.views.views[0];_3f0.content.decorateEvent(e);this.onRowClick(e);_3ec.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_3ee=this.focus.getHeaderIndex();if(_3ee>=0){this.setSortIndex(_3ee);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_3ec.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _3f1=e.keyCode;_3ec.stop(e);_3ee=this.focus.getHeaderIndex();if(_3ee>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_3ee,(_3f1==keys.LEFT_ARROW?-1:1)*5);}else{var _3f2=(_3f1==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_3f2*=-1;}this.focus.move(0,_3f2);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_3ec.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_3ec.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_3ec.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_3ec.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_3ea.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_3ea.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _3f3;if(this._click.length>1&&has("ie")){_3f3=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_3f3=this._click[0];}else{_3f3=e;}}this.focus.setFocusCell(_3f3.cell,_3f3.rowIndex);this.onRowClick(_3f3);this.edit.setEditCell(_3f3.cell,_3f3.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_3f4,_3f5){this.edit.cellFocus(_3f4,_3f5);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_3ec.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_3ea.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_3ea.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_3ec.stop(e);}},onStartEdit:function(_3f6,_3f7){},onApplyCellEdit:function(_3f8,_3f9,_3fa){},onCancelEdit:function(_3fb){},onApplyEdit:function(_3fc){},onCanSelect:function(_3fd){return true;},onCanDeselect:function(_3fe){return true;},onSelected:function(_3ff){this.updateRowStyles(_3ff);},onDeselected:function(_400){this.updateRowStyles(_400);},onSelectionChanged:function(){}});});},"dojo/dnd/autoscroll":function(){define(["../_base/lang","../sniff","../_base/window","../dom-geometry","../dom-style","../window"],function(lang,has,win,_401,_402,_403){var _404={};lang.setObject("dojo.dnd.autoscroll",_404);_404.getViewport=_403.getBox;_404.V_TRIGGER_AUTOSCROLL=32;_404.H_TRIGGER_AUTOSCROLL=32;_404.V_AUTOSCROLL_VALUE=16;_404.H_AUTOSCROLL_VALUE=16;var _405,doc=win.doc,_406=Infinity,_407=Infinity;_404.autoScrollStart=function(d){doc=d;_405=_403.getBox(doc);var html=win.body(doc).parentNode;_406=Math.max(html.scrollHeight-_405.h,0);_407=Math.max(html.scrollWidth-_405.w,0);};_404.autoScroll=function(e){var v=_405||_403.getBox(doc),html=win.body(doc).parentNode,dx=0,dy=0;if(e.clientX<_404.H_TRIGGER_AUTOSCROLL){dx=-_404.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-_404.H_TRIGGER_AUTOSCROLL){dx=Math.min(_404.H_AUTOSCROLL_VALUE,_407-html.scrollLeft);}}if(e.clientY<_404.V_TRIGGER_AUTOSCROLL){dy=-_404.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-_404.V_TRIGGER_AUTOSCROLL){dy=Math.min(_404.V_AUTOSCROLL_VALUE,_406-html.scrollTop);}}window.scrollBy(dx,dy);};_404._validNodes={"div":1,"p":1,"td":1};_404._validOverflow={"auto":1,"scroll":1};_404.autoScrollNodes=function(e){var b,t,w,h,rx,ry,dx=0,dy=0,_408,_409;for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in _404._validNodes)){var s=_402.getComputedStyle(n),_40a=(s.overflow.toLowerCase() in _404._validOverflow),_40b=(s.overflowX.toLowerCase() in _404._validOverflow),_40c=(s.overflowY.toLowerCase() in _404._validOverflow);if(_40a||_40b||_40c){b=_401.getContentBox(n,s);t=_401.position(n,true);}if(_40a||_40b){w=Math.min(_404.H_TRIGGER_AUTOSCROLL,b.w/2);rx=e.pageX-t.x;if(has("webkit")||has("opera")){rx+=win.body().scrollLeft;}dx=0;if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}_408=n.scrollLeft;n.scrollLeft=n.scrollLeft+dx;}}if(_40a||_40c){h=Math.min(_404.V_TRIGGER_AUTOSCROLL,b.h/2);ry=e.pageY-t.y;if(has("webkit")||has("opera")){ry+=win.body().scrollTop;}dy=0;if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}_409=n.scrollTop;n.scrollTop=n.scrollTop+dy;}}if(dx||dy){return;}}try{n=n.parentNode;}catch(x){n=null;}}_404.autoScroll(e);};return _404;});},"dijit/Destroyable":function(){define("dijit/Destroyable",["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(_40d,_40e,_40f){return _40f("dijit.Destroyable",null,{destroy:function(_410){this._destroyed=true;},own:function(){_40d.forEach(arguments,function(_411){var _412="destroyRecursive" in _411?"destroyRecursive":"destroy" in _411?"destroy":"remove";var odh=_40e.before(this,"destroy",function(_413){_411[_412](_413);});var hdh=_40e.after(_411,_412,function(){odh.remove();hdh.remove();},true);},this);return arguments;}});});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/date/locale","dojo/sniff","dojo/io-query","dojo/dom-construct","dojo/i18n","esri/kernel","esri/lang","esri/request","esri/deferredUtils","esri/SpatialReference","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/jsonUtils","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/jsonUtils","esri/tasks/QueryTask","esri/tasks/query","esri/tasks/FeatureSet","esri/geometry/Extent","esri/geometry/jsonUtils","esri/geometry/normalizeUtils","esri/layers/GraphicsLayer","esri/layers/Field","esri/layers/TimeInfo","esri/layers/FeatureType","esri/layers/FeatureTemplate","esri/layers/FeatureEditResult","esri/layers/SnapshotMode","esri/layers/OnDemandMode","esri/layers/SelectionMode","esri/layers/TrackManager","dojo/i18n!esri/nls/jsapi","dojo/has!extend-esri?esri/layers/agscommon"],function(_414,_415,lang,_416,_417,_418,_419,has,ioq,_41a,i18n,_41b,_41c,_41d,_41e,_41f,_420,_421,_422,_423,_424,_425,_426,_427,_428,_429,_42a,_42b,_42c,_42d,_42e,_42f,_430,_431,_432,_433,_434,_435,_436){var _437=_414(_42d,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",constructor:function(url,_438){this.i18n=i18n.getLocalization("esri","jsapi");this._outFields=_438&&_438.outFields;this._loadCallback=_438&&_438.loadCallback;var _439=_438&&_438._usePatch;this._usePatch=(_439===null||_439===undefined)?true:_439;this._trackIdField=_438&&_438.trackIdField;this.objectIdField=_438&&_438.objectIdField;this._maxOffset=_438&&_438.maxAllowableOffset;this._optEditable=_438&&_438.editable;this._optAutoGen=_438&&_438.autoGeneralize;this.editSummaryCallback=_438&&_438.editSummaryCallback;this.userId=_438&&_438.userId;this.userIsAdmin=_438&&_438.userIsAdmin;this.useMapTime=(_438&&_438.hasOwnProperty("useMapTime"))?(!!_438.useMapTime):true;this.source=_438&&_438.source;this.gdbVersion=_438&&_438.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(_41c.isDefined(_438&&_438.mode)?_438.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new _433(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_438&&_438.tileWidth)||512;this._tileHeight=(_438&&_438.tileHeight)||512;this._mode=new _434(this);var _43a=_438&&_438.latticeTiling;this.latticeTiling=_43a;break;case ctor.MODE_SELECTION:this._mode=new _435(this);this._isSelOnly=true;break;}this._initLayer=lang.hitch(this,this._initLayer);this._selectHandler=lang.hitch(this,this._selectHandler);this._editable=false;if(lang.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new _427(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _43b=this._url.path;this._fserver=false;if(_43b.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _43c=_438&&_438.resourceInfo;if(_43c){this._initLayer(_43c);}else{if(this.source){var _43d={source:this.source.toJson()};this._url.query=lang.mixin(this._url.query,{layer:_417.toJson(_43d)});}if(this.gdbVersion){this._url.query=lang.mixin(this._url.query,{gdbVersion:this.gdbVersion});}_41d({url:_43b,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_43e,io){if(_43e||io){this._json=_43e;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_43e&&_43e._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new _433(this);this._isSnapshot=true;this._featureSet=_43e.featureSet;this._nextId=_43e.nextObjectId;_43e=_43e.layerDefinition;}if(_43e.hasOwnProperty("capabilities")){var _43f=(this.capabilities=_43e.capabilities);if(_43f&&_43f.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(_41c.isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_417.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_43e.geometryType==="esriGeometryPolyline")||(_43e.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_41c.isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _440=_43e.effectiveMinScale||_43e.minScale,_441=_43e.effectiveMaxScale||_43e.maxScale;if(!this._hasMin&&_440){this.setMinScale(_440);}if(!this._hasMax&&_441){this.setMaxScale(_441);}this.layerId=_43e.id;this.name=_43e.name;this.description=_43e.description;this.copyright=_43e.copyrightText;this.type=_43e.type;this.geometryType=_43e.geometryType;this.displayField=_43e.displayField;this.defaultDefinitionExpression=_43e.definitionExpression;this.fullExtent=new _42a(_43e.extent);this.initialExtent=new _42a(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new _41f(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_43e.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_43e.indexedFields;this.maxRecordCount=_43e.maxRecordCount;this.canModifyLayer=_43e.canModifyLayer;this.supportsStatistics=_43e.supportsStatistics;this.supportsAdvancedQueries=_43e.supportsAdvancedQueries;this.hasLabels=_43e.hasLabels;this.canScaleSymbols=_43e.canScaleSymbols;this.supportsRollbackOnFailure=_43e.supportsRollbackOnFailure;this.syncCanReturnChanges=_43e.syncCanReturnChanges;this.isDataVersioned=_43e.isDataVersioned;this.editFieldsInfo=_43e.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_43e.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_43e.relationships;this.allowGeometryUpdates=_41c.isDefined(_43e.allowGeometryUpdates)?_43e.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _442=(this.fields=[]),_443=_43e.fields,i;for(i=0;i<_443.length;i++){_442.push(new _42e(_443[i]));}if(!this.objectIdField){this.objectIdField=_43e.objectIdField;if(!this.objectIdField){_443=_43e.fields;for(i=0;i<_443.length;i++){var _444=_443[i];if(_444.type==="esriFieldTypeOID"){this.objectIdField=_444.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+_41c.substitute({url:this.url},"objectIdField is not set [url: ${url}]"));}}if(!_41c.isDefined(this._nextId)){var _445=this.objectIdField,_446=-1;if(this._collection&&_445){var fset=this._featureSet,_447=fset&&fset.features,il=_447?_447.length:0,oid,attr;for(i=0;i<il;i++){attr=_447[i].attributes;oid=attr&&attr[_445];if(oid>_446){_446=oid;}}}this._nextId=(_446+1);}this.globalIdField=_43e.globalIdField;var _448=(this.typeIdField=_43e.typeIdField),_449;if(_448){_449=!this._getField(_448)&&this._getField(_448,true);if(_449){this.typeIdField=_449.name;}}this.visibilityField=_43e.visibilityField;var _44a=_43e.defaultSymbol;if(_44a){this.defaultSymbol=_423.fromJson(_44a);}var _44b=this.types=[],_44c=_43e.types,_44d,_44e,_44f,_450=this.editFieldsInfo,_451=_450&&_450.creatorField,_452=_450&&_450.editorField,fix=(_451||_452),_453=[];if(_44c){for(i=0;i<_44c.length;i++){_44d=new _430(_44c[i]);_44e=_44d.templates;if(fix&&_44e&&_44e.length){_453=_453.concat(_44e);}_44b.push(_44d);}}var _454=_43e.templates,_455,_456=this.templates=[];if(_454){for(i=0;i<_454.length;i++){_455=new _431(_454[i]);if(fix){_453.push(_455);}_456.push(_455);}}for(i=0;i<_453.length;i++){_44f=lang.getObject("prototype.attributes",false,_453[i]);if(_44f){if(_451){delete _44f[_451];}if(_452){delete _44f[_452];}}}var _457=_43e.timeInfo;if(_457){this.timeInfo=new _42f(_457);this._startTimeField=_457.startTimeField;this._endTimeField=_457.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_457.trackIdField=this._trackIdField;}else{this._trackIdField=_457.trackIdField;}}this.hasAttachments=(!this._collection&&_43e.hasAttachments)?true:false;this.htmlPopupType=_43e.htmlPopupType;var _458=_43e.drawingInfo,_459;if(!this.renderer){if(_458&&_458.renderer){_459=_458.renderer;this.setRenderer(_426.fromJson(_459));if(_459.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _45a=_459.type,_45b=[];_459=this.renderer;switch(_45a){case "simple":_45b.push(_459.symbol);break;case "uniqueValue":case "classBreaks":_45b.push(_459.defaultSymbol);_45b=_45b.concat(_416.map(_459.infos,function(info){return info.symbol;}));break;}_45b=_416.filter(_45b,_41c.isDefined);var _45c=this._url.path+"/images/",_45d=this._getToken();_416.forEach(_45b,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_45c+url;}if(_45d&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_45d);}}});}}else{if(_44a){_44c=this.types;if(_44c.length>0){_459=new _425(this.defaultSymbol,this.typeIdField);_416.forEach(_44c,function(type){_459.addValue(type.id,type.symbol);});}else{_459=new _424(this.defaultSymbol);}this.setRenderer(_459);}else{if(!this._isTable){var _45e;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_45e=new _420();break;case "esriGeometryPolyline":_45e=new _421();break;case "esriGeometryPolygon":_45e=new _422();break;}this.setRenderer(_45e?new _424(_45e):null);}}}}var _45f=(_458&&_458.transparency)||0;if(!_41c.isDefined(this.opacity)&&_45f>0){this.opacity=1-(_45f/100);}this.version=_43e.currentVersion;if(!this.version){var ver;if("capabilities" in _43e||"drawingInfo" in _43e||"hasAttachments" in _43e||"htmlPopupType" in _43e||"relationships" in _43e||"timeInfo" in _43e||"typeIdField" in _43e||"types" in _43e){ver=10;}else{ver=9.3;}this.version=ver;}if((has("ie")||has("safari"))&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _460=function(){this.onLoad(this);var _461=this._loadCallback;if(_461){delete this._loadCallback;_461(this);}};if(this._collection){this._fireUpdateStart();var _462=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new _429(_462));this._fcAdded=true;_460.call(this);}else{this._forceIdentity(_460);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _463=this.renderer;if(_463){this._ager=(_463.declaredClass.indexOf("TemporalRenderer")!==-1&&_463.observationAger&&_463.observationRenderer);var _464=_416.filter([_463,_463.observationRenderer,_463.latestObservationRenderer,_463.trackRenderer],_41c.isDefined);var _465=[];_416.forEach(_464,function(rnd){if(!lang.isFunction(rnd.attributeField)){_465.push(rnd.attributeField);}_465.push(rnd.attributeField2);_465.push(rnd.attributeField3);},this);this._rendererFields=_416.filter(_465,_41c.isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map){var div=this.inherited(arguments),mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_415.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_466){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_466;return this;}var _467=this._editable;this._editable=_466;this._updateCaps();if(_467!==_466){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_468){var _469={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _469;}var _46a=_468&&_468.feature,_46b=_468&&_468.userId,caps=_416.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),lang.trim),_46c=_416.indexOf(caps,"editing")>-1,_46d=_46c&&(_416.indexOf(caps,"create")>-1),_46e=_46c&&(_416.indexOf(caps,"update")>-1),_46f=_46c&&(_416.indexOf(caps,"delete")>-1),_470=this.ownershipBasedAccessControlForFeatures,_471=this.editFieldsInfo,_472=_471&&_471.creatorField,_473=_471&&_471.realm,_474=_46a&&_46a.attributes,_475=(_474&&_472)?_474[_472]:undefined,_476,_477=!!this.userIsAdmin,_478=!_470||_477||!!(_470.allowOthersToUpdate||_470.allowUpdateToOthers),_479=!_470||_477||!!(_470.allowOthersToDelete||_470.allowDeleteToOthers);if(_477||(_46c&&!(_46d||_46e||_46f))){_46d=_46e=_46f=true;}_476={"canCreate":_46d,"canUpdate":_46e,"canDelete":_46f};if(_475===null){_476.canUpdate=_46e&&_478;_476.canDelete=_46f&&_479;}else{if(_475===""){return _476;}else{if(_475){_46b=_46b||this.getUserId();if(_46b&&_473){_46b=_46b+"@"+_473;}if(_46b.toLowerCase()===_475.toLowerCase()){return _476;}else{_476.canUpdate=_46e&&_478;_476.canDelete=_46f&&_479;}}}}return _476;},getUserId:function(){var _47a;if(this.loaded){_47a=(this.credential&&this.credential.userId)||this.userId||"";}return _47a;},setUserIsAdmin:function(_47b){this.userIsAdmin=_47b;},setEditSummaryCallback:function(_47c){this.editSummaryCallback=_47c;},getEditSummary:function(_47d,_47e,_47f){_47f=_41c.isDefined(_47f)?_47f:(new Date()).getTime();var _480="",info=this.getEditInfo(_47d,_47e,_47f),_481=(_47e&&_47e.callback)||this.editSummaryCallback;if(_481){info=_481(_47d,info)||"";}if(lang.isString(info)){_480=info;}else{if(info){var _482=info.action,_483=info.userId,_484=info.timeValue,_485=0;if(_482){_485++;}if(_483){_485++;}if(_41c.isDefined(_484)){_485++;}if(_485>1){_480=(_482==="edit"?"edit":"create")+(_483?"User":"")+(_41c.isDefined(_484)?info.displayPattern:"");}}_480=_480&&_41c.substitute(info,this.i18n.layers.FeatureLayer[_480]);}return _480;},getEditInfo:function(_486,_487,_488){if(!this.loaded){return;}_488=_41c.isDefined(_488)?_488:(new Date()).getTime();var _489=(_487&&_487.action)||"last",_48a=this.editFieldsInfo,_48b=_48a&&_48a.creatorField,_48c=_48a&&_48a.creationDateField,_48d=_48a&&_48a.editorField,_48e=_48a&&_48a.editDateField,_48f=_48a&&_48a.realm,_490=_486&&_486.attributes,_491=(_490&&_48b)?_490[_48b]:undefined,_492=(_490&&_48c)?_490[_48c]:null,_493=(_490&&_48d)?_490[_48d]:undefined,_494=(_490&&_48e)?_490[_48e]:null,_495=this._getEditData(_491,_492,_488),_496=this._getEditData(_493,_494,_488),_497;switch(_489){case "creation":_497=_495;break;case "edit":_497=_496;break;case "last":_497=_496||_495;break;}if(_497){_497.action=(_497===_496)?"edit":"creation";}return _497;},_getEditData:function(_498,_499,_49a){var data,_49b,_49c,_49d=60000,_49e=3600000,_49f=2*_49e,_4a0=24*_49e,_4a1=7*_4a0;if(_41c.isDefined(_499)){_49b=_49a-_499;if(_49b<0){_49c="Full";}else{if(_49b<_49d){_49c="Seconds";}else{if(_49b<(2*_49d)){_49c="Minute";}else{if(_49b<_49e){_49c="Minutes";}else{if(_49b<_49f){_49c="Hour";}else{if(_49b<_4a0){_49c="Hours";}else{if(_49b<_4a1){_49c="WeekDay";}else{_49c="Full";}}}}}}}}if((_498!==undefined)||_49c){data=data||{};data.userId=_498;if(_49c){var _4a2=_419.format,_4a3=new Date(_499);data.minutes=Math.floor(_49b/_49d);data.hours=Math.floor(_49b/_49e);data.weekDay=_4a2(_4a3,{datePattern:"EEEE",selector:"date"});data.formattedDate=_4a2(_4a3,{selector:"date"});data.formattedTime=_4a2(_4a3,{selector:"time"});data.displayPattern=_49c;data.timeValue=_499;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_4a4){if(!this.isEditable()){this._maxOffset=_4a4;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_4a5){if(!this.loaded){this._optAutoGen=_4a5;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_4a5;if(_4a5){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_4a6){if(!this._collection&&(_4a6!==this.gdbVersion)&&(_4a6||this.gdbVersion)){this.gdbVersion=_4a6;this._task.gdbVersion=_4a6;this._url.query=lang.mixin(this._url.query,{gdbVersion:_4a6});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_4a7){if(this._isSnapshot){this._timeDefn=_4a7;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_4a8,_4a9){this._timeOffset=_4a8;this._timeOffsetUnits=_4a9;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_4aa,_4ab,_4ac,_4ad){_4ab=_4ab||this.constructor.SELECTION_NEW;var _4ae=this._getShallowClone(_4aa),map=this._map,_4af,dfd=_41e._fixDfd(new _418(_41e._dfdCanceller));_4ae.outFields=this._getOutFields();_4ae.returnGeometry=true;if(map){_4ae.outSpatialReference=new _41f(map.spatialReference.toJson());}if(!this._applyQueryFilters(_4ae)){_4af={features:[]};this._selectHandler(_4af,_4ab,_4ac,_4ad,dfd);return dfd;}var _4b0=this._canDoClientSideQuery(_4ae);if(_4b0){_4af={features:this._doQuery(_4ae,_4b0)};this._selectHandler(_4af,_4ab,_4ac,_4ad,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+this.invalidParams);this._resolve([err],null,_4ad,dfd,true);return dfd;}var self=this;if(this._ts){_4ae._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_4ae);temp.addCallbacks(function(_4b1){self._selectHandler(_4b1,_4ab,_4ac,_4ad,dfd);},function(err){self._resolve([err],null,_4ad,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _4b2=this._selectedFeatures,_4b3=[],item;for(item in _4b2){if(_4b2.hasOwnProperty(item)){_4b3.push(_4b2[item]);}}return _4b3;},clearSelection:function(_4b4){var _4b5=this._selectedFeatures,mode=this._mode,item;for(item in _4b5){if(_4b5.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_4b4){this.onSelectionClear();}return this;},setSelectionSymbol:function(_4b6){this._selectionSymbol=_4b6;if(_4b6){var _4b7=this._selectedFeatures,item;for(item in _4b7){if(_4b7.hasOwnProperty(item)){_4b7[item].setSymbol(_4b6);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_4b8,_4b9,_4ba,_4bb,_4bc){var _4bd=_4bc.assembly,dfd=_4bc.dfd;this._applyNormalized(adds,_4bd&&_4bd[0]);this._applyNormalized(_4b8,_4bd&&_4bd[1]);this.onBeforeApplyEdits(adds,_4b8,_4b9);var i,_4be={},_4bf=this.objectIdField,_4c0={f:"json"},_4c1=false;if(this._collection){var _4c2={};_4c2.addResults=adds?_416.map(adds,function(){_4c1=true;return {objectId:this._nextId++,success:true};},this):null;_4c2.updateResults=_4b8?_416.map(_4b8,function(_4c3){_4c1=true;var oid=_4c3.attributes[_4bf];_4be[oid]=_4c3;return {objectId:oid,success:true};},this):null;_4c2.deleteResults=_4b9?_416.map(_4b9,function(_4c4){_4c1=true;return {objectId:_4c4.attributes[_4bf],success:true};},this):null;if(_4c1){this._editHandler(_4c2,adds,_4be,_4ba,_4bb,dfd);}return;}if(adds&&adds.length>0){_4c0.adds=this._convertFeaturesToJson(adds,0,1);_4c1=true;}if(_4b8&&_4b8.length>0){for(i=0;i<_4b8.length;i++){var _4c5=_4b8[i];_4be[_4c5.attributes[_4bf]]=_4c5;}_4c0.updates=this._convertFeaturesToJson(_4b8,0,0,1);_4c1=true;}if(_4b9&&_4b9.length>0){var ids=[];for(i=0;i<_4b9.length;i++){ids.push(_4b9[i].attributes[_4bf]);}_4c0.deletes=ids.join(",");_4c1=true;}if(_4c1){var self=this;return _41d({url:this._url.path+"/applyEdits",content:lang.mixin(_4c0,this._url.query),callbackParamName:"callback",load:function(_4c6){self._editHandler(_4c6,adds,_4be,_4ba,_4bb,dfd);},error:function(err){self._resolve([err],null,_4bb,dfd,true);}},{usePost:true});}},queryFeatures:function(_4c7,_4c8,_4c9){return this._query("execute","onQueryFeaturesComplete",_4c7,_4c8,_4c9);},queryRelatedFeatures:function(_4ca,_4cb,_4cc){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_4ca,_4cb,_4cc);},queryIds:function(_4cd,_4ce,_4cf){return this._query("executeForIds","onQueryIdsComplete",_4cd,_4ce,_4cf);},queryCount:function(_4d0,_4d1,_4d2){return this._query("executeForCount","onQueryCountComplete",_4d0,_4d1,_4d2);},queryAttachmentInfos:function(_4d3,_4d4,_4d5){var url=this._url.path+"/"+_4d3+"/attachments",dfd=new _418(_41e._dfdCanceller),self=this;dfd._pendingDfd=_41d({url:url,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_4d6){var _4d7=_4d6.attachmentInfos,_4d8;_416.forEach(_4d7,function(info){_4d8=ioq.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_4d8?("?"+_4d8):"");info.objectId=_4d3;});self._resolve([_4d7],"onQueryAttachmentInfosComplete",_4d4,dfd);},error:function(err){self._resolve([err],null,_4d5,dfd,true);}});return dfd;},addAttachment:function(_4d9,_4da,_4db,_4dc){return this._sendAttachment("add",_4d9,_4da,_4db,_4dc);},updateAttachment:function(_4dd,_4de,_4df,_4e0,_4e1){_4df.appendChild(_41a.create("input",{type:"hidden",name:"attachmentId",value:_4de}));return this._sendAttachment("update",_4dd,_4df,_4e0,_4e1);},deleteAttachments:function(_4e2,_4e3,_4e4,_4e5){var url=this._url.path+"/"+_4e2+"/deleteAttachments",dfd=new _418(_41e._dfdCanceller),self=this,_4e6={f:"json",attachmentIds:_4e3.join(",")};dfd._pendingDfd=_41d({url:url,content:lang.mixin(_4e6,this._url.query),callbackParamName:"callback",load:lang.hitch(this,function(_4e7){var _4e8=_4e7.deleteAttachmentResults;_4e8=_416.map(_4e8,function(_4e9){var res=new _432(_4e9);res.attachmentId=res.objectId;res.objectId=_4e2;return res;});self._resolve([_4e8],"onDeleteAttachmentsComplete",_4e4,dfd);}),error:function(err){self._resolve([err],null,_4e5,dfd,true);}},{usePost:true});return dfd;},addType:function(_4ea){var _4eb=this.types;if(_4eb){var _4ec=_416.some(_4eb,function(type){if(type.id==_4ea.id){return true;}return false;});if(_4ec){return false;}else{_4eb.push(_4ea);}}else{this.types=[_4ea];}this._typesDirty=true;return true;},deleteType:function(_4ed){if(!this._collection){return;}var _4ee=this.types;if(_4ee){var _4ef=-1;_416.some(_4ee,function(type,_4f0){if(type.id==_4ed){_4ef=_4f0;return true;}return false;});if(_4ef>-1){this._typesDirty=true;return _4ee.splice(_4ef,1)[0];}}},toJson:function(){var _4f1=this._json,json=lang.isString(_4f1)?_417.fromJson(_4f1):lang.clone(_4f1);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _4f2=json.layerDefinition,_4f3=this._collection;if(_4f3&&this._typesDirty){_4f2.types=_416.map(this.types||[],function(type){return type.toJson();});var _4f4=this.renderer,_4f5=_4f2.drawingInfo;if(_4f5&&_4f4&&_4f4.declaredClass.indexOf("TemporalRenderer")===-1){_4f5.renderer=_4f4.toJson();}}var _4f6=null;if(!(_4f3&&!this._fcAdded)){_4f6={geometryType:_4f2.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=lang.mixin({},json.featureSet||{},_4f6);if(_4f3){json.nextObjectId=this._nextId;_4f2.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_4f7){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&_41b.id&&_41b.id._hasPortalSession()&&_41b.id._doPortalSignIn(path)){_41b.id.getCredential(path).then(function(){self._findCredential();_4f7.call(self);},function(){_4f7.call(self);});}else{_4f7.call(this);}},_updateCaps:function(){var _4f8=this._editable,_4f9=lang.trim(this.capabilities||""),_4fa=_416.map((_4f9?_4f9.split(","):[]),lang.trim),caps=_416.map((_4f9?_4f9.toLowerCase().split(","):[]),lang.trim),_4fb=_416.indexOf(caps,"editing"),cap,i,_4fc,_4fd={"Create":_416.indexOf(caps,"create"),"Update":_416.indexOf(caps,"update"),"Delete":_416.indexOf(caps,"delete")};if(_4f8&&_4fb===-1){_4fa.push("Editing");}else{if(!_4f8&&_4fb>-1){_4fc=[_4fb];for(cap in _4fd){if(_4fd[cap]>-1){_4fc.push(_4fd[cap]);}}_4fc.sort();for(i=_4fc.length-1;i>=0;i--){_4fa.splice(_4fc[i],1);}}}this.capabilities=_4fa.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_4fe=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_4fe&&(_4fe.latestObservationRenderer||_4fe.trackRenderer))){this._trackManager=new _436(this);this._trackManager.initialize(map);}}this._zoomConnect=_415.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.startup():mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_4ff){var map=this._map;if(_4ff&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_415.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_415.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_500){this._mapTimeExtent=_500;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_501){var _502=this._timeOffset,_503=this._timeOffsetUnits;return (_501&&_502&&_503)?_501.offset(-1*_502,_503):_501;},_getTimeOverlap:function(_504,_505){if(_504&&_505){return _504.intersection(_505);}else{return _504||_505;}},_getTimeFilter:function(_506){var _507=this.getTimeDefinition(),_508=null,_509;if(_507||_508){_509=this._getTimeOverlap(_507,_508);if(!_509){return [false];}}if(_506){_506=_509?this._getTimeOverlap(_506,_509):_506;if(!_506){return [false];}}else{_506=_509;}return [true,_506];},_getAttributeFilter:function(_50a){var _50b=this.getDefinitionExpression();if(_50a){_50a=_50b?"("+_50b+") AND ("+_50a+")":_50a;}else{_50a=_50b;}return _50a;},_applyQueryFilters:function(_50c){_50c.where=this._getAttributeFilter(_50c.where);_50c.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _50d=this._getTimeFilter(_50c.timeExtent);if(!_50d[0]){return false;}else{_50c.timeExtent=_50d[1];}}return true;},_add:function(_50e){var _50f=this._selectionSymbol,attr=_50e.attributes,_510=this.visibilityField;if(_50f&&this._isSelOnly){_50e.setSymbol(_50f);}if(_510&&attr&&attr.hasOwnProperty(_510)){_50e[attr[_510]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_511){var _512=[],map=this._map;if(this._isTable||!map){return;}if(_511.text||(_511.where&&_511.where!==this.getDefinitionExpression())){return;}var _513=this._isSnapshot,_514=this._isSelOnly;var _515=_511.geometry;if(_515){if(!_514&&_511.spatialRelationship===_428.SPATIAL_REL_INTERSECTS&&(_515.type==="extent"&&(_513||map.extent.contains(_515)))){_512.push(1);}else{return;}}var ids=_511.objectIds;if(ids){if(_513){_512.push(2);}else{var len=ids.length,mode=this._mode,_516=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_516++;}}if(_516===len){_512.push(2);}else{return;}}}if(this.timeInfo){var _517=_511.timeExtent,_518=this._mapTimeExtent;if(_513){if(_517){_512.push(3);}}else{if(_514){if(_517){return;}}else{if(_518){if(_416.indexOf(_512,2)!==-1){if(_517){_512.push(3);}}else{return;}}else{if(_512.length>0){if(_517){_512.push(3);}}else{if(_517){return;}}}}}}return _512.length>0?_512:null;},_doQuery:function(_519,_51a,_51b){var _51c=[],mode=this._mode,_51d=this.objectIdField,i,len,_51e;if(_416.indexOf(_51a,2)!==-1){_51c=[];var ids=_519.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_51c.push(obj);}}if(_51c.length===0){return [];}}if(_416.indexOf(_51a,1)!==-1){_51e=_51c.length>0?_51c:this.graphics;len=_51e.length;var _51f=_519.geometry._normalize(null,true);_51c=[];for(i=0;i<len;i++){var _520=_51e[i],_521=_520.geometry;if(_521){if(this.normalization&&_51f.length){if(_51f[0].intersects(_521)||_51f[1].intersects(_521)){_51c.push(_520);}}else{if(_51f.intersects(_521)){_51c.push(_520);}}}}if(_51c.length===0){return [];}}if(_416.indexOf(_51a,3)!==-1){if(this.timeInfo){_51e=_51c.length>0?_51c:this.graphics;var time=_519.timeExtent,_522=this._filterByTime(_51e,time.startTime,time.endTime);_51c=_522.match;}}if(_51b){return _416.map(_51c,function(obj){return obj.attributes[_51d];},this);}else{return _51c;}},_filterByTime:function(_523,_524,_525){var _526=this._startTimeField,_527=this._endTimeField,_528;if(!this._twoTimeFields){_528=_526||_527;}var _529=_41c.isDefined,yea=[],nay=[],i,len=_523.length,_52a,_52b;_524=_524?_524.getTime():-Infinity;_525=_525?_525.getTime():Infinity;if(_528){for(i=0;i<len;i++){_52a=_523[i];_52b=_52a.attributes;var time=_52b[_528];if(time>=_524&&time<=_525){yea.push(_52a);}else{nay.push(_52a);}}}else{for(i=0;i<len;i++){_52a=_523[i];_52b=_52a.attributes;var _52c=_52b[_526],end=_52b[_527];_52c=_529(_52c)?_52c:-Infinity;end=_529(end)?end:Infinity;if((_52c>=_524&&_52c<=_525)||(end>=_524&&end<=_525)||(_524>=_52c&&_525<=end)){yea.push(_52a);}else{nay.push(_52a);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_52d,_52e,dfd,_52f){if(_52d){this[_52d].apply(this,args);}if(_52e){_52e.apply(null,args);}if(dfd){_41e._resDfd(dfd,args,_52f);}},_getShallowClone:function(_530){var _531=new _428(),prop;for(prop in _530){if(_530.hasOwnProperty(prop)){_531[prop]=_530[prop];}}return _531;},_query:function(type,_532,_533,_534,_535){var that=this,map=this._map,dfd=new _418(_41e._dfdCanceller),_536=_533;var _537=function(_538,_539){if(!_539&&type==="execute"&&!that._isTable){var _53a=_538.features,mode=that._mode,_53b=that.objectIdField,il=_53a.length,i;for(i=il-1;i>=0;i--){var oid=_53a[i].attributes[_53b];var _53c=mode._getFeature(oid);if(_53c){_53a.splice(i,1,_53c);}}}that._resolve([_538],_532,_534,dfd);};if(type!=="executeRelationshipQuery"){_536=this._getShallowClone(_533);_536.outFields=this._getOutFields();_536.returnGeometry=(!map&&_533.hasOwnProperty("returnGeometry"))?_533.returnGeometry:true;var _53d;if(map){_536.outSpatialReference=new _41f(map.spatialReference.toJson());}if(!this._applyQueryFilters(_536)){switch(type){case "execute":_53d=new _429({features:[]});break;case "executeForIds":_53d=[];break;case "executeForCount":_53d=0;break;}_537(_53d,true);return dfd;}var _53e=this._canDoClientSideQuery(_536);if(_53e){var _53f=this._doQuery(_536,_53e,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_53d=new _429();_53d.features=_53f;break;case "executeForIds":_53d=_53f;break;case "executeForCount":_53d=_53f.length;break;}_537(_53d,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+this.invalidParams);this._resolve([err],null,_535,dfd,true);return dfd;}if(this._ts){_536._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_536);temp.addCallbacks(_537,function(err){that._resolve([err],null,_535,dfd,true);});return dfd;},_convertFeaturesToJson:function(_540,_541,_542,_543){var json=[],_544=this._selectionSymbol,_545=this.visibilityField,i,_546,_547=this.objectIdField;if(this.loaded&&(_542||_543)){_546=_416.filter(this.fields,function(_548){return (_548.editable===false)&&(!_543||(_548.name!==_547));});}for(i=0;i<_540.length;i++){var _549=_540[i],_54a={},_54b=_549.geometry,attr=_549.attributes,_54c=_549.symbol;if(_54b&&(!_543||!this.loaded||this.allowGeometryUpdates)){_54a.geometry=_54b.toJson();}if(_545){_54a.attributes=attr=lang.mixin({},attr);attr[_545]=_549.visible?1:0;}else{if(attr){_54a.attributes=lang.mixin({},attr);}}if(_54a.attributes&&_546&&_546.length){_416.forEach(_546,function(_54d){delete _54a.attributes[_54d.name];});}if(_54c&&(_54c!==_544)){_54a.symbol=_54c.toJson();}json.push(_54a);}return _541?json:_417.toJson(json);},_selectHandler:function(_54e,_54f,_550,_551,dfd){var _552,ctor=this.constructor;switch(_54f){case ctor.SELECTION_NEW:this.clearSelection(true);_552=true;break;case ctor.SELECTION_ADD:_552=true;break;case ctor.SELECTION_SUBTRACT:_552=false;break;}var i,_553=_54e.features,mode=this._mode,_554=[],_555=this.objectIdField,_556,oid;if(_552){for(i=0;i<_553.length;i++){_556=_553[i];oid=_556.attributes[_555];var _557=mode._addFeatureIIf(oid,_556);_554.push(_557);this._selectFeatureIIf(oid,_557,mode);}}else{for(i=0;i<_553.length;i++){_556=_553[i];oid=_556.attributes[_555];this._unSelectFeatureIIf(oid,mode);var _558=mode._removeFeatureIIf(oid);_554.push(_558||_556);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_554,_54f,_54e.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_550,dfd);if(_54e.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_559,mode){var _55a=this._selectedFeatures,_55b=_55a[oid];if(!_55b){mode._incRefCount(oid);_55a[oid]=_559;if(!this._isTable){this._setSelectSymbol(_559);}}return _55b||_559;},_unSelectFeatureIIf:function(oid,mode){var _55c=this._selectedFeatures[oid];if(_55c){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_55c);}}return _55c;},_isSelected:function(_55d){},_setSelectSymbol:function(_55e){var _55f=this._selectionSymbol;if(_55f&&!this._isSelOnly){_55e.setSymbol(_55f);}},_setUnSelectSymbol:function(_560){var _561=this._selectionSymbol;if(_561&&!this._isSelOnly){if(_561===_560.symbol){_560.setSymbol(null,true);}}},_getOutFields:function(){var _562=_416.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_563,_564,arr){return !!_563&&(_416.indexOf(arr,_563)===_564);});var _565=lang.clone(this._outFields);if(_565){if(_416.indexOf(_565,"*")!==-1){return _565;}_416.forEach(_562,function(_566){if(_416.indexOf(_565,_566)===-1){_565.push(_566);}});return _565;}else{return _562;}},_checkFields:function(_567){var _568=_567||this._getOutFields();_416.forEach(_568,function(_569){if(_569==="*"){return;}if(!this._getField(_569)){console.debug("esri.layers.FeatureLayer: "+_41c.substitute({url:this.url,field:_569},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]"));}},this);if(!_567&&!this._isTable&&!this._fserver&&!this._collection){var _56a=_416.some(this.fields,function(_56b){return (_56b&&_56b.type==="esriFieldTypeGeometry")?true:false;});if(!_56a){console.debug("esri.layers.FeatureLayer: "+_41c.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"));}}},_fixRendererFields:function(){var _56c=this.renderer;if(_56c&&this.fields.length>0){var _56d=_416.filter([_56c,_56c.observationRenderer,_56c.latestObservationRenderer,_56c.trackRenderer],_41c.isDefined);var _56e=[];_416.forEach(_56d,function(rnd){var _56f,_570;_570=rnd.attributeField;if(_570&&!lang.isFunction(_570)){_56f=!this._getField(_570)&&this._getField(_570,true);if(_56f){rnd.attributeField=_56f.name;}}_570=rnd.attributeField2;if(_570){_56f=!this._getField(_570)&&this._getField(_570,true);if(_56f){rnd.attributeField2=_56f.name;}}_570=rnd.attributeField3;if(_570){_56f=!this._getField(_570)&&this._getField(_570,true);if(_56f){rnd.attributeField3=_56f.name;}}if(!lang.isFunction(rnd.attributeField)){_56e.push(rnd.attributeField);}_56e.push(rnd.attributeField2);_56e.push(rnd.attributeField3);},this);this._rendererFields=_416.filter(_56e,_41c.isDefined);}},_getField:function(_571,_572){var _573=this.fields;if(_573.length===0){return null;}var _574;if(_572){_571=_571.toLowerCase();}_416.some(_573,function(_575){var _576=false;if(_572){_576=(_575&&_575.name.toLowerCase()===_571)?true:false;}else{_576=(_575&&_575.name===_571)?true:false;}if(_576){_574=_575;}return _576;});return _574;},_getDateOpts:function(){if(!this._dtOpts){var _577=_416.map(_416.filter(this.fields,function(_578){return !!(_578&&_578.type==="esriFieldTypeDate");}),function(_579){return _579.name;});this._dtOpts={properties:_577};}return this._dtOpts;},_applyNormalized:function(_57a,_57b){if(_57a&&_57b){_416.forEach(_57a,function(_57c,_57d){if(_57c&&_57b[_57d]){_57c.setGeometry(_57b[_57d]);}});}},_editHandler:function(_57e,adds,_57f,_580,_581,dfd){var _582=_57e.addResults,_583=_57e.updateResults,_584=_57e.deleteResults,i,_585,oid,_586,attr,_587=this.objectIdField,mode=this._mode,_588=this._isTable;var _589=this.editFieldsInfo,_58a=this._getOutFields()||[],_58b=_589&&_589.creatorField,_58c=_589&&_589.creationDateField,_58d=_589&&_589.editorField,_58e=_589&&_589.editDateField,_58f=_589&&_589.realm;if(_416.indexOf(_58a,"*")===-1){if(_58b&&_416.indexOf(_58a,_58b)===-1){_58b=null;}if(_58c&&_416.indexOf(_58a,_58c)===-1){_58c=null;}if(_58d&&_416.indexOf(_58a,_58d)===-1){_58d=null;}if(_58e&&_416.indexOf(_58a,_58e)===-1){_58e=null;}}var _590=(_58c||_58e)?(new Date()).getTime():null,_591=(_58b||_58d)?this.getUserId():undefined;if(_591&&_58f){_591=_591+"@"+_58f;}if(_582){for(i=0;i<_582.length;i++){_582[i]=new _432(_582[i]);if(_588){continue;}_585=_582[i];if(_585.success){oid=_585.objectId;_586=adds[i];var gl=_586._graphicsLayer;if(gl&&gl!==this){gl.remove(_586);}attr=_586.attributes||{};attr[_587]=oid;if(_58b){attr[_58b]=_591;}if(_58d){attr[_58d]=_591;}if(_58c){attr[_58c]=_590;}if(_58e){attr[_58e]=_590;}_586.setAttributes(attr);if(mode._init){mode.drawFeature(_586);}}}}if(_583){for(i=0;i<_583.length;i++){_583[i]=new _432(_583[i]);if(_588){continue;}_585=_583[i];if(_585.success){oid=_585.objectId;_586=_57f[oid];var _592=mode._getFeature(oid);if(_592){if(_592.geometry!==_586.geometry){_592.setGeometry(_42b.fromJson(_586.geometry.toJson()));}this._repaint(_592,oid);}_586=_592||_586;attr=_586.attributes||{};if(_58d){attr[_58d]=_591;}if(_58e){attr[_58e]=_590;}_586.setAttributes(attr);}}}if(_584){var _593=[];for(i=0;i<_584.length;i++){_584[i]=new _432(_584[i]);if(_588){continue;}_585=_584[i];if(_585.success){oid=_585.objectId;_586=mode._getFeature(oid);if(_586){if(this._unSelectFeatureIIf(oid,mode)){_593.push(_586);}_586._count=0;mode._removeFeatureIIf(oid);}}}if(_593.length>0){this.onSelectionComplete(_593,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_582,_583,_584],"onEditsComplete",_580,dfd);},_sendAttachment:function(type,_594,_595,_596,_597){var _598=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_594+"/"+_598,self=this;var dfd=_41d({url:url,form:_595,content:lang.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_599){var _59a=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_59b=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_59c=new _432(_599[_59a]);_59c.attachmentId=_59c.objectId;_59c.objectId=_594;self._resolve([_59c],_59b,_596);return _59c;}).addErrback(function(_59d){self._resolve([_59d],null,_597,null,true);});return dfd;},_repaint:function(_59e,oid,_59f){oid=_41c.isDefined(oid)?oid:_59e.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_59e.setSymbol(_59e.symbol,_59f);}},_getKind:function(_5a0){var _5a1=this._trackManager;if(_5a1){return _5a1.isLatestObservation(_5a0)?1:0;}return 0;}});lang.mixin(_437,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});_42c._createWrappers(_437);if(has("extend-esri")){lang.setObject("layers.FeatureLayer",_437,_41b);}return _437;});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_5a2,arr,_5a3,_5a4,_5a5,_5a6,win,_5a7,_5a8){return _5a2("dojox.gfx.Moveable",null,{constructor:function(_5a9,_5aa){this.shape=_5a9;this.delay=(_5aa&&_5aa.delay>0)?_5aa.delay:0;this.mover=(_5aa&&_5aa.mover)?_5aa.mover:_5a7;this.leftButtonOnly=_5aa&&_5aa.leftButtonOnly;this.events=[this.shape.connect(_5a5.press,lang.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_5ab){_5ab.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_5a5.move,lang.hitch(this,"onMouseMove")),this.shape.connect(_5a5.release,lang.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_5a8.isLeft(e)){new this.mover(this.shape,e,this);}}_5a3.stop(e);},onMouseMove:function(e){var _5ac=e.clientX,_5ad=e.clientY;if(Math.abs(_5ac-this._lastX)>this.delay||Math.abs(_5ad-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_5a3.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_5ae){_5a4.publish("/gfx/move/start",_5ae);_5a6.add(win.body(),"dojoMove");},onMoveStop:function(_5af){_5a4.publish("/gfx/move/stop",_5af);_5a6.remove(win.body(),"dojoMove");},onFirstMove:function(_5b0){},onMove:function(_5b1,_5b2){this.onMoving(_5b1,_5b2);this.shape.applyLeftTransform(_5b2);this.onMoved(_5b1,_5b2);},onMoving:function(_5b3,_5b4){},onMoved:function(_5b5,_5b6){}});});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_5b7,lang,has,_5b8,_5b9,_5ba,_5bb){var dhm=lang.getObject("dojox.html.metrics",true);var _5bc=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _5bd={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_5ba.doc.documentElement.style.fontSize="100%";}var div=_5ba.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_5ba.body().appendChild(div);for(var p in _5bd){ds.fontSize=p;_5bd[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_5ba.body().removeChild(div);div=null;return _5bd;};var _5be=null;dhm.getCachedFontMeasurements=function(_5bf){if(_5bf||!_5be){_5be=dhm.getFontMeasurements();}return _5be;};var _5c0=null,_5c1={};dhm.getTextBox=function(text,_5c2,_5c3){var m,s;if(!_5c0){m=_5c0=_5ba.doc.createElement("div");var c=_5ba.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_5ba.body().appendChild(c);}else{m=_5c0;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_5c2){for(var i in _5c2){if(i in _5c1){continue;}s[i]=_5c2[i];}}if(arguments.length>2&&_5c3){m.className=_5c3;}m.innerHTML=text;var box=_5bb.position(m);box.w=m.parentNode.scrollWidth;return box;};var _5c4={w:16,h:16};dhm.getScrollbar=function(){return {w:_5c4.w,h:_5c4.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_5c5){var f=dhm._fontResizeNode=_5ba.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_5bc._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_5bc._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_5ba.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_5b9.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_5b8(function(){try{var n=_5ba.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_5ba.body().appendChild(n);_5c4.w=n.offsetWidth-n.clientWidth;_5c4.h=n.offsetHeight-n.clientHeight;_5ba.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _5b7.config&&!!_5b7.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"esri/layers/SelectionMode":function(){define("esri/layers/SelectionMode",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/layers/RenderMode"],function(_5c6,lang,has,_5c7,_5c8){var _5c9=_5c6([_5c8],{declaredClass:"esri.layers._SelectionMode",constructor:function(_5ca){this.featureLayer=_5ca;this._featureMap={};},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},resume:function(){this.propertyChangeHandler(0);}});if(has("extend-esri")){lang.setObject("layers._SelectionMode",_5c9,_5c7);}return _5c9;});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_5cb,_5cc,_5cd,has,util){return _5cc("dojox.grid._EditManager",null,{constructor:function(_5ce){this.grid=_5ce;if(has("ie")){this.connections=[_5cd.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_5cd.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_5cb.forEach(this.connections,_5cd.disconnect);},cellFocus:function(_5cf,_5d0){if(this.grid.singleClickEdit||this.isEditRow(_5d0)){this.setEditCell(_5cf,_5d0);}else{this.apply();}if(this.isEditing()||(_5cf&&_5cf.editable&&_5cf.alwaysEditing)){this._focusEditor(_5cf,_5d0);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_5d1){if(_5d1.index==this.info.rowIndex){_5d1.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_5d2,_5d3){return (this.info.rowIndex===_5d2)&&(this.info.cell.index==_5d3);},isEditRow:function(_5d4){return this.info.rowIndex===_5d4;},setEditCell:function(_5d5,_5d6){if(!this.isEditCell(_5d6,_5d5.index)&&this.grid.canEdit&&this.grid.canEdit(_5d5,_5d6)){this.start(_5d5,_5d6,this.isEditRow(_5d6)||_5d5.editable);}},_focusEditor:function(_5d7,_5d8){util.fire(_5d7,"focus",[_5d8]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_5d9,_5da,_5db){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_5da)){this.applyRowEdit();this.grid.updateRow(_5da);}if(_5db){this.info={cell:_5d9,rowIndex:_5da};this.grid.doStartEdit(_5d9,_5da);this.grid.updateRow(_5da);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_5d9,_5da);this._doCatchBoomerang();},_editorDo:function(_5dc){var c=this.info.cell;if(c&&c.editable){c[_5dc](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_5dd,_5de,_5df){if(this.grid.canEdit(_5de,_5df)){this.grid.doApplyCellEdit(_5dd,_5df,_5de.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_5e0,_5e1){var c=this.info.cell;if(this.isEditRow(_5e0)&&(!_5e1||c.view==_5e1)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_5e2,_5e3){var c=this.info.cell;if(this.isEditRow(_5e3)&&c.view==_5e2&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"esri/layers/TrackManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/graphic","esri/geometry/Polyline","esri/layers/GraphicsLayer"],function(_5e4,lang,_5e5,has,_5e6,_5e7,_5e8,_5e9){var _5ea=_5e4(null,{declaredClass:"esri.layers._TrackManager",constructor:function(_5eb){this.layer=_5eb;this.trackMap={};},initialize:function(map){this.map=map;var _5ec=this.layer,_5ed=_5ec.renderer.trackRenderer;if(_5ed&&(_5ec.geometryType==="esriGeometryPoint")){var _5ee=(this.container=new _5e9._GraphicsLayer({id:_5ec.id+"_tracks",_child:true}));_5ee.loaded=true;_5ee.onLoad(_5ee);_5ee._setMap(map,_5ec._div);_5ee.setRenderer(_5ed);}},addFeatures:function(_5ef){var tkid,_5f0=this.trackMap,_5f1=this.layer,_5f2=_5f1._trackIdField;_5e5.forEach(_5ef,function(_5f3){var _5f4=_5f3.attributes;tkid=_5f4[_5f2];var ary=(_5f0[tkid]=(_5f0[tkid]||[]));ary.push(_5f3);});var _5f5=_5f1._startTimeField,_5f6=_5f1.objectIdField;var _5f7=function(a,b){var _5f8=a.attributes[_5f5],_5f9=b.attributes[_5f5];if(_5f8===_5f9){return (a.attributes[_5f6]<b.attributes[_5f6])?-1:1;}else{return (_5f8<_5f9)?-1:1;}};for(tkid in _5f0){_5f0[tkid].sort(_5f7);}},drawTracks:function(){var _5fa=this.container;if(!_5fa){return;}var _5fb=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_5fc,_5fd=this.layer._trackIdField,_5fe;for(tkid in _5fb){ary=_5fb[tkid];path=[];for(i=ary.length-1;i>=0;i--){_5fc=ary[i].geometry;if(_5fc){path.push([_5fc.x,_5fc.y]);}}_5fe={};_5fe[_5fd]=tkid;if(path.length>0){_5fa.add(new _5e7(new _5e8({paths:[path],spatialReference:sr}),null,_5fe));}}},moveLatestToFront:function(){_5e5.forEach(this.getLatestObservations(),function(_5ff){var _600=_5ff._shape;_600&&_600._moveToFront();this._repaint(_5ff,null,true);},this.layer);},getLatestObservations:function(){var _601=[];if(!this.layer.renderer.latestObservationRenderer){return _601;}var _602=this.trackMap,tkid;for(tkid in _602){var ary=_602[tkid];_601.push(ary[ary.length-1]);}return _601;},clearTracks:function(){var _603=this.getLatestObservations();this.trackMap={};var _604=this.container;if(_604){_604.clear();}_5e5.forEach(_603,function(_605){this._repaint(_605,null,true);},this.layer);},isLatestObservation:function(_606){var _607=this.layer._trackIdField;var _608=this.trackMap[_606.attributes[_607]];if(_608){return (_608[_608.length-1]===_606);}return false;},destroy:function(){var _609=this.container;if(_609){_609.clear();_609._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});if(has("extend-esri")){lang.setObject("layers._TrackManager",_5ea,_5e6);}return _5ea;});},"dijit/a11y":function(){define("dijit/a11y",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/sniff","./main"],function(_60a,_60b,_60c,dom,_60d,_60e,has,_60f){var _610=(_60f._isElementShown=function(elem){var s=_60e.get(elem);return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(_60d.get(elem,"type")!="hidden");});_60f.hasDefaultTabStop=function(elem){switch(elem.nodeName.toLowerCase()){case "a":return _60d.has(elem,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":var body;try{var _611=elem.contentDocument;if("designMode" in _611&&_611.designMode=="on"){return true;}body=_611.body;}catch(e1){try{body=elem.contentWindow.document.body;}catch(e2){return false;}}return body&&(body.contentEditable=="true"||(body.firstChild&&body.firstChild.contentEditable=="true"));default:return elem.contentEditable=="true";}};var _612=(_60f.isTabNavigable=function(elem){if(_60d.get(elem,"disabled")){return false;}else{if(_60d.has(elem,"tabIndex")){return _60d.get(elem,"tabIndex")>=0;}else{return _60f.hasDefaultTabStop(elem);}}});_60f._getTabNavigable=function(root){var _613,last,_614,_615,_616,_617,_618={};function _619(node){return node&&node.tagName.toLowerCase()=="input"&&node.type&&node.type.toLowerCase()=="radio"&&node.name&&node.name.toLowerCase();};var _61a=function(_61b){for(var _61c=_61b.firstChild;_61c;_61c=_61c.nextSibling){if(_61c.nodeType!=1||(has("ie")<=9&&_61c.scopeName!=="HTML")||!_610(_61c)){continue;}if(_612(_61c)){var _61d=+_60d.get(_61c,"tabIndex");if(!_60d.has(_61c,"tabIndex")||_61d==0){if(!_613){_613=_61c;}last=_61c;}else{if(_61d>0){if(!_614||_61d<_615){_615=_61d;_614=_61c;}if(!_616||_61d>=_617){_617=_61d;_616=_61c;}}}var rn=_619(_61c);if(_60d.get(_61c,"checked")&&rn){_618[rn]=_61c;}}if(_61c.nodeName.toUpperCase()!="SELECT"){_61a(_61c);}}};if(_610(root)){_61a(root);}function rs(node){return _618[_619(node)]||node;};return {first:rs(_613),last:rs(last),lowest:rs(_614),highest:rs(_616)};};_60f.getFirstInTabbingOrder=function(root,doc){var _61e=_60f._getTabNavigable(dom.byId(root,doc));return _61e.lowest?_61e.lowest:_61e.first;};_60f.getLastInTabbingOrder=function(root,doc){var _61f=_60f._getTabNavigable(dom.byId(root,doc));return _61f.last?_61f.last:_61f.highest;};return {hasDefaultTabStop:_60f.hasDefaultTabStop,isTabNavigable:_60f.isTabNavigable,_getTabNavigable:_60f._getTabNavigable,getFirstInTabbingOrder:_60f.getFirstInTabbingOrder,getLastInTabbingOrder:_60f.getLastInTabbingOrder};});},"esri/tasks/QueryTask":function(){define("esri/tasks/QueryTask",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/_base/json","dojo/has","esri/kernel","esri/request","esri/deferredUtils","esri/geometry/normalizeUtils","esri/tasks/Task","esri/tasks/FeatureSet"],function(_620,lang,_621,_622,_623,has,_624,_625,_626,_627,Task,_628){var _629=_620(Task,{declaredClass:"esri.tasks.QueryTask",constructor:function(url,_62a){this._handler=lang.hitch(this,this._handler);this._relationshipQueryHandler=lang.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=lang.hitch(this,this._executeForIdsHandler);this._countHandler=lang.hitch(this,this._countHandler);this.source=_62a&&_62a.source;this.gdbVersion=_62a&&_62a.gdbVersion;},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},execute:function(_62b,_62c,_62d,_62e,_62f){var _630=_62f.assembly,_631=this._encode(lang.mixin({},this._url.query,{f:"json"},_62b.toJson(_630&&_630[0]))),_632=this._handler,_633=this._errorHandler;if(this.source){var _634={source:this.source.toJson()};_631.layer=_623.toJson(_634);}if(this.gdbVersion){_631.gdbVersion=this.gdbVersion;}return _625({url:this._url.path+"/query",content:_631,callbackParamName:"callback",load:function(r,i){_632(r,i,_62c,_62d,_62f.dfd);},error:function(r){_633(r,_62d,_62f.dfd);},callbackSuffix:_62e});},executeRelationshipQuery:function(_635,_636,_637){var _638=this._encode(lang.mixin({},this._url.query,{f:"json"},_635.toJson())),_639=this._relationshipQueryHandler,_63a=this._errorHandler;if(this.gdbVersion){_638.gdbVersion=this.gdbVersion;}var dfd=new _622(_626._dfdCanceller);dfd._pendingDfd=_625({url:this._url.path+"/queryRelatedRecords",content:_638,callbackParamName:"callback",load:function(r,i){_639(r,i,_636,_637,dfd);},error:function(r){_63a(r,_637,dfd);}});return dfd;},executeForIds:function(_63b,_63c,_63d,_63e){var _63f=_63e.assembly,_640=this._encode(lang.mixin({},this._url.query,{f:"json",returnIdsOnly:true},_63b.toJson(_63f&&_63f[0]))),_641=this._executeForIdsHandler,_642=this._errorHandler;if(this.source){var _643={source:this.source.toJson()};_640.layer=_623.toJson(_643);}if(this.gdbVersion){_640.gdbVersion=this.gdbVersion;}return _625({url:this._url.path+"/query",content:_640,callbackParamName:"callback",load:function(r,i){_641(r,i,_63c,_63d,_63e.dfd);},error:function(r){_642(r,_63d,_63e.dfd);}});},executeForCount:function(_644,_645,_646,_647){var _648=_647.assembly,_649=this._encode(lang.mixin({},this._url.query,{f:"json",returnIdsOnly:true,returnCountOnly:true},_644.toJson(_648&&_648[0]))),_64a=this._countHandler,_64b=this._errorHandler;if(this.source){var _64c={source:this.source.toJson()};_649.layer=_623.toJson(_64c);}if(this.gdbVersion){_649.gdbVersion=this.gdbVersion;}return _625({url:this._url.path+"/query",content:_649,callbackParamName:"callback",load:function(r,i){_64a(r,i,_645,_646,_647.dfd);},error:function(r){_64b(r,_646,_647.dfd);}});},_handler:function(_64d,io,_64e,_64f,dfd){try{var _650=new _628(_64d);this._successHandler([_650],"onComplete",_64e,dfd);}catch(err){this._errorHandler(err,_64f,dfd);}},_relationshipQueryHandler:function(_651,io,_652,_653,dfd){try{var gt=_651.geometryType,sr=_651.spatialReference,_654={};_621.forEach(_651.relatedRecordGroups,function(gr){var _655={};_655.geometryType=gt;_655.spatialReference=sr;_655.features=gr.relatedRecords;var fset=new _628(_655);_654[gr.objectId]=fset;});this._successHandler([_654],"onExecuteRelationshipQueryComplete",_652,dfd);}catch(err){this._errorHandler(err,_653,dfd);}},_executeForIdsHandler:function(_656,io,_657,_658,dfd){try{this._successHandler([_656.objectIds],"onExecuteForIdsComplete",_657,dfd);}catch(err){this._errorHandler(err,_658,dfd);}},_countHandler:function(_659,io,_65a,_65b,dfd){try{var _65c,_65d=_659.features,ids=_659.objectIds;if(ids){_65c=ids.length;}else{if(_65d){throw new Error("Unable to perform query. Please check your parameters.");}else{_65c=_659.count;}}this._successHandler([_65c],"onExecuteForCountComplete",_65a,dfd);}catch(err){this._errorHandler(err,_65b,dfd);}}});_627._createWrappers(_629);if(has("extend-esri")){lang.setObject("tasks.QueryTask",_629,_624);}return _629;});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_65e,_65f,_660,_661){return _65e("dijit.CheckedMenuItem",_660,{templateString:_661,checked:false,_setCheckedAttr:function(_662){_65f.toggle(this.domNode,"dijitCheckedMenuItemChecked",_662);this.domNode.setAttribute("aria-checked",_662?"true":"false");this._set("checked",_662);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"esri/toolbars/_toolbar":function(){define("esri/toolbars/_toolbar",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_663,lang,has,_664){var TB=_663(null,{declaredClass:"esri.toolbars._Toolbar",constructor:function(map){this.map=map;},_cursors:{"move":"pointer","move-v":"pointer","move-gv":"pointer","box0":"nw-resize","box1":"n-resize","box2":"ne-resize","box3":"e-resize","box4":"se-resize","box5":"s-resize","box6":"sw-resize","box7":"w-resize","box8":"pointer"},_deactivateMapTools:function(nav,_665,_666,_667){var map=this.map;if(nav){this._mapNavState={isDoubleClickZoom:map.isDoubleClickZoom,isClickRecenter:map.isClickRecenter,isPan:map.isPan,isRubberBandZoom:map.isRubberBandZoom,isKeyboardNavigation:map.isKeyboardNavigation,isScrollWheelZoom:map.isScrollWheelZoom};map.disableDoubleClickZoom();map.disableClickRecenter();map.disablePan();map.disableRubberBandZoom();map.disableKeyboardNavigation();}if(_665){map.hideZoomSlider();}if(_666){map.hidePanArrows();}if(_667){map.graphics.disableMouseEvents();}},_activateMapTools:function(nav,_668,_669,_66a){var map=this.map,_66b=this._mapNavState;if(nav&&_66b){if(_66b.isDoubleClickZoom){map.enableDoubleClickZoom();}if(_66b.isClickRecenter){map.enableClickRecenter();}if(_66b.isPan){map.enablePan();}if(_66b.isRubberBandZoom){map.enableRubberBandZoom();}if(_66b.isKeyboardNavigation){map.enableKeyboardNavigation();}if(_66b.isScrollWheelZoom){map.enableScrollWheelZoom();}}if(_668){map.showZoomSlider();}if(_669){map.showPanArrows();}if(_66a){map.graphics.enableMouseEvents();}}});if(has("extend-esri")){lang.setObject("toolbars._Toolbar",TB,_664);}return TB;});},"esri/layers/GridLayout":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Extent","esri/geometry/Polyline"],function(_66c,lang,_66d,has,_66e,_66f,_670,_671){var _672=_66c(null,{declaredClass:"esri.layers._GridLayout",constructor:function(_673,_674,_675,_676){this.origin=_673;this.cellWidth=_674.width;this.cellHeight=_674.height;this.mapWidth=_675.width;this.mapHeight=_675.height;this.srInfo=_676;},setResolution:function(_677){this._resolution=(_677.xmax-_677.xmin)/this.mapWidth;if(this.srInfo){var _678=Math.round((2*this.srInfo.valid[1])/this._resolution),_679=Math.round(_678/this.cellWidth);this._frameStats=[_679,0,_679-1];}},getCellCoordinates:function(_67a){var res=this._resolution,_67b=this.origin;return {row:Math.floor((_67b.y-_67a.y)/(this.cellHeight*res)),col:Math.floor((_67a.x-_67b.x)/(this.cellWidth*res))};},normalize:function(col){var _67c=this._frameStats;if(_67c){var _67d=_67c[0],m180=_67c[1],p180=_67c[2];if(col<m180){col=col%_67d;col=col<m180?col+_67d:col;}else{if(col>p180){col=col%_67d;}}}return col;},intersects:function(_67e,_67f){var _680=this.srInfo;if(_680){return _66d.some(_67f._getParts(_680),function(_681){return _67e.intersects(_681.extent);});}else{return _67e.intersects(_67f);}},getCellExtent:function(row,col){var res=this._resolution,_682=this.origin,_683=this.cellWidth,_684=this.cellHeight;return new _670((col*_683*res)+_682.x,_682.y-((row+1)*_684*res),((col+1)*_683*res)+_682.x,_682.y-(row*_684*res),new _66f(_682.spatialReference.toJson()));},getLatticeID:function(_685){var _686=this.getCellCoordinates({x:_685.xmin,y:_685.ymax}),_687=this.getCellCoordinates({x:_685.xmax,y:_685.ymin}),_688=_686.row,_689=_687.row,_68a=this.normalize(_686.col),_68b=this.normalize(_687.col);return _688+"_"+_689+"_"+_68a+"_"+_68b;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_68c,_68d){var _68e=this.getCellCoordinates({x:_68c.xmin,y:_68c.ymax}),_68f=this.getCellCoordinates({x:_68c.xmax,y:_68c.ymin}),_690=_68e.row,_691=_68f.row,_692=_68e.col,_693=_68f.col,_694=[],i,j,nj,_695=[],_696=[],len,xmin,xmax,ymin,ymax,_697=[],_698,_699;for(i=_690;i<=_691;i++){for(j=_692;j<=_693;j++){nj=this.normalize(j);_68c=this.getCellExtent(i,nj);_694.push({row:i,col:nj,extent:_68c,resolution:this._resolution});if(_68d){_695.push(_68c.xmin,_68c.xmax);_696.push(_68c.ymin,_68c.ymax);}}}_692=this.normalize(_692);_693=this.normalize(_693);_695.sort(this.sorter);_696.sort(this.sorter);len=_695.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_695[i]===_695[i+1]){_695.splice(i,1);}}}len=_696.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_696[i]===_696[i+1]){_696.splice(i,1);}}}if(_695.length&&_696.length){xmin=_695[0];xmax=_695[_695.length-1];ymin=_696[0];ymax=_696[_696.length-1];len=_695.length;for(i=0;i<len;i++){_697.push([[_695[i],ymax],[_695[i],ymin]]);}len=_696.length;for(i=0;i<len;i++){_697.push([[xmin,_696[i]],[xmax,_696[i]]]);}_698=new _671({paths:_697,spatialReference:this.origin.spatialReference.toJson()});_699=_690+"_"+_691+"_"+_692+"_"+_693;_694.push({latticeID:_699,lattice:_698,resolution:this._resolution});}return {minRow:_690,maxRow:_691,minCol:_692,maxCol:_693,cells:_694};}});if(has("extend-esri")){lang.setObject("layers._GridLayout",_672,_66e);}return _672;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_69a,_69b,_69c,_69d,dom,_69e,_69f,_6a0,keys,lang,on,has,win,_6a1,pm,_6a2,_6a3){if(has("dijit-legacy-requires")){_6a3(0,function(){var _6a4=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_69a(_6a4);});}return _69c("dijit.Menu",_6a2,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_69b.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_6a5){return _6a1.get(this._iframeContentDocument(_6a5))||this._iframeContentDocument(_6a5)["__parent__"]||(_6a5.name&&win.doc.frames[_6a5.name])||null;},_iframeContentDocument:function(_6a6){return _6a6.contentDocument||(_6a6.contentWindow&&_6a6.contentWindow.document)||(_6a6.name&&win.doc.frames[_6a6.name]&&win.doc.frames[_6a6.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _6a7=node,_6a8=this._iframeContentWindow(_6a7);cn=win.body(_6a8.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _6a9={node:node,iframe:_6a7};_69e.set(node,"_dijitMenu"+this.id,this._bindings.push(_6a9));var _6aa=lang.hitch(this,function(cn){var _6ab=this.selector,_6ac=_6ab?function(_6ad){return on.selector(_6ab,_6ad);}:function(_6ae){return _6ae;},self=this;return [on(cn,_6ac(this.leftClickToOpen?"click":"contextmenu"),function(evt){_69d.stop(evt);self._scheduleOpen(this,_6a7,{x:evt.pageX,y:evt.pageY});}),on(cn,_6ac("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_69d.stop(evt);self._scheduleOpen(this,_6a7);}})];});_6a9.connects=cn?_6aa(cn):[];if(_6a7){_6a9.onloadHandler=lang.hitch(this,function(){var _6af=this._iframeContentWindow(_6a7);cn=win.body(_6af.document);_6a9.connects=_6aa(cn);});if(_6a7.addEventListener){_6a7.addEventListener("load",_6a9.onloadHandler,false);}else{_6a7.attachEvent("onload",_6a9.onloadHandler);}}},unBindDomNode:function(_6b0){var node;try{node=dom.byId(_6b0,this.ownerDocument);}catch(e){return;}var _6b1="_dijitMenu"+this.id;if(node&&_69e.has(node,_6b1)){var bid=_69e.get(node,_6b1)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _6b2=b.iframe;if(_6b2){if(_6b2.removeEventListener){_6b2.removeEventListener("load",b.onloadHandler,false);}else{_6b2.detachEvent("onload",b.onloadHandler);}}_69e.remove(node,_6b1);delete this._bindings[bid];}},_scheduleOpen:function(_6b3,_6b4,_6b5){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_6b3,iframe:_6b4,coords:_6b5});},1);}},_openMyself:function(args){var _6b6=args.target,_6b7=args.iframe,_6b8=args.coords;this.currentTarget=_6b6;if(_6b8){if(_6b7){var ifc=_69f.position(_6b7,true),_6b9=this._iframeContentWindow(_6b7),_6ba=_69f.docScroll(_6b9.document);var cs=_6a0.getComputedStyle(_6b7),tp=_6a0.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_6b7,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_6b7,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_6b7,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_6b7,cs.borderTopWidth):0);_6b8.x+=ifc.x+left-_6ba.x;_6b8.y+=ifc.y+top-_6ba.y;}}else{_6b8=_69f.position(_6b6,true);_6b8.x+=10;_6b8.y+=10;}var self=this;var _6bb=this._focusManager.get("prevNode");var _6bc=this._focusManager.get("curNode");var _6bd=!_6bc||(dom.isDescendant(_6bc,this.domNode))?_6bb:_6bc;function _6be(){if(self.refocus&&_6bd){_6bd.focus();}pm.close(self);};pm.open({popup:this,x:_6b8.x,y:_6b8.y,onExecute:_6be,onCancel:_6be,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_69b.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_6bf,_6c0,_6c1,_6c2,lang,win,dom,_6c3,_6c4,_6c5,has,on,_6c6,_6c7,_6c8,dnd){var _6c9=_6c0("dojo.dnd.Container",_6c5,{skipForm:false,allowNested:false,constructor:function(node,_6ca){this.node=dom.byId(node);if(!_6ca){_6ca={};}this.creator=_6ca.creator||null;this.skipForm=_6ca.skipForm;this.parent=_6ca.dropParent&&dom.byId(_6ca.dropParent);this.map={};this.current=null;this.containerState="";_6c3.add(this.node,"dojoDndContainer");if(!(_6ca&&_6ca._skipStartup)){this.startup();}this.events=[on(this.node,_6c8.over,lang.hitch(this,"onMouseOver")),on(this.node,_6c8.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_6c2.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _6c6((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_6cb,_6cc){if(!this.parent.firstChild){_6cc=null;}else{if(_6cb){if(!_6cc){_6cc=this.parent.firstChild;}}else{if(_6cc){_6cc=_6cc.nextSibling;}}}var i,t;if(_6cc){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_6cc.parentNode.insertBefore(t.node,_6cc);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_6bf.forEach(this.events,function(_6cd){_6cd.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_6ce,node,Ctor){_6ce._skipStartup=true;return new Ctor(node,_6ce);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_6c1.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_6cf){var _6d0="dojoDnd"+type;var _6d1=type.toLowerCase()+"State";_6c3.replace(this.node,_6d0+_6cf,_6d0+this[_6d1]);this[_6d1]=_6cf;},_addItemClass:function(node,type){_6c3.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_6c3.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _6d2=node.parentNode;_6d2;node=_6d2,_6d2=node.parentNode){if((_6d2==this.parent||this.allowNested)&&_6c3.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_6c3.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _6c4.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_6c4.create("tr");_6c4.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _6c4.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _6d3=item&&lang.isObject(item),data,type,n;if(_6d3&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_6d3&&item.data)?item.data:item;type=(_6d3&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _6c9;});},"dojo/dnd/common":function(){define(["../_base/connect","../_base/kernel","../_base/lang","../dom"],function(_6d4,_6d5,lang,dom){var _6d6=lang.getObject("dojo.dnd",true);_6d6.getCopyKeyState=_6d4.isCopyKey;_6d6._uniqueId=0;_6d6.getUniqueId=function(){var id;do{id=_6d5._scopeName+"Unique"+(++_6d6._uniqueId);}while(dom.byId(id));return id;};_6d6._empty={};_6d6.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};return _6d6;});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_6d7,has,_6d8){return _6d7("dojox.grid._ViewManager",null,{constructor:function(_6d9){this.grid=_6d9;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_6da){_6da.idx=this.views.length;this.views.push(_6da);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _6db=[];for(var i=0,v;v=this.views[i];i++){_6db.push(v.contentNode);}return _6db;},forEach:function(_6dc){for(var i=0,v;v=this.views[i];i++){_6dc(v,i);}},onEach:function(_6dd,_6de){_6de=_6de||[];for(var i=0,v;v=this.views[i];i++){if(_6dd in v){v[_6dd].apply(v,_6de);}}},normalizeHeaderNodeHeight:function(){var _6df=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_6df.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_6df);},normalizeRowNodeHeights:function(_6e0){var h=0;var _6e1=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_6e0.length<=1){return;}for(var i=0,n;(n=_6e0[i]);i++){if(!_6d8.contains(n,"dojoxGridNonNormalizedCell")){_6e1[i]=n.firstChild.offsetHeight;h=Math.max(h,_6e1[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_6e0[i]);i++){if(_6e1[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_6e2){var _6e3=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_6e2));i++){n.firstChild.style.height="";_6e3.push(n);}this.normalizeRowNodeHeights(_6e3);},getViewWidth:function(_6e4){return this.views[_6e4].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_6e5){_6e5.headerContentNode.style.height="";});var h=0;this.forEach(function(_6e6){h=Math.max(_6e6.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_6e7){h=Math.max(_6e7.domNode.offsetHeight,h);});return h;},findClient:function(_6e8){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _6e9=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_6e9(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_6e9(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_6e9(v,l);}return l;},renderRow:function(_6ea,_6eb,_6ec){var _6ed=[];for(var i=0,v,n,_6ee;(v=this.views[i])&&(n=_6eb[i]);i++){_6ee=v.renderRow(_6ea);n.appendChild(_6ee);_6ed.push(_6ee);}if(!_6ec){this.normalizeRowNodeHeights(_6ed);}},rowRemoved:function(_6ef){this.onEach("rowRemoved",[_6ef]);},updateRow:function(_6f0,_6f1){for(var i=0,v;v=this.views[i];i++){v.updateRow(_6f0);}if(!_6f1){this.renormalizeRow(_6f0);}},updateRowStyles:function(_6f2){this.onEach("updateRowStyles",[_6f2]);},setScrollTop:function(_6f3){var top=_6f3;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_6f3);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"dijit/place":function(){define("dijit/place",["dojo/_base/array","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/window","dojo/window","./main"],function(_6f4,_6f5,_6f6,_6f7,win,_6f8,_6f9){function _6fa(node,_6fb,_6fc,_6fd){var view=_6f8.getBox(node.ownerDocument);if(!node.parentNode||String(node.parentNode.tagName).toLowerCase()!="body"){win.body(node.ownerDocument).appendChild(node);}var best=null;_6f4.some(_6fb,function(_6fe){var _6ff=_6fe.corner;var pos=_6fe.pos;var _700=0;var _701={w:{"L":view.l+view.w-pos.x,"R":pos.x-view.l,"M":view.w}[_6ff.charAt(1)],h:{"T":view.t+view.h-pos.y,"B":pos.y-view.t,"M":view.h}[_6ff.charAt(0)]};var s=node.style;s.left=s.right="auto";if(_6fc){var res=_6fc(node,_6fe.aroundCorner,_6ff,_701,_6fd);_700=typeof res=="undefined"?0:res;}var _702=node.style;var _703=_702.display;var _704=_702.visibility;if(_702.display=="none"){_702.visibility="hidden";_702.display="";}var bb=_6f5.position(node);_702.display=_703;_702.visibility=_704;var _705={"L":pos.x,"R":pos.x-bb.w,"M":Math.max(view.l,Math.min(view.l+view.w,pos.x+(bb.w>>1))-bb.w)}[_6ff.charAt(1)],_706={"T":pos.y,"B":pos.y-bb.h,"M":Math.max(view.t,Math.min(view.t+view.h,pos.y+(bb.h>>1))-bb.h)}[_6ff.charAt(0)],_707=Math.max(view.l,_705),_708=Math.max(view.t,_706),endX=Math.min(view.l+view.w,_705+bb.w),endY=Math.min(view.t+view.h,_706+bb.h),_709=endX-_707,_70a=endY-_708;_700+=(bb.w-_709)+(bb.h-_70a);if(best==null||_700<best.overflow){best={corner:_6ff,aroundCorner:_6fe.aroundCorner,x:_707,y:_708,w:_709,h:_70a,overflow:_700,spaceAvailable:_701};}return !_700;});if(best.overflow&&_6fc){_6fc(node,best.aroundCorner,best.corner,best.spaceAvailable,_6fd);}var l=_6f5.isBodyLtr(node.ownerDocument),s=node.style;s.top=best.y+"px";s[l?"left":"right"]=(l?best.x:view.w-best.x-best.w)+"px";s[l?"right":"left"]="auto";return best;};var _70b={at:function(node,pos,_70c,_70d){var _70e=_6f4.map(_70c,function(_70f){var c={corner:_70f,pos:{x:pos.x,y:pos.y}};if(_70d){c.pos.x+=_70f.charAt(1)=="L"?_70d.x:-_70d.x;c.pos.y+=_70f.charAt(0)=="T"?_70d.y:-_70d.y;}return c;});return _6fa(node,_70e);},around:function(node,_710,_711,_712,_713){var _714=(typeof _710=="string"||"offsetWidth" in _710)?_6f5.position(_710,true):_710;if(_710.parentNode){var _715=_6f6.getComputedStyle(_710).position=="absolute";var _716=_710.parentNode;while(_716&&_716.nodeType==1&&_716.nodeName!="BODY"){var _717=_6f5.position(_716,true),pcs=_6f6.getComputedStyle(_716);if(/relative|absolute/.test(pcs.position)){_715=false;}if(!_715&&/hidden|auto|scroll/.test(pcs.overflow)){var _718=Math.min(_714.y+_714.h,_717.y+_717.h);var _719=Math.min(_714.x+_714.w,_717.x+_717.w);_714.x=Math.max(_714.x,_717.x);_714.y=Math.max(_714.y,_717.y);_714.h=_718-_714.y;_714.w=_719-_714.x;}if(pcs.position=="absolute"){_715=true;}_716=_716.parentNode;}}var x=_714.x,y=_714.y,_71a="w" in _714?_714.w:(_714.w=_714.width),_71b="h" in _714?_714.h:(_6f7.deprecated("place.around: dijit/place.__Rectangle: { x:"+x+", y:"+y+", height:"+_714.height+", width:"+_71a+" } has been deprecated.  Please use { x:"+x+", y:"+y+", h:"+_714.height+", w:"+_71a+" }","","2.0"),_714.h=_714.height);var _71c=[];function push(_71d,_71e){_71c.push({aroundCorner:_71d,corner:_71e,pos:{x:{"L":x,"R":x+_71a,"M":x+(_71a>>1)}[_71d.charAt(1)],y:{"T":y,"B":y+_71b,"M":y+(_71b>>1)}[_71d.charAt(0)]}});};_6f4.forEach(_711,function(pos){var ltr=_712;switch(pos){case "above-centered":push("TM","BM");break;case "below-centered":push("BM","TM");break;case "after-centered":ltr=!ltr;case "before-centered":push(ltr?"ML":"MR",ltr?"MR":"ML");break;case "after":ltr=!ltr;case "before":push(ltr?"TL":"TR",ltr?"TR":"TL");push(ltr?"BL":"BR",ltr?"BR":"BL");break;case "below-alt":ltr=!ltr;case "below":push(ltr?"BL":"BR",ltr?"TL":"TR");push(ltr?"BR":"BL",ltr?"TR":"TL");break;case "above-alt":ltr=!ltr;case "above":push(ltr?"TL":"TR",ltr?"BL":"BR");push(ltr?"TR":"TL",ltr?"BR":"BL");break;default:push(pos.aroundCorner,pos.corner);}});var _71f=_6fa(node,_71c,_713,{w:_71a,h:_71b});_71f.aroundNodePos=_714;return _71f;}};return _6f9.place=_70b;});},"esri/tasks/Task":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","esri/kernel","esri/deferredUtils","esri/urlUtils"],function(_720,lang,_721,has,_722,_723,_724){var Task=_720(null,{declaredClass:"esri.tasks._Task",constructor:function(url){if(url&&lang.isString(url)){this._url=_724.urlToObject(this.url=url);}this.normalization=true;this._errorHandler=lang.hitch(this,this._errorHandler);},_useSSL:function(){var _725=this._url,re=/^http:/i,rep="https:";if(this.url){this.url=this.url.replace(re,rep);}if(_725&&_725.path){_725.path=_725.path.replace(re,rep);}},_encode:function(_726,_727,_728){var _729,type,_72a={},i,p,pl;for(i in _726){if(i==="declaredClass"){continue;}_729=_726[i];type=typeof _729;if(_729!==null&&_729!==undefined&&type!=="function"){if(lang.isArray(_729)){_72a[i]=[];pl=_729.length;for(p=0;p<pl;p++){_72a[i][p]=this._encode(_729[p]);}}else{if(type==="object"){if(_729.toJson){var json=_729.toJson(_728&&_728[i]);if(_729.declaredClass==="esri.tasks.FeatureSet"){if(json.spatialReference){json.sr=json.spatialReference;delete json.spatialReference;}}_72a[i]=_727?json:_721.toJson(json);}}else{_72a[i]=_729;}}}}return _72a;},_successHandler:function(args,_72b,_72c,dfd){if(_72b){this[_72b].apply(this,args);}if(_72c){_72c.apply(null,args);}if(dfd){_723._resDfd(dfd,args);}},_errorHandler:function(err,_72d,dfd){this.onError(err);if(_72d){_72d(err);}if(dfd){dfd.errback(err);}},setNormalization:function(_72e){this.normalization=_72e;},onError:function(){}});if(has("extend-esri")){_722.Task=Task;}return Task;});},"esri/tasks/FeatureSet":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/graphic","esri/SpatialReference","esri/graphicsUtils","esri/geometry/jsonUtils","esri/symbols/jsonUtils"],function(_72f,lang,_730,has,_731,_732,_733,_734,_735,_736,_737){var _738=_72f(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(json){if(json){lang.mixin(this,json);var _739=this.features,sr=json.spatialReference,_73a=_736.getGeometryType(json.geometryType);sr=(this.spatialReference=new _734(sr));this.geometryType=json.geometryType;if(json.fields){this.fields=json.fields;}_730.forEach(_739,function(_73b,i){var _73c=_73b.geometry&&_73b.geometry.spatialReference;_739[i]=new _733((_73a&&_73b.geometry)?new _73a(_73b.geometry):null,_73b.symbol&&_737.fromJson(_73b.symbol),_73b.attributes);if(_739[i].geometry&&!_73c){_739[i].geometry.setSpatialReference(sr);}});}else{this.features=[];}},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(_73d){var json={};if(this.displayFieldName){json.displayFieldName=this.displayFieldName;}if(this.fields){json.fields=this.fields;}if(this.spatialReference){json.spatialReference=this.spatialReference.toJson();}else{if(this.features[0]&&this.features[0].geometry){json.spatialReference=this.features[0].geometry.spatialReference.toJson();}}if(this.features[0]){if(this.features[0].geometry){json.geometryType=_736.getJsonType(this.features[0].geometry);}json.features=_735._encodeGraphics(this.features,_73d);}json.exceededTransferLimit=this.exceededTransferLimit;return _732.fixJson(json);}});if(has("extend-esri")){lang.setObject("tasks.FeatureSet",_738,_731);}return _738;});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_73e,_73f,keys,_740,_741,_742){return _73e("dijit.DropDownMenu",[_742,_741],{templateString:_740,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_73f.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_73f.stop(evt);}break;}}});});},"dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_743){return _743.grid.cells;});},"dijit/_Widget":function(){define("dijit/_Widget",["dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/ready","./registry","./_WidgetBase","./_OnDijitClickMixin","./_FocusMixin","dojo/uacss","./hccss"],function(_744,_745,_746,_747,has,_748,lang,_749,_74a,_74b,_74c,_74d,_74e){function _74f(){};function _750(_751){return function(obj,_752,_753,_754){if(obj&&typeof _752=="string"&&obj[_752]==_74f){return obj.on(_752.substring(2).toLowerCase(),lang.hitch(_753,_754));}return _751.apply(_746,arguments);};};_744.around(_746,"connect",_750);if(_748.connect){_744.around(_748,"connect",_750);}var _755=_747("dijit._Widget",[_74c,_74d,_74e],{onClick:_74f,onDblClick:_74f,onKeyDown:_74f,onKeyPress:_74f,onKeyUp:_74f,onMouseDown:_74f,onMouseMove:_74f,onMouseOut:_74f,onMouseOver:_74f,onMouseLeave:_74f,onMouseEnter:_74f,onMouseUp:_74f,constructor:function(_756){this._toConnect={};for(var name in _756){if(this[name]===_74f){this._toConnect[name.replace(/^on/,"").toLowerCase()]=_756[name];delete _756[name];}}},postCreate:function(){this.inherited(arguments);for(var name in this._toConnect){this.on(name,this._toConnect[name]);}delete this._toConnect;},on:function(type,func){if(this[this._onMap(type)]===_74f){return _746.connect(this.domNode,type.toLowerCase(),this,func);}return this.inherited(arguments);},_setFocusedAttr:function(val){this._focused=val;this._set("focused",val);},setAttribute:function(attr,_757){_748.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(attr,_757);},attr:function(name,_758){if(_745.isDebug){var _759=arguments.callee._ach||(arguments.callee._ach={}),_75a=(arguments.callee.caller||"unknown caller").toString();if(!_759[_75a]){_748.deprecated(this.declaredClass+"::attr() is deprecated. Use get() or set() instead, called from "+_75a,"","2.0");_759[_75a]=true;}}var args=arguments.length;if(args>=2||typeof name==="object"){return this.set.apply(this,arguments);}else{return this.get(name);}},getDescendants:function(){_748.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?_749("[widgetId]",this.containerNode).map(_74b.byNode):[];},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){},onClose:function(){return true;}});if(has("dijit-legacy-requires")){_74a(0,function(){var _75b=["dijit/_base"];require(_75b);});}return _755;});},"dojo/cache":function(){define(["./_base/kernel","./text"],function(dojo){return dojo.cache;});},"dijit/_OnDijitClickMixin":function(){define("dijit/_OnDijitClickMixin",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/has","dojo/_base/unload","dojo/_base/window","./a11yclick"],function(on,_75c,keys,_75d,has,_75e,win,_75f){var ret=_75d("dijit._OnDijitClickMixin",null,{connect:function(obj,_760,_761){return this.inherited(arguments,[obj,_760=="ondijitclick"?_75f:_760,_761]);}});ret.a11yclick=_75f;return ret;});},"dijit/_FocusMixin":function(){define("dijit/_FocusMixin",["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(_762,_763,_764,lang){lang.extend(_763,{focused:false,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus();},_onBlur:function(){this.onBlur();}});return _764("dijit._FocusMixin",null,{_focusManager:_762});});},"dijit/_Templated":function(){define("dijit/_Templated",["./_WidgetBase","./_TemplatedMixin","./_WidgetsInTemplateMixin","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/kernel"],function(_765,_766,_767,_768,_769,lang,_76a){lang.extend(_765,{waiRole:"",waiState:""});return _769("dijit._Templated",[_766,_767],{widgetsInTemplate:false,constructor:function(){_76a.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0");},_attachTemplateNodes:function(_76b,_76c){this.inherited(arguments);var _76d=lang.isArray(_76b)?_76b:(_76b.all||_76b.getElementsByTagName("*"));var x=lang.isArray(_76b)?0:-1;for(;x<_76d.length;x++){var _76e=(x==-1)?_76b:_76d[x];var role=_76c(_76e,"waiRole");if(role){_76e.setAttribute("role",role);}var _76f=_76c(_76e,"waiState");if(_76f){_768.forEach(_76f.split(/\s*,\s*/),function(_770){if(_770.indexOf("-")!=-1){var pair=_770.split("-");_76e.setAttribute("aria-"+pair[0],pair[1]);}});}}}});});},"dijit/focus":function(){define("dijit/focus",["dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/Evented","dojo/_base/lang","dojo/on","dojo/ready","dojo/sniff","dojo/Stateful","dojo/_base/unload","dojo/_base/window","dojo/window","./a11y","./registry","./main"],function(_771,_772,dom,_773,_774,_775,lang,on,_776,has,_777,_778,win,_779,a11y,_77a,_77b){var _77c=_772([_777,_775],{curNode:null,activeStack:[],constructor:function(){var _77d=lang.hitch(this,function(node){if(dom.isDescendant(this.curNode,node)){this.set("curNode",null);}if(dom.isDescendant(this.prevNode,node)){this.set("prevNode",null);}});_771.before(_774,"empty",_77d);_771.before(_774,"destroy",_77d);},registerIframe:function(_77e){return this.registerWin(_77e.contentWindow,_77e);},registerWin:function(_77f,_780){var _781=this;var _782=function(evt){_781._justMouseDowned=true;setTimeout(function(){_781._justMouseDowned=false;},0);if(has("ie")&&evt&&evt.srcElement&&evt.srcElement.parentNode==null){return;}_781._onTouchNode(_780||evt.target||evt.srcElement,"mouse");};var doc=has("ie")?_77f.document.documentElement:_77f.document;if(doc){if(has("ie")){_77f.document.body.attachEvent("onmousedown",_782);var _783=function(evt){var tag=evt.srcElement.tagName.toLowerCase();if(tag=="#document"||tag=="body"){return;}if(a11y.isTabNavigable(evt.srcElement)){_781._onFocusNode(_780||evt.srcElement);}else{_781._onTouchNode(_780||evt.srcElement);}};doc.attachEvent("onfocusin",_783);var _784=function(evt){_781._onBlurNode(_780||evt.srcElement);};doc.attachEvent("onfocusout",_784);return {remove:function(){_77f.document.detachEvent("onmousedown",_782);doc.detachEvent("onfocusin",_783);doc.detachEvent("onfocusout",_784);doc=null;}};}else{doc.body.addEventListener("mousedown",_782,true);doc.body.addEventListener("touchstart",_782,true);var _785=function(evt){_781._onFocusNode(_780||evt.target);};doc.addEventListener("focus",_785,true);var _786=function(evt){_781._onBlurNode(_780||evt.target);};doc.addEventListener("blur",_786,true);return {remove:function(){doc.body.removeEventListener("mousedown",_782,true);doc.body.removeEventListener("touchstart",_782,true);doc.removeEventListener("focus",_785,true);doc.removeEventListener("blur",_786,true);doc=null;}};}}},_onBlurNode:function(node){if(this._clearFocusTimer){clearTimeout(this._clearFocusTimer);}this._clearFocusTimer=setTimeout(lang.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null);}),0);if(this._justMouseDowned){return;}if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);}this._clearActiveWidgetsTimer=setTimeout(lang.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([]);}),0);},_onTouchNode:function(node,by){if(this._clearActiveWidgetsTimer){clearTimeout(this._clearActiveWidgetsTimer);delete this._clearActiveWidgetsTimer;}var _787=[];try{while(node){var _788=_773.get(node,"dijitPopupParent");if(_788){node=_77a.byId(_788).domNode;}else{if(node.tagName&&node.tagName.toLowerCase()=="body"){if(node===win.body()){break;}node=_779.get(node.ownerDocument).frameElement;}else{var id=node.getAttribute&&node.getAttribute("widgetId"),_789=id&&_77a.byId(id);if(_789&&!(by=="mouse"&&_789.get("disabled"))){_787.unshift(id);}node=node.parentNode;}}}}catch(e){}this._setStack(_787,by);},_onFocusNode:function(node){if(!node){return;}if(node.nodeType==9){return;}if(this._clearFocusTimer){clearTimeout(this._clearFocusTimer);delete this._clearFocusTimer;}this._onTouchNode(node);if(node==this.curNode){return;}this.set("prevNode",this.curNode);this.set("curNode",node);},_setStack:function(_78a,by){var _78b=this.activeStack;this.set("activeStack",_78a);for(var _78c=0;_78c<Math.min(_78b.length,_78a.length);_78c++){if(_78b[_78c]!=_78a[_78c]){break;}}var _78d;for(var i=_78b.length-1;i>=_78c;i--){_78d=_77a.byId(_78b[i]);if(_78d){_78d._hasBeenBlurred=true;_78d.set("focused",false);if(_78d._focusManager==this){_78d._onBlur(by);}this.emit("widget-blur",_78d,by);}}for(i=_78c;i<_78a.length;i++){_78d=_77a.byId(_78a[i]);if(_78d){_78d.set("focused",true);if(_78d._focusManager==this){_78d._onFocus(by);}this.emit("widget-focus",_78d,by);}}},focus:function(node){if(node){try{node.focus();}catch(e){}}}});var _78e=new _77c();_776(function(){var _78f=_78e.registerWin(_779.get(win.doc));if(has("ie")){_778.addOnWindowUnload(function(){if(_78f){_78f.remove();_78f=null;}});}});_77b.focus=function(node){_78e.focus(node);};for(var attr in _78e){if(!/^_/.test(attr)){_77b.focus[attr]=typeof _78e[attr]=="function"?lang.hitch(_78e,attr):_78e[attr];}}_78e.watch(function(attr,_790,_791){_77b.focus[attr]=_791;});return _78e;});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_792,lang,dom){var dgu=lang.getObject("grid.util",true,_792);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_793,_794){if(_794>=0){var s=_793.style;var v=_794+"px";if(_793&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_795,_796,_797,_798){var evts=(_798?_798:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_796.connect(_795,"on"+evts[i],_797);}};dgu.removeNode=function(_799){_799=dom.byId(_799);_799&&_799.parentNode&&_799.parentNode.removeChild(_799);return _799;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_79a,_79b,_79c){if(_79a.length<=_79b){_79a[_79b]=_79c;}else{_79a.splice(_79b,0,_79c);}};dgu.arrayRemove=function(_79d,_79e){_79d.splice(_79e,1);};dgu.arraySwap=function(_79f,inI,inJ){var _7a0=_79f[inI];_79f[inI]=_79f[inJ];_79f[inJ]=_7a0;};return dgu;});},"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_7a1,_7a2,lang,json,has,_7a3,_7a4,_7a5,html){var _7a6=_7a3("dojox.grid.DataGrid",_7a4,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _7a5(this);},get:function(_7a7,_7a8){if(_7a8&&this.field=="_item"&&!this.fields){return _7a8;}else{if(_7a8&&this.fields){var ret=[];var s=this.grid.store;_7a2.forEach(this.fields,function(f){ret=ret.concat(s.getValues(_7a8,f));});return ret;}else{if(!_7a8&&typeof _7a7==="string"){return this.inherited(arguments);}}}return (!_7a8?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_7a8:this.grid.store.getValue(_7a8,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _7a9=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_7a9=true;}if(!this.updating){this.beginUpdate();_7a9=true;}if(_7a9){var _7aa=this;this._endUpdateDelay=setTimeout(function(){delete _7aa._endUpdateDelay;_7aa.endUpdate();},this.updateDelay);}}},_onSet:function(item,_7ab,_7ac,_7ad){this._checkUpdateStatus();var idx=this.getItemIndex(item);if(idx>-1){this.updateRow(idx);}},_createItem:function(item,_7ae){var idty=this._hasIdentity?this.store.getIdentity(item):json.toJson(this.query)+":idx:"+_7ae+":sort:"+json.toJson(this.getSortProps());var o=this._by_idty[idty]={idty:idty,item:item};return o;},_addItem:function(item,_7af,_7b0){this._by_idx[_7af]=this._createItem(item,_7af);if(!_7b0){this.updateRow(_7af);}},_onNew:function(item,_7b1){this._checkUpdateStatus();var _7b2=this.get("rowCount");this._addingItem=true;this.updateRowCount(_7b2+1);this._addingItem=false;this._addItem(item,_7b2);this.showMessage();},_onDelete:function(item){this._checkUpdateStatus();var idx=this._getItemIndex(item,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_7b3,_7b4,_7b5){if(this._requestsPending(0)){return;}this._setQuery(_7b4,_7b5);this._setStore(_7b3);this._refresh(true);},setQuery:function(_7b6,_7b7){if(this._requestsPending(0)){return;}this._setQuery(_7b6,_7b7);this._refresh(true);},setItems:function(_7b8){this.items=_7b8;this._setStore(this.store);this._refresh(true);},_setQuery:function(_7b9,_7ba){this.query=_7b9;this.queryOptions=_7ba||this.queryOptions;},_setStore:function(_7bb){if(this.store&&this._store_connects){_7a2.forEach(this._store_connects,this.disconnect,this);}this.store=_7bb;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(size,req){if(!this.scroller){return;}if(this.rowCount!=size){if(req.isRender){this.scroller.init(size,this.keepRows,this.rowsPerPage);this.rowCount=size;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(size);}}if(!size){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_7bc,req){if(!this.scroller){return;}if(_7bc&&_7bc.length>0){_7a2.forEach(_7bc,function(item,idx){this._addItem(item,req.start+idx,true);},this);this.updateRows(req.start,_7bc.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(has("ie")){html.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_7bd,_7be){_7bd=_7bd||0;if(this.store&&!this._pending_requests[_7bd]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_7bd]=true;try{if(this.items){var _7bf=this.items;var _7c0=this.store;this.rowsPerPage=_7bf.length;var req={start:_7bd,count:this.rowsPerPage,isRender:_7be};this._onFetchBegin(_7bf.length,req);var _7c1=0;_7a2.forEach(_7bf,function(i){if(!_7c0.isItemLoaded(i)){_7c1++;}});if(_7c1===0){this._onFetchComplete(_7bf,req);}else{var _7c2=function(item){_7c1--;if(_7c1===0){this._onFetchComplete(_7bf,req);}};_7a2.forEach(_7bf,function(i){if(!_7c0.isItemLoaded(i)){_7c0.loadItem({item:i,onItem:_7c2,scope:this});}},this);}}else{this.store.fetch({start:_7bd,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_7be,onBegin:lang.hitch(this,"_onFetchBegin"),onComplete:lang.hitch(this,"_onFetchComplete"),onError:lang.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_7bd,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var data=this._by_idx[idx];if(!data||(data&&!data.item)){this._preparePage(idx);return null;}return data.item;},getItemIndex:function(item){return this._getItemIndex(item,false);},_getItemIndex:function(item,_7c3){if(!_7c3&&!this.store.isItem(item)){return -1;}var idty=this._hasIdentity?this.store.getIdentity(item):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((idty&&d.idty==idty)||(d.item===item))){return i;}}return -1;},filter:function(_7c4,_7c5){this.query=_7c4;if(_7c5){this._clearData();}this._fetch();},_getItemAttr:function(idx,attr){var item=this.getItem(idx);return (!item?this.fetchText:this.store.getValue(item,attr));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_7c6){return this._pending_requests[_7c6];},_rowToPage:function(_7c7){return (this.rowsPerPage?Math.floor(_7c7/this.rowsPerPage):_7c7);},_pageToRow:function(_7c8){return (this.rowsPerPage?this.rowsPerPage*_7c8:_7c8);},_preparePage:function(_7c9){if((_7c9<this._bop||_7c9>=this._eop)&&!this._addingItem){var _7ca=this._rowToPage(_7c9);this._needPage(_7ca);this._bop=_7ca*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_7cb){if(!this._pages[_7cb]){this._pages[_7cb]=true;this._requestPage(_7cb);}},_requestPage:function(_7cc){var row=this._pageToRow(_7cc);var _7cd=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_7cd>0){this._requests++;if(!this._requestsPending(row)){setTimeout(lang.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_7ce){return _7ce.field;},_refresh:function(_7cf){this._clearData();this._fetch(0,_7cf);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var desc=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof desc=="undefined"){desc=si;}else{desc=si?!desc:desc;}return [{attribute:c.field,descending:desc}];}},styleRowState:function(_7d0){if(this.store&&this.store.getState){var _7d1=this.store.getState(_7d0.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_7d1[s]){c=" dojoxGridRow-"+s;break;}}_7d0.customClasses+=c;}},onStyleRow:function(_7d2){this.styleRowState(_7d2);this.inherited(arguments);},canEdit:function(_7d3,_7d4){return this._canEdit;},_copyAttr:function(idx,attr){var row={};var _7d5={};var src=this.getItem(idx);return this.store.getValue(src,attr);},doStartEdit:function(_7d6,_7d7){if(!this._cache[_7d7]){this._cache[_7d7]=this._copyAttr(_7d7,_7d6.field);}this.onStartEdit(_7d6,_7d7);},doApplyCellEdit:function(_7d8,_7d9,_7da){this.store.fetchItemByIdentity({identity:this._by_idx[_7d9].idty,onItem:lang.hitch(this,function(item){var _7db=this.store.getValue(item,_7da);if(typeof _7db=="number"){_7d8=isNaN(_7d8)?_7d8:parseFloat(_7d8);}else{if(typeof _7db=="boolean"){_7d8=_7d8=="true"?true:_7d8=="false"?false:_7d8;}else{if(_7db instanceof Date){var _7dc=new Date(_7d8);_7d8=isNaN(_7dc.getTime())?_7d8:_7dc;}}}this.store.setValue(item,_7da,_7d8);this.onApplyCellEdit(_7d8,_7d9,_7da);})});},doCancelEdit:function(_7dd){var _7de=this._cache[_7dd];if(_7de){this.updateRow(_7dd);delete this._cache[_7dd];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_7df,_7e0){var _7e1=this._cache[_7df];this.onApplyEdit(_7df);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=lang.hitch(this,function(_7e2){if(_7e2.length){_7a2.forEach(_7e2,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_7a6.cell_markupFactory=function(_7e3,node,_7e4){var _7e5=lang.trim(html.attr(node,"field")||"");if(_7e5){_7e4.field=_7e5;}_7e4.field=_7e4.field||_7e4.name;var _7e6=lang.trim(html.attr(node,"fields")||"");if(_7e6){_7e4.fields=_7e6.split(",");}if(_7e3){_7e3(node,_7e4);}};_7a6.markupFactory=function(_7e7,node,ctor,_7e8){return _7a4.markupFactory(_7e7,node,ctor,lang.partial(_7a6.cell_markupFactory,_7e8));};return _7a6;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(lang,_7e9){var _7ea={};lang.setObject("dojo.date.stamp",_7ea);_7ea.fromISOString=function(_7eb,_7ec){if(!_7ea._isoRegExp){_7ea._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _7ed=_7ea._isoRegExp.exec(_7eb),_7ee=null;if(_7ed){_7ed.shift();if(_7ed[1]){_7ed[1]--;}if(_7ed[6]){_7ed[6]*=1000;}if(_7ec){_7ec=new Date(_7ec);_7e9.forEach(_7e9.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _7ec["get"+prop]();}),function(_7ef,_7f0){_7ed[_7f0]=_7ed[_7f0]||_7ef;});}_7ee=new Date(_7ed[0]||1970,_7ed[1]||0,_7ed[2]||1,_7ed[3]||0,_7ed[4]||0,_7ed[5]||0,_7ed[6]||0);if(_7ed[0]<100){_7ee.setFullYear(_7ed[0]||1970);}var _7f1=0,_7f2=_7ed[7]&&_7ed[7].charAt(0);if(_7f2!="Z"){_7f1=((_7ed[8]||0)*60)+(Number(_7ed[9])||0);if(_7f2!="-"){_7f1*=-1;}}if(_7f2){_7f1-=_7ee.getTimezoneOffset();}if(_7f1){_7ee.setTime(_7ee.getTime()+_7f1*60000);}}return _7ee;};_7ea.toISOString=function(_7f3,_7f4){var _7f5=function(n){return (n<10)?"0"+n:n;};_7f4=_7f4||{};var _7f6=[],_7f7=_7f4.zulu?"getUTC":"get",date="";if(_7f4.selector!="time"){var year=_7f3[_7f7+"FullYear"]();date=["0000".substr((year+"").length)+year,_7f5(_7f3[_7f7+"Month"]()+1),_7f5(_7f3[_7f7+"Date"]())].join("-");}_7f6.push(date);if(_7f4.selector!="date"){var time=[_7f5(_7f3[_7f7+"Hours"]()),_7f5(_7f3[_7f7+"Minutes"]()),_7f5(_7f3[_7f7+"Seconds"]())].join(":");var _7f8=_7f3[_7f7+"Milliseconds"]();if(_7f4.milliseconds){time+="."+(_7f8<100?"0":"")+_7f5(_7f8);}if(_7f4.zulu){time+="Z";}else{if(_7f4.selector!="time"){var _7f9=_7f3.getTimezoneOffset();var _7fa=Math.abs(_7f9);time+=(_7f9>0?"-":"+")+_7f5(Math.floor(_7fa/60))+":"+_7f5(_7fa%60);}}_7f6.push(time);}return _7f6.join("T");};return _7ea;});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_7fb,lang,_7fc,_7fd,_7fe,has,_7ff,util,html){return _7fc("dojox.grid._FocusManager",null,{constructor:function(_800){this.grid=_800;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_7fd.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_7fd.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_7fd.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_7fd.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_7fd.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_7fd.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_7fd.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_7fd.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_7fd.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_7fb.forEach(this._connects,_7fd.disconnect);_7fb.forEach(this._headerConnects,_7fd.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_801,_802){return (this.cell==_801)&&(this.rowIndex==_802);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _7fb.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_803){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){html.toggleClass(n,this.focusClass,_803);if(_803){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){util.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){html.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}util.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_7fb.forEach(this._headerConnects,_7fd.disconnect);this._headerConnects=[];var _804=this._findHeaderCells();for(var i=0;i<_804.length;i++){this._headerConnects.push(_7fd.connect(_804[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_7fd.connect(_804[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _805=_7ff("th",this.grid.viewsHeaderNode);var _806=[];for(var i=0;i<_805.length;i++){var _807=_805[i];var _808=html.hasAttr(_807,"tabIndex");var _809=html.attr(_807,"tabIndex");if(_808&&_809<0){_806.push(_807);}}return _806;},_setActiveColHeader:function(_80a,_80b,_80c){this.grid.domNode.setAttribute("aria-activedescendant",_80a.id);if(_80c!=null&&_80c>=0&&_80c!=_80b){html.toggleClass(this._findHeaderCells()[_80c],this.focusClass,false);}html.toggleClass(_80a,this.focusClass,true);this._colHeadNode=_80a;this._colHeadFocusIdx=_80b;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var info=(this.cell?this._scrollInfo(this.cell):null);if(!info||!info.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(info.n&&info.sr){if(info.n.offsetLeft+info.n.offsetWidth>info.sr.l+info.sr.w){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}}}if(info.r&&info.sr){if(rt+info.r.offsetHeight>info.sr.t+info.sr.h){this.grid.setScrollTop(rt+info.r.offsetHeight-info.sr.h);}else{if(rt<info.sr.t){this.grid.setScrollTop(rt);}}}return info.s.scrollLeft;},_scrollInfo:function(cell,_80d){if(cell){var cl=cell,sbn=cl.view.scrollboxNode,sbnr={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:sbnr,n:(_80d?_80d:cell.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_80e){var info=null;if(this._colHeadNode){var cell=this.grid.getCell(_80e);if(!cell){return;}info=this._scrollInfo(cell,cell.getNode(0));}if(info&&info.s&&info.sr&&info.n){var _80f=info.sr.l+info.sr.w;if(info.n.offsetLeft+info.n.offsetWidth>_80f){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}else{if(has("ie")<=7&&cell&&cell.view.headerNode){cell.view.headerNode.scrollLeft=info.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _810=this.focusView;if(!_810){for(var i=0,_811;(_811=this.grid.views.views[i]);i++){if(_811.headerNode){_810=_811;break;}}}return (_810&&html.getComputedStyle(_810.headerNode).display=="none");},colSizeAdjust:function(e,_812,_813){var _814=this._findHeaderCells();var view=this.focusView;if(!view||!view.header.tableMap.map){for(var i=0,_815;(_815=this.grid.views.views[i]);i++){if(_815.header.tableMap.map){view=_815;break;}}}var _816=_814[_812];if(!view||(_812==_814.length-1&&_812===0)){return;}view.content.baseDecorateEvent(e);e.cellNode=_816;e.cellIndex=view.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(view.header.canResize(e)){var _817={l:_813};var drag=view.header.colResizeSetup(e,false);view.header.doResizeColumn(drag,null,_817);view.update();}},styleRow:function(_818){return;},setFocusIndex:function(_819,_81a){this.setFocusCell(this.grid.getCell(_81a),_819);},setFocusCell:function(_81b,_81c){if(_81b&&!this.isFocusCell(_81b,_81c)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_81b;this.rowIndex=_81c;this._focusifyCellNode(true);}if(has("opera")){setTimeout(lang.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _81d=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_81d.editable||this.grid.canEdit&&!this.grid.canEdit(_81d,row))){this.cell=_81d;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _81e=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_81e.editable){this.cell=_81e;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_81f,_820){var _821=_820<0?-1:1;if(this.isNavHeader()){var _822=this._findHeaderCells();var _823=currentIdx=_7fb.indexOf(_822,this._colHeadNode);currentIdx+=_820;while(currentIdx>=0&&currentIdx<_822.length&&_822[currentIdx].style.display=="none"){currentIdx+=_821;}if((currentIdx>=0)&&(currentIdx<_822.length)){this._setActiveColHeader(_822[currentIdx],currentIdx,_823);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_81f));if(_81f){if(_81f>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_81f<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_820));var cell=this.grid.getCell(col);while(col>=0&&col<cc&&cell&&cell.hidden===true){col+=_821;cell=this.grid.getCell(col);}if(!cell||cell.hidden===true){col=i;}var n=cell.getNode(row);if(!n&&_81f){if((row+_81f)>=0&&(row+_81f)<=rc){this.move(_81f>0?++_81f:--_81f,_820);}return;}else{if((!n||html.style(n,"display")==="none")&&_820){if((col+_820)>=0&&(col+_820)<=cc){this.move(_81f,_820>0?++_820:--_820);}return;}}this.setFocusIndex(row,col);if(_81f){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_7fe.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_7fe.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){html.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _824=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_7fe.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_7fe.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_825){this.tabbingOut=true;_825.focus();},focusGridView:function(){util.fire(this.focusView,"focus");},focusGrid:function(_826){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _827=true;var _828=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_828){var _829=0;var cell=this.grid.getCell(_829);if(cell.hidden){_829=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_829);}else{if(this.cell&&!_828){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_827=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _827;},focusHeader:function(){var _82a=this._findHeaderCells();var _82b=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_82a[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_82a.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_82a[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_82b);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){html.removeClass(this._colHeadNode,this.focusClass);html.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _82c=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_82c);this._contextMenuBindNode=_82c;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_7fe.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_7fe.stop(e);},doBlur:function(e){_7fe.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_7fe.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_7fe.stop(e);},doLastNodeBlur:function(e){_7fe.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,html.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_7fe.stop(e);},doColHeaderBlur:function(e){html.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"esri/layers/SnapshotMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/tasks/query","esri/layers/RenderMode"],function(_82d,lang,has,_82e,_82f,_830,_831){var _832=_82d([_831],{declaredClass:"esri.layers._SnapshotMode",constructor:function(_833){this.featureLayer=_833;this._featureMap={};this._drawFeatures=lang.hitch(this,this._drawFeatures);this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},startup:function(){if(this.featureLayer._collection){this._applyTimeFilter();}else{this._fetchAll();}},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},drawFeature:function(_834){var _835=this.featureLayer,_836=_835.objectIdField,oid=_834.attributes[_836];this._addFeatureIIf(oid,_834);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _837=this.featureLayer;if(_837._collection){_837._fireUpdateStart();_837._refresh(true);_837._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_838){var id="_"+_838.name+_838.layerId+_838._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _839=this.featureLayer;if(_839._collection){return;}_839._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_83a=this.featureLayer,_83b=_83a.getDefinitionExpression();var _83c=new _830();_83c.outFields=_83a._getOutFields();_83c.where=_83b||"1=1";_83c.returnGeometry=true;_83c.outSpatialReference=new _82f(map.spatialReference.toJson());_83c.timeExtent=_83a.getTimeDefinition();_83c.maxAllowableOffset=_83a._maxOffset;if(_83a._ts){_83c._ts=(new Date()).getTime();}var _83d;if(_83a._usePatch){_83d=this._getRequestId(_83a);this._cancelPendingRequest(null,_83d);}_83a._task.execute(_83c,this._drawFeatures,this._queryErrorHandler,_83d);},_drawFeatures:function(_83e){this._purgeRequests();var _83f=_83e.features,_840=this.featureLayer,_841=_840.objectIdField,i,len=_83f.length,_842,oid;for(i=0;i<len;i++){_842=_83f[i];oid=_842.attributes[_841];this._addFeatureIIf(oid,_842);this._incRefCount(oid);}this._applyTimeFilter(true);_840._fireUpdateEnd(null,_83e.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_83e.exceededTransferLimit){_840.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _843=this.featureLayer;_843._errorHandler(err);_843._fireUpdateEnd(err);}});if(has("extend-esri")){lang.setObject("layers._SnapshotMode",_832,_82e);}return _832;});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_844,dom,_845,_846,_847,has,_848,_849,_84a,_84b,_84c){return _844("dijit.MenuItem",[_848,_849,_84a,_84b],{templateString:_84c,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_84d){if(_84d&&!("label" in this.params)){this.set("label",_84d.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _84e=this.id+"_text";_845.set(this.containerNode,"id",_84e);if(this.accelKeyNode){_845.set(this.accelKeyNode,"id",this.id+"_accel");_84e+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_84e);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_84f){_846.toggle(this.domNode,"dijitMenuItemSelected",_84f);},setLabel:function(_850){_847.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_850);},setDisabled:function(_851){_847.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_851);},_setDisabledAttr:function(_852){this.focusNode.setAttribute("aria-disabled",_852?"true":"false");this._set("disabled",_852);},_setAccelKeyAttr:function(_853){this.accelKeyNode.style.display=_853?"":"none";this.accelKeyNode.innerHTML=_853;_845.set(this.containerNode,"colSpan",_853?"1":"2");this._set("accelKey",_853);},_setTextDirAttr:function(_854){if(!this._created||this.textDir!=_854){this._set("textDir",_854);this.applyTextDir(this.focusNode,this.label);}}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","esri/tasks/SpatialRelationship":function(){define("esri/tasks/SpatialRelationship",["dojo/_base/lang","dojo/has","esri/kernel"],function(lang,has,_855){var _856={SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"};if(has("extend-esri")){lang.setObject("tasks._SpatialRelationship",_856,_855);}return _856;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_857,_858,dom,_859,_85a,lang,_85b,on,_85c,_85d,pm,_85e,_85f,_860,_861){return _858("dijit._MenuBase",[_85f,_861,_860],{parentMenu:null,popupDelay:500,autoFocus:false,childSelector:function(node){var _862=_85e.byNode(node);return node.parentNode==this.containerNode&&_862&&_862.focus;},postCreate:function(){var self=this,_863=typeof this.childSelector=="string"?this.childSelector:lang.hitch(this,"childSelector");this.own(on(this.containerNode,on.selector(_863,_85b.enter),function(){self.onItemHover(_85e.byNode(this));}),on(this.containerNode,on.selector(_863,_85b.leave),function(){self.onItemUnhover(_85e.byNode(this));}),on(this.containerNode,on.selector(_863,_85d),function(evt){self.onItemClick(_85e.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _864=this._getTopMenu();if(_864&&_864._isMenuBar){_864.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _865=this.currentPopup.parentMenu;if(_865.focusedChild){_865.focusedChild._setSelected(false);}_865.focusedChild=this.currentPopup.from_item;_865.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _866=item.popup;if(_866){this._stopPendingCloseTimer(_866);_866._pendingClose_timer=this.defer(function(){_866._pendingClose_timer=null;if(_866.parentMenu){_866.parentMenu.currentPopup=null;}pm.close(_866);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_867){if(_867._pendingClose_timer){_867._pendingClose_timer=_867._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_868){this._stopPopupTimer();var _869=this.focusedChild;if(!_869){return;}var _86a=_869.popup;if(!_86a.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_86a.parentMenu=this;_86a.from_item=_869;var self=this;pm.open({parent:this,popup:_86a,around:_869.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_869);self._cleanUp();_869._setSelected(true);self.focusedChild=_869;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_86a;_86a.connect(_86a.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_868&&_86a.focus){_86a._focus_timer=this.defer(lang.hitch(_86a,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_85a.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_85a.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_857.indexOf(this._focusManager.activeStack,this.id)>=0){_859.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dijit/_TemplatedMixin":function(){define("dijit/_TemplatedMixin",["dojo/_base/lang","dojo/touch","./_WidgetBase","dojo/string","dojo/cache","dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/sniff","dojo/_base/unload"],function(lang,_86b,_86c,_86d,_86e,_86f,_870,_871,has,_872){var _873=_870("dijit._TemplatedMixin",null,{templateString:null,templatePath:null,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];this._attachEvents=[];},_stringRepl:function(tmpl){var _874=this.declaredClass,_875=this;return _86d.substitute(tmpl,this,function(_876,key){if(key.charAt(0)=="!"){_876=lang.getObject(key.substr(1),false,_875);}if(typeof _876=="undefined"){throw new Error(_874+" template:"+key);}if(_876==null){return "";}return key.charAt(0)=="!"?_876:_876.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){if(!this.templateString){this.templateString=_86e(this.templatePath,{sanitize:true});}var _877=_873.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument);var node;if(lang.isString(_877)){node=_871.toDom(this._stringRepl(_877),this.ownerDocument);if(node.nodeType!=1){throw new Error("Invalid template: "+_877);}}else{node=_877.cloneNode(true);}this.domNode=node;this.inherited(arguments);this._attachTemplateNodes(node,function(n,p){return n.getAttribute(p);});this._beforeFillContent();this._fillContent(this.srcNodeRef);},_beforeFillContent:function(){},_fillContent:function(_878){var dest=this.containerNode;if(_878&&dest){while(_878.hasChildNodes()){dest.appendChild(_878.firstChild);}}},_attachTemplateNodes:function(_879,_87a){var _87b=lang.isArray(_879)?_879:(_879.all||_879.getElementsByTagName("*"));var x=lang.isArray(_879)?0:-1;for(;x<0||_87b[x];x++){var _87c=(x==-1)?_879:_87b[x];if(this.widgetsInTemplate&&(_87a(_87c,"dojoType")||_87a(_87c,"data-dojo-type"))){continue;}var _87d=_87a(_87c,"dojoAttachPoint")||_87a(_87c,"data-dojo-attach-point");if(_87d){var _87e,_87f=_87d.split(/\s*,\s*/);while((_87e=_87f.shift())){if(lang.isArray(this[_87e])){this[_87e].push(_87c);}else{this[_87e]=_87c;}this._attachPoints.push(_87e);}}var _880=_87a(_87c,"dojoAttachEvent")||_87a(_87c,"data-dojo-attach-event");if(_880){var _881,_882=_880.split(/\s*,\s*/);var trim=lang.trim;while((_881=_882.shift())){if(_881){var _883=null;if(_881.indexOf(":")!=-1){var _884=_881.split(":");_881=trim(_884[0]);_883=trim(_884[1]);}else{_881=trim(_881);}if(!_883){_883=_881;}this._attachEvents.push(this.connect(_87c,_86b[_881]||_881,_883));}}}}},destroyRendering:function(){_86f.forEach(this._attachPoints,function(_885){delete this[_885];},this);this._attachPoints=[];_86f.forEach(this._attachEvents,this.disconnect,this);this._attachEvents=[];this.inherited(arguments);}});_873._templateCache={};_873.getCachedTemplate=function(_886,_887,doc){var _888=_873._templateCache;var key=_886;var _889=_888[key];if(_889){try{if(!_889.ownerDocument||_889.ownerDocument==(doc||document)){return _889;}}catch(e){}_871.destroy(_889);}_886=_86d.trim(_886);if(_887||_886.match(/\$\{([^\}]+)\}/g)){return (_888[key]=_886);}else{var node=_871.toDom(_886,doc);if(node.nodeType!=1){throw new Error("Invalid template: "+_886);}return (_888[key]=node);}};if(has("ie")){_872.addOnWindowUnload(function(){var _88a=_873._templateCache;for(var key in _88a){var _88b=_88a[key];if(typeof _88b=="object"){_871.destroy(_88b);}delete _88a[key];}});}lang.extend(_86c,{dojoAttachEvent:"",dojoAttachPoint:""});return _873;});},"esri/dijit/editing/TemplatePicker":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/json","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojo/data/ItemFileReadStore","dojox/grid/DataGrid","dojox/gfx","esri/layers/FeatureLayer","esri/symbols/PictureMarkerSymbol","esri/dijit/editing/TemplatePickerItem","esri/kernel","esri/lang","esri/request","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/TemplatePicker.html"],function(_88c,_88d,lang,_88e,html,_88f,_890,_891,has,_892,_893,_894,_895,_896,_897,_898,_899,_89a,_89b,gfx,_89c,_89d,_89e,_89f,_8a0,_8a1,_8a2,_8a3){var TP=_88d([_898,_899],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:true,templateString:_8a3,basePath:_88c.toUrl("esri/dijit/editing")+"/",featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_8a4,_8a5){_8a4=_8a4||{};if(!_8a4.items&&!_8a4.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(_891.version.minor>=4);this._itemWidgets={};if(_8a4.featureLayers&&_8a4.featureLayers.length){this._flChanged=1;}this._nls=_8a2.widgets.templatePicker;this.emptyMessage=_8a4.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=_896.getContentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=_896.getContentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();_88e.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(has("ie")<9){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _8a6=this._selectedCell,info=this._selectedInfo;if(_8a6){this._rowClicked({cellNode:_8a6,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_8a7){var _8a8=(this.rows==="auto"&&this.columns==="auto"&&_8a7)?true:false,grid=this.grid,box;if(_8a8){var _8a9=this.domNode,id=_8a9.id,_8aa,item=_891.query("#"+id+".templatePicker div.item")[0];box=_896.getContentBox(_8a9);item=item&&item.parentNode;if(item){_8aa=html.coords(item).w;}else{_8aa=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_8aa);this._columns=this._columns||1;}var _8ab=this._rows;this._preprocess();var _8ac=this._rows;this._setGridLayout();this._setGridData();if(_8ac!==_8ab){grid.set("autoHeight",this._rows,false);}if(_8a8){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_8ad=this.getSelected();if(_8ad){grid.store.fetch({onComplete:function(its){var _8ae=self._locate(_8ad,self._selectedInfo,its);var _8af=_8ae&&grid.views.views[0].getCellNode(_8ae[0],_8ae[1]);if(_8af){self._rowClicked({cellNode:_8af,rowIndex:_8ae[0],cellIndex:_8ae[1]},true);}}});}if(has("ie")<9){setTimeout(this._repaintItems,this._ieTimer);}var _8b0=this.featureLayers,_8b1=this.items;if((!_8b0||!_8b0.length)&&(!_8b1||!_8b1.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _8b2=this.useLegend;if(!this._started||_8b2!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_8b3){var _8b4=this.featureLayers;if(!this._started||_8b4!==_8b3){this._flChanged=1;}this.featureLayers=_8b3;},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _8b5;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}_8b5=this._flItems=this._getItemsFromLayers(this.featureLayers);}else{_8b5=this._itItems=this._getItemsFromItems(this.items);}if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_8b5.length;_88f.forEach(_8b5,function(_8b6){len+=Math.ceil(_8b6.length/this.columns);},this);}else{_88f.forEach(_8b5,function(_8b7){len+=_8b7.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_8b5.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{_88f.forEach(_8b5,function(_8b8){len+=_8b8.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_8b5.length/this.rows);}this._columns=len;}}},_processSelectionLayers:function(){var map,_8b9,info,_8ba,key,_8bb,_8bc,_8bd={};_88f.forEach(this.featureLayers,function(_8be,idx){if(_8be.mode===_89c.MODE_SELECTION&&_8be._map&&_8be.url&&_8be._params.drawMode&&!_8be.source){_8b9=lang.trim(_8be._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_8bd[_8b9]=_8bd[_8b9]||{});_8ba=(info.featureLayers=info.featureLayers||{});_8bb=(info.indices=info.indices||[]);_8ba[idx]=_8be;_8bb.push(idx);map=_8be._map;}});if(map){_88f.forEach(map.layerIds,function(_8bf){_8bf=map.getLayer(_8bf);if(_8bf&&_8bf.url&&(_8bf.getImageUrl||_8bf.getTileUrl)&&_8bf.loaded&&_8bf.version>=10.1){_8b9=lang.trim(_8bf._url.path).replace(/(\/MapServer).*/ig,"$1");key=_8b9.replace(/^https?:\/\//ig,"").toLowerCase();if(_8bd[key]&&(!_8bd[key].mapServiceUrl)){info=_8bd[key];info.mapServiceUrl=_8b9;info.mapServiceLayer=_8bf;this._legendIndices=this._legendIndices.concat(info.indices);_8bc=this._fetchLegend({pickerInstance:this,info:info},key);if(_8bc.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_8bc);}else{this._processLegendResponse(_8bc,info);}}}},this);}},_fetchLegend:function(_8c0,key){var _8c1=TP.prototype,_8c2=_8c1.legendCache[key];if(!_8c2){_8c2=(_8c1.legendCache[key]=_8a1({url:_8c0.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_8c2._contexts=[_8c0];_8c2.addBoth(function(_8c3){if(_8c2.canceled){return;}_8c1.legendCache[key]=_8c3;var _8c4=_8c2._contexts;_8c2._contexts=null;_88f.forEach(_8c4,function(ctxt){var _8c5=ctxt.pickerInstance,info=ctxt.info,_8c6;if(_8c5._destroyed){return;}_88f.forEach(info.indices,function(idx){_8c6=_88f.indexOf(_8c5._loadingIndices,idx);if(_8c6>-1){_8c5._loadingIndices.splice(_8c6,1);}});_8c6=_88f.indexOf(_8c5._loadingLegends,_8c2);if(_8c6>-1){_8c5._loadingLegends.splice(_8c6,1);}_8c5._processLegendResponse(_8c3,info);});});}else{if(_8c2.then){_8c2._contexts.push(_8c0);}}return _8c2;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){_88f.forEach(this._loadingLegends,function(_8c7){var _8c8=-1;_88f.some(_8c7._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_8c8=idx;}return (_8c8>-1);},this);if(_8c8>-1){_8c7._contexts.splice(_8c8,1);}},this);}},_processLegendResponse:function(_8c9,info){if(_8c9&&!(_8c9 instanceof Error)){_88f.forEach(info.indices,function(idx){var _8ca=info.featureLayers[idx].layerId,i,_8cb=info.mapServiceUrl+"/"+_8ca+"/images/",_8cc=info.mapServiceLayer._getToken(),_8cd,obj,_8ce,url;if(this._legendSymbols[idx]){return;}_8cd=null;_88f.some(_8c9.layers,function(_8cf){if(_8cf.layerId==_8ca){_8cd=_8cf;}return !!_8cd;});if(_8cd){obj=(this._legendSymbols[idx]={});_88f.forEach(_8cd.legend,function(_8d0){_8ce=_8d0.values;if(_8ce&&_8ce.length){for(i=0;i<_8ce.length;i++){obj[_8ce[i]]=_8d0;}}else{obj.defaultSymbol=_8d0;}url=_8d0.url;if(url&&!_8d0._fixed){_8d0._fixed=1;if((url.search(/https?\:/)===-1)){_8d0.url=_8cb+url;}if(_8cc&&_8d0.url.search(/https?\:/)!==-1){_8d0.url+=(((_8d0.url.indexOf("?")>-1)?"&":"?")+"token="+_8cc);}}});}},this);}else{var _8d1;_88f.forEach(info.indices,function(idx){_8d1=_88f.indexOf(this._legendIndices,idx);if(_8d1>-1){this._legendIndices.splice(_8d1,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _8d2=grid.adaptWidth,_8d3,i,view;grid.adaptWidth=function(){_8d3=this.views.views;for(i=0;view=_8d3[i];i++){_897.set(view.headerNode,"display","block");}_8d2.apply(this,arguments);for(i=0;view=_8d3[i];i++){_897.set(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _8d4=_88e.connect(grid,"_onFetchComplete",this,function(){_88e.disconnect(_8d4);this.grid.set("autoHeight",this._rows);});}_88e.connect(grid,"_onDelete",this,this._destroyItems);_88e.connect(grid,"_clearData",this,this._destroyItems);_88e.connect(grid,"destroy",this,this._destroyItems);var _8d5=grid.focus;if(_8d5&&_8d5.findAndFocusGridCell){_8d5.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _8d6=function(_8d7){return function(_8d8,_8d9){return this._cellGet(_8d7,_8d8,_8d9);};};var _8da=lang.hitch(this,this._cellFormatter),_8db=[],cols=this._columns,i;for(i=0;i<cols;i++){_8db.push({field:"cell"+i,get:lang.hitch(this,_8d6(i)),formatter:_8da});}var _8dc={cells:[_8db]};if(this.grouping){var _8dd={field:"groupName",colSpan:cols,get:lang.hitch(this,this._cellGetGroup),formatter:lang.hitch(this,this._cellGroupFormatter)};_8dc.cells.push([_8dd]);}var grid=this.grid,_8de=_89b.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_8de)?this._rows:_8de);grid.set("structure",_8dc);},_setGridData:function(){var _8df=[];if(this.grouping){this._groupRowIndices=[];var _8e0,_8e1,cols=this._columns;_88f.forEach(this._flItems,function(_8e2,idx){_8df.push({});var _8e3=(idx===0)?0:(_8e0+_8e1+1);this._groupRowIndices.push(_8e3);_8e0=_8e3;_8e1=Math.ceil(_8e2.length/cols);_8df=_8df.concat(this._getStoreItems(_8e2));},this);}else{if(this.featureLayers){_88f.forEach(this._flItems,function(_8e4){_8df=_8df.concat(_8e4);});_8df=this._getStoreItems(_8df);}else{_8df=this._getStoreItems(this._itItems);}}var _8e5=new _89a({data:{items:_8df}});this.grid.setStore(_8e5);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=_895.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=_88e.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=_88e.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){_88e.disconnect(this._mouseOverConnect);_88e.disconnect(this._mouseOutConnect);_895.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_8e6){var _8e7=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_8e7,row,col);if(!cell){return;}var _8e8=this.grid.store;if(_8e8.getValue(cell,"loadingCell")){return;}if(this._selectedCell){_894.remove(this._selectedCell,"selectedItem");}if(_8e7!==this._selectedCell){_894.add(_8e7,"selectedItem");this._selectedCell=_8e7;this._selectedItem={featureLayer:_8e8.getValue(cell,"layer"),type:_8e8.getValue(cell,"type"),template:_8e8.getValue(cell,"template"),symbolInfo:_8e8.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_8e8.getValue(cell,"index1"),index2:_8e8.getValue(cell,"index2"),index:_8e8.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_8e6){this.onSelectionChange();}},_locate:function(_8e9,info,_8ea){var _8eb=this.grid.store,cols=new Array(this._columns);var _8ec,_8ed=info.index1,_8ee=info.index2,_8ef=info.index,item=_8e9.item;_88f.some(_8ea,function(_8f0,_8f1){return _88f.some(cols,function(_8f2,_8f3){var cell=_8eb.getValue(_8f0,"cell"+_8f3);if(cell&&(item?(_8ef===_8eb.getValue(cell,"index")):(_8ed===_8eb.getValue(cell,"index1")&&_8ee===_8eb.getValue(cell,"index2")))){_8ec=[_8f1,_8f3];return true;}else{return false;}});});return _8ec;},_getCellInfo:function(_8f4,row,col){if(!_8f4){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _8f5=this.items;if(_8f5){return _8f5[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _8f6=this.tooltip;var _8f7=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_8f7,row,col);if(_8f6&&cell){var _8f8=this.grid.store;var _8f9=_8f8.getValue(cell,"template");var type=_8f8.getValue(cell,"type");var _8fa=_8f8.getValue(cell,"symbolInfo");var _8fb=_8f8.getValue(cell,"layer");var item=this._getItem(cell);var _8fc=(item&&(item.label+(item.description?(": "+item.description):"")))||(_8f9&&(_8f9.name+(_8f9.description?(": "+_8f9.description):"")))||(type&&type.name)||(_8fa&&(_8fa.label+(_8fa.description?(": "+_8fa.description):"")))||((_8fb&&_8fb.name+": ")+"Default");_8f6.style.display="none";_8f6.innerHTML=_8fc;var _8fd=html.coords(_8f7.firstChild);_897.set(_8f6,{left:(_8fd.x)+"px",top:(_8fd.y+_8fd.h+5)+"px"});_8f6.style.display="";}},_cellMouseOut:function(){var _8fe=this.tooltip;if(_8fe){_8fe.style.display="none";}},_destroyItems:function(){var _8ff=this._itemWidgets,w;for(w in _8ff){if(!_8ff[w]){continue;}_8ff[w].destroy();delete _8ff[w];}},_repaintItems:function(){var _900=this._itemWidgets,w;for(w in _900){var _901=_900[w];if(_901){_901._repaint(_901._surface);}}},_getStoreItems:function(_902){var uid=this._uniqueId;_902=_88f.map(_902,function(item){return lang.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_902.length,_903=0,obj={},k=0,prop,_904=[],flag=true,cols=this._columns;while(_903<len){flag=true;prop="cell"+k;obj[prop]=_902[_903];_903++;k++;if(k%cols===0){flag=false;_904.push(obj);obj={};k=0;}}if(flag&&len){_904.push(obj);}return _904;},_getItemsFromLayers:function(_905){var _906=[];_88f.forEach(_905,function(_907,_908){_906.push(this._getItemsFromLayer(_907,_908));},this);return _906;},_getItemsFromLayer:function(_909,_90a){var _90b=[];if(this.useLegend&&_88f.indexOf(this._loadingIndices,_90a)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_909,type:null,template:null,index1:_90a,index2:0,loadingCell:1}];}var _90c=[];_90c=_90c.concat(_909.templates);_88f.forEach(_909.types,function(_90d){var _90e=_90d.templates;_88f.forEach(_90e,function(_90f){_90f._type_=_90d;});_90c=_90c.concat(_90e);});_90c=_88f.filter(_90c,_8a0.isDefined);var _910=_909.renderer;if(_910){var _911=_910.declaredClass.replace("esri.renderer.","");if(_90c.length>0){_88f.forEach(_90c,function(_912){var _913=_912.prototype;if(_913){var _914=_910.getSymbol(_913);if(_914){var _915=null,pms,_916;if(this.useLegend&&_88f.indexOf(this._legendIndices,_90a)>-1){_916=this._legendSymbols&&this._legendSymbols[_90a];if(_916){switch(_911){case "SimpleRenderer":_915=_916.defaultSymbol;break;case "UniqueValueRenderer":_88f.some(_910.infos,function(info){if(info.symbol===_914){_915=_916[info.value];}return !!_915;});break;case "ClassBreaksRenderer":_88f.some(_910.infos,function(info){if(info.symbol===_914){_915=_916[info.maxValue];}return !!_915;});break;}}if(_915){pms=_890.fromJson(_890.toJson(_89d.defaultProps));pms.url=_915.url;pms.imageData=_915.imageData;pms.contentType=_915.contentType;pms.width=_915.width;pms.height=_915.height;if(!_8a0.isDefined(pms.width)||!_8a0.isDefined(pms.height)){pms.width=15;pms.height=15;}_915=new _89d(pms);}}_90b.push({label:this._trimLabel(_912.name),symbol:_915||_914,legendOverride:!!_915,layer:_909,type:_912._type_,template:_912,index1:_90a,index2:_90b.length});}}delete _912._type_;},this);}else{var _917=[];if(_911==="TemporalRenderer"){_910=_910.observationRenderer;if(_910){_911=_910.declaredClass.replace("esri.renderer.","");}}switch(_911){case "SimpleRenderer":_917=[{symbol:_910.symbol,label:_910.label,description:_910.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_917=_910.infos;break;}_90b=_88f.map(_917,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:lang.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_909,index1:_90a,index2:idx};},this);}}return _90b;},_getItemsFromItems:function(_918){return _88f.map(_918,function(item,idx){item=lang.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_919){var max=this.maxLabelLength;if(max&&_919){if(_919.length>max){_919=_919.substr(0,max)+"...";}}return _919||"";},_cellGet:function(_91a,_91b,_91c){if(!_91c){return "";}return this.grid.store.getValue(_91c,"cell"+_91a);},_cellFormatter:function(_91d){if(_91d){var _91e=this._itemWidgets,_91f=this.grid.store;var sid=_91f.getValue(_91d,"surfaceId");var w=_91e[sid];if(!w){w=(_91e[sid]=new _89e({id:sid,label:_91f.getValue(_91d,"label"),symbol:_91f.getValue(_91d,"symbol"),legendOverride:_91f.getValue(_91d,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_91f.getValue(_91d,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_920,_921){if(!this._groupRowIndices){return "";}var _922=_88f.indexOf(this._groupRowIndices,_920);if(!_921||_922===-1){return "";}return (this.featureLayers[_922]&&this.featureLayers[_922].name)||"";},_cellGroupFormatter:function(_923){if(_923){return "<div class='groupLabel'>"+_923+"</div>";}else{return "";}}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePicker",TP,_89f);}return TP;});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_924,lang,_925,_926,xhr,_927,_928,_929,_92a){var _92b=_925("dojo.data.ItemFileReadStore",[_927],{constructor:function(_92c){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_92c.url;this._ccUrl=_92c.url;this.url=_92c.url;this._jsonData=_92c.data;this.data=null;this._datatypeMap=_92c.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_92d){return _92a.fromISOString(_92d);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_92c.urlPreventCache!==undefined){this.urlPreventCache=_92c.urlPreventCache?true:false;}if(_92c.hierarchical!==undefined){this.hierarchical=_92c.hierarchical?true:false;}if(_92c.clearOnClose){this.clearOnClose=true;}if("failOk" in _92c){this.failOk=_92c.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_92e){if(typeof _92e!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_92f,_930){var _931=this.getValues(item,_92f);return (_931.length>0)?_931[0]:_930;},getValues:function(item,_932){this._assertIsItem(item);this._assertIsAttribute(_932);return (item[_932]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _933=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_933.push(key);}}return _933;},hasAttribute:function(item,_934){this._assertIsItem(item);this._assertIsAttribute(_934);return (_934 in item);},containsValue:function(item,_935,_936){var _937=undefined;if(typeof _936==="string"){_937=_928.patternToRegExp(_936,false);}return this._containsValue(item,_935,_936,_937);},_containsValue:function(item,_938,_939,_93a){return _926.some(this.getValues(item,_938),function(_93b){if(_93b!==null&&!lang.isObject(_93b)&&_93a){if(_93b.toString().match(_93a)){return true;}}else{if(_939===_93b){return true;}}});},isItem:function(_93c){if(_93c&&_93c[this._storeRefPropName]===this){if(this._arrayOfAllItems[_93c[this._itemNumPropName]]===_93c){return true;}}return false;},isItemLoaded:function(_93d){return this.isItem(_93d);},loadItem:function(_93e){this._assertIsItem(_93e.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_93f,_940,_941){var _942=[],i,key;if(_93f.query){var _943,_944=_93f.queryOptions?_93f.queryOptions.ignoreCase:false;var _945={};for(key in _93f.query){_943=_93f.query[key];if(typeof _943==="string"){_945[key]=_928.patternToRegExp(_943,_944);}else{if(_943 instanceof RegExp){_945[key]=_943;}}}for(i=0;i<_940.length;++i){var _946=true;var _947=_940[i];if(_947===null){_946=false;}else{for(key in _93f.query){_943=_93f.query[key];if(!this._containsValue(_947,key,_943,_945[key])){_946=false;}}}if(_946){_942.push(_947);}}_941(_942,_93f);}else{for(i=0;i<_940.length;++i){var item=_940[i];if(item!==null){_942.push(item);}}_941(_942,_93f);}},_fetchItems:function(_948,_949,_94a){var self=this;if(this._loadFinished){this.filter(_948,this._getItemsArray(_948.queryOptions),_949);}else{if(this._jsonFileUrl!==this._ccUrl){_924.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_948,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_949)});}else{this._loadInProgress=true;var _94b={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _94c=xhr.get(_94b);_94c.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_948,self._getItemsArray(_948.queryOptions),_949);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_94a(e,_948);}});_94c.addErrback(function(_94d){self._loadInProgress=false;_94a(_94d,_948);});var _94e=null;if(_948.abort){_94e=_948.abort;}_948.abort=function(){var df=_94c;if(df&&df.fired===-1){df.cancel();df=null;}if(_94e){_94e.call(_948);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_948,this._getItemsArray(_948.queryOptions),_949);}catch(e){_94a(e,_948);}}else{_94a(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_948);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _94f=this._queuedFetches[i],_950=_94f.args,_951=_94f.filter,_952=_94f.findCallback;if(_951){_951(_950,this._getItemsArray(_950.queryOptions),_952);}else{this.fetchItemByIdentity(_950);}}this._queuedFetches=[];}},_getItemsArray:function(_953){if(_953&&_953.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_954){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_955){var _956=false,self=this;function _957(_958){return (_958!==null)&&(typeof _958==="object")&&(!lang.isArray(_958)||_956)&&(!lang.isFunction(_958))&&(_958.constructor==Object||lang.isArray(_958))&&(typeof _958._reference==="undefined")&&(typeof _958._type==="undefined")&&(typeof _958._value==="undefined")&&self.hierarchical;};function _959(_95a){self._arrayOfAllItems.push(_95a);for(var _95b in _95a){var _95c=_95a[_95b];if(_95c){if(lang.isArray(_95c)){var _95d=_95c;for(var k=0;k<_95d.length;++k){var _95e=_95d[k];if(_957(_95e)){_959(_95e);}}}else{if(_957(_95c)){_959(_95c);}}}}};this._labelAttr=_955.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_955.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_956=true;}_959(item);item[this._rootItemPropName]=true;}var _95f={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _960=item[key];if(_960!==null){if(!lang.isArray(_960)){item[key]=[_960];}}else{item[key]=[null];}}_95f[key]=key;}}while(_95f[this._storeRefPropName]){this._storeRefPropName+="_";}while(_95f[this._itemNumPropName]){this._itemNumPropName+="_";}while(_95f[this._reverseRefMap]){this._reverseRefMap+="_";}var _961;var _962=_955.identifier;if(_962){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_962;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_961=item[_962];var _963=_961[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_963)){this._itemsByIdentity[_963]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_962+"].  Value collided: ["+_963+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_962+"].  Value collided: ["+_963+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_961=item[key];for(var j=0;j<_961.length;++j){_960=_961[j];if(_960!==null&&typeof _960=="object"){if(("_type" in _960)&&("_value" in _960)){var type=_960._type;var _964=this._datatypeMap[type];if(!_964){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_964)){_961[j]=new _964(_960._value);}else{if(lang.isFunction(_964.deserialize)){_961[j]=_964.deserialize(_960._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_960._reference){var _965=_960._reference;if(!lang.isObject(_965)){_961[j]=this._getItemByIdentity(_965);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _966=this._arrayOfAllItems[k],_967=true;for(var _968 in _965){if(_966[_968]!=_965[_968]){_967=false;}}if(_967){_961[j]=_966;}}}if(this.referenceIntegrity){var _969=_961[j];if(this.isItem(_969)){this._addReferenceToMap(_969,item,key);}}}else{if(this.isItem(_960)){if(this.referenceIntegrity){this._addReferenceToMap(_960,item,key);}}}}}}}},_addReferenceToMap:function(_96a,_96b,_96c){},getIdentity:function(item){var _96d=this._features["dojo.data.api.Identity"];if(_96d===Number){return item[this._itemNumPropName];}else{var _96e=item[_96d];if(_96e){return _96e[0];}}return null;},fetchItemByIdentity:function(_96f){var item,_970;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_924.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_96f});}else{this._loadInProgress=true;var _971={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _972=xhr.get(_971);_972.addCallback(function(data){var _973=_96f.scope?_96f.scope:_924.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_96f.identity);if(_96f.onItem){_96f.onItem.call(_973,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_96f.onError){_96f.onError.call(_973,error);}}});_972.addErrback(function(_974){self._loadInProgress=false;if(_96f.onError){var _975=_96f.scope?_96f.scope:_924.global;_96f.onError.call(_975,_974);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_96f.identity);if(_96f.onItem){_970=_96f.scope?_96f.scope:_924.global;_96f.onItem.call(_970,item);}}}}else{item=this._getItemByIdentity(_96f.identity);if(_96f.onItem){_970=_96f.scope?_96f.scope:_924.global;_96f.onItem.call(_970,item);}}},_getItemByIdentity:function(_976){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_976)){item=this._itemsByIdentity[_976];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_976)){item=this._arrayOfAllItems[_976];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _977=this._features["dojo.data.api.Identity"];if(_977===Number){return null;}else{return [_977];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_924.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _978={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _979=xhr.get(_978);_979.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_979.addErrback(function(_97a){throw _97a;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_92b,_929);return _92b;});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_97b,_97c,lang,_97d){return _97b("dojox.grid._SelectionPreserver",null,{constructor:function(_97e){this.selection=_97e;var grid=this.grid=_97e.grid;this.reset();this._connects=[_97c.connect(grid,"_setStore",this,"reset"),_97c.connect(grid,"_addItem",this,"_reSelectById"),_97c.connect(_97e,"onSelected",lang.hitch(this,"_selectById",true)),_97c.connect(_97e,"onDeselected",lang.hitch(this,"_selectById",false)),_97c.connect(_97e,"deselectAll",this,"reset")];},destroy:function(){this.reset();_97d.forEach(this._connects,_97c.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_97f){if(item&&this.grid._hasIdentity){this.selection.selected[_97f]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_980,_981){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_981,g=this.grid;if(typeof _981=="number"||typeof _981=="string"){var _982=g._by_idx[_981];item=_982&&_982.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_980;}return item;}});});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_983,_984){var _985={};lang.setObject("dojo.data.util.simpleFetch",_985);_985.errorHandler=function(_986,_987){if(_987.onError){var _988=_987.scope||_983.global;_987.onError.call(_988,_986,_987);}};_985.fetchHandler=function(_989,_98a){var _98b=_98a.abort||null,_98c=false,_98d=_98a.start?_98a.start:0,_98e=(_98a.count&&(_98a.count!==Infinity))?(_98d+_98a.count):_989.length;_98a.abort=function(){_98c=true;if(_98b){_98b.call(_98a);}};var _98f=_98a.scope||_983.global;if(!_98a.store){_98a.store=this;}if(_98a.onBegin){_98a.onBegin.call(_98f,_989.length,_98a);}if(_98a.sort){_989.sort(_984.createSortFunction(_98a.sort,this));}if(_98a.onItem){for(var i=_98d;(i<_989.length)&&(i<_98e);++i){var item=_989[i];if(!_98c){_98a.onItem.call(_98f,item,_98a);}}}if(_98a.onComplete&&!_98c){var _990=null;if(!_98a.onItem){_990=_989.slice(_98d,_98e);}_98a.onComplete.call(_98f,_990,_98a);}};_985.fetch=function(_991){_991=_991||{};if(!_991.store){_991.store=this;}this._fetchItems(_991,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _991;};return _985;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_992,_993,lang,win,_994,has,_995,_996,_997,util,html){var dg=_992.grid;var _998=function(td){return td.cellIndex>=0?td.cellIndex:_993.indexOf(td.parentNode.cells,td);};var _999=function(tr){return tr.rowIndex>=0?tr.rowIndex:_993.indexOf(tr.parentNode.childNodes,tr);};var _99a=function(_99b,_99c){return _99b&&((_99b.rows||0)[_99c]||_99b.childNodes[_99c]);};var _99d=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _99e=function(_99f,_9a0){for(var n=_99f;n&&_9a0(n);n=n.parentNode){}return n;};var _9a1=function(_9a2){var name=_9a2.toUpperCase();return function(node){return node.tagName!=name;};};var _9a3=util.rowIndexTag;var _9a4=util.gridViewTag;var _9a5=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_9a6,_9a7,_9a8,_9a9){var _9aa=[],html;if(_9a9){var _9ab=_9a6.index!=_9a6.grid.getSortIndex()?"":_9a6.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_9a6.id){_9a6.id=this.grid.id+"Hdr"+_9a6.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_9ab,"id=\"",_9a6.id,"\""];}else{var _9ac=this.grid.editable&&!_9a6.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_9ac];}if(_9a6.colSpan){html.push(" colspan=\"",_9a6.colSpan,"\"");}if(_9a6.rowSpan){html.push(" rowspan=\"",_9a6.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_9a6.classes){html.push(_9a6.classes," ");}if(_9a8){html.push(_9a8," ");}_9aa.push(html.join(""));_9aa.push("");html=["\" idx=\"",_9a6.index,"\" style=\""];if(_9a7&&_9a7[_9a7.length-1]!=";"){_9a7+=";";}html.push(_9a6.styles,_9a7||"",_9a6.hidden?"display:none;":"");if(_9a6.unitWidth){html.push("width:",_9a6.unitWidth,";");}_9aa.push(html.join(""));_9aa.push("");html=["\""];if(_9a6.attrs){html.push(" ",_9a6.attrs);}html.push(">");_9aa.push(html.join(""));_9aa.push("");_9aa.push(_9a9?"</th>":"</td>");return _9aa;},isCellNode:function(_9ad){return Boolean(_9ad&&_9ad!=win.doc&&html.attr(_9ad,"idx"));},getCellNodeIndex:function(_9ae){return _9ae?Number(html.attr(_9ae,"idx")):-1;},getCellNode:function(_9af,_9b0){for(var i=0,row;((row=_99a(_9af.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_9b0){return cell;}}}return null;},findCellTarget:function(_9b1,_9b2){var n=_9b1;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_9a4 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_9a4]!=this.view.id))&&(n!=_9b2)){n=n.parentNode;}return n!=_9b2?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_9b3,_9b4){var n=_9b3;while(n&&(n!=this.domNode)&&(!(_9b4 in n)||(_9a4 in n&&n[_9a4]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_9b5){return this.findTarget(_9b5,_9a3);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _9b6=dg._ContentBuilder=lang.extend(function(view){_9a5.call(this,view);},_9a5.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _9b7=this.grid.get,_9b8=this.view.structure.cells;for(var j=0,row;(row=_9b8[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_9b7;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_9b9,_9ba){var html=this.getTableArray(),v=this.view,_9bb=v.structure.cells,item=this.grid.getItem(_9ba);util.fire(this.view,"onBeforeRow",[_9ba,_9bb]);for(var j=0,row;(row=_9bb[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_9ba,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_9a3];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _9bc=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_9a5.call(this,view);},_9a5.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_9bd,_9be){var html=this.getTableArray(),_9bf=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_9bf]);for(var j=0,row;(row=_9bf[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_9c0;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_9c0=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_9c0[5]=(_9be!=undefined?_9be:_9bd(cell));_9c0[3]=cell.customStyles.join(";");_9c0[1]=cell.customClasses.join(" ");html.push(_9c0.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_99e(e.target,_9a1("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_99e(n,_9a1("table"));x-=(table&&table.offsetLeft)||0;}}n=_99e(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_994.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_994.stop(e);return true;}return false;},colResizeSetup:function(e,_9c1){var _9c2=html.contentBox(e.sourceView.headerNode);if(_9c1){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _9c3=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_997.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_9c3.h+_9c2.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _9c4=[],_9c5=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_9c5[i]);i++){_9c4.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _9c6=e.grid.views.views;var _9c7=[];for(var j=view.idx+adj,_9c8;(_9c8=_9c6[j]);j=j+adj){_9c7.push({node:_9c8.headerNode,left:window.parseInt(_9c8.headerNode.style.left)});}var _9c9=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_9c2.w,table:_9c9,tw:html.contentBox(_9c9).w,spanners:_9c4,followers:_9c7};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _996(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_995.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_9ca,_9cb,_9cc){var _9cd=_9cc.l;var data={deltaX:_9cd,w:_9ca.w+(this.grid.isLeftToRight()?_9cd:-_9cd),vw:_9ca.vw+_9cd,tw:_9ca.tw+_9cd};this.dragRecord={inDrag:_9ca,mover:_9cb,leftTop:_9cc};if(data.w>=this.minColWidth){if(!_9cb){this.doResizeNow(_9ca,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_9ce){if(this.dragRecord){var _9cf=this.dragRecord.leftTop;var _9d0=this.grid.isLeftToRight()?_9cf.l:-_9cf.l;_9d0+=Math.max(_9ce.w+_9d0,this.minColWidth)-(_9ce.w+_9d0);if(has("webkit")&&_9ce.spanners.length){_9d0+=html._getPadBorderExtents(_9ce.spanners[0].node).w;}var data={deltaX:_9d0,w:_9ce.w+_9d0,vw:_9ce.vw+_9d0,tw:_9ce.tw+_9d0};this.doResizeNow(_9ce,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_9ce.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_9ce.index);},doResizeNow:function(_9d1,data){_9d1.view.convertColPctToFixed();if(_9d1.view.flexCells&&!_9d1.view.testFlexCells()){var t=_99d(_9d1.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_9d1.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_9d1.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_9d1.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_9d1.node.style.width=data.w+"px";_9d1.view.setColWidth(_9d1.index,data.w);_9d1.view.headerNode.style.width=data.vw+"px";_9d1.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_9d1.view.headerNode.scrollLeft=_9d1.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_9d2){var _9d3=_9d2.length;if(!_9d3){return;}this.map=[];var row;for(var k=0;(row=_9d2[k]);k++){this.map[k]=[];}for(var j=0;(row=_9d2[j]);j++){for(var i=0,x=0,cell,_9d4,_9d5;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_9d5=cell.rowSpan||1;_9d4=cell.colSpan||1;for(var y=0;y<_9d5;y++){for(var s=0;s<_9d4;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_9d4;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_9d6,_9d7){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_9d7&&cell.r==_9d6){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_9d8,_9d9,_9da){var row=_9d8&&_9d8.rows[_9d9];return row&&row.cells[_9da];},_findOverlappingNodes:function(_9db,_9dc,_9dd){var _9de=[];var m=this.getMapCoords(_9dc,_9dd);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_9db,rw.r,rw.c):null);if(n){_9de.push(n);}}return _9de;},findOverlappingNodes:function(_9df){return this._findOverlappingNodes(_99d(_9df),_999(_9df.parentNode),_998(_9df));}});return {_Builder:_9a5,_HeaderBuilder:_9bc,_ContentBuilder:_9b6};});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_9e0,_9e1,_9e2,_9e3,lang,_9e4,_9e5,_9e6,_9e7,_9e8,dnd,_9e9,_9ea){if(!_9e3.isAsync){_9e7(0,function(){var _9eb=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_9eb);});}var _9ec=_9e2("dojo.dnd.Source",_9e9,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_9ed){lang.mixin(this,lang.mixin({},_9ed));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_9e4.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_9e4.add(this.node,"dojoDndTarget");}if(this.horizontal){_9e4.add(this.node,"dojoDndHorizontal");}this.topics=[_9e8.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_9e8.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_9e8.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_9e8.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_9ee,_9ef){if(this==_9ee){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_9ef.length;++i){var type=_9ee.getItem(_9ef[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_9f0,self){if(_9f0){return true;}if(arguments.length<2){self=this==_9ea.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_9ec.superclass.destroy.call(this);_9e0.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_9ec.superclass.onMouseMove.call(this,e);var m=_9ea.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _9f1=this.getSelectedNodes();if(_9f1.length){m.startDrag(this,_9f1,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _9f2=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_9e5.position(this.current,true);}if(this.horizontal){_9f2=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_9e5.isBodyLtr(this.current.ownerDocument);}else{_9f2=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_9f2!=this.before){this._markTargetAnchor(_9f2);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_9ec.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_9ec.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_9f3){if(this!==_9f3){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_9ea.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_9f4,_9f5,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_9f4?(copy?"Copied":"Moved"):"");}var _9f6=this.accept&&this.checkAcceptance(_9f4,_9f5);this._changeState("Target",_9f6?"":"Disabled");if(this==_9f4){_9ea.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_9f7,_9f8,copy,_9f9){if(this==_9f9){this.onDrop(_9f7,_9f8,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_9fa,_9fb,copy){if(this!=_9fa){this.onDropExternal(_9fa,_9fb,copy);}else{this.onDropInternal(_9fb,copy);}},onDropExternal:function(_9fc,_9fd,copy){var _9fe=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _9fe.call(this,_9fc.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_9fc.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_9fc.getItem(node.id);_9fc.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_9fc.selectNone();}this.insertNodes(true,_9fd,this.before,this.current);if(!copy&&this.creator){_9fc.deleteSelectedNodes();}this._normalizedCreator=_9fe;},onDropInternal:function(_9ff,copy){var _a00=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _a00.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_9ff,this.before,this.current);this._normalizedCreator=_a00;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_9ec.superclass.onOverEvent.call(this);_9ea.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_9ec.superclass.onOutEvent.call(this);_9ea.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_a01){if(this.current==this.targetAnchor&&this.before==_a01){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_a01;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_9e6.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_9e4.contains(node,"dojoDndHandle")){return true;}if(_9e4.contains(node,"dojoDndItem")||_9e4.contains(node,"dojoDndIgnore")){break;}}return false;}});return _9ec;});},"esri/layers/OnDemandMode":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/geometry/Point","esri/tasks/query","esri/layers/RenderMode","esri/layers/GridLayout"],function(_a02,_a03,lang,_a04,has,_a05,_a06,_a07,_a08,_a09){var _a0a=_a02([_a08],{declaredClass:"esri.layers._OnDemandMode",constructor:function(_a0b){this.featureLayer=_a0b;this._featureMap={};this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},initialize:function(map){this.inherited(arguments);var _a0c=this.featureLayer,_a0d=_a0c._srInfo;this._gridLayer=new _a09(new _a06(_a0d?_a0d.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_a0c._tileWidth,height:_a0c._tileHeight},{width:map.width,height:map.height},_a0d);this._cellMap={};this._gridLayer.setResolution(map.extent);},startup:function(){this._ioQueue=[];if(!this.featureLayer.suspended){this._zoomHandler();this._enableConnectors();}},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this.inherited(arguments);},drawFeature:function(_a0e){var _a0f=this._gridLayer,geom=_a0e.geometry,_a10=[];if(!geom){return;}_a10=_a0f.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _a11=this._cellMap,i,cell,oid=_a0e.attributes[this.featureLayer.objectIdField],_a12,row,col;for(i=0;i<_a10.length;i++){cell=_a10[i];_a12=cell.latticeID;row=cell.row;col=cell.col;if(_a12){cell=(_a11[_a12]=(_a11[_a12]||cell));}else{_a11[row]=_a11[row]||{};cell=(_a11[row][col]=(_a11[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_a0e);this._addFeatureIIf(oid,_a0e);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_enableConnectors:function(){var map=this.map;this._zoomConnect=_a03.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_a03.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=_a03.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){_a03.disconnect(this._zoomConnect);_a03.disconnect(this._panConnect);_a03.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _a13=this.featureLayer,map=this.map;if(_a13.suspended){return;}_a13._fireUpdateStart();this._clearIIf();var _a14=_a13._trackManager;if(_a14){_a14.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_a15,cell){var id="_"+_a15.name+_a15.layerId+_a15._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_a16){this._exceeds=false;var _a17=this.featureLayer,map=this.map,_a18=_a16||map.extent,_a19=this._gridLayer.getCellsInExtent(_a18,_a17.latticeTiling),_a1a=_a19.cells;if(!_a17.isEditable()){var _a1b=this._cellMap;_a1a=_a04.filter(_a1a,function(cell){if(cell.lattice){if(_a1b[cell.latticeID]){return false;}}else{if(_a1b[cell.row]&&_a1b[cell.row][cell.col]){return false;}}return true;});}var _a1c=_a17._getOutFields(),_a1d=_a17.getDefinitionExpression(),time=_a17._getOffsettedTE(_a17._mapTimeExtent),_a1e=_a17._usePatch,_a1f=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_a20,_a21;this._pending=this._pending||0;for(i=0;i<_a1a.length;i++){cell=_a1a[i];_a20=new _a07();_a20.geometry=cell.extent||cell.lattice;_a20.outFields=_a1c;_a20.where=_a1d;if(_a17.latticeTiling&&cell.extent){_a20.spatialRelationship=_a07.SPATIAL_REL_CONTAINS;}_a20.returnGeometry=true;_a20.timeExtent=time;_a20.maxAllowableOffset=_a17._maxOffset;if(_a17._ts){_a20._ts=(new Date()).getTime();}_a21=null;if(_a1e){_a21=this._getRequestId(_a17,cell);if(this._isPending(_a21)){continue;}}this._pending++;_a1f.push(_a17._task.execute(_a20,function(){var _a22=cell;return function(_a23){func.apply(self,[_a23,_a22]);};}.call(this),this._queryErrorHandler,_a21));}this._removeOldCells(_a18);this._endCheck();},_drawFeatures:function(_a24,cell){this._exceeds=this._exceeds||_a24.exceededTransferLimit;this._finalizeIO();var _a25=this.featureLayer,map=this.map,_a26=map.extent,_a27=cell.extent,row=cell.row,col=cell.col,_a28=_a25.objectIdField,_a29=_a24.features,_a2a=this._gridLayer,_a2b=this._cellMap,i,len,_a2c=cell.latticeID,_a2d=_a2c?_a2b[_a2c]:(_a2b[row]&&_a2b[row][col]);if((cell.resolution!=_a2a._resolution)||(_a2c?(_a2c!==_a2a.getLatticeID(_a26)):(!_a2a.intersects(_a27,_a26)))){if(_a2d){this._removeCell(row,col,_a2c);}}else{if(_a2d){this._updateCell(_a2d,_a29);}else{cell.features=_a29;if(_a2c){_a2b[_a2c]=cell;}else{_a2b[row]=_a2b[row]||{};_a2b[row][col]=cell;}len=_a29.length;for(i=0;i<len;i++){var _a2e=_a29[i];var oid=_a2e.attributes[_a28];this._addFeatureIIf(oid,_a2e);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_a2f){if(this._pending===0){this._processIOQueue();var _a30=this.featureLayer,_a31=_a30._trackManager;if(_a31){_a31.clearTracks();_a31.addFeatures(_a30.graphics);if(_a30._ager){_a04.forEach(_a30.graphics,function(_a32){if(_a32._shape){_a30._repaint(_a32);}});}_a31.moveLatestToFront();_a31.drawTracks();}this.featureLayer._fireUpdateEnd(_a2f&&new Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_a30.onQueryLimitExceeded();}}},_processIOQueue:function(_a33){this._ioQueue=_a04.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_a33){_a04.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_a34){var _a35=this._cellMap,_a36=this._gridLayer,_a37,_a38;for(_a37 in _a35){if(_a35[_a37]){var row=_a35[_a37],_a39=row.latticeID,_a3a=0,_a3b=0;if(_a39){_a3a++;if(_a39!==_a36.getLatticeID(_a34)){this._removeCell(null,null,_a39);_a3b++;}}else{for(_a38 in row){if(row[_a38]){_a3a++;var _a3c=row[_a38].extent;if(!_a36.intersects(_a3c,_a34)){this._removeCell(_a37,_a38);_a3b++;}}}}if(_a3b===_a3a){delete _a35[_a37];}}}},_updateCell:function(cell,_a3d){var _a3e=this.featureLayer,_a3f=_a3e.objectIdField,_a40=_a3e._selectedFeatures,i,len=_a3d.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _a41=_a3d[i];var oid=_a41.attributes[_a3f];var _a42=this._addFeatureIIf(oid,_a41);if(_a42===_a41){this._incRefCount(oid);cell.features.push(_a42);}else{if(!(oid in _a40)){_a42.setGeometry(_a41.geometry);_a42.setAttributes(_a41.attributes);}}}},_removeCell:function(row,col,_a43){var _a44=this._cellMap,_a45=this.featureLayer,_a46=_a45.objectIdField;var cell=_a43?_a44[_a43]:(_a44[row]&&_a44[row][col]);if(cell){if(_a43){delete _a44[_a43];}else{delete _a44[row][col];}var _a47=cell.features,i;for(i=0;i<_a47.length;i++){var _a48=_a47[i];var oid=_a48.attributes[_a46];this._decRefCount(oid);if(oid in _a45._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});if(has("extend-esri")){lang.setObject("layers._OnDemandMode",_a0a,_a05);}return _a0a;});},"dijit/popup":function(){define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","./place","./BackgroundIframe","./main"],function(_a49,_a4a,_a4b,_a4c,dom,_a4d,_a4e,_a4f,_a50,_a51,keys,lang,on,has,_a52,_a53,_a54){function _a55(){if(this._popupWrapper){_a4e.destroy(this._popupWrapper);delete this._popupWrapper;}};var _a56=_a4c(null,{_stack:[],_beginZIndex:1000,_idGen:1,_createWrapper:function(_a57){var _a58=_a57._popupWrapper,node=_a57.domNode;if(!_a58){_a58=_a4e.create("div",{"class":"dijitPopup",style:{display:"none"},role:"presentation"},_a57.ownerDocumentBody);_a58.appendChild(node);var s=node.style;s.display="";s.visibility="";s.position="";s.top="0px";_a57._popupWrapper=_a58;_a4a.after(_a57,"destroy",_a55,true);}return _a58;},moveOffScreen:function(_a59){var _a5a=this._createWrapper(_a59);_a50.set(_a5a,{visibility:"hidden",top:"-9999px",display:""});},hide:function(_a5b){var _a5c=this._createWrapper(_a5b);_a50.set(_a5c,"display","none");},getTopPopup:function(){var _a5d=this._stack;for(var pi=_a5d.length-1;pi>0&&_a5d[pi].parent===_a5d[pi-1].widget;pi--){}return _a5d[pi];},open:function(args){var _a5e=this._stack,_a5f=args.popup,_a60=args.orient||["below","below-alt","above","above-alt"],ltr=args.parent?args.parent.isLeftToRight():_a4f.isBodyLtr(_a5f.ownerDocument),_a61=args.around,id=(args.around&&args.around.id)?(args.around.id+"_dropdown"):("popup_"+this._idGen++);while(_a5e.length&&(!args.parent||!dom.isDescendant(args.parent.domNode,_a5e[_a5e.length-1].widget.domNode))){this.close(_a5e[_a5e.length-1].widget);}var _a62=this._createWrapper(_a5f);_a4d.set(_a62,{id:id,style:{zIndex:this._beginZIndex+_a5e.length},"class":"dijitPopup "+(_a5f.baseClass||_a5f["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:args.parent?args.parent.id:""});if(has("ie")||has("mozilla")){if(!_a5f.bgIframe){_a5f.bgIframe=new _a53(_a62);}}var best=_a61?_a52.around(_a62,_a61,_a60,ltr,_a5f.orient?lang.hitch(_a5f,"orient"):null):_a52.at(_a62,args,_a60=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],args.padding);_a62.style.display="";_a62.style.visibility="visible";_a5f.domNode.style.visibility="visible";var _a63=[];_a63.push(on(_a62,_a4b._keypress,lang.hitch(this,function(evt){if(evt.charOrCode==keys.ESCAPE&&args.onCancel){_a51.stop(evt);args.onCancel();}else{if(evt.charOrCode===keys.TAB){_a51.stop(evt);var _a64=this.getTopPopup();if(_a64&&_a64.onCancel){_a64.onCancel();}}}})));if(_a5f.onCancel&&args.onCancel){_a63.push(_a5f.on("cancel",args.onCancel));}_a63.push(_a5f.on(_a5f.onExecute?"execute":"change",lang.hitch(this,function(){var _a65=this.getTopPopup();if(_a65&&_a65.onExecute){_a65.onExecute();}})));_a5e.push({widget:_a5f,parent:args.parent,onExecute:args.onExecute,onCancel:args.onCancel,onClose:args.onClose,handlers:_a63});if(_a5f.onOpen){_a5f.onOpen(best);}return best;},close:function(_a66){var _a67=this._stack;while((_a66&&_a49.some(_a67,function(elem){return elem.widget==_a66;}))||(!_a66&&_a67.length)){var top=_a67.pop(),_a68=top.widget,_a69=top.onClose;if(_a68.onClose){_a68.onClose();}var h;while(h=top.handlers.pop()){h.remove();}if(_a68&&_a68.domNode){this.hide(_a68);}if(_a69){_a69();}}}});return (_a54.popup=new _a56());});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_a6a,lang,_a6b,_a6c,_a6d,has,dom,_a6e,_a6f,_a70,util){var _a71=_a6a("dojox.grid._DeferredTextWidget",_a70,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _a72=function(_a73){try{util.fire(_a73,"focus");util.fire(_a73,"select");}catch(e){}};var _a74=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _a75=_a6a("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_a76){this._props=_a76||{};lang.mixin(this,_a76);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_a77,_a78){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_a77!=this.defaultValue&&f)?f.apply(s,_a78):_a77;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _a71({deferred:v},_a6f.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_a79,_a7a){var f,i=this.grid.edit.info,d=this.get?this.get(_a79,_a7a):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_a79&&i.cell==this))){return this.formatEditing(d,_a79);}else{return this._defaultFormat(d,[d,_a79,this]);}},formatEditing:function(_a7b,_a7c){},getNode:function(_a7d){return this.view.getCellNode(_a7d,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_a7e){return (this.getNode(_a7e)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_a7f,_a80){if(this.getNode(_a80)){this.grid.edit.applyCellEdit(_a7f,this,_a80);}},cancelEdit:function(_a81){this.grid.doCancelEdit(_a81);},_onEditBlur:function(_a82){if(this.grid.edit.isEditCell(_a82,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_a83,_a84){if(this.commitOnBlur){_a6c.connect(_a83,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_a84),250);});}},needFormatNode:function(_a85,_a86){this._formatPending=true;_a74(this,"_formatNode",_a85,_a86);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_a87,_a88){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_a88),_a87,_a88);}},formatNode:function(_a89,_a8a,_a8b){if(has("ie")){_a74(this,"focus",_a8b,_a89);}else{this.focus(_a8b,_a89);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_a8c){return this.getEditNode(_a8c)[this._valueProp];},setValue:function(_a8d,_a8e){var n=this.getEditNode(_a8d);if(n){n[this._valueProp]=_a8e;}},focus:function(_a8f,_a90){_a72(_a90||this.getEditNode(_a8f));},save:function(_a91){this.value=this.value||this.getValue(_a91);},restore:function(_a92){this.setValue(_a92,this.value);},_finish:function(_a93){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_a94){this.applyEdit(this.getValue(_a94),_a94);this._finish(_a94);},cancel:function(_a95){this.cancelEdit(_a95);this._finish(_a95);}});_a75.markupFactory=function(node,_a96){var _a97=lang.trim(_a6e.get(node,"formatter")||"");if(_a97){_a96.formatter=lang.getObject(_a97)||_a97;}var get=lang.trim(_a6e.get(node,"get")||"");if(get){_a96.get=lang.getObject(get);}var _a98=function(attr,cell,_a99){var _a9a=lang.trim(_a6e.get(node,attr)||"");if(_a9a){cell[_a99||attr]=!(_a9a.toLowerCase()=="false");}};_a98("sortDesc",_a96);_a98("editable",_a96);_a98("alwaysEditing",_a96);_a98("noresize",_a96);_a98("draggable",_a96);var _a9b=lang.trim(_a6e.get(node,"loadingText")||_a6e.get(node,"defaultValue")||"");if(_a9b){_a96.defaultValue=_a9b;}var _a9c=function(attr,cell,_a9d){var _a9e=lang.trim(_a6e.get(node,attr)||"")||undefined;if(_a9e){cell[_a9d||attr]=_a9e;}};_a9c("styles",_a96);_a9c("headerStyles",_a96);_a9c("cellStyles",_a96);_a9c("classes",_a96);_a9c("headerClasses",_a96);_a9c("cellClasses",_a96);};var Cell=_a6a("dojox.grid.cells.Cell",_a75,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_a9f,_aa0){this.needFormatNode(_a9f,_aa0);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_a9f+"\">";},formatNode:function(_aa1,_aa2,_aa3){this.inherited(arguments);this.registerOnBlur(_aa1,_aa3);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_a6b.stop(e);}}},_finish:function(_aa4){this.inherited(arguments);var n=this.getEditNode(_aa4);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_aa5){_a75.markupFactory(node,_aa5);var _aa6=lang.trim(_a6e.get(node,"keyFilter")||"");if(_aa6){_aa5.keyFilter=new RegExp(_aa6);}};var _aa7=_a6a("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_aa8){return _aa8+1;}});_aa7.markupFactory=function(node,_aa9){Cell.markupFactory(node,_aa9);};var _aaa=_a6a("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_aab){this.values=this.values||this.options;},formatEditing:function(_aac,_aad){this.needFormatNode(_aac,_aad);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_aac==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_aae,_aaf){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_a6d.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_ab0){var n=this.getEditNode(_ab0);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_aaa.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _ab1=lang.trim(_a6e.get(node,"options")||"");if(_ab1){var o=_ab1.split(",");if(o[0]!=_ab1){cell.options=o;}}var _ab2=lang.trim(_a6e.get(node,"values")||"");if(_ab2){var v=_ab2.split(",");if(v[0]!=_ab2){cell.values=v;}}};var _ab3=_a6a("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_ab4,_ab5){this.formatNode(this.getEditNode(_ab5),_ab4,_ab5);},applyStaticValue:function(_ab6){var e=this.grid.edit;e.applyCellEdit(this.getValue(_ab6),this,_ab6);e.start(this,_ab6,true);}});_ab3.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_a6a("dojox.grid.cells.Bool",_ab3,{_valueProp:"checked",formatEditing:function(_ab7,_ab8){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_ab7?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_ab3.markupFactory(node,cell);};return _a75;});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/Color","dojo/has","esri/kernel","esri/lang","esri/sniff","esri/toolbars/_toolbar","esri/toolbars/_Box","esri/toolbars/_GraphicMover","esri/toolbars/_VertexEditor","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"],function(_ab9,lang,_aba,_abb,_abc,has,_abd,_abe,_abf,_ac0,Box,_ac1,_ac2,_ac3,_ac4){var EDT=_ab9(_ac0,{declaredClass:"esri.toolbars.Edit",constructor:function(map,_ac5){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _ac6=has("esri-touch")||has("esri-pointer");this._defaultOptions=lang.mixin({vertexSymbol:new _ac3(_ac3.STYLE_CIRCLE,_ac6?20:12,new _ac4(_ac4.STYLE_SOLID,new _abc([0,0,0,0.5]),1),new _abc([128,128,128])),ghostVertexSymbol:new _ac3(_ac3.STYLE_CIRCLE,_ac6?18:10,new _ac4(_ac4.STYLE_SOLID,new _abc([0,0,0,0.5]),1),new _abc([255,255,255,0.75])),ghostLineSymbol:new _ac4(_ac4.STYLE_DOT,new _abc([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_ac6?24:16,boxLineSymbol:new _ac4(_ac4.STYLE_DASH,new _abc([64,64,64]),1),boxHandleSymbol:new _ac3(_ac3.STYLE_SQUARE,_ac6?16:9,new _ac4(_ac4.STYLE_SOLID,new _abc([0,0,0,0.5]),1),new _abc([255,255,255,0.75]))},_ac5||{});},activate:function(tool,_ac7,_ac8){this.deactivate();this._graphic=_ac7;this._options=lang.mixin(lang.mixin({},this._defaultOptions),_ac8||{});var MOVE=EDT.MOVE,EDIT=EDT.EDIT_VERTICES,_ac9=EDT.SCALE,_aca=EDT.ROTATE,move=false,edit=false,box=false,map=this._map,_acb=map.spatialReference,_acc=_ac7.geometry.spatialReference;this._geo=!!(_acb&&_acc&&!_acb.equals(_acc)&&_acb.isWebMercator()&&_acc.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_ac7);}var _acd=((tool&_ac9)===_ac9),_ace=((tool&_aca)===_aca);if(_acd||_ace){box=this._enableBoxEditing(_ac7,_acd,_ace);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_ac7);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");}this._tool=tool;if(this._tool){this._mapPanEndHandle=_aba.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=_aba.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_ac7);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_acf=this._graphic;if(!tool){return;}var _ad0=!!this._modified;this._clear();_aba.disconnect(this._mapPanEndHandle);_aba.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_acf,{isModified:_ad0});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_ad1){},onDeactivate:function(tool,_ad2,info){},onGraphicMoveStart:function(_ad3){},onGraphicFirstMove:function(_ad4){this._modified=true;},onGraphicMove:function(_ad5,_ad6){},onGraphicMoveStop:function(_ad7,_ad8){},onGraphicClick:function(_ad9,info){},onVertexMoveStart:function(_ada,_adb){},onVertexFirstMove:function(_adc,_add){this._modified=true;},onVertexMove:function(_ade,_adf,_ae0){},onVertexMoveStop:function(_ae1,_ae2,_ae3){},onVertexAdd:function(_ae4,_ae5){this._modified=true;},onVertexClick:function(_ae6,_ae7){},onVertexMouseOver:function(_ae8,_ae9){},onVertexMouseOut:function(_aea,_aeb){},onVertexDelete:function(_aec,_aed){this._modified=true;},onScaleStart:function(_aee){},onScaleFirstMove:function(_aef){this._modified=true;},onScale:function(_af0,info){},onScaleStop:function(_af1,info){},onRotateStart:function(_af2){},onRotateFirstMove:function(_af3){this._modified=true;},onRotate:function(_af4,info){},onRotateStop:function(_af5,info){},_enableMove:function(_af6){var map=this._map,type=_af6.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new _ac1(_af6,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_af7){var map=this._map,type=_af7.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=_ac2.create(_af7,map,this);return true;}return false;},_enableBoxEditing:function(_af8,_af9,_afa){var map=this._map,type=_af8.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new Box(_af8,map,this,_af9,_afa,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _afb=this._graphicMover;if(_afb){_afb.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _afc=this._vertexEditor;if(_afc){_afc.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_afd){if(_afd){this._refreshMoveables();}},_refreshMoveables:function(_afe){var _aff=_abb.filter([this._graphicMover,this._vertexEditor,this._boxEditor],_abe.isDefined);_abb.forEach(_aff,function(mov){mov.refresh(_afe);});},_beginOperation:function(_b00){_abb.forEach(this._getAffectedTools(_b00),function(tool){tool.suspend();});},_endOperation:function(_b01){_abb.forEach(this._getAffectedTools(_b01),function(tool){tool.resume();});},_getAffectedTools:function(_b02){var _b03=[];switch(_b02){case "MOVE":_b03=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_b03=[this._boxEditor];break;case "BOX":_b03=[this._vertexEditor];break;}_b03=_abb.filter(_b03,_abe.isDefined);return _b03;}});lang.mixin(EDT,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});if(has("extend-esri")){lang.setObject("toolbars.Edit",EDT,_abd);}return EDT;});},"esri/toolbars/_VertexMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/has","dojo/sniff","dojo/dom-style","dojox/gfx/Moveable","esri/kernel","esri/geometry/Point","esri/graphic","esri/geometry/webMercatorUtils"],function(_b04,lang,_b05,has,_b06,_b07,_b08,_b09,_b0a,_b0b,_b0c){var VM=_b04(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(_b0d,_b0e,_b0f,_b10,_b11,_b12,_b13,_b14){this.point=_b0d;this.symbol=_b0e;this.relatedGraphic=_b0f;this.segIndex=_b10;this.ptIndex=_b11;this.segLength=_b12;this.editor=_b13;this.map=_b13.map;this._scratchGL=_b13.toolbar._scratchGL;this._placeholder=_b14||false;this._type=_b0f.geometry.type;this._init();this._enable();},refresh:function(_b15){if(_b15||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _b16=new _b0a(this.point.toJson());var _b17=new _b0b(_b16,this.symbol);switch(this._type){case "multipoint":_b17._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_b17);break;}this.graphic=_b17;},_enable:function(){var _b18=this.graphic.getDojoShape();if(_b18){_b18._hasMover=true;this._moveable=this._getMoveable(_b18);var node=_b18.getEventSource();if(node){_b07.set(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _b19=this._moveable;if(_b19){_b05.disconnect(this._startHandle);_b05.disconnect(this._firstHandle);_b05.disconnect(this._movingHandle);_b05.disconnect(this._stopHandle);var _b1a=_b19.shape;if(_b1a){var node=_b1a.getEventSource();if(node){_b07.set(node,"cursor",null);}}_b19.destroy();this._moveable=null;}},_needRefresh:function(){var _b1b=this.graphic.getDojoShape(),need=false;if(_b1b){switch(this._type){case "multipoint":var _b1c=this.relatedGraphic.getDojoShape();if(_b1c){var _b1d=_b1c.children[this.ptIndex];if(_b1b!==_b1d){_b1b=_b1d;this.graphic._shape=_b1b;need=true;}}break;case "polyline":case "polygon":need=!_b1b._hasMover;break;}}return need;},_getMoveable:function(_b1e){var _b1f=new _b08(_b1e,_b06("mac")&&_b06("ff")&&!has("esri-touch")&&{leftButtonOnly:true});this._startHandle=_b05.connect(_b1f,"onMoveStart",this,this._moveStartHandler);this._firstHandle=_b05.connect(_b1f,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_b05.connect(_b1f,"onMoving",this,this._movingHandler);this._stopHandle=_b05.connect(_b1f,"onMoveStop",this,this._moveStopHandler);return _b1f;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_b20){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_b20.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_b21){var _b22=_b21.shape;var _b23=this._getControlEdges();var _b24=this._scratchGL._div;var i,_b25=[],_b26=_b21.host.shape._wrapOffsets[0]||0;for(i=0;i<_b23.length;i++){var edge=_b23[i];edge.x1+=_b26;edge.x2+=_b26;_b25.push([_b24.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_b22._lines=_b25;_b21.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_b27){var _b28=_b27.shape,tx=_b28.getTransform();var i,_b29=_b28._lines;for(i=0;i<_b29.length;i++){var line=_b29[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_b2a){var _b2b=_b2a.shape,_b2c=this.editor.toolbar,tx=_b2b.getTransform(),map=this.map,host=this.graphic,_b2d=_b2c._geo?_b0c.geographicToWebMercator(host.geometry):host.geometry;var i,_b2e=_b2b._lines;if(_b2e){for(i=0;i<_b2e.length;i++){_b2e[i][0].removeShape();}_b2b._lines=null;}var ph=false,_b2f=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_b2f=false;}var _b30;if(map.snappingManager){_b30=map.snappingManager._snappingPoint;}var _b31=_b30||map.toMap(map.toScreen(_b2d).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_b2b.setTransform(null);host.setGeometry(_b2c._geo?_b0c.webMercatorToGeographic(_b31,true):_b31);this.constructor.onMoveStop(this,tx);_b2c.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_b2f){_b2c.onVertexClick(this.relatedGraphic,info);}if(ph){_b2c.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _b32=this.relatedGraphic.geometry;var _b33=this.segIndex,_b34=this.ptIndex,_b35=this.segLength;var _b36=this._scratchGL._div;var _b37=_b36.getTransform();var sdx=_b37.dx,sdy=_b37.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _b38=[];var _b39=this.editor._getControlPoints(this,_b32,_b33,_b34,_b35);if(_b39[0]){_b38.push({x1:x,y1:y,x2:_b39[0].x-sdx,y2:_b39[0].y-sdy});}if(_b39[1]){_b38.push({x1:x,y1:y,x2:_b39[1].x-sdx,y2:_b39[1].y-sdy});}return _b38;}});if(has("extend-esri")){lang.setObject("toolbars.VertexMover",VM,_b09);}lang.mixin(VM,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return VM;});},"dijit/_WidgetBase":function(){define("dijit/_WidgetBase",["require","dojo/_base/array","dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/ready","dojo/Stateful","dojo/topic","dojo/_base/window","./Destroyable","./registry"],function(_b3a,_b3b,_b3c,_b3d,_b3e,_b3f,dom,_b40,_b41,_b42,_b43,_b44,has,_b45,lang,on,_b46,_b47,_b48,win,_b49,_b4a){has.add("dijit-legacy-requires",!_b45.isAsync);if(has("dijit-legacy-requires")){_b46(0,function(){var _b4b=["dijit/_base/manager"];_b3a(_b4b);});}var _b4c={};function _b4d(obj){var ret={};for(var attr in obj){ret[attr.toLowerCase()]=true;}return ret;};function _b4e(attr){return function(val){_b40[val?"set":"remove"](this.domNode,attr,val);this._set(attr,val);};};return _b3f("dijit._WidgetBase",[_b47,_b49],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:_b4e("lang"),dir:"",_setDirAttr:_b4e("dir"),textDir:"","class":"",_setClassAttr:{node:"domNode",type:"class"},style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(val){this._set("ownerDocument",val);},attributeMap:{},_blankGif:_b3d.blankGif||_b3a.toUrl("dojo/resources/blank.gif"),postscript:function(_b4f,_b50){this.create(_b4f,_b50);},create:function(_b51,_b52){this.srcNodeRef=dom.byId(_b52);this._connects=[];this._supportingWidgets=[];if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_b51){this.params=_b51;lang.mixin(this,_b51);}this.postMixInProperties();if(!this.id){this.id=_b4a.getUniqueId(this.declaredClass.replace(/\./g,"_"));if(this.params){delete this.params.id;}}this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:win.doc);this.ownerDocumentBody=win.body(this.ownerDocument);_b4a.add(this);this.buildRendering();var _b53;if(this.domNode){this._applyAttributes();var _b54=this.srcNodeRef;if(_b54&&_b54.parentNode&&this.domNode!==_b54){_b54.parentNode.replaceChild(this.domNode,_b54);_b53=true;}this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(_b53){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var ctor=this.constructor,list=ctor._setterAttrs;if(!list){list=(ctor._setterAttrs=[]);for(var attr in this.attributeMap){list.push(attr);}var _b55=ctor.prototype;for(var _b56 in _b55){if(_b56 in this.attributeMap){continue;}var _b57="_set"+_b56.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();})+"Attr";if(_b57 in _b55){list.push(_b56);}}}var _b58={};for(var key in this.params||{}){_b58[key]=this[key];}_b3b.forEach(list,function(attr){if(attr in _b58){}else{if(this[attr]){this.set(attr,this[attr]);}}},this);for(key in _b58){this.set(key,_b58[key]);}},postMixInProperties:function(){},buildRendering:function(){if(!this.domNode){this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div");}if(this.baseClass){var _b59=this.baseClass.split(" ");if(!this.isLeftToRight()){_b59=_b59.concat(_b3b.map(_b59,function(name){return name+"Rtl";}));}_b41.add(this.domNode,_b59);}},postCreate:function(){},startup:function(){if(this._started){return;}this._started=true;_b3b.forEach(this.getChildren(),function(obj){if(!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)){obj.startup();obj._started=true;}});},destroyRecursive:function(_b5a){this._beingDestroyed=true;this.destroyDescendants(_b5a);this.destroy(_b5a);},destroy:function(_b5b){this._beingDestroyed=true;this.uninitialize();function _b5c(w){if(w.destroyRecursive){w.destroyRecursive(_b5b);}else{if(w.destroy){w.destroy(_b5b);}}};_b3b.forEach(this._connects,lang.hitch(this,"disconnect"));_b3b.forEach(this._supportingWidgets,_b5c);if(this.domNode){_b3b.forEach(_b4a.findWidgets(this.domNode,this.containerNode),_b5c);}this.destroyRendering(_b5b);_b4a.remove(this.id);this._destroyed=true;},destroyRendering:function(_b5d){if(this.bgIframe){this.bgIframe.destroy(_b5d);delete this.bgIframe;}if(this.domNode){if(_b5d){_b40.remove(this.domNode,"widgetId");}else{_b42.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_b5d){_b42.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_b5e){_b3b.forEach(this.getChildren(),function(_b5f){if(_b5f.destroyRecursive){_b5f.destroyRecursive(_b5e);}});},uninitialize:function(){return false;},_setStyleAttr:function(_b60){var _b61=this.domNode;if(lang.isObject(_b60)){_b44.set(_b61,_b60);}else{if(_b61.style.cssText){_b61.style.cssText+="; "+_b60;}else{_b61.style.cssText=_b60;}}this._set("style",_b60);},_attrToDom:function(attr,_b62,_b63){_b63=arguments.length>=3?_b63:this.attributeMap[attr];_b3b.forEach(lang.isArray(_b63)?_b63:[_b63],function(_b64){var _b65=this[_b64.node||_b64||"domNode"];var type=_b64.type||"attribute";switch(type){case "attribute":if(lang.isFunction(_b62)){_b62=lang.hitch(this,_b62);}var _b66=_b64.attribute?_b64.attribute:(/^on[A-Z][a-zA-Z]*$/.test(attr)?attr.toLowerCase():attr);if(_b65.tagName){_b40.set(_b65,_b66,_b62);}else{_b65.set(_b66,_b62);}break;case "innerText":_b65.innerHTML="";_b65.appendChild(this.ownerDocument.createTextNode(_b62));break;case "innerHTML":_b65.innerHTML=_b62;break;case "class":_b41.replace(_b65,_b62,this[attr]);break;}},this);},get:function(name){var _b67=this._getAttrNames(name);return this[_b67.g]?this[_b67.g]():this[name];},set:function(name,_b68){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _b69=this._getAttrNames(name),_b6a=this[_b69.s];if(lang.isFunction(_b6a)){var _b6b=_b6a.apply(this,Array.prototype.slice.call(arguments,1));}else{var _b6c=this.focusNode&&!lang.isFunction(this.focusNode)?"focusNode":"domNode",_b6d,map,tag;tag=this[_b6c]&&this[_b6c].tagName;if(tag){_b6d=_b4c[tag]||(_b4c[tag]=_b4d(this[_b6c]));}map=name in this.attributeMap?this.attributeMap[name]:_b69.s in this?this[_b69.s]:((_b6d&&_b69.l in _b6d&&typeof _b68!="function")||/^aria-|^data-|^role$/.test(name))?_b6c:null;if(map!=null){this._attrToDom(name,_b68,map);}this._set(name,_b68);}return _b6b||this;},_attrPairNames:{},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.replace(/^[a-z]|-[a-zA-Z]/g,function(c){return c.charAt(c.length-1).toUpperCase();});return (apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr",l:uc.toLowerCase()});},_set:function(name,_b6e){var _b6f=this[name];this[name]=_b6e;if(this._created&&_b6e!==_b6f){if(this._watchCallbacks){this._watchCallbacks(name,_b6f,_b6e);}this.emit("attrmodified-"+name,{detail:{prevValue:_b6f,newValue:_b6e}});}},emit:function(type,_b70,_b71){_b70=_b70||{};if(_b70.bubbles===undefined){_b70.bubbles=true;}if(_b70.cancelable===undefined){_b70.cancelable=true;}if(!_b70.detail){_b70.detail={};}_b70.detail.widget=this;var ret,_b72=this["on"+type];if(_b72){ret=_b72.apply(this,_b71?_b71:[_b70]);}if(this._started&&!this._beingDestroyed){on.emit(this.domNode,type.toLowerCase(),_b70);}return ret;},on:function(type,func){var _b73=this._onMap(type);if(_b73){return _b3c.after(this,_b73,func,true);}return this.own(on(this.domNode,type,func))[0];},_onMap:function(type){var ctor=this.constructor,map=ctor._onMap;if(!map){map=(ctor._onMap={});for(var attr in ctor.prototype){if(/^on/.test(attr)){map[attr.replace(/^on/,"").toLowerCase()]=attr;}}}return map[typeof type=="string"&&type.toLowerCase()];},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getChildren:function(){return this.containerNode?_b4a.findWidgets(this.containerNode):[];},getParent:function(){return _b4a.getEnclosingWidget(this.domNode.parentNode);},connect:function(obj,_b74,_b75){return this.own(_b3e.connect(obj,_b74,this,_b75))[0];},disconnect:function(_b76){_b76.remove();},subscribe:function(t,_b77){return this.own(_b48.subscribe(t,lang.hitch(this,_b77)))[0];},unsubscribe:function(_b78){_b78.remove();},isLeftToRight:function(){return this.dir?(this.dir=="ltr"):_b43.isBodyLtr(this.ownerDocument);},isFocusable:function(){return this.focus&&(_b44.get(this.domNode,"display")!="none");},placeAt:function(_b79,_b7a){var _b7b=!_b79.tagName&&_b4a.byId(_b79);if(_b7b&&_b7b.addChild&&(!_b7a||typeof _b7a==="number")){_b7b.addChild(this,_b7a);}else{var ref=_b7b?(_b7b.containerNode&&!/after|before|replace/.test(_b7a||"")?_b7b.containerNode:_b7b.domNode):dom.byId(_b79,this.ownerDocument);_b42.place(this.domNode,ref,_b7a);if(!this._started&&(this.getParent()||{})._started){this.startup();}}return this;},getTextDir:function(text,_b7c){return _b7c;},applyTextDir:function(){},defer:function(fcn,_b7d){var _b7e=setTimeout(lang.hitch(this,function(){_b7e=null;if(!this._destroyed){lang.hitch(this,fcn)();}}),_b7d||0);return {remove:function(){if(_b7e){clearTimeout(_b7e);_b7e=null;}return null;}};}});});},"dojo/dnd/Moveable":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../dom","../dom-class","../Evented","../on","../topic","../touch","./common","./Mover","../_base/window"],function(_b7f,_b80,_b81,lang,dom,_b82,_b83,on,_b84,_b85,dnd,_b86,win){var _b87=_b80("dojo.dnd.Moveable",[_b83],{handle:"",delay:0,skip:false,constructor:function(node,_b88){this.node=dom.byId(node);if(!_b88){_b88={};}this.handle=_b88.handle?dom.byId(_b88.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_b88.delay>0?_b88.delay:0;this.skip=_b88.skip;this.mover=_b88.mover?_b88.mover:_b86;this.events=[on(this.handle,_b85.press,lang.hitch(this,"onMouseDown")),on(this.handle,"dragstart",lang.hitch(this,"onSelectStart")),on(this.handle,"selectstart",lang.hitch(this,"onSelectStart"))];},markupFactory:function(_b89,node,Ctor){return new Ctor(node,_b89);},destroy:function(){_b7f.forEach(this.events,function(_b8a){_b8a.remove();});this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dnd.isFormElement(e)){return;}if(this.delay){this.events.push(on(this.handle,_b85.move,lang.hitch(this,"onMouseMove")),on(this.handle,_b85.release,lang.hitch(this,"onMouseUp")));this._lastX=e.pageX;this._lastY=e.pageY;}else{this.onDragDetected(e);}_b81.stop(e);},onMouseMove:function(e){if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}_b81.stop(e);},onMouseUp:function(e){for(var i=0;i<2;++i){this.events.pop().remove();}_b81.stop(e);},onSelectStart:function(e){if(!this.skip||!dnd.isFormElement(e)){_b81.stop(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_b8b){_b84.publish("/dnd/move/start",_b8b);_b82.add(win.body(),"dojoMove");_b82.add(this.node,"dojoMoveItem");},onMoveStop:function(_b8c){_b84.publish("/dnd/move/stop",_b8c);_b82.remove(win.body(),"dojoMove");_b82.remove(this.node,"dojoMoveItem");},onFirstMove:function(){},onMove:function(_b8d,_b8e){this.onMoving(_b8d,_b8e);var s=_b8d.node.style;s.left=_b8e.l+"px";s.top=_b8e.t+"px";this.onMoved(_b8d,_b8e);},onMoving:function(){},onMoved:function(){}});return _b87;});},"esri/toolbars/_VertexEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dijit/Menu","dijit/MenuItem","esri/kernel","esri/toolbars/_VertexMover","esri/geometry/Point","esri/geometry/jsonUtils","dojo/i18n!esri/nls/jsapi"],function(_b8f,lang,_b90,_b91,has,Menu,_b92,_b93,_b94,_b95,_b96,_b97){var GVE=_b8f(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(_b98,map,_b99){this.graphic=_b98;this.map=map;this.toolbar=_b99;var _b9a=_b99._options;this._symbol1=_b9a.vertexSymbol;this._symbol2=_b9a.ghostVertexSymbol;var _b9b=_b9a.ghostLineSymbol;this._lineStroke={style:_b9b.style,width:_b9b.width,color:_b9b.color};this._canDel=_b9a.allowDeleteVertices;this._canAdd=_b9a.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_b9c){if(_b9c){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_b90.connect(_b94,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_b90.connect(_b94,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _b9d=this._getGraphicsLayer();this._mouseOverHandle=_b90.connect(_b9d,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_b90.connect(_b9d,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _b9e=(this._ctxDelete=new _b92({label:_b97.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_b90.connect(_b9e,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_b9e);this._ctxMenu.startup();}},_removeControllers:function(){_b90.disconnect(this._firstMoveHandle);_b90.disconnect(this._moveStopHandle);_b90.disconnect(this._mouseOverHandle);_b90.disconnect(this._mouseOutHandle);_b90.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_b9f,_ba0,_ba1){var i,j,_ba2=this.graphic,_ba3=[];for(i=0;i<_b9f.length;i++){var _ba4=_b9f[i],_ba5=[];for(j=0;j<_ba4.length;j++){_ba5.push(new _b94(_ba4[j],_ba0,_ba2,i,j,_ba4.length,this,_ba1));}_ba3.push(_ba5);}return _ba3;},_remove:function(_ba6){if(_ba6){_b91.forEach(_ba6,function(_ba7){_b91.forEach(_ba7,function(_ba8){_ba8.destroy();});});}},_refresh:function(_ba9){if(_ba9){_b91.forEach(_ba9,function(_baa){_b91.forEach(_baa,function(_bab){_bab.refresh();});});}},_isNew:function(_bac){return (_b91.indexOf(this._vertexMovers[_bac.segIndex],_bac)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _bad=this._selectedMover,_bae=_bad.ptIndex;this._updateRelatedGraphic(_bad,_bad.relatedGraphic,_bad.graphic.geometry,_bad.segIndex,_bad.ptIndex,_bad.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_bad);}this._deleteVertex(_bad);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _baf=evt.graphic,_bb0=this._findMover(_baf);if(_bb0){this.toolbar.onVertexMouseOver(this.graphic,_bb0._getInfo());if(!_bb0._placeholder){this._selectedMover=_bb0;if(this._canDel){this._bindCtxNode(_baf.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _bb1=evt.graphic,_bb2=this._findMover(_bb1);if(_bb2){this.toolbar.onVertexMouseOut(this.graphic,_bb2._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_bb3){var i,_bb4=[],_bb5=this._mpVertexMovers;_b91.forEach(this._vertexMovers,function(_bb6){_bb4=_bb4.concat(_bb6);});if(_bb5){_b91.forEach(_bb5,function(_bb7){_bb4=_bb4.concat(_bb7);});}for(i=0;i<_bb4.length;i++){var _bb8=_bb4[i];if(_bb8.graphic===_bb3){return _bb8;}}},_firstMoveHandler:function(_bb9){if(!this._isNew(_bb9)&&this._canAdd){this._hideRelatedMidpoints(_bb9);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_bba,tx){var add=this._isNew(_bba);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_bba);}return;}this._updateRelatedGraphic(_bba,_bba.relatedGraphic,_bba.graphic.geometry,_bba.segIndex,_bba.ptIndex,_bba.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_bba);}else{this._repositionRelatedMidpoints(_bba);this._showRelatedMidpoints(_bba);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_bbb){var i,_bbc=this._getAdjacentMidpoints(_bbb.ptIndex,_bbb.segLength),_bbd=this._mpVertexMovers[_bbb.segIndex];for(i=0;i<_bbc.length;i++){var mvr=_bbd[_bbc[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_bbe){var i,_bbf=this._getAdjacentMidpoints(_bbe.ptIndex,_bbe.segLength),_bc0=this._mpVertexMovers[_bbe.segIndex];for(i=0;i<_bbf.length;i++){_bc0[_bbf[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_bc1){var i,_bc2=this._getAdjacentMidpoints(_bc1.ptIndex,_bc1.segLength),_bc3=this._mpVertexMovers[_bc1.segIndex];for(i=0;i<_bc2.length;i++){var _bc4=this._getAdjacentVertices(_bc2[i],_bc1.segLength);var _bc5=_bc1.relatedGraphic.geometry.getPoint(_bc1.segIndex,_bc4[0]),_bc6=_bc1.relatedGraphic.geometry.getPoint(_bc1.segIndex,_bc4[1]);var _bc7=new _b95({x:(_bc5.x+_bc6.x)/2,y:(_bc5.y+_bc6.y)/2,spatialReference:_bc5.spatialReference.toJson()});_bc3[_bc2[i]].graphic.setGeometry(_bc7);}},_addMidpoints:function(_bc8){var _bc9=_bc8.segIndex,_bca=_bc8.ptIndex,_bcb=_bc8.segLength;var _bcc=_bca+1;var i,_bcd=_bcb+1;this._mpVertexMovers[_bc9].splice(_bca,1);var _bce=this._vertexMovers[_bc9];for(i=0;i<_bcc;i++){_bce[i].segLength+=1;}for(i=_bcc;i<_bce.length;i++){_bce[i].ptIndex+=1;_bce[i].segLength+=1;}_bc8.ptIndex=_bcc;_bc8.segLength=_bce.length+1;_bce.splice(_bcc,0,_bc8);_bc8.graphic.setSymbol(this._symbol1);_bce=this._mpVertexMovers[_bc9];for(i=0;i<_bca;i++){_bce[i].segLength+=1;}for(i=_bca;i<_bcb-1;i++){_bce[i].ptIndex+=1;_bce[i].segLength+=1;}var _bcf=this._getAdjacentVertices(_bca,_bcd);var _bd0=this._getAdjacentVertices(_bca+1,_bcd);var _bd1,_bd2;_bd1=_bc8.relatedGraphic.geometry.getPoint(_bc8.segIndex,_bcf[0]);_bd2=_bc8.relatedGraphic.geometry.getPoint(_bc8.segIndex,_bcf[1]);var _bd3=new _b95({x:(_bd1.x+_bd2.x)/2,y:(_bd1.y+_bd2.y)/2,spatialReference:_bd1.spatialReference.toJson()});_bd1=_bc8.relatedGraphic.geometry.getPoint(_bc8.segIndex,_bd0[0]);_bd2=_bc8.relatedGraphic.geometry.getPoint(_bc8.segIndex,_bd0[1]);var _bd4=new _b95({x:(_bd1.x+_bd2.x)/2,y:(_bd1.y+_bd2.y)/2,spatialReference:_bd1.spatialReference.toJson()});var mvr1=new _b94(_bd3,this._symbol2,this.graphic,_bc8.segIndex,_bca,_bcd,this,true);var mvr2=new _b94(_bd4,this._symbol2,this.graphic,_bc8.segIndex,_bca+1,_bcd,this,true);_bce.splice(_bca,0,mvr1,mvr2);},_deleteVertex:function(_bd5){var i,_bd6=_bd5.segIndex,_bd7=_bd5.ptIndex;var _bd8=this._vertexMovers[_bd6];for(i=0;i<_bd7;i++){_bd8[i].segLength-=1;}for(i=_bd7+1;i<_bd8.length;i++){var mvr=_bd8[i];mvr.ptIndex-=1;mvr.segLength-=1;}_bd8.splice(_bd7,1);var info=_bd5._getInfo();_bd5.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});lang.mixin(GVE,{create:function(_bd9,map,_bda){var type=_bd9.geometry.type;switch(type){case "multipoint":return new GVE.MultipointVertexEditor(_bd9,map,_bda);break;case "polyline":return new GVE.PolylineVertexEditor(_bd9,map,_bda);break;case "polygon":return new GVE.PolygonVertexEditor(_bd9,map,_bda);break;}}});GVE.MultipointVertexEditor=_b8f(GVE,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=_b90.connect(_b94,"onMoveStart",this,this._moveStartHandler);_b90.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_b90.disconnect(this._moveStartHandle);},_getSegments:function(_bdb){var i,_bdc=_bdb.points,_bdd=[],sr=_bdb.spatialReference;for(i=0;i<_bdc.length;i++){var _bde=_bdc[i];_bdd.push(new _b95({x:_bde[0],y:_bde[1],spatialReference:sr.toJson()}));}return [_bdd];},_getMidpointSegments:function(_bdf){return [];},_getControlPoints:function(_be0,_be1,_be2,_be3,_be4){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _be5=evt.graphic,_be6=this._findMover(evt);if(_be6){this.toolbar.onVertexMouseOver(_be5,_be6._getInfo());this._selectedMover=_be6;if(this._canDel){this._bindCtxNode(_be6.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _be7=evt.graphic,_be8=this._findMover(evt);if(_be8){this.toolbar.onVertexMouseOut(_be7,_be8._getInfo());}},_findMover:function(evt){var i,_be9=[].concat(this._vertexMovers[0]),_bea=evt.target;for(i=0;i<_be9.length;i++){var _beb=_be9[i];if(_beb.graphic.getDojoShape().getNode()===_bea){return _beb;}}},_moveStartHandler:function(_bec){var geom=_bec.relatedGraphic.geometry,_bed=_bec.ptIndex;var _bee=_bec.segLength-1;var _bef=geom.points;var _bf0=_bef.splice(_bed,1);_bef.push(_bf0[0]);var j,_bf1=this._vertexMovers[0];for(j=_bee;j>_bed;j--){_bf1[j].ptIndex-=1;}_bf0=_bf1.splice(_bed,1);_bf1.push(_bf0[0]);_bf0[0].ptIndex=_bee;},_moveStopHandler:function(_bf2){this._updateRelatedGraphic(_bf2,_bf2.relatedGraphic,_bf2.graphic.geometry,_bf2.segIndex,_bf2.ptIndex,_bf2.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_bf3,_bf4,_bf5,_bf6,_bf7,_bf8,add,del){var geom=_bf4.geometry;if(del){geom.removePoint(_bf7);}else{geom.setPoint(_bf7,_bf5);}_bf4.setGeometry(geom);},_deleteMidpoints:function(_bf9){}});GVE.PolylineVertexEditor=_b8f(GVE,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(_bfa){var i,j,_bfb=_bfa.paths,_bfc=[];for(i=0;i<_bfb.length;i++){var path=_bfb[i],_bfd=[];for(j=0;j<path.length;j++){_bfd.push(_bfa.getPoint(i,j));}_bfc.push(_bfd);}return _bfc;},_getMidpointSegments:function(_bfe){var i,j,_bff=_bfe.paths,_c00=[],sr=_bfe.spatialReference;for(i=0;i<_bff.length;i++){var path=_bff[i],_c01=[];for(j=0;j<path.length-1;j++){var _c02=_bfe.getPoint(i,j),_c03=_bfe.getPoint(i,j+1);var midX=(_c02.x+_c03.x)/2,midY=(_c02.y+_c03.y)/2;var _c04=new _b95({x:midX,y:midY,spatialReference:sr.toJson()});_c01.push(_c04);}_c00.push(_c01);}return _c00;},_getControlPoints:function(_c05,_c06,_c07,_c08,_c09){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_c05)){idx1=_c08;idx2=_c08+1;if(idx1>=0){pt1=map.toScreen(_c06.getPoint(_c07,idx1));}if(idx2<=_c09){pt2=map.toScreen(_c06.getPoint(_c07,idx2));}}else{idx1=_c08-1;idx2=_c08+1;if(idx1>=0){pt1=map.toScreen(_c06.getPoint(_c07,idx1));}if(idx2<_c09){pt2=map.toScreen(_c06.getPoint(_c07,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_c0a,_c0b){var _c0c=[];var idx1=_c0a-1;if(idx1>=0){_c0c.push(idx1);}var idx2=_c0a;if(idx2<_c0b-1){_c0c.push(idx2);}return _c0c;},_getAdjacentVertices:function(_c0d,_c0e){return [_c0d,_c0d+1];},_deleteMidpoints:function(_c0f){var _c10=_c0f.segIndex,_c11=_c0f.ptIndex,_c12=_c0f.segLength;var _c13=this._mpVertexMovers[_c10],_c14=_c13.length-1;var _c15=this._getAdjacentMidpoints(_c11,_c12).sort();var i,min=_c15[0];for(i=0;i<min;i++){_c13[i].segLength-=1;}for(i=min+1;i<_c13.length;i++){var mvr=_c13[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_c15.length===1){_c13.splice(min,1)[0].destroy();}else{var _c16=this._getAdjacentVertices(min,_c14);var _c17=_c0f.relatedGraphic.geometry.getPoint(_c0f.segIndex,_c16[0]);var _c18=_c0f.relatedGraphic.geometry.getPoint(_c0f.segIndex,_c16[1]);var _c19=new _b95({x:(_c17.x+_c18.x)/2,y:(_c17.y+_c18.y)/2,spatialReference:_c17.spatialReference.toJson()});var mvr1=new _b94(_c19,this._symbol2,this.graphic,_c0f.segIndex,min,_c14,this,true);var _c1a=_c13.splice(min,_c15.length,mvr1);for(i=0;i<_c1a.length;i++){_c1a[i].destroy();}}},_updateRelatedGraphic:function(_c1b,_c1c,_c1d,_c1e,_c1f,_c20,add,del){var geom=_c1c.geometry;if(add){geom.insertPoint(_c1e,_c1f+1,_b96.fromJson(_c1d.toJson()));}else{if(del){geom.removePoint(_c1e,_c1f);}else{geom.setPoint(_c1e,_c1f,_b96.fromJson(_c1d.toJson()));}}_c1c.setGeometry(geom);}});GVE.PolygonVertexEditor=_b8f(GVE,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(_c21){var i,j,_c22=_c21.rings,_c23=[];for(i=0;i<_c22.length;i++){var ring=_c22[i],_c24=[];for(j=0;j<ring.length-1;j++){_c24.push(_c21.getPoint(i,j));}_c23.push(_c24);}return _c23;},_getMidpointSegments:function(_c25){var i,j,_c26=_c25.rings,_c27=[],sr=_c25.spatialReference;for(i=0;i<_c26.length;i++){var ring=_c26[i],_c28=[];for(j=0;j<ring.length-1;j++){var _c29=_c25.getPoint(i,j),_c2a=_c25.getPoint(i,j+1);var midX=(_c29.x+_c2a.x)/2,midY=(_c29.y+_c2a.y)/2;var _c2b=new _b95({x:midX,y:midY,spatialReference:sr.toJson()});_c28.push(_c2b);}_c27.push(_c28);}return _c27;},_getControlPoints:function(_c2c,_c2d,_c2e,_c2f,_c30){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_c2c)){idx1=_c2f;idx2=(_c2f+1)%_c30;}else{idx1=_c2f-1;idx1=idx1<0?(_c30+idx1)%_c30:idx1;idx2=(_c2f+1)%_c30;}pt1=map.toScreen(_c2d.getPoint(_c2e,idx1));pt2=map.toScreen(_c2d.getPoint(_c2e,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_c31,_c32){var idx1=_c31-1;idx1=idx1<0?(_c32+idx1)%_c32:idx1;var idx2=_c31;return [idx1,idx2];},_getAdjacentVertices:function(_c33,_c34){return [_c33,(_c33+1)%_c34];},_deleteMidpoints:function(_c35){var _c36=_c35.segIndex,_c37=_c35.ptIndex,_c38=_c35.segLength;var _c39=this._mpVertexMovers[_c36],_c3a=_c39.length-1,_c3b=this._getAdjacentMidpoints(_c37,_c38).sort(),_c3c,_c3d,_c3e,_c3f,i,mvr1,mvr,min=_c3b[0],max=_c3b[_c3b.length-1];if(_c37===0){_c3c=this._getAdjacentVertices(_c3a-1,_c3a);_c3d=_c35.relatedGraphic.geometry.getPoint(_c35.segIndex,_c3c[0]);_c3e=_c35.relatedGraphic.geometry.getPoint(_c35.segIndex,_c3c[1]);_c3f=new _b95({x:(_c3d.x+_c3e.x)/2,y:(_c3d.y+_c3e.y)/2,spatialReference:_c3d.spatialReference.toJson()});mvr1=new _b94(_c3f,this._symbol2,this.graphic,_c35.segIndex,_c3a-1,_c3a,this,true);_c39.splice(max,1,mvr1)[0].destroy();_c39.splice(min,1)[0].destroy();for(i=0;i<_c39.length-1;i++){mvr=_c39[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_c3c=this._getAdjacentVertices(min,_c3a);_c3d=_c35.relatedGraphic.geometry.getPoint(_c35.segIndex,_c3c[0]);_c3e=_c35.relatedGraphic.geometry.getPoint(_c35.segIndex,_c3c[1]);_c3f=new _b95({x:(_c3d.x+_c3e.x)/2,y:(_c3d.y+_c3e.y)/2,spatialReference:_c3d.spatialReference.toJson()});mvr1=new _b94(_c3f,this._symbol2,this.graphic,_c35.segIndex,min,_c3a,this,true);var _c40=_c39.splice(min,_c3b.length,mvr1);for(i=0;i<_c40.length;i++){_c40[i].destroy();}for(i=0;i<min;i++){_c39[i].segLength-=1;}for(i=min+1;i<_c39.length;i++){mvr=_c39[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_c41,_c42,_c43,_c44,_c45,_c46,add,del){var geom=_c42.geometry;if(add){geom.insertPoint(_c44,_c45+1,_b96.fromJson(_c43.toJson()));}else{if(del){geom.removePoint(_c44,_c45);if(_c45===0){geom.setPoint(_c44,_c46-1,_b96.fromJson(geom.getPoint(_c44,0).toJson()));}}else{geom.setPoint(_c44,_c45,_b96.fromJson(_c43.toJson()));if(_c45===0){geom.setPoint(_c44,_c46,_b96.fromJson(_c43.toJson()));}}}_c42.setGeometry(geom);}});if(has("extend-esri")){lang.setObject("toolbars._GraphicVertexEditor",GVE,_b93);lang.setObject("toolbars._MultipointVertexEditor",GVE.MultipointVertexEditor,_b93);lang.setObject("toolbars._PolylineVertexEditor",GVE.PolylineVertexEditor,_b93);lang.setObject("toolbars._PolygonVertexEditor",GVE.PolygonVertexEditor,_b93);}return GVE;});},"*now":function(r){r(["dojo/i18n!*preload*esri/dijit/editing/nls/TemplatePicker-all*[\"ar\",\"az\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ro\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);},"*noref":1}});define("esri/dijit/editing/TemplatePicker-all",["esri/layers/FeatureLayer","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/editing/TemplatePicker"],function(_c47,Draw,Edit,_c48){return {};});